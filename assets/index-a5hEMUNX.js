var G=Object.defineProperty;var z=(i,t,n)=>t in i?G(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var m=(i,t,n)=>(z(i,typeof t!="symbol"?t+"":t,n),n),O=(i,t,n)=>{if(!t.has(i))throw TypeError("Cannot "+n)};var h=(i,t,n)=>(O(i,t,"read from private field"),n?n.call(i):t.get(i)),x=(i,t,n)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,n)};import{r as u,j as s,F as B,l as D,m as U,n as V}from"./index-uaQOYxUX.js";import{G as L,S as N,c as T,V as r,u as p,b as X}from"./index-hTUbDY-1.js";import"./react-spring_web.modern-83pUniV1.js";var a;class f extends L{constructor(){super(...arguments);m(this,"age",Math.random()*6);x(this,a,10)}step(n){this.age+=n,this.age>h(this,a)&&this.grid.setAtIndex(this.index,this.grid.createEmpty()),this.grid.registerChanged(this)}getRGBA(){return[255,0,100,255-Math.min(this.age/h(this,a)*255,255)]}}a=new WeakMap;class Y extends N{createGrid(t){return new T({...t,createEmpty:n=>new f(n)})}step(t){this.grid.forEach(n=>{n.step(t)})}}function Q(){const i=r.create(160,90),t=u.useRef(null),n=u.useRef(void 0),[l,g]=u.useState(!0),[j,C]=p(void 0),[d,S]=p(r.create(0,0));u.useEffect(()=>{const e=t.current;e&&(l?e.start():e.stop())},[l]);function F(){const e=new Y({gridOptions:{size:i}}),o=e.grid;return o.set(r.create(3,3),new f(o)),e}function R(e){e.preventDefault()}function b(){C(void 0),n.current=void 0}function v(e){const o=e.target,{x:c,y:w,width:A,height:E}=o.getBoundingClientRect(),I=r.create(c,w),k=r.create(A,E);S(r.create(e.clientX,e.clientY).subtract(I).divide(k).multiply(i).floor())}function y({grid:e}){M(e)}function M(e){if(j.current===void 0)return;(n.current?e.getCellsInLine(n.current,d.current):[e.getAtPosition(d.current)]).forEach(c=>{c&&e.setAtIndex(c.index,new f(e))}),n.current=d.current}function P(){var e;(e=t.current)==null||e.clear()}return s.jsxs("div",{className:"route fluid",children:[s.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[s.jsx("button",{onClick:()=>g(e=>!e),children:l?s.jsxs(s.Fragment,{children:[s.jsx(B,{}),"stop"]}):s.jsxs(s.Fragment,{children:[s.jsx(D,{}),"start"]})}),s.jsxs("button",{onClick:()=>{var e;return(e=t.current)==null?void 0:e.step(.1)},children:[s.jsx(U,{}),"step"]}),s.jsxs("button",{onClick:()=>P(),children:[s.jsx(V,{}),"reset"]})]}),s.jsx(X,{ref:t,initSimulation:F,onStep:y,onPointerUp:b,onPointerMove:v,onContextMenu:R})]})}export{Q as default};
