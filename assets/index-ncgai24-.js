var N=Object.defineProperty;var J=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var b=(s,e,t)=>(J(s,typeof e!="symbol"?e+"":e,t),t),A=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var l=(s,e,t)=>(A(s,e,"read from private field"),t?t.call(s):e.get(s)),w=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},M=(s,e,t,r)=>(A(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var O=(s,e,t)=>(A(s,e,"access private method"),t);import{r as f,e as K,_ as Q,j as i,F as Z,i as $,l as tt,m as et}from"./index-Tp3dEnl-.js";import{G as nt,a as st,n as rt,u as p,V as j,b as it}from"./index-gwt7HjUD.js";class F extends nt{constructor(t,r){super(t);b(this,"alive",!1);b(this,"age",0);this.alive=r||!1,this.sleep(),this.color=this.getRGBA()}getRGBA(){return this.alive?[255,0,0,255]:[0,0,0,0]}}var a,m,C,T;class ot{constructor(e){w(this,C);w(this,a,void 0);w(this,m,!1);M(this,a,new st({...e,createEmpty:t=>new F(t)}))}start(){M(this,m,!0)}stop(){M(this,m,!1)}isRunning(){return l(this,m)}getGrid(){return l(this,a)}restart(){this.stop(),l(this,a).clear()}step(e){const t=l(this,a).map(r=>r.alive);l(this,a).forEach(r=>{let o=O(this,C,T).call(this,t,r);r.alive!==o&&l(this,a).setAtIndex(r.index,new F(l(this,a),o))},{})}}a=new WeakMap,m=new WeakMap,C=new WeakSet,T=function(e,t){let r=0;return rt.forEach(o=>{if(!t.position)return;const h=l(this,a).position2index(t.position.add(o));e[h]===!0&&r++}),t.alive&&(r<2||r>3)?!1:!t.alive&&r===3?!0:t.alive};function ut(s,e){if(!f.useContext(K))throw new Error("Hook can't be used outside of a burger menu context");const[r,o]=f.useState([]);f.useEffect(()=>{Q.isEqual(r,e)},[s,e])}function ft(){const t=.08333333333333333,r=f.useRef(null),o=f.useRef(),[h,q]=p(void 0),g=f.useRef(),x=f.useRef(void 0),[y,P]=p(void 0),[E,I]=p(new j(0,0)),[v,W]=p(!0),[k,B]=p(-1);f.useEffect(()=>(o.current=new ot({width:160,height:90}),q(o.current.getGrid()),S(),g.current=requestAnimationFrame(L),()=>{g.current!==void 0&&cancelAnimationFrame(g.current)}),[]),f.useEffect(()=>{const n=o.current;n&&(v.current?n.start():n.stop())},[v]),ut("actions",[{title:"yolo",action:()=>console.log("blerp")}]);function _(n){n.preventDefault()}function U(n){var H;const d=n.target,{x:c,y:u,width:R,height:G}=d.getBoundingClientRect(),z=new j(Math.floor((n.clientX-c)/R*160),Math.floor((n.clientY-u)/G*90)),D=(H=h.current)==null?void 0:H.get(z);D&&P(D.alive?"erase":"add")}function V(){P(void 0),x.current=void 0}function X(n){const d=n.target,{x:c,y:u,width:R,height:G}=d.getBoundingClientRect();I(new j(Math.floor((n.clientX-c)/R*160),Math.floor((n.clientY-u)/G*90)))}function L(n){var d;if(k.current===-1)B(n);else{const c=(n-k.current)/1e3;if(c>t){const u=o.current;if(!u)return;Y(u.getGrid()),v.current&&u.step(c),(d=r.current)==null||d.render(),B(n)}}g.current=requestAnimationFrame(L)}function Y(n){if(y.current===void 0||!o.current)return;(x.current?n.getPositionsInLine(x.current,E.current):[E.current]).forEach(u=>{n.get(u)&&n.set(u,new F(n,y.current==="add"))}),x.current=E.current}function S(){const n=o.current;if(!n)return;n.restart(),[[16,10],[17,10],[18,10],[18,9],[17,8]].forEach(c=>{var u;(u=h.current)==null||u.setAtPosition(new j(...c),new F(h.current,!0))})}return i.jsxs("div",{className:"route game-of-life",children:[i.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[i.jsx("button",{onClick:()=>W(n=>!n),children:v.current?i.jsxs(i.Fragment,{children:[i.jsx(Z,{}),"stop"]}):i.jsxs(i.Fragment,{children:[i.jsx($,{}),"start"]})}),i.jsxs("button",{onClick:()=>{var n;return(n=o.current)==null?void 0:n.step(1)},children:[i.jsx(tt,{}),"step"]}),i.jsxs("button",{onClick:()=>S(),children:[i.jsx(et,{}),"reset"]})]}),i.jsx(it,{ref:r,grid:h.current,onMouseDown:U,onMouseUp:V,onMouseMove:X,onContextMenu:_})]})}export{ft as default};
