import{b as Am,c as xo,g as Qr,k as kt,r as Vr,d as Q0,j as xn}from"./index-eXnB_Edc.js";import{r as Z0}from"./___vite-browser-external_commonjs-proxy-Gz-s7I_6.js";var is=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(is||{}),Cm=(i=>(i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS",i))(Cm||{}),gu=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(gu||{}),pt=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(pt||{}),lr=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(lr||{}),X=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(X||{}),ks=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(ks||{}),ut=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(ut||{}),J=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(J||{}),Yr=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Yr||{}),Zr=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(Zr||{}),Nr=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(Nr||{}),Me=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(Me||{}),Rr=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(Rr||{}),_c=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(_c||{}),Ke=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(Ke||{}),ie=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(ie||{}),te=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(te||{}),Br=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(Br||{});const J0={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},tt={ADAPTER:J0,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Ih=/iPhone/i,If=/iPod/i,Pf=/iPad/i,Rf=/\biOS-universal(?:.+)Mac\b/i,Ph=/\bAndroid(?:.+)Mobile\b/i,Mf=/Android/i,bs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,za=/Silk/i,Wr=/Windows Phone/i,Df=/\bWindows(?:.+)ARM\b/i,Bf=/BlackBerry/i,Ff=/BB10/i,Nf=/Opera Mini/i,Of=/\b(CriOS|Chrome)(?:.+)Mobile/i,kf=/Mobile(?:.+)Firefox\b/i,Lf=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function tv(i){return function(t){return t.test(i)}}function Uf(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,r=e.split("[FBAN");typeof r[1]<"u"&&(e=r[0]),r=e.split("Twitter"),typeof r[1]<"u"&&(e=r[0]);var s=tv(e),n={apple:{phone:s(Ih)&&!s(Wr),ipod:s(If),tablet:!s(Ih)&&(s(Pf)||Lf(t))&&!s(Wr),universal:s(Rf),device:(s(Ih)||s(If)||s(Pf)||s(Rf)||Lf(t))&&!s(Wr)},amazon:{phone:s(bs),tablet:!s(bs)&&s(za),device:s(bs)||s(za)},android:{phone:!s(Wr)&&s(bs)||!s(Wr)&&s(Ph),tablet:!s(Wr)&&!s(bs)&&!s(Ph)&&(s(za)||s(Mf)),device:!s(Wr)&&(s(bs)||s(za)||s(Ph)||s(Mf))||s(/\bokhttp\b/i)},windows:{phone:s(Wr),tablet:s(Df),device:s(Wr)||s(Df)},other:{blackberry:s(Bf),blackberry10:s(Ff),opera:s(Nf),firefox:s(kf),chrome:s(Of),device:s(Bf)||s(Ff)||s(Nf)||s(kf)||s(Of)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const ev=Uf.default??Uf,qr=ev(globalThis.navigator);tt.RETINA_PREFIX=/@([0-9\.]+)x/;tt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Im={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function s(u,d,p){this.fn=u,this.context=d,this.once=p||!1}function n(u,d,p,g,y){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new s(p,g||u,y),x=e?e+d:d;return u._events[x]?u._events[x].fn?u._events[x]=[u._events[x],v]:u._events[x].push(v):(u._events[x]=v,u._eventsCount++),u}function l(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function h(){this._events=new r,this._eventsCount=0}h.prototype.eventNames=function(){var d=[],p,g;if(this._eventsCount===0)return d;for(g in p=this._events)t.call(p,g)&&d.push(e?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(p)):d},h.prototype.listeners=function(d){var p=e?e+d:d,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var y=0,v=g.length,x=new Array(v);y<v;y++)x[y]=g[y].fn;return x},h.prototype.listenerCount=function(d){var p=e?e+d:d,g=this._events[p];return g?g.fn?1:g.length:0},h.prototype.emit=function(d,p,g,y,v,x){var b=e?e+d:d;if(!this._events[b])return!1;var T=this._events[b],S=arguments.length,I,w;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),S){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,g),!0;case 4:return T.fn.call(T.context,p,g,y),!0;case 5:return T.fn.call(T.context,p,g,y,v),!0;case 6:return T.fn.call(T.context,p,g,y,v,x),!0}for(w=1,I=new Array(S-1);w<S;w++)I[w-1]=arguments[w];T.fn.apply(T.context,I)}else{var C=T.length,N;for(w=0;w<C;w++)switch(T[w].once&&this.removeListener(d,T[w].fn,void 0,!0),S){case 1:T[w].fn.call(T[w].context);break;case 2:T[w].fn.call(T[w].context,p);break;case 3:T[w].fn.call(T[w].context,p,g);break;case 4:T[w].fn.call(T[w].context,p,g,y);break;default:if(!I)for(N=1,I=new Array(S-1);N<S;N++)I[N-1]=arguments[N];T[w].fn.apply(T[w].context,I)}}return!0},h.prototype.on=function(d,p,g){return n(this,d,p,g,!1)},h.prototype.once=function(d,p,g){return n(this,d,p,g,!0)},h.prototype.removeListener=function(d,p,g,y){var v=e?e+d:d;if(!this._events[v])return this;if(!p)return l(this,v),this;var x=this._events[v];if(x.fn)x.fn===p&&(!y||x.once)&&(!g||x.context===g)&&l(this,v);else{for(var b=0,T=[],S=x.length;b<S;b++)(x[b].fn!==p||y&&!x[b].once||g&&x[b].context!==g)&&T.push(x[b]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},h.prototype.removeAllListeners=function(d){var p;return d?(p=e?e+d:d,this._events[p]&&l(this,p)):(this._events=new r,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=e,h.EventEmitter=h,i.exports=h})(Im);var rv=Im.exports;const Yn=Am(rv);var xc={exports:{}};xc.exports=Jo;xc.exports.default=Jo;function Jo(i,t,e){e=e||2;var r=t&&t.length,s=r?t[0]*e:i.length,n=Pm(i,0,s,e,!0),l=[];if(!n||n.next===n.prev)return l;var h,u,d,p,g,y,v;if(r&&(n=ov(i,t,n,e)),i.length>80*e){h=d=i[0],u=p=i[1];for(var x=e;x<s;x+=e)g=i[x],y=i[x+1],g<h&&(h=g),y<u&&(u=y),g>d&&(d=g),y>p&&(p=y);v=Math.max(d-h,p-u),v=v!==0?32767/v:0}return Gn(n,l,e,h,u,v,0),l}function Pm(i,t,e,r,s){var n,l;if(s===_u(i,t,e,r)>0)for(n=t;n<e;n+=r)l=Gf(n,i[n],i[n+1],l);else for(n=e-r;n>=t;n-=r)l=Gf(n,i[n],i[n+1],l);return l&&tl(l,l.next)&&(zn(l),l=l.next),l}function es(i,t){if(!i)return i;t||(t=i);var e=i,r;do if(r=!1,!e.steiner&&(tl(e,e.next)||jt(e.prev,e,e.next)===0)){if(zn(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Gn(i,t,e,r,s,n,l){if(i){!l&&n&&dv(i,r,s,n);for(var h=i,u,d;i.prev!==i.next;){if(u=i.prev,d=i.next,n?sv(i,r,s,n):iv(i)){t.push(u.i/e|0),t.push(i.i/e|0),t.push(d.i/e|0),zn(i),i=d.next,h=d.next;continue}if(i=d,i===h){l?l===1?(i=nv(es(i),t,e),Gn(i,t,e,r,s,n,2)):l===2&&av(i,t,e,r,s,n):Gn(es(i),t,e,r,s,n,1);break}}}}function iv(i){var t=i.prev,e=i,r=i.next;if(jt(t,e,r)>=0)return!1;for(var s=t.x,n=e.x,l=r.x,h=t.y,u=e.y,d=r.y,p=s<n?s<l?s:l:n<l?n:l,g=h<u?h<d?h:d:u<d?u:d,y=s>n?s>l?s:l:n>l?n:l,v=h>u?h>d?h:d:u>d?u:d,x=r.next;x!==t;){if(x.x>=p&&x.x<=y&&x.y>=g&&x.y<=v&&Fs(s,h,n,u,l,d,x.x,x.y)&&jt(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function sv(i,t,e,r){var s=i.prev,n=i,l=i.next;if(jt(s,n,l)>=0)return!1;for(var h=s.x,u=n.x,d=l.x,p=s.y,g=n.y,y=l.y,v=h<u?h<d?h:d:u<d?u:d,x=p<g?p<y?p:y:g<y?g:y,b=h>u?h>d?h:d:u>d?u:d,T=p>g?p>y?p:y:g>y?g:y,S=yu(v,x,t,e,r),I=yu(b,T,t,e,r),w=i.prevZ,C=i.nextZ;w&&w.z>=S&&C&&C.z<=I;){if(w.x>=v&&w.x<=b&&w.y>=x&&w.y<=T&&w!==s&&w!==l&&Fs(h,p,u,g,d,y,w.x,w.y)&&jt(w.prev,w,w.next)>=0||(w=w.prevZ,C.x>=v&&C.x<=b&&C.y>=x&&C.y<=T&&C!==s&&C!==l&&Fs(h,p,u,g,d,y,C.x,C.y)&&jt(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;w&&w.z>=S;){if(w.x>=v&&w.x<=b&&w.y>=x&&w.y<=T&&w!==s&&w!==l&&Fs(h,p,u,g,d,y,w.x,w.y)&&jt(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;C&&C.z<=I;){if(C.x>=v&&C.x<=b&&C.y>=x&&C.y<=T&&C!==s&&C!==l&&Fs(h,p,u,g,d,y,C.x,C.y)&&jt(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function nv(i,t,e){var r=i;do{var s=r.prev,n=r.next.next;!tl(s,n)&&Rm(s,r,r.next,n)&&Hn(s,n)&&Hn(n,s)&&(t.push(s.i/e|0),t.push(r.i/e|0),t.push(n.i/e|0),zn(r),zn(r.next),r=i=n),r=r.next}while(r!==i);return es(r)}function av(i,t,e,r,s,n){var l=i;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&mv(l,h)){var u=Mm(l,h);l=es(l,l.next),u=es(u,u.next),Gn(l,t,e,r,s,n,0),Gn(u,t,e,r,s,n,0);return}h=h.next}l=l.next}while(l!==i)}function ov(i,t,e,r){var s=[],n,l,h,u,d;for(n=0,l=t.length;n<l;n++)h=t[n]*r,u=n<l-1?t[n+1]*r:i.length,d=Pm(i,h,u,r,!1),d===d.next&&(d.steiner=!0),s.push(pv(d));for(s.sort(lv),n=0;n<s.length;n++)e=hv(s[n],e);return e}function lv(i,t){return i.x-t.x}function hv(i,t){var e=uv(i,t);if(!e)return t;var r=Mm(e,i);return es(r,r.next),es(e,e.next)}function uv(i,t){var e=t,r=i.x,s=i.y,n=-1/0,l;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var h=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(h<=r&&h>n&&(n=h,l=e.x<e.next.x?e:e.next,h===r))return l}e=e.next}while(e!==t);if(!l)return null;var u=l,d=l.x,p=l.y,g=1/0,y;e=l;do r>=e.x&&e.x>=d&&r!==e.x&&Fs(s<p?r:n,s,d,p,s<p?n:r,s,e.x,e.y)&&(y=Math.abs(s-e.y)/(r-e.x),Hn(e,i)&&(y<g||y===g&&(e.x>l.x||e.x===l.x&&cv(l,e)))&&(l=e,g=y)),e=e.next;while(e!==u);return l}function cv(i,t){return jt(i.prev,i,t.prev)<0&&jt(t.next,i,i.next)<0}function dv(i,t,e,r){var s=i;do s.z===0&&(s.z=yu(s.x,s.y,t,e,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,fv(s)}function fv(i){var t,e,r,s,n,l,h,u,d=1;do{for(e=i,i=null,n=null,l=0;e;){for(l++,r=e,h=0,t=0;t<d&&(h++,r=r.nextZ,!!r);t++);for(u=d;h>0||u>0&&r;)h!==0&&(u===0||!r||e.z<=r.z)?(s=e,e=e.nextZ,h--):(s=r,r=r.nextZ,u--),n?n.nextZ=s:i=s,s.prevZ=n,n=s;e=r}n.nextZ=null,d*=2}while(l>1);return i}function yu(i,t,e,r,s){return i=(i-e)*s|0,t=(t-r)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function pv(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Fs(i,t,e,r,s,n,l,h){return(s-l)*(t-h)>=(i-l)*(n-h)&&(i-l)*(r-h)>=(e-l)*(t-h)&&(e-l)*(n-h)>=(s-l)*(r-h)}function mv(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!gv(i,t)&&(Hn(i,t)&&Hn(t,i)&&yv(i,t)&&(jt(i.prev,i,t.prev)||jt(i,t.prev,t))||tl(i,t)&&jt(i.prev,i,i.next)>0&&jt(t.prev,t,t.next)>0)}function jt(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function tl(i,t){return i.x===t.x&&i.y===t.y}function Rm(i,t,e,r){var s=Wa(jt(i,t,e)),n=Wa(jt(i,t,r)),l=Wa(jt(e,r,i)),h=Wa(jt(e,r,t));return!!(s!==n&&l!==h||s===0&&$a(i,e,t)||n===0&&$a(i,r,t)||l===0&&$a(e,i,r)||h===0&&$a(e,t,r))}function $a(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Wa(i){return i>0?1:i<0?-1:0}function gv(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Rm(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Hn(i,t){return jt(i.prev,i,i.next)<0?jt(i,t,i.next)>=0&&jt(i,i.prev,t)>=0:jt(i,t,i.prev)<0||jt(i,i.next,t)<0}function yv(i,t){var e=i,r=!1,s=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==i);return r}function Mm(i,t){var e=new vu(i.i,i.x,i.y),r=new vu(t.i,t.x,t.y),s=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=s,s.prev=e,r.next=e,e.prev=r,n.next=r,r.prev=n,r}function Gf(i,t,e,r){var s=new vu(i,t,e);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function zn(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function vu(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jo.deviation=function(i,t,e,r){var s=t&&t.length,n=s?t[0]*e:i.length,l=Math.abs(_u(i,0,n,e));if(s)for(var h=0,u=t.length;h<u;h++){var d=t[h]*e,p=h<u-1?t[h+1]*e:i.length;l-=Math.abs(_u(i,d,p,e))}var g=0;for(h=0;h<r.length;h+=3){var y=r[h]*e,v=r[h+1]*e,x=r[h+2]*e;g+=Math.abs((i[y]-i[x])*(i[v+1]-i[y+1])-(i[y]-i[v])*(i[x+1]-i[y+1]))}return l===0&&g===0?0:Math.abs((g-l)/l)};function _u(i,t,e,r){for(var s=0,n=t,l=e-r;n<e;n+=r)s+=(i[l]-i[n])*(i[n+1]+i[l+1]),l=n;return s}Jo.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<i.length;s++){for(var n=0;n<i[s].length;n++)for(var l=0;l<t;l++)e.vertices.push(i[s][n][l]);s>0&&(r+=i[s-1].length,e.holes.push(r))}return e};var vv=xc.exports;const _v=Am(vv);var Mo={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Mo.exports;(function(i,t){(function(e){var r=t&&!t.nodeType&&t,s=i&&!i.nodeType&&i,n=typeof xo=="object"&&xo;(n.global===n||n.window===n||n.self===n)&&(e=n);var l,h=2147483647,u=36,d=1,p=26,g=38,y=700,v=72,x=128,b="-",T=/^xn--/,S=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=u-d,N=Math.floor,V=String.fromCharCode,z;function G(F){throw new RangeError(w[F])}function Y(F,H){for(var ct=F.length,Et=[];ct--;)Et[ct]=H(F[ct]);return Et}function rt(F,H){var ct=F.split("@"),Et="";ct.length>1&&(Et=ct[0]+"@",F=ct[1]),F=F.replace(I,".");var _t=F.split("."),Dt=Y(_t,H).join(".");return Et+Dt}function mt(F){for(var H=[],ct=0,Et=F.length,_t,Dt;ct<Et;)_t=F.charCodeAt(ct++),_t>=55296&&_t<=56319&&ct<Et?(Dt=F.charCodeAt(ct++),(Dt&64512)==56320?H.push(((_t&1023)<<10)+(Dt&1023)+65536):(H.push(_t),ct--)):H.push(_t);return H}function Z(F){return Y(F,function(H){var ct="";return H>65535&&(H-=65536,ct+=V(H>>>10&1023|55296),H=56320|H&1023),ct+=V(H),ct}).join("")}function M(F){return F-48<10?F-22:F-65<26?F-65:F-97<26?F-97:u}function W(F,H){return F+22+75*(F<26)-((H!=0)<<5)}function it(F,H,ct){var Et=0;for(F=ct?N(F/y):F>>1,F+=N(F/H);F>C*p>>1;Et+=u)F=N(F/C);return N(Et+(C+1)*F/(F+g))}function ft(F){var H=[],ct=F.length,Et,_t=0,Dt=x,Pt=v,Bt,ne,fe,Xt,xt,Ot,At,Ue,Ge;for(Bt=F.lastIndexOf(b),Bt<0&&(Bt=0),ne=0;ne<Bt;++ne)F.charCodeAt(ne)>=128&&G("not-basic"),H.push(F.charCodeAt(ne));for(fe=Bt>0?Bt+1:0;fe<ct;){for(Xt=_t,xt=1,Ot=u;fe>=ct&&G("invalid-input"),At=M(F.charCodeAt(fe++)),(At>=u||At>N((h-_t)/xt))&&G("overflow"),_t+=At*xt,Ue=Ot<=Pt?d:Ot>=Pt+p?p:Ot-Pt,!(At<Ue);Ot+=u)Ge=u-Ue,xt>N(h/Ge)&&G("overflow"),xt*=Ge;Et=H.length+1,Pt=it(_t-Xt,Et,Xt==0),N(_t/Et)>h-Dt&&G("overflow"),Dt+=N(_t/Et),_t%=Et,H.splice(_t++,0,Dt)}return Z(H)}function nt(F){var H,ct,Et,_t,Dt,Pt,Bt,ne,fe,Xt,xt,Ot=[],At,Ue,Ge,Ri;for(F=mt(F),At=F.length,H=x,ct=0,Dt=v,Pt=0;Pt<At;++Pt)xt=F[Pt],xt<128&&Ot.push(V(xt));for(Et=_t=Ot.length,_t&&Ot.push(b);Et<At;){for(Bt=h,Pt=0;Pt<At;++Pt)xt=F[Pt],xt>=H&&xt<Bt&&(Bt=xt);for(Ue=Et+1,Bt-H>N((h-ct)/Ue)&&G("overflow"),ct+=(Bt-H)*Ue,H=Bt,Pt=0;Pt<At;++Pt)if(xt=F[Pt],xt<H&&++ct>h&&G("overflow"),xt==H){for(ne=ct,fe=u;Xt=fe<=Dt?d:fe>=Dt+p?p:fe-Dt,!(ne<Xt);fe+=u)Ri=ne-Xt,Ge=u-Xt,Ot.push(V(W(Xt+Ri%Ge,0))),ne=N(Ri/Ge);Ot.push(V(W(ne,0))),Dt=it(ct,Ue,Et==_t),ct=0,++Et}++ct,++H}return Ot.join("")}function k(F){return rt(F,function(H){return T.test(H)?ft(H.slice(4).toLowerCase()):H})}function et(F){return rt(F,function(H){return S.test(H)?"xn--"+nt(H):H})}if(l={version:"1.4.1",ucs2:{decode:mt,encode:Z},decode:ft,encode:nt,toASCII:et,toUnicode:k},r&&s)if(i.exports==r)s.exports=l;else for(z in l)l.hasOwnProperty(z)&&(r[z]=l[z]);else e.punycode=l})(xo)})(Mo,Mo.exports);var xv=Mo.exports,bv=Error,Ev=EvalError,Tv=RangeError,wv=ReferenceError,Dm=SyntaxError,qn=TypeError,Sv=URIError,Av=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),r=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,e);if(l.value!==s||l.enumerable!==!0)return!1}return!0},Hf=typeof Symbol<"u"&&Symbol,Cv=Av,Iv=function(){return typeof Hf!="function"||typeof Symbol!="function"||typeof Hf("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Cv()},zf={foo:{}},Pv=Object,Rv=function(){return{__proto__:zf}.foo===zf.foo&&!({__proto__:null}instanceof Pv)},Mv="Function.prototype.bind called on incompatible ",Dv=Object.prototype.toString,Bv=Math.max,Fv="[object Function]",$f=function(t,e){for(var r=[],s=0;s<t.length;s+=1)r[s]=t[s];for(var n=0;n<e.length;n+=1)r[n+t.length]=e[n];return r},Nv=function(t,e){for(var r=[],s=e||0,n=0;s<t.length;s+=1,n+=1)r[n]=t[s];return r},Ov=function(i,t){for(var e="",r=0;r<i.length;r+=1)e+=i[r],r+1<i.length&&(e+=t);return e},kv=function(t){var e=this;if(typeof e!="function"||Dv.apply(e)!==Fv)throw new TypeError(Mv+e);for(var r=Nv(arguments,1),s,n=function(){if(this instanceof s){var p=e.apply(this,$f(r,arguments));return Object(p)===p?p:this}return e.apply(t,$f(r,arguments))},l=Bv(0,e.length-r.length),h=[],u=0;u<l;u++)h[u]="$"+u;if(s=Function("binder","return function ("+Ov(h,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var d=function(){};d.prototype=e.prototype,s.prototype=new d,d.prototype=null}return s},Lv=kv,bc=Function.prototype.bind||Lv,Uv=Function.prototype.call,Gv=Object.prototype.hasOwnProperty,Hv=bc,zv=Hv.call(Uv,Gv),Tt,$v=bv,Wv=Ev,jv=Tv,Xv=wv,js=Dm,Ls=qn,Vv=Sv,Bm=Function,Rh=function(i){try{return Bm('"use strict"; return ('+i+").constructor;")()}catch{}},Qi=Object.getOwnPropertyDescriptor;if(Qi)try{Qi({},"")}catch{Qi=null}var Mh=function(){throw new Ls},Yv=Qi?function(){try{return arguments.callee,Mh}catch{try{return Qi(arguments,"callee").get}catch{return Mh}}}():Mh,Es=Iv(),qv=Rv(),ue=Object.getPrototypeOf||(qv?function(i){return i.__proto__}:null),Cs={},Kv=typeof Uint8Array>"u"||!ue?Tt:ue(Uint8Array),Zi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Tt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Tt:ArrayBuffer,"%ArrayIteratorPrototype%":Es&&ue?ue([][Symbol.iterator]()):Tt,"%AsyncFromSyncIteratorPrototype%":Tt,"%AsyncFunction%":Cs,"%AsyncGenerator%":Cs,"%AsyncGeneratorFunction%":Cs,"%AsyncIteratorPrototype%":Cs,"%Atomics%":typeof Atomics>"u"?Tt:Atomics,"%BigInt%":typeof BigInt>"u"?Tt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Tt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Tt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Tt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$v,"%eval%":eval,"%EvalError%":Wv,"%Float32Array%":typeof Float32Array>"u"?Tt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Tt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Tt:FinalizationRegistry,"%Function%":Bm,"%GeneratorFunction%":Cs,"%Int8Array%":typeof Int8Array>"u"?Tt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Tt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Tt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Es&&ue?ue(ue([][Symbol.iterator]())):Tt,"%JSON%":typeof JSON=="object"?JSON:Tt,"%Map%":typeof Map>"u"?Tt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Es||!ue?Tt:ue(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Tt:Promise,"%Proxy%":typeof Proxy>"u"?Tt:Proxy,"%RangeError%":jv,"%ReferenceError%":Xv,"%Reflect%":typeof Reflect>"u"?Tt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Tt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Es||!ue?Tt:ue(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Tt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Es&&ue?ue(""[Symbol.iterator]()):Tt,"%Symbol%":Es?Symbol:Tt,"%SyntaxError%":js,"%ThrowTypeError%":Yv,"%TypedArray%":Kv,"%TypeError%":Ls,"%Uint8Array%":typeof Uint8Array>"u"?Tt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Tt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Tt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Tt:Uint32Array,"%URIError%":Vv,"%WeakMap%":typeof WeakMap>"u"?Tt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Tt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Tt:WeakSet};if(ue)try{null.error}catch(i){var Qv=ue(ue(i));Zi["%Error.prototype%"]=Qv}var Zv=function i(t){var e;if(t==="%AsyncFunction%")e=Rh("async function () {}");else if(t==="%GeneratorFunction%")e=Rh("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Rh("async function* () {}");else if(t==="%AsyncGenerator%"){var r=i("%AsyncGeneratorFunction%");r&&(e=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=i("%AsyncGenerator%");s&&ue&&(e=ue(s.prototype))}return Zi[t]=e,e},Wf={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Kn=bc,Do=zv,Jv=Kn.call(Function.call,Array.prototype.concat),t_=Kn.call(Function.apply,Array.prototype.splice),jf=Kn.call(Function.call,String.prototype.replace),Bo=Kn.call(Function.call,String.prototype.slice),e_=Kn.call(Function.call,RegExp.prototype.exec),r_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,i_=/\\(\\)?/g,s_=function(t){var e=Bo(t,0,1),r=Bo(t,-1);if(e==="%"&&r!=="%")throw new js("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&e!=="%")throw new js("invalid intrinsic syntax, expected opening `%`");var s=[];return jf(t,r_,function(n,l,h,u){s[s.length]=h?jf(u,i_,"$1"):l||n}),s},n_=function(t,e){var r=t,s;if(Do(Wf,r)&&(s=Wf[r],r="%"+s[0]+"%"),Do(Zi,r)){var n=Zi[r];if(n===Cs&&(n=Zv(r)),typeof n>"u"&&!e)throw new Ls("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:n}}throw new js("intrinsic "+t+" does not exist!")},qs=function(t,e){if(typeof t!="string"||t.length===0)throw new Ls("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Ls('"allowMissing" argument must be a boolean');if(e_(/^%?[^%]*%?$/,t)===null)throw new js("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=s_(t),s=r.length>0?r[0]:"",n=n_("%"+s+"%",e),l=n.name,h=n.value,u=!1,d=n.alias;d&&(s=d[0],t_(r,Jv([0,1],d)));for(var p=1,g=!0;p<r.length;p+=1){var y=r[p],v=Bo(y,0,1),x=Bo(y,-1);if((v==='"'||v==="'"||v==="`"||x==='"'||x==="'"||x==="`")&&v!==x)throw new js("property names with quotes must have matching quotes");if((y==="constructor"||!g)&&(u=!0),s+="."+y,l="%"+s+"%",Do(Zi,l))h=Zi[l];else if(h!=null){if(!(y in h)){if(!e)throw new Ls("base intrinsic for "+t+" exists, but the property is not available.");return}if(Qi&&p+1>=r.length){var b=Qi(h,y);g=!!b,g&&"get"in b&&!("originalValue"in b.get)?h=b.get:h=h[y]}else g=Do(h,y),h=h[y];g&&!u&&(Zi[l]=h)}}return h},Fm={exports:{}},Dh,Xf;function Ec(){if(Xf)return Dh;Xf=1;var i=qs,t=i("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return Dh=t,Dh}var a_=qs,bo=a_("%Object.getOwnPropertyDescriptor%",!0);if(bo)try{bo([],"length")}catch{bo=null}var Nm=bo,Vf=Ec(),o_=Dm,Ts=qn,Yf=Nm,l_=function(t,e,r){if(!t||typeof t!="object"&&typeof t!="function")throw new Ts("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new Ts("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Ts("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Ts("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Ts("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Ts("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,u=!!Yf&&Yf(t,e);if(Vf)Vf(t,e,{configurable:l===null&&u?u.configurable:!l,enumerable:s===null&&u?u.enumerable:!s,value:r,writable:n===null&&u?u.writable:!n});else if(h||!s&&!n&&!l)t[e]=r;else throw new o_("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},xu=Ec(),Om=function(){return!!xu};Om.hasArrayLengthDefineBug=function(){if(!xu)return null;try{return xu([],"length",{value:1}).length!==1}catch{return!0}};var h_=Om,u_=qs,qf=l_,c_=h_(),Kf=Nm,Qf=qn,d_=u_("%Math.floor%"),f_=function(t,e){if(typeof t!="function")throw new Qf("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||d_(e)!==e)throw new Qf("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],s=!0,n=!0;if("length"in t&&Kf){var l=Kf(t,"length");l&&!l.configurable&&(s=!1),l&&!l.writable&&(n=!1)}return(s||n||!r)&&(c_?qf(t,"length",e,!0,!0):qf(t,"length",e)),t};(function(i){var t=bc,e=qs,r=f_,s=qn,n=e("%Function.prototype.apply%"),l=e("%Function.prototype.call%"),h=e("%Reflect.apply%",!0)||t.call(l,n),u=Ec(),d=e("%Math.max%");i.exports=function(y){if(typeof y!="function")throw new s("a function is required");var v=h(t,l,arguments);return r(v,1+d(0,y.length-(arguments.length-1)),!0)};var p=function(){return h(t,n,arguments)};u?u(i.exports,"apply",{value:p}):i.exports.apply=p})(Fm);var p_=Fm.exports,km=qs,Lm=p_,m_=Lm(km("String.prototype.indexOf")),g_=function(t,e){var r=km(t,!!e);return typeof r=="function"&&m_(t,".prototype.")>-1?Lm(r):r},Tc=typeof Map=="function"&&Map.prototype,Bh=Object.getOwnPropertyDescriptor&&Tc?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Fo=Tc&&Bh&&typeof Bh.get=="function"?Bh.get:null,Zf=Tc&&Map.prototype.forEach,wc=typeof Set=="function"&&Set.prototype,Fh=Object.getOwnPropertyDescriptor&&wc?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,No=wc&&Fh&&typeof Fh.get=="function"?Fh.get:null,Jf=wc&&Set.prototype.forEach,y_=typeof WeakMap=="function"&&WeakMap.prototype,Nn=y_?WeakMap.prototype.has:null,v_=typeof WeakSet=="function"&&WeakSet.prototype,On=v_?WeakSet.prototype.has:null,__=typeof WeakRef=="function"&&WeakRef.prototype,tp=__?WeakRef.prototype.deref:null,x_=Boolean.prototype.valueOf,b_=Object.prototype.toString,E_=Function.prototype.toString,T_=String.prototype.match,Sc=String.prototype.slice,xi=String.prototype.replace,w_=String.prototype.toUpperCase,ep=String.prototype.toLowerCase,Um=RegExp.prototype.test,rp=Array.prototype.concat,Mr=Array.prototype.join,S_=Array.prototype.slice,ip=Math.floor,bu=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Nh=Object.getOwnPropertySymbols,Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ee=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xs||!0)?Symbol.toStringTag:null,Gm=Object.prototype.propertyIsEnumerable,sp=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(i){return i.__proto__}:null);function np(i,t){if(i===1/0||i===-1/0||i!==i||i&&i>-1e3&&i<1e3||Um.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof i=="number"){var r=i<0?-ip(-i):ip(i);if(r!==i){var s=String(r),n=Sc.call(t,s.length+1);return xi.call(s,e,"$&_")+"."+xi.call(xi.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return xi.call(t,e,"$&_")}var Tu=Z0,ap=Tu.custom,op=zm(ap)?ap:null,A_=function i(t,e,r,s){var n=e||{};if(yi(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(yi(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=yi(n,"customInspect")?n.customInspect:!0;if(typeof l!="boolean"&&l!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(yi(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(yi(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var h=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Wm(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return h?np(t,u):u}if(typeof t=="bigint"){var d=String(t)+"n";return h?np(t,d):d}var p=typeof n.depth>"u"?5:n.depth;if(typeof r>"u"&&(r=0),r>=p&&p>0&&typeof t=="object")return wu(t)?"[Array]":"[Object]";var g=W_(n,r);if(typeof s>"u")s=[];else if($m(s,t)>=0)return"[Circular]";function y(M,W,it){if(W&&(s=S_.call(s),s.push(W)),it){var ft={depth:n.depth};return yi(n,"quoteStyle")&&(ft.quoteStyle=n.quoteStyle),i(M,ft,r+1,s)}return i(M,n,r+1,s)}if(typeof t=="function"&&!lp(t)){var v=N_(t),x=ja(t,y);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(x.length>0?" { "+Mr.call(x,", ")+" }":"")}if(zm(t)){var b=Xs?xi.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Eu.call(t);return typeof t=="object"&&!Xs?bn(b):b}if(H_(t)){for(var T="<"+ep.call(String(t.nodeName)),S=t.attributes||[],I=0;I<S.length;I++)T+=" "+S[I].name+"="+Hm(C_(S[I].value),"double",n);return T+=">",t.childNodes&&t.childNodes.length&&(T+="..."),T+="</"+ep.call(String(t.nodeName))+">",T}if(wu(t)){if(t.length===0)return"[]";var w=ja(t,y);return g&&!$_(w)?"["+Su(w,g)+"]":"[ "+Mr.call(w,", ")+" ]"}if(P_(t)){var C=ja(t,y);return!("cause"in Error.prototype)&&"cause"in t&&!Gm.call(t,"cause")?"{ ["+String(t)+"] "+Mr.call(rp.call("[cause]: "+y(t.cause),C),", ")+" }":C.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Mr.call(C,", ")+" }"}if(typeof t=="object"&&l){if(op&&typeof t[op]=="function"&&Tu)return Tu(t,{depth:p-r});if(l!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(O_(t)){var N=[];return Zf&&Zf.call(t,function(M,W){N.push(y(W,t,!0)+" => "+y(M,t))}),hp("Map",Fo.call(t),N,g)}if(U_(t)){var V=[];return Jf&&Jf.call(t,function(M){V.push(y(M,t))}),hp("Set",No.call(t),V,g)}if(k_(t))return Oh("WeakMap");if(G_(t))return Oh("WeakSet");if(L_(t))return Oh("WeakRef");if(M_(t))return bn(y(Number(t)));if(B_(t))return bn(y(bu.call(t)));if(D_(t))return bn(x_.call(t));if(R_(t))return bn(y(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===xo)return"{ [object globalThis] }";if(!I_(t)&&!lp(t)){var z=ja(t,y),G=sp?sp(t)===Object.prototype:t instanceof Object||t.constructor===Object,Y=t instanceof Object?"":"null prototype",rt=!G&&Ee&&Object(t)===t&&Ee in t?Sc.call(Ci(t),8,-1):Y?"Object":"",mt=G||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",Z=mt+(rt||Y?"["+Mr.call(rp.call([],rt||[],Y||[]),": ")+"] ":"");return z.length===0?Z+"{}":g?Z+"{"+Su(z,g)+"}":Z+"{ "+Mr.call(z,", ")+" }"}return String(t)};function Hm(i,t,e){var r=(e.quoteStyle||t)==="double"?'"':"'";return r+i+r}function C_(i){return xi.call(String(i),/"/g,"&quot;")}function wu(i){return Ci(i)==="[object Array]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function I_(i){return Ci(i)==="[object Date]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function lp(i){return Ci(i)==="[object RegExp]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function P_(i){return Ci(i)==="[object Error]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function R_(i){return Ci(i)==="[object String]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function M_(i){return Ci(i)==="[object Number]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function D_(i){return Ci(i)==="[object Boolean]"&&(!Ee||!(typeof i=="object"&&Ee in i))}function zm(i){if(Xs)return i&&typeof i=="object"&&i instanceof Symbol;if(typeof i=="symbol")return!0;if(!i||typeof i!="object"||!Eu)return!1;try{return Eu.call(i),!0}catch{}return!1}function B_(i){if(!i||typeof i!="object"||!bu)return!1;try{return bu.call(i),!0}catch{}return!1}var F_=Object.prototype.hasOwnProperty||function(i){return i in this};function yi(i,t){return F_.call(i,t)}function Ci(i){return b_.call(i)}function N_(i){if(i.name)return i.name;var t=T_.call(E_.call(i),/^function\s*([\w$]+)/);return t?t[1]:null}function $m(i,t){if(i.indexOf)return i.indexOf(t);for(var e=0,r=i.length;e<r;e++)if(i[e]===t)return e;return-1}function O_(i){if(!Fo||!i||typeof i!="object")return!1;try{Fo.call(i);try{No.call(i)}catch{return!0}return i instanceof Map}catch{}return!1}function k_(i){if(!Nn||!i||typeof i!="object")return!1;try{Nn.call(i,Nn);try{On.call(i,On)}catch{return!0}return i instanceof WeakMap}catch{}return!1}function L_(i){if(!tp||!i||typeof i!="object")return!1;try{return tp.call(i),!0}catch{}return!1}function U_(i){if(!No||!i||typeof i!="object")return!1;try{No.call(i);try{Fo.call(i)}catch{return!0}return i instanceof Set}catch{}return!1}function G_(i){if(!On||!i||typeof i!="object")return!1;try{On.call(i,On);try{Nn.call(i,Nn)}catch{return!0}return i instanceof WeakSet}catch{}return!1}function H_(i){return!i||typeof i!="object"?!1:typeof HTMLElement<"u"&&i instanceof HTMLElement?!0:typeof i.nodeName=="string"&&typeof i.getAttribute=="function"}function Wm(i,t){if(i.length>t.maxStringLength){var e=i.length-t.maxStringLength,r="... "+e+" more character"+(e>1?"s":"");return Wm(Sc.call(i,0,t.maxStringLength),t)+r}var s=xi.call(xi.call(i,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,z_);return Hm(s,"single",t)}function z_(i){var t=i.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+w_.call(t.toString(16))}function bn(i){return"Object("+i+")"}function Oh(i){return i+" { ? }"}function hp(i,t,e,r){var s=r?Su(e,r):Mr.call(e,", ");return i+" ("+t+") {"+s+"}"}function $_(i){for(var t=0;t<i.length;t++)if($m(i[t],`
`)>=0)return!1;return!0}function W_(i,t){var e;if(i.indent==="	")e="	";else if(typeof i.indent=="number"&&i.indent>0)e=Mr.call(Array(i.indent+1)," ");else return null;return{base:e,prev:Mr.call(Array(t+1),e)}}function Su(i,t){if(i.length===0)return"";var e=`
`+t.prev+t.base;return e+Mr.call(i,","+e)+`
`+t.prev}function ja(i,t){var e=wu(i),r=[];if(e){r.length=i.length;for(var s=0;s<i.length;s++)r[s]=yi(i,s)?t(i[s],i):""}var n=typeof Nh=="function"?Nh(i):[],l;if(Xs){l={};for(var h=0;h<n.length;h++)l["$"+n[h]]=n[h]}for(var u in i)yi(i,u)&&(e&&String(Number(u))===u&&u<i.length||Xs&&l["$"+u]instanceof Symbol||(Um.call(/[^\w$]/,u)?r.push(t(u,i)+": "+t(i[u],i)):r.push(u+": "+t(i[u],i))));if(typeof Nh=="function")for(var d=0;d<n.length;d++)Gm.call(i,n[d])&&r.push("["+t(n[d])+"]: "+t(i[n[d]],i));return r}var jm=qs,Ks=g_,j_=A_,X_=qn,Xa=jm("%WeakMap%",!0),Va=jm("%Map%",!0),V_=Ks("WeakMap.prototype.get",!0),Y_=Ks("WeakMap.prototype.set",!0),q_=Ks("WeakMap.prototype.has",!0),K_=Ks("Map.prototype.get",!0),Q_=Ks("Map.prototype.set",!0),Z_=Ks("Map.prototype.has",!0),Ac=function(i,t){for(var e=i,r;(r=e.next)!==null;e=r)if(r.key===t)return e.next=r.next,r.next=i.next,i.next=r,r},J_=function(i,t){var e=Ac(i,t);return e&&e.value},tx=function(i,t,e){var r=Ac(i,t);r?r.value=e:i.next={key:t,next:i.next,value:e}},ex=function(i,t){return!!Ac(i,t)},rx=function(){var t,e,r,s={assert:function(n){if(!s.has(n))throw new X_("Side channel does not contain "+j_(n))},get:function(n){if(Xa&&n&&(typeof n=="object"||typeof n=="function")){if(t)return V_(t,n)}else if(Va){if(e)return K_(e,n)}else if(r)return J_(r,n)},has:function(n){if(Xa&&n&&(typeof n=="object"||typeof n=="function")){if(t)return q_(t,n)}else if(Va){if(e)return Z_(e,n)}else if(r)return ex(r,n);return!1},set:function(n,l){Xa&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new Xa),Y_(t,n,l)):Va?(e||(e=new Va),Q_(e,n,l)):(r||(r={key:{},next:null}),tx(r,n,l))}};return s},ix=String.prototype.replace,sx=/%20/g,kh={RFC1738:"RFC1738",RFC3986:"RFC3986"},Cc={default:kh.RFC3986,formatters:{RFC1738:function(i){return ix.call(i,sx,"+")},RFC3986:function(i){return String(i)}},RFC1738:kh.RFC1738,RFC3986:kh.RFC3986},nx=Cc,Lh=Object.prototype.hasOwnProperty,qi=Array.isArray,Tr=function(){for(var i=[],t=0;t<256;++t)i.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return i}(),ax=function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(qi(r)){for(var s=[],n=0;n<r.length;++n)typeof r[n]<"u"&&s.push(r[n]);e.obj[e.prop]=s}}},Xm=function(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},s=0;s<t.length;++s)typeof t[s]<"u"&&(r[s]=t[s]);return r},ox=function i(t,e,r){if(!e)return t;if(typeof e!="object"){if(qi(t))t.push(e);else if(t&&typeof t=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Lh.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var s=t;return qi(t)&&!qi(e)&&(s=Xm(t,r)),qi(t)&&qi(e)?(e.forEach(function(n,l){if(Lh.call(t,l)){var h=t[l];h&&typeof h=="object"&&n&&typeof n=="object"?t[l]=i(h,n,r):t.push(n)}else t[l]=n}),t):Object.keys(e).reduce(function(n,l){var h=e[l];return Lh.call(n,l)?n[l]=i(n[l],h,r):n[l]=h,n},s)},lx=function(t,e){return Object.keys(e).reduce(function(r,s){return r[s]=e[s],r},t)},hx=function(i,t,e){var r=i.replace(/\+/g," ");if(e==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},ux=function(t,e,r,s,n){if(t.length===0)return t;var l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),r==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var h="",u=0;u<l.length;++u){var d=l.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||n===nx.RFC1738&&(d===40||d===41)){h+=l.charAt(u);continue}if(d<128){h=h+Tr[d];continue}if(d<2048){h=h+(Tr[192|d>>6]+Tr[128|d&63]);continue}if(d<55296||d>=57344){h=h+(Tr[224|d>>12]+Tr[128|d>>6&63]+Tr[128|d&63]);continue}u+=1,d=65536+((d&1023)<<10|l.charCodeAt(u)&1023),h+=Tr[240|d>>18]+Tr[128|d>>12&63]+Tr[128|d>>6&63]+Tr[128|d&63]}return h},cx=function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],s=0;s<e.length;++s)for(var n=e[s],l=n.obj[n.prop],h=Object.keys(l),u=0;u<h.length;++u){var d=h[u],p=l[d];typeof p=="object"&&p!==null&&r.indexOf(p)===-1&&(e.push({obj:l,prop:d}),r.push(p))}return ax(e),t},dx=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},fx=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},px=function(t,e){return[].concat(t,e)},mx=function(t,e){if(qi(t)){for(var r=[],s=0;s<t.length;s+=1)r.push(e(t[s]));return r}return e(t)},Vm={arrayToObject:Xm,assign:lx,combine:px,compact:cx,decode:hx,encode:ux,isBuffer:fx,isRegExp:dx,maybeMap:mx,merge:ox},Ym=rx,Eo=Vm,kn=Cc,gx=Object.prototype.hasOwnProperty,qm={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Pr=Array.isArray,yx=Array.prototype.push,Km=function(i,t){yx.apply(i,Pr(t)?t:[t])},vx=Date.prototype.toISOString,up=kn.default,re={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Eo.encode,encodeValuesOnly:!1,format:up,formatter:kn.formatters[up],indices:!1,serializeDate:function(t){return vx.call(t)},skipNulls:!1,strictNullHandling:!1},_x=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Uh={},xx=function i(t,e,r,s,n,l,h,u,d,p,g,y,v,x,b,T,S,I){for(var w=t,C=I,N=0,V=!1;(C=C.get(Uh))!==void 0&&!V;){var z=C.get(t);if(N+=1,typeof z<"u"){if(z===N)throw new RangeError("Cyclic object value");V=!0}typeof C.get(Uh)>"u"&&(N=0)}if(typeof p=="function"?w=p(e,w):w instanceof Date?w=v(w):r==="comma"&&Pr(w)&&(w=Eo.maybeMap(w,function(F){return F instanceof Date?v(F):F})),w===null){if(l)return d&&!T?d(e,re.encoder,S,"key",x):e;w=""}if(_x(w)||Eo.isBuffer(w)){if(d){var G=T?e:d(e,re.encoder,S,"key",x);return[b(G)+"="+b(d(w,re.encoder,S,"value",x))]}return[b(e)+"="+b(String(w))]}var Y=[];if(typeof w>"u")return Y;var rt;if(r==="comma"&&Pr(w))T&&d&&(w=Eo.maybeMap(w,d)),rt=[{value:w.length>0?w.join(",")||null:void 0}];else if(Pr(p))rt=p;else{var mt=Object.keys(w);rt=g?mt.sort(g):mt}var Z=u?e.replace(/\./g,"%2E"):e,M=s&&Pr(w)&&w.length===1?Z+"[]":Z;if(n&&Pr(w)&&w.length===0)return M+"[]";for(var W=0;W<rt.length;++W){var it=rt[W],ft=typeof it=="object"&&typeof it.value<"u"?it.value:w[it];if(!(h&&ft===null)){var nt=y&&u?it.replace(/\./g,"%2E"):it,k=Pr(w)?typeof r=="function"?r(M,nt):M:M+(y?"."+nt:"["+nt+"]");I.set(t,N);var et=Ym();et.set(Uh,I),Km(Y,i(ft,k,r,s,n,l,h,u,r==="comma"&&T&&Pr(w)?null:d,p,g,y,v,x,b,T,S,et))}}return Y},bx=function(t){if(!t)return re;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||re.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=kn.default;if(typeof t.format<"u"){if(!gx.call(kn.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var s=kn.formatters[r],n=re.filter;(typeof t.filter=="function"||Pr(t.filter))&&(n=t.filter);var l;if(t.arrayFormat in qm?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=re.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:re.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:re.addQueryPrefix,allowDots:h,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:re.allowEmptyArrays,arrayFormat:l,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:re.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?re.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:re.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:re.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:re.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:re.encodeValuesOnly,filter:n,format:r,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:re.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:re.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:re.strictNullHandling}},Ex=function(i,t){var e=i,r=bx(t),s,n;typeof r.filter=="function"?(n=r.filter,e=n("",e)):Pr(r.filter)&&(n=r.filter,s=n);var l=[];if(typeof e!="object"||e===null)return"";var h=qm[r.arrayFormat],u=h==="comma"&&r.commaRoundTrip;s||(s=Object.keys(e)),r.sort&&s.sort(r.sort);for(var d=Ym(),p=0;p<s.length;++p){var g=s[p];r.skipNulls&&e[g]===null||Km(l,xx(e[g],g,h,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,d))}var y=l.join(r.delimiter),v=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),y.length>0?v+y:""},Vs=Vm,Au=Object.prototype.hasOwnProperty,Tx=Array.isArray,Kt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!0,decoder:Vs.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},wx=function(i){return i.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Qm=function(i,t){return i&&typeof i=="string"&&t.comma&&i.indexOf(",")>-1?i.split(","):i},Sx="utf8=%26%2310003%3B",Ax="utf8=%E2%9C%93",Cx=function(t,e){var r={__proto__:null},s=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,n=e.parameterLimit===1/0?void 0:e.parameterLimit,l=s.split(e.delimiter,n),h=-1,u,d=e.charset;if(e.charsetSentinel)for(u=0;u<l.length;++u)l[u].indexOf("utf8=")===0&&(l[u]===Ax?d="utf-8":l[u]===Sx&&(d="iso-8859-1"),h=u,u=l.length);for(u=0;u<l.length;++u)if(u!==h){var p=l[u],g=p.indexOf("]="),y=g===-1?p.indexOf("="):g+1,v,x;y===-1?(v=e.decoder(p,Kt.decoder,d,"key"),x=e.strictNullHandling?null:""):(v=e.decoder(p.slice(0,y),Kt.decoder,d,"key"),x=Vs.maybeMap(Qm(p.slice(y+1),e),function(T){return e.decoder(T,Kt.decoder,d,"value")})),x&&e.interpretNumericEntities&&d==="iso-8859-1"&&(x=wx(x)),p.indexOf("[]=")>-1&&(x=Tx(x)?[x]:x);var b=Au.call(r,v);b&&e.duplicates==="combine"?r[v]=Vs.combine(r[v],x):(!b||e.duplicates==="last")&&(r[v]=x)}return r},Ix=function(i,t,e,r){for(var s=r?t:Qm(t,e),n=i.length-1;n>=0;--n){var l,h=i[n];if(h==="[]"&&e.parseArrays)l=e.allowEmptyArrays&&s===""?[]:[].concat(s);else{l=e.plainObjects?Object.create(null):{};var u=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,d=e.decodeDotInKeys?u.replace(/%2E/g,"."):u,p=parseInt(d,10);!e.parseArrays&&d===""?l={0:s}:!isNaN(p)&&h!==d&&String(p)===d&&p>=0&&e.parseArrays&&p<=e.arrayLimit?(l=[],l[p]=s):d!=="__proto__"&&(l[d]=s)}s=l}return s},Px=function(t,e,r,s){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,l=/(\[[^[\]]*])/,h=/(\[[^[\]]*])/g,u=r.depth>0&&l.exec(n),d=u?n.slice(0,u.index):n,p=[];if(d){if(!r.plainObjects&&Au.call(Object.prototype,d)&&!r.allowPrototypes)return;p.push(d)}for(var g=0;r.depth>0&&(u=h.exec(n))!==null&&g<r.depth;){if(g+=1,!r.plainObjects&&Au.call(Object.prototype,u[1].slice(1,-1))&&!r.allowPrototypes)return;p.push(u[1])}return u&&p.push("["+n.slice(u.index)+"]"),Ix(p,e,r,s)}},Rx=function(t){if(!t)return Kt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?Kt.charset:t.charset,r=typeof t.duplicates>"u"?Kt.duplicates:t.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:Kt.allowDots:!!t.allowDots;return{allowDots:s,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Kt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Kt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Kt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Kt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Kt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:Kt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:Kt.decoder,delimiter:typeof t.delimiter=="string"||Vs.isRegExp(t.delimiter)?t.delimiter:Kt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Kt.depth,duplicates:r,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Kt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Kt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Kt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kt.strictNullHandling}},Mx=function(i,t){var e=Rx(t);if(i===""||i===null||typeof i>"u")return e.plainObjects?Object.create(null):{};for(var r=typeof i=="string"?Cx(i,e):i,s=e.plainObjects?Object.create(null):{},n=Object.keys(r),l=0;l<n.length;++l){var h=n[l],u=Px(h,r[h],e,typeof i=="string");s=Vs.merge(s,u,e)}return e.allowSparse===!0?s:Vs.compact(s)},Dx=Ex,Bx=Mx,Fx=Cc,Nx={formats:Fx,parse:Bx,stringify:Dx},Ox=xv;function Jr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var kx=/^([a-z0-9.+-]+:)/i,Lx=/:[0-9]*$/,Ux=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Gx=["<",">",'"',"`"," ","\r",`
`,"	"],Hx=["{","}","|","\\","^","`"].concat(Gx),Cu=["'"].concat(Hx),cp=["%","/","?",";","#"].concat(Cu),dp=["/","?","#"],zx=255,fp=/^[+a-z0-9A-Z_-]{0,63}$/,$x=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wx={javascript:!0,"javascript:":!0},Iu={javascript:!0,"javascript:":!0},Us={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Pu=Nx;function jx(i,t,e){if(i&&typeof i=="object"&&i instanceof Jr)return i;var r=new Jr;return r.parse(i,t,e),r}Jr.prototype.parse=function(i,t,e){if(typeof i!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var r=i.indexOf("?"),s=r!==-1&&r<i.indexOf("#")?"?":"#",n=i.split(s),l=/\\/g;n[0]=n[0].replace(l,"/"),i=n.join(s);var h=i;if(h=h.trim(),!e&&i.split("#").length===1){var u=Ux.exec(h);if(u)return this.path=h,this.href=h,this.pathname=u[1],u[2]?(this.search=u[2],t?this.query=Pu.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var d=kx.exec(h);if(d){d=d[0];var p=d.toLowerCase();this.protocol=p,h=h.substr(d.length)}if(e||d||h.match(/^\/\/[^@/]+@[^@/]+/)){var g=h.substr(0,2)==="//";g&&!(d&&Iu[d])&&(h=h.substr(2),this.slashes=!0)}if(!Iu[d]&&(g||d&&!Us[d])){for(var y=-1,v=0;v<dp.length;v++){var x=h.indexOf(dp[v]);x!==-1&&(y===-1||x<y)&&(y=x)}var b,T;y===-1?T=h.lastIndexOf("@"):T=h.lastIndexOf("@",y),T!==-1&&(b=h.slice(0,T),h=h.slice(T+1),this.auth=decodeURIComponent(b)),y=-1;for(var v=0;v<cp.length;v++){var x=h.indexOf(cp[v]);x!==-1&&(y===-1||x<y)&&(y=x)}y===-1&&(y=h.length),this.host=h.slice(0,y),h=h.slice(y),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var I=this.hostname.split(/\./),v=0,w=I.length;v<w;v++){var C=I[v];if(C&&!C.match(fp)){for(var N="",V=0,z=C.length;V<z;V++)C.charCodeAt(V)>127?N+="x":N+=C[V];if(!N.match(fp)){var G=I.slice(0,v),Y=I.slice(v+1),rt=C.match($x);rt&&(G.push(rt[1]),Y.unshift(rt[2])),Y.length&&(h="/"+Y.join(".")+h),this.hostname=G.join(".");break}}}this.hostname.length>zx?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=Ox.toASCII(this.hostname));var mt=this.port?":"+this.port:"",Z=this.hostname||"";this.host=Z+mt,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),h[0]!=="/"&&(h="/"+h))}if(!Wx[p])for(var v=0,w=Cu.length;v<w;v++){var M=Cu[v];if(h.indexOf(M)!==-1){var W=encodeURIComponent(M);W===M&&(W=escape(M)),h=h.split(M).join(W)}}var it=h.indexOf("#");it!==-1&&(this.hash=h.substr(it),h=h.slice(0,it));var ft=h.indexOf("?");if(ft!==-1?(this.search=h.substr(ft),this.query=h.substr(ft+1),t&&(this.query=Pu.parse(this.query)),h=h.slice(0,ft)):t&&(this.search="",this.query={}),h&&(this.pathname=h),Us[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var mt=this.pathname||"",nt=this.search||"";this.path=mt+nt}return this.href=this.format(),this};Jr.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",r=this.hash||"",s=!1,n="";this.host?s=i+this.host:this.hostname&&(s=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Pu.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var l=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Us[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),r&&r.charAt(0)!=="#"&&(r="#"+r),l&&l.charAt(0)!=="?"&&(l="?"+l),e=e.replace(/[?#]/g,function(h){return encodeURIComponent(h)}),l=l.replace("#","%23"),t+s+e+l+r};Jr.prototype.resolve=function(i){return this.resolveObject(jx(i,!1,!0)).format()};Jr.prototype.resolveObject=function(i){if(typeof i=="string"){var t=new Jr;t.parse(i,!1,!0),i=t}for(var e=new Jr,r=Object.keys(this),s=0;s<r.length;s++){var n=r[s];e[n]=this[n]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var l=Object.keys(i),h=0;h<l.length;h++){var u=l[h];u!=="protocol"&&(e[u]=i[u])}return Us[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!Us[i.protocol]){for(var d=Object.keys(i),p=0;p<d.length;p++){var g=d[p];e[g]=i[g]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!Iu[i.protocol]){for(var w=(i.pathname||"").split("/");w.length&&!(i.host=w.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),w[0]!==""&&w.unshift(""),w.length<2&&w.unshift(""),e.pathname=w.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var y=e.pathname||"",v=e.search||"";e.path=y+v}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var x=e.pathname&&e.pathname.charAt(0)==="/",b=i.host||i.pathname&&i.pathname.charAt(0)==="/",T=b||x||e.host&&i.pathname,S=T,I=e.pathname&&e.pathname.split("/")||[],w=i.pathname&&i.pathname.split("/")||[],C=e.protocol&&!Us[e.protocol];if(C&&(e.hostname="",e.port=null,e.host&&(I[0]===""?I[0]=e.host:I.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(w[0]===""?w[0]=i.host:w.unshift(i.host)),i.host=null),T=T&&(w[0]===""||I[0]==="")),b)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,I=w;else if(w.length)I||(I=[]),I.pop(),I=I.concat(w),e.search=i.search,e.query=i.query;else if(i.search!=null){if(C){e.host=I.shift(),e.hostname=e.host;var N=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;N&&(e.auth=N.shift(),e.hostname=N.shift(),e.host=e.hostname)}return e.search=i.search,e.query=i.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!I.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var V=I.slice(-1)[0],z=(e.host||i.host||I.length>1)&&(V==="."||V==="..")||V==="",G=0,Y=I.length;Y>=0;Y--)V=I[Y],V==="."?I.splice(Y,1):V===".."?(I.splice(Y,1),G++):G&&(I.splice(Y,1),G--);if(!T&&!S)for(;G--;G)I.unshift("..");T&&I[0]!==""&&(!I[0]||I[0].charAt(0)!=="/")&&I.unshift(""),z&&I.join("/").substr(-1)!=="/"&&I.push("");var rt=I[0]===""||I[0]&&I[0].charAt(0)==="/";if(C){e.hostname=rt?"":I.length?I.shift():"",e.host=e.hostname;var N=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;N&&(e.auth=N.shift(),e.hostname=N.shift(),e.host=e.hostname)}return T=T||e.host&&I.length,T&&!rt&&I.unshift(""),I.length>0?e.pathname=I.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};Jr.prototype.parseHost=function(){var i=this.host,t=Lx.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const pp={};function bt(i,t,e=3){if(pp[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(r))),pp[t]=!0}function ir(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function En(i){return i.split("?")[0].split("#")[0]}function Xx(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Vx(i,t,e){return i.replace(new RegExp(Xx(t),"g"),e)}function Yx(i,t){let e="",r=0,s=-1,n=0,l=-1;for(let h=0;h<=i.length;++h){if(h<i.length)l=i.charCodeAt(h);else{if(l===47)break;l=47}if(l===47){if(!(s===h-1||n===1))if(s!==h-1&&n===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const u=e.lastIndexOf("/");if(u!==e.length-1){u===-1?(e="",r=0):(e=e.slice(0,u),r=e.length-1-e.lastIndexOf("/")),s=h,n=0;continue}}else if(e.length===2||e.length===1){e="",r=0,s=h,n=0;continue}}t&&(e.length>0?e+="/..":e="..",r=2)}else e.length>0?e+=`/${i.slice(s+1,h)}`:e=i.slice(s+1,h),r=h-s-1;s=h,n=0}else l===46&&n!==-1?++n:n=-1}return e}const se={toPosix(i){return Vx(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){ir(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(ir(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const r=En(this.toPosix(t??tt.ADAPTER.getBaseUrl())),s=En(this.toPosix(e??this.rootname(r)));return i=this.toPosix(i),i.startsWith("/")?se.join(s,i.slice(1)):this.isAbsolute(i)?i:this.join(r,i)},normalize(i){if(ir(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const r=i.endsWith("/");return i=Yx(i,!1),i.length>0&&r&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return ir(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const r=i[e];if(ir(r),r.length>0)if(t===void 0)t=r;else{const s=i[e-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(ir(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let r=-1,s=!0;const n=this.getProtocol(i),l=i;i=i.slice(n.length);for(let h=i.length-1;h>=1;--h)if(t=i.charCodeAt(h),t===47){if(!s){r=h;break}}else s=!1;return r===-1?e?"/":this.isUrl(l)?n+i:n:e&&r===1?"//":n+i.slice(0,r)},rootname(i){ir(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){ir(i),t&&ir(t),i=En(this.toPosix(i));let e=0,r=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let l=t.length-1,h=-1;for(n=i.length-1;n>=0;--n){const u=i.charCodeAt(n);if(u===47){if(!s){e=n+1;break}}else h===-1&&(s=!1,h=n+1),l>=0&&(u===t.charCodeAt(l)?--l===-1&&(r=n):(l=-1,r=h))}return e===r?r=h:r===-1&&(r=i.length),i.slice(e,r)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!s){e=n+1;break}}else r===-1&&(s=!1,r=n+1);return r===-1?"":i.slice(e,r)},extname(i){ir(i),i=En(this.toPosix(i));let t=-1,e=0,r=-1,s=!0,n=0;for(let l=i.length-1;l>=0;--l){const h=i.charCodeAt(l);if(h===47){if(!s){e=l+1;break}continue}r===-1&&(s=!1,r=l+1),h===46?t===-1?t=l:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||r===-1||n===0||n===1&&t===r-1&&t===e+1?"":i.slice(t,r)},parse(i){ir(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=En(this.toPosix(i));let e=i.charCodeAt(0);const r=this.isAbsolute(i);let s;t.root=this.rootname(i),r||this.hasProtocol(i)?s=1:s=0;let n=-1,l=0,h=-1,u=!0,d=i.length-1,p=0;for(;d>=s;--d){if(e=i.charCodeAt(d),e===47){if(!u){l=d+1;break}continue}h===-1&&(u=!1,h=d+1),e===46?n===-1?n=d:p!==1&&(p=1):n!==-1&&(p=-1)}return n===-1||h===-1||p===0||p===1&&n===h-1&&n===l+1?h!==-1&&(l===0&&r?t.base=t.name=i.slice(1,h):t.base=t.name=i.slice(l,h)):(l===0&&r?(t.name=i.slice(1,n),t.base=i.slice(1,h)):(t.name=i.slice(l,n),t.base=i.slice(l,h)),t.ext=i.slice(n,h)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Gh;async function qx(){return Gh??(Gh=(async()=>{var n;const i=document.createElement("canvas").getContext("webgl");if(!i)return Me.UNPACK;const t=await new Promise(l=>{const h=document.createElement("video");h.onloadeddata=()=>l(h),h.onerror=()=>l(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!t)return Me.UNPACK;const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);const r=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,s),i.deleteFramebuffer(r),i.deleteTexture(e),(n=i.getExtension("WEBGL_lose_context"))==null||n.loseContext(),s[0]<=s[3]?Me.PMA:Me.UNPACK})()),Gh}let Hh;function Kx(){return typeof Hh>"u"&&(Hh=function(){var t;const i={stencil:!0,failIfMajorPerformanceCaveat:tt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!tt.ADAPTER.getWebGLRenderingContext())return!1;const e=tt.ADAPTER.createCanvas();let r=e.getContext("webgl",i)||e.getContext("experimental-webgl",i);const s=!!((t=r==null?void 0:r.getContextAttributes())!=null&&t.stencil);if(r){const n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,s}catch{return!1}}()),Hh}var Qx={grad:.9,turn:360,rad:360/(2*Math.PI)},jr=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},ce=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},Qe=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},Zm=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},mp=function(i){return{r:Qe(i.r,0,255),g:Qe(i.g,0,255),b:Qe(i.b,0,255),a:Qe(i.a)}},zh=function(i){return{r:ce(i.r),g:ce(i.g),b:ce(i.b),a:ce(i.a,3)}},Zx=/^#([0-9a-f]{3,8})$/i,Ya=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},Jm=function(i){var t=i.r,e=i.g,r=i.b,s=i.a,n=Math.max(t,e,r),l=n-Math.min(t,e,r),h=l?n===t?(e-r)/l:n===e?2+(r-t)/l:4+(t-e)/l:0;return{h:60*(h<0?h+6:h),s:n?l/n*100:0,v:n/255*100,a:s}},tg=function(i){var t=i.h,e=i.s,r=i.v,s=i.a;t=t/360*6,e/=100,r/=100;var n=Math.floor(t),l=r*(1-e),h=r*(1-(t-n)*e),u=r*(1-(1-t+n)*e),d=n%6;return{r:255*[r,h,l,l,u,r][d],g:255*[u,r,r,h,l,l][d],b:255*[l,l,u,r,r,h][d],a:s}},gp=function(i){return{h:Zm(i.h),s:Qe(i.s,0,100),l:Qe(i.l,0,100),a:Qe(i.a)}},yp=function(i){return{h:ce(i.h),s:ce(i.s),l:ce(i.l),a:ce(i.a,3)}},vp=function(i){return tg((e=(t=i).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},Ln=function(i){return{h:(t=Jm(i)).h,s:(s=(200-(e=t.s))*(r=t.v)/100)>0&&s<200?e*r/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,r,s},Jx=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tb=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,eb=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rb=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ru={string:[[function(i){var t=Zx.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?ce(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?ce(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=eb.exec(i)||rb.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:mp({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=Jx.exec(i)||tb.exec(i);if(!t)return null;var e,r,s=gp({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(Qx[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return vp(s)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,r=i.b,s=i.a,n=s===void 0?1:s;return jr(t)&&jr(e)&&jr(r)?mp({r:Number(t),g:Number(e),b:Number(r),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,r=i.l,s=i.a,n=s===void 0?1:s;if(!jr(t)||!jr(e)||!jr(r))return null;var l=gp({h:Number(t),s:Number(e),l:Number(r),a:Number(n)});return vp(l)},"hsl"],[function(i){var t=i.h,e=i.s,r=i.v,s=i.a,n=s===void 0?1:s;if(!jr(t)||!jr(e)||!jr(r))return null;var l=function(h){return{h:Zm(h.h),s:Qe(h.s,0,100),v:Qe(h.v,0,100),a:Qe(h.a)}}({h:Number(t),s:Number(e),v:Number(r),a:Number(n)});return tg(l)},"hsv"]]},_p=function(i,t){for(var e=0;e<t.length;e++){var r=t[e][0](i);if(r)return[r,t[e][1]]}return[null,void 0]},ib=function(i){return typeof i=="string"?_p(i.trim(),Ru.string):typeof i=="object"&&i!==null?_p(i,Ru.object):[null,void 0]},$h=function(i,t){var e=Ln(i);return{h:e.h,s:Qe(e.s+100*t,0,100),l:e.l,a:e.a}},Wh=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},xp=function(i,t){var e=Ln(i);return{h:e.h,s:e.s,l:Qe(e.l+100*t,0,100),a:e.a}},Mu=function(){function i(t){this.parsed=ib(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return ce(Wh(this.rgba),2)},i.prototype.isDark=function(){return Wh(this.rgba)<.5},i.prototype.isLight=function(){return Wh(this.rgba)>=.5},i.prototype.toHex=function(){return t=zh(this.rgba),e=t.r,r=t.g,s=t.b,l=(n=t.a)<1?Ya(ce(255*n)):"","#"+Ya(e)+Ya(r)+Ya(s)+l;var t,e,r,s,n,l},i.prototype.toRgb=function(){return zh(this.rgba)},i.prototype.toRgbString=function(){return t=zh(this.rgba),e=t.r,r=t.g,s=t.b,(n=t.a)<1?"rgba("+e+", "+r+", "+s+", "+n+")":"rgb("+e+", "+r+", "+s+")";var t,e,r,s,n},i.prototype.toHsl=function(){return yp(Ln(this.rgba))},i.prototype.toHslString=function(){return t=yp(Ln(this.rgba)),e=t.h,r=t.s,s=t.l,(n=t.a)<1?"hsla("+e+", "+r+"%, "+s+"%, "+n+")":"hsl("+e+", "+r+"%, "+s+"%)";var t,e,r,s,n},i.prototype.toHsv=function(){return t=Jm(this.rgba),{h:ce(t.h),s:ce(t.s),v:ce(t.v),a:ce(t.a,3)};var t},i.prototype.invert=function(){return wr({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),wr($h(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),wr($h(this.rgba,-t))},i.prototype.grayscale=function(){return wr($h(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),wr(xp(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),wr(xp(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?wr({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ce(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=Ln(this.rgba);return typeof t=="number"?wr({h:t,s:e.s,l:e.l,a:e.a}):ce(e.h)},i.prototype.isEqual=function(t){return this.toHex()===wr(t).toHex()},i}(),wr=function(i){return i instanceof Mu?i:new Mu(i)},bp=[],sb=function(i){i.forEach(function(t){bp.indexOf(t)<0&&(t(Mu,Ru),bp.push(t))})};function nb(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var s in e)r[e[s]]=s;var n={};i.prototype.toName=function(l){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var h,u,d=r[this.toHex()];if(d)return d;if(l!=null&&l.closest){var p=this.toRgb(),g=1/0,y="black";if(!n.length)for(var v in e)n[v]=new i(e[v]).toRgb();for(var x in e){var b=(h=p,u=n[x],Math.pow(h.r-u.r,2)+Math.pow(h.g-u.g,2)+Math.pow(h.b-u.b,2));b<g&&(g=b,y=x)}return y}},t.string.push([function(l){var h=l.toLowerCase(),u=h==="transparent"?"#0000":e[h];return u?new i(u).toRgb():null},"name"])}sb([nb]);const Is=class To{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof To)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,n)=>s===e[n]);if(t!==null&&e!==null){const s=Object.keys(t),n=Object.keys(e);return s.length!==n.length?!1:s.every(l=>t[l]===e[l])}return t===e}toRgba(){const[t,e,r,s]=this._components;return{r:t,g:e,b:r,a:s}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,r,s]=this._components;return t[0]=e,t[1]=r,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,s,n]=To.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(r=r*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(r<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,r,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(r*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,r,s,n]=this._components;return t[0]=e,t[1]=r,t[2]=s,t[3]=n,t}normalize(t){let e,r,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const l=t;e=(l>>16&255)/255,r=(l>>8&255)/255,s=(l&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,s,n=255]=t,e/=255,r/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const h=To.HEX_PATTERN.exec(t);h&&(t=`#${h[2]}`)}const l=wr(t);l.isValid()&&({r:e,g:r,b:s,a:n}=l.rgba,e/=255,r/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),r)}),t)}};Is.shared=new Is,Is.temp=new Is,Is.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Nt=Is;function ab(i){return bt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Nt.shared.setValue(i).toHex()}function ob(i){return bt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Nt.shared.setValue(i).toNumber()}function lb(){const i=[],t=[];for(let r=0;r<32;r++)i[r]=r,t[r]=r;i[pt.NORMAL_NPM]=pt.NORMAL,i[pt.ADD_NPM]=pt.ADD,i[pt.SCREEN_NPM]=pt.SCREEN,t[pt.NORMAL]=pt.NORMAL_NPM,t[pt.ADD]=pt.ADD_NPM,t[pt.SCREEN]=pt.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const eg=lb();function rg(i,t){return eg[t?1:0][i]}function hb(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let r=0,s=0;r<e;r+=6,s+=4)t[r+0]=s+0,t[r+1]=s+1,t[r+2]=s+2,t[r+3]=s+0,t[r+4]=s+2,t[r+5]=s+3;return t}function ig(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function Oo(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function Ep(i){return!(i&i-1)&&!!i}function Tp(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function Gs(i,t,e){const r=i.length;let s;if(t>=r||e===0)return;e=t+e>r?r-t:e;const n=r-e;for(s=t;s<n;++s)i[s]=i[s+e];i.length=n}function bi(i){return i===0?0:i<0?-1:1}let ub=0;function rs(){return++ub}const Du=class{constructor(i,t,e,r){this.left=i,this.top=t,this.right=e,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Du.EMPTY=new Du(0,0,0,0);let wp=Du;const Sp={},Sr=Object.create(null),pi=Object.create(null);class cb{constructor(t,e,r){this._canvas=tt.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||tt.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Ap(i,t,e){for(let r=0,s=4*e*t;r<t;++r,s+=4)if(i[s+3]!==0)return!1;return!0}function Cp(i,t,e,r,s){const n=4*t;for(let l=r,h=r*n+4*e;l<=s;++l,h+=n)if(i[h+3]!==0)return!1;return!0}function db(i){const{width:t,height:e}=i,r=i.getContext("2d",{willReadFrequently:!0});if(r===null)throw new TypeError("Failed to get canvas 2D context");const s=r.getImageData(0,0,t,e).data;let n=0,l=0,h=t-1,u=e-1;for(;l<e&&Ap(s,t,l);)++l;if(l===e)return wp.EMPTY;for(;Ap(s,t,u);)--u;for(;Cp(s,t,n,l,u);)++n;for(;Cp(s,t,h,l,u);)--h;return++h,++u,new wp(n,l,h,u)}function fb(i){const t=db(i),{width:e,height:r}=t;let s=null;if(!t.isEmpty()){const n=i.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");s=n.getImageData(t.left,t.top,e,r)}return{width:e,height:r,data:s}}function pb(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(i,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function ti(i,t=1){var r;const e=(r=tt.RETINA_PREFIX)==null?void 0:r.exec(i);return e?parseFloat(e[1]):t}var Q=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(Q||{});const Bu=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Ip=(i,t)=>Bu(i).priority??t,ot={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Bu).forEach(t=>{t.type.forEach(e=>{var r,s;return(s=(r=this._removeHandlers)[e])==null?void 0:s.call(r,t)})}),this},add(...i){return i.map(Bu).forEach(t=>{t.type.forEach(e=>{var n,l;const r=this._addHandlers,s=this._queue;r[e]?(n=r[e])==null||n.call(r,t):(s[e]=s[e]||[],(l=s[e])==null||l.push(t))})}),this},handle(i,t,e){var l;const r=this._addHandlers,s=this._removeHandlers;if(r[i]||s[i])throw new Error(`Extension type ${i} already has a handler`);r[i]=t,s[i]=e;const n=this._queue;return n[i]&&((l=n[i])==null||l.forEach(h=>t(h)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((s,n)=>Ip(n,e)-Ip(s,e)))},r=>{const s=t.indexOf(r.ref);s!==-1&&t.splice(s,1)})}};class Fu{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const mb=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function gb(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function yb(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const r=mb.replace(/%forloop%/gi,gb(i));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const jh=0,Xh=1,Vh=2,Yh=3,qh=4,Kh=5;class Lr{constructor(){this.data=0,this.blendMode=pt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<jh)}set blend(t){!!(this.data&1<<jh)!==t&&(this.data^=1<<jh)}get offsets(){return!!(this.data&1<<Xh)}set offsets(t){!!(this.data&1<<Xh)!==t&&(this.data^=1<<Xh)}get culling(){return!!(this.data&1<<Vh)}set culling(t){!!(this.data&1<<Vh)!==t&&(this.data^=1<<Vh)}get depthTest(){return!!(this.data&1<<Yh)}set depthTest(t){!!(this.data&1<<Yh)!==t&&(this.data^=1<<Yh)}get depthMask(){return!!(this.data&1<<Kh)}set depthMask(t){!!(this.data&1<<Kh)!==t&&(this.data^=1<<Kh)}get clockwiseFrontFace(){return!!(this.data&1<<qh)}set clockwiseFrontFace(t){!!(this.data&1<<qh)!==t&&(this.data^=1<<qh)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==pt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Lr;return t.depthTest=!1,t.blend=!0,t}}Lr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Nu=[];function sg(i,t){if(!i)return null;let e="";if(typeof i=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);r&&(e=r[1].toLowerCase())}for(let r=Nu.length-1;r>=0;--r){const s=Nu[r];if(s.test&&s.test(i,e))return new s(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ur{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,r,s,n,l,h,u){if(arguments.length>8)throw new Error("max arguments reached");const{name:d,items:p}=this;this._aliasCount++;for(let g=0,y=p.length;g<y;g++)p[g][d](t,e,r,s,n,l,h,u);return p===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ur.prototype,{dispatch:{value:ur.prototype.emit},run:{value:ur.prototype.emit}});class $n{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ur("setRealSize"),this.onUpdate=new ur("update"),this.onError=new ur("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class el extends $n{constructor(t,e){const{width:r,height:s}=e||{};if(!r||!s)throw new Error("BufferResource width or height invalid");super(r,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,r){const s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Me.UNPACK);const n=e.realWidth,l=e.realHeight;return r.width===n&&r.height===l?s.texSubImage2D(e.target,0,0,0,n,l,e.format,r.type,this.data):(r.width=n,r.height=l,s.texImage2D(e.target,0,r.internalFormat,n,l,0,e.format,r.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const vb={scaleMode:Yr.NEAREST,alphaMode:Me.NPM},Ou=class Ps extends Yn{constructor(t=null,e=null){super(),e=Object.assign({},Ps.defaultOptions,e);const{alphaMode:r,mipmap:s,anisotropicLevel:n,scaleMode:l,width:h,height:u,wrapMode:d,format:p,type:g,target:y,resolution:v,resourceOptions:x}=e;t&&!(t instanceof $n)&&(t=sg(t,x),t.internal=!0),this.resolution=v||tt.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((u||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=d,this._scaleMode=l,this.format=p,this.type=g,this.target=y,this.alphaMode=r,this.uid=rs(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&u>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ep(this.realWidth)&&Ep(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete pi[this.cacheId],delete Sr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Ps.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=tt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else{if(!t._pixiId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${h}_${rs()}`}n=t._pixiId}let l=pi[n];if(s&&r&&!l)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return l||(l=new Ps(t,e),l.cacheId=n,Ps.addToCache(l,n)),l}static fromBuffer(t,e,r,s){t=t||new Float32Array(e*r*4);const n=new el(t,{width:e,height:r,...s==null?void 0:s.resourceOptions});let l,h;return t instanceof Float32Array?(l=X.RGBA,h=ut.FLOAT):t instanceof Int32Array?(l=X.RGBA_INTEGER,h=ut.INT):t instanceof Uint32Array?(l=X.RGBA_INTEGER,h=ut.UNSIGNED_INT):t instanceof Int16Array?(l=X.RGBA_INTEGER,h=ut.SHORT):t instanceof Uint16Array?(l=X.RGBA_INTEGER,h=ut.UNSIGNED_SHORT):t instanceof Int8Array?(l=X.RGBA,h=ut.BYTE):(l=X.RGBA,h=ut.UNSIGNED_BYTE),n.internal=!0,new Ps(n,Object.assign({},vb,{type:h,format:l},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),pi[e]&&pi[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),pi[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=pi[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete pi[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete pi[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Ou.defaultOptions={mipmap:Nr.POW2,anisotropicLevel:0,scaleMode:Yr.LINEAR,wrapMode:Zr.CLAMP,alphaMode:Me.UNPACK,target:ks.TEXTURE_2D,format:X.RGBA,type:ut.UNSIGNED_BYTE},Ou._globalBatch=0;let gt=Ou;class ku{constructor(){this.texArray=null,this.blend=0,this.type=lr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let _b=0;class Zt{constructor(t,e=!0,r=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=_b++,this.disposeRunner=new ur("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Br.ELEMENT_ARRAY_BUFFER:Br.ARRAY_BUFFER}get index(){return this.type===Br.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Zt(t)}}class ko{constructor(t,e=0,r=!1,s=ut.FLOAT,n,l,h,u=1){this.buffer=t,this.size=e,this.normalized=r,this.type=s,this.stride=n,this.start=l,this.instance=h,this.divisor=u}destroy(){this.buffer=null}static from(t,e,r,s,n){return new ko(t,e,r,s,n)}}const xb={Float32Array,Uint32Array,Int32Array,Uint8Array};function bb(i,t){let e=0,r=0;const s={};for(let u=0;u<i.length;u++)r+=t[u],e+=i[u].length;const n=new ArrayBuffer(e*4);let l=null,h=0;for(let u=0;u<i.length;u++){const d=t[u],p=i[u],g=ig(p);s[g]||(s[g]=new xb[g](n)),l=s[g];for(let y=0;y<p.length;y++){const v=(y/d|0)*r+h,x=y%d;l[v+x]=p[y]}h+=d}return new Float32Array(n)}const Pp={5126:4,5123:2,5121:1};let Eb=0;const Tb={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class wi{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Eb++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ur("disposeGeometry"),this.refCount=0}addAttribute(t,e,r=0,s=!1,n,l,h,u=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Zt||(e instanceof Array&&(e=new Float32Array(e)),e=new Zt(e));const d=t.split("|");if(d.length>1){for(let g=0;g<d.length;g++)this.addAttribute(d[g],e,r,s,n);return this}let p=this.buffers.indexOf(e);return p===-1&&(this.buffers.push(e),p=this.buffers.length-1),this.attributes[t]=new ko(p,r,s,n,l,h,u),this.instanced=this.instanced||u,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Zt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Zt(t)),t.type=Br.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],r=new Zt;let s;for(s in this.attributes){const n=this.attributes[s],l=this.buffers[n.buffer];t.push(l.data),e.push(n.size*Pp[n.type]/4),n.buffer=0}for(r.data=bb(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new wi;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Zt(this.buffers[e].data.slice(0));for(const e in this.attributes){const r=this.attributes[e];t.attributes[e]=new ko(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Br.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new wi,r=[],s=[],n=[];let l;for(let h=0;h<t.length;h++){l=t[h];for(let u=0;u<l.buffers.length;u++)s[u]=s[u]||0,s[u]+=l.buffers[u].data.length,n[u]=0}for(let h=0;h<l.buffers.length;h++)r[h]=new Tb[ig(l.buffers[h].data)](s[h]),e.buffers[h]=new Zt(r[h]);for(let h=0;h<t.length;h++){l=t[h];for(let u=0;u<l.buffers.length;u++)r[u].set(l.buffers[u].data,n[u]),n[u]+=l.buffers[u].data.length}if(e.attributes=l.attributes,l.indexBuffer){e.indexBuffer=e.buffers[l.buffers.indexOf(l.indexBuffer)],e.indexBuffer.type=Br.ELEMENT_ARRAY_BUFFER;let h=0,u=0,d=0,p=0;for(let g=0;g<l.buffers.length;g++)if(l.buffers[g]!==l.indexBuffer){p=g;break}for(const g in l.attributes){const y=l.attributes[g];(y.buffer|0)===p&&(u+=y.size*Pp[y.type]/4)}for(let g=0;g<t.length;g++){const y=t[g].indexBuffer.data;for(let v=0;v<y.length;v++)e.indexBuffer.data[v+d]+=h;h+=t[g].buffers[p].data.length/u,d+=y.length}}return e}}class ng extends wi{constructor(t=!1){super(),this._buffer=new Zt(null,t,!1),this._indexBuffer=new Zt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,ut.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,ut.FLOAT).addAttribute("aColor",this._buffer,4,!0,ut.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,ut.FLOAT).addIndex(this._indexBuffer)}}const Lo=Math.PI*2,wb=180/Math.PI,Sb=Math.PI/180;var ye=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(ye||{});class wt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new wt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}wt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const qa=[new wt,new wt,new wt,new wt];class yt{constructor(t=0,e=0,r=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(s),this.type=ye.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new yt(0,0,0,0)}clone(){return new yt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const G=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=G)return!1;const Y=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>Y}const r=this.left,s=this.right,n=this.top,l=this.bottom;if(s<=r||l<=n)return!1;const h=qa[0].set(t.left,t.top),u=qa[1].set(t.left,t.bottom),d=qa[2].set(t.right,t.top),p=qa[3].set(t.right,t.bottom);if(d.x<=h.x||u.y<=h.y)return!1;const g=Math.sign(e.a*e.d-e.b*e.c);if(g===0||(e.apply(h,h),e.apply(u,u),e.apply(d,d),e.apply(p,p),Math.max(h.x,u.x,d.x,p.x)<=r||Math.min(h.x,u.x,d.x,p.x)>=s||Math.max(h.y,u.y,d.y,p.y)<=n||Math.min(h.y,u.y,d.y,p.y)>=l))return!1;const y=g*(u.y-h.y),v=g*(h.x-u.x),x=y*r+v*n,b=y*s+v*n,T=y*r+v*l,S=y*s+v*l;if(Math.max(x,b,T,S)<=y*h.x+v*h.y||Math.min(x,b,T,S)>=y*p.x+v*p.y)return!1;const I=g*(h.y-d.y),w=g*(d.x-h.x),C=I*r+w*n,N=I*s+w*n,V=I*r+w*l,z=I*s+w*l;return!(Math.max(C,N,V,z)<=I*h.x+w*h.y||Math.min(C,N,V,z)>=I*p.x+w*p.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=s,this.height=n-s,this}}yt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class rl{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.radius=r,this.type=ye.CIRC}clone(){return new rl(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let s=this.x-t,n=this.y-e;return s*=s,n*=n,s+n<=r}getBounds(){return new yt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}rl.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class il{constructor(t=0,e=0,r=0,s=0){this.x=t,this.y=e,this.width=r,this.height=s,this.type=ye.ELIP}clone(){return new il(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let r=(t-this.x)/this.width,s=(e-this.y)/this.height;return r*=r,s*=s,r+s<=1}getBounds(){return new yt(this.x-this.width,this.y-this.height,this.width,this.height)}}il.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ji{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let s=0,n=e.length;s<n;s++)r.push(e[s].x,e[s].y);e=r}this.points=e,this.type=ye.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Ji(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let r=!1;const s=this.points.length/2;for(let n=0,l=s-1;n<s;l=n++){const h=this.points[n*2],u=this.points[n*2+1],d=this.points[l*2],p=this.points[l*2+1];u>e!=p>e&&t<(d-h)*((e-u)/(p-u))+h&&(r=!r)}return r}}Ji.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((i,t)=>`${i}, ${t}`,"")}]`};class sl{constructor(t=0,e=0,r=0,s=0,n=20){this.x=t,this.y=e,this.width=r,this.height=s,this.radius=n,this.type=ye.RREC}clone(){return new sl(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let s=t-(this.x+r),n=e-(this.y+r);const l=r*r;if(s*s+n*n<=l||(s=t-(this.x+this.width-r),s*s+n*n<=l)||(n=e-(this.y+this.height-r),s*s+n*n<=l)||(s=t-(this.x+r),s*s+n*n<=l))return!0}return!1}}sl.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Lt{constructor(t=1,e=0,r=0,s=1,n=0,l=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=s,this.tx=n,this.ty=l}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,s,n,l){return this.a=t,this.b=e,this.c=r,this.d=s,this.tx=n,this.ty=l,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new wt;const r=t.x,s=t.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e}applyInverse(t,e){e=e||new wt;const r=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*r*s+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),s=this.a,n=this.c,l=this.tx;return this.a=s*e-this.b*r,this.b=s*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=l*e-this.ty*r,this.ty=l*r+this.ty*e,this}append(t){const e=this.a,r=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this}setTransform(t,e,r,s,n,l,h,u,d){return this.a=Math.cos(h+d)*n,this.b=Math.sin(h+d)*n,this.c=-Math.sin(h-u)*l,this.d=Math.cos(h-u)*l,this.tx=t-(r*this.a+s*this.c),this.ty=e-(r*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,s=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,s=this.c,n=this.d,l=t.pivot,h=-Math.atan2(-s,n),u=Math.atan2(r,e),d=Math.abs(h+u);return d<1e-5||Math.abs(Lo-d)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=h,t.skew.y=u),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(l.x*e+l.y*s),t.position.y=this.ty+(l.x*r+l.y*n),t}invert(){const t=this.a,e=this.b,r=this.c,s=this.d,n=this.tx,l=t*s-e*r;return this.a=s/l,this.b=-e/l,this.c=-r/l,this.d=t/l,this.tx=(r*this.ty-s*n)/l,this.ty=-(t*this.ty-e*n)/l,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Lt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Lt}static get TEMP_MATRIX(){return new Lt}}Lt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const $i=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Wi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ji=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Xi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Lu=[],ag=[],Ka=Math.sign;function Ab(){for(let i=0;i<16;i++){const t=[];Lu.push(t);for(let e=0;e<16;e++){const r=Ka($i[i]*$i[e]+ji[i]*Wi[e]),s=Ka(Wi[i]*$i[e]+Xi[i]*Wi[e]),n=Ka($i[i]*ji[e]+ji[i]*Xi[e]),l=Ka(Wi[i]*ji[e]+Xi[i]*Xi[e]);for(let h=0;h<16;h++)if($i[h]===r&&Wi[h]===s&&ji[h]===n&&Xi[h]===l){t.push(h);break}}}for(let i=0;i<16;i++){const t=new Lt;t.set($i[i],Wi[i],ji[i],Xi[i],0,0),ag.push(t)}}Ab();const Wt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>$i[i],uY:i=>Wi[i],vX:i=>ji[i],vY:i=>Xi[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Lu[i][t],sub:(i,t)=>Lu[i][Wt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?Wt.S:Wt.N:Math.abs(t)*2<=Math.abs(i)?i>0?Wt.E:Wt.W:t>0?i>0?Wt.SE:Wt.SW:i>0?Wt.NE:Wt.NW,matrixAppendRotationInv:(i,t,e=0,r=0)=>{const s=ag[Wt.inv(t)];s.tx=e,s.ty=r,i.append(s)}};class Dr{constructor(t,e,r=0,s=0){this._x=r,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Dr(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Dr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Uu=class{constructor(){this.worldTransform=new Lt,this.localTransform=new Lt,this.position=new Dr(this.onChange,this,0,0),this.scale=new Dr(this.onChange,this,1,1),this.pivot=new Dr(this.onChange,this,0,0),this.skew=new Dr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,r=this.worldTransform;r.a=t.a*e.a+t.b*e.c,r.b=t.a*e.b+t.b*e.d,r.c=t.c*e.a+t.d*e.c,r.d=t.c*e.b+t.d*e.d,r.tx=t.tx*e.a+t.ty*e.c+e.tx,r.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};Uu.IDENTITY=new Uu;let nl=Uu;nl.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Cb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Ib=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Rp(i,t,e){const r=i.createShader(t);return i.shaderSource(r,e),i.compileShader(r),r}function Qh(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function og(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Qh(2*t);case"bvec3":return Qh(3*t);case"bvec4":return Qh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Hs=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${i}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(i,t)=>i.type==="vec3"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${i}"].location, v.red, v.green, v.blue)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],Pb={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Rb={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Mb(i,t){var r;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in i.uniforms){const n=t[s];if(!n){((r=i.uniforms[s])==null?void 0:r.group)===!0&&(i.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const l=i.uniforms[s];let h=!1;for(let u=0;u<Hs.length;u++)if(Hs[u].test(n,l)){e.push(Hs[u].code(s,l)),h=!0;break}if(!h){const u=(n.size===1&&!n.isArray?Pb:Rb)[n.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${u};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const lg={};let ws=lg;function Db(){if(ws===lg||ws!=null&&ws.isContextLost()){const i=tt.ADAPTER.createCanvas();let t;tt.PREFER_ENV>=is.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),ws=t}return ws}let Qa;function Bb(){if(!Qa){Qa=Ke.MEDIUM;const i=Db();if(i&&i.getShaderPrecisionFormat){const t=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);t&&(Qa=t.precision?Ke.HIGH:Ke.MEDIUM)}}return Qa}function Mp(i,t){const e=i.getShaderSource(t).split(`
`).map((d,p)=>`${p}: ${d}`),r=i.getShaderInfoLog(t),s=r.split(`
`),n={},l=s.map(d=>parseFloat(d.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(d=>d&&!n[d]?(n[d]=!0,!0):!1),h=[""];l.forEach(d=>{e[d-1]=`%c${e[d-1]}%c`,h.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const u=e.join(`
`);h[0]=u,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...h),console.groupEnd()}function Fb(i,t,e,r){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||Mp(i,e),i.getShaderParameter(r,i.COMPILE_STATUS)||Mp(i,r),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const Nb={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function hg(i){return Nb[i]}let Za=null;const Dp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ug(i,t){if(!Za){const e=Object.keys(Dp);Za={};for(let r=0;r<e.length;++r){const s=e[r];Za[i[s]]=Dp[s]}}return Za[t]}function Bp(i,t,e){if(i.substring(0,9)!=="precision"){let r=t;return t===Ke.HIGH&&e!==Ke.HIGH&&(r=Ke.MEDIUM),`precision ${r} float;
${i}`}else if(e!==Ke.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Tn;function Ob(){if(typeof Tn=="boolean")return Tn;try{Tn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Tn=!1}return Tn}let kb=0;const Ja={},Gu=class Rs{constructor(t,e,r="pixi-shader",s={}){this.extra={},this.id=kb++,this.vertexSrc=t||Rs.defaultVertexSrc,this.fragmentSrc=e||Rs.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Ja[r]?(Ja[r]++,r+=`-${Ja[r]}`):Ja[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=Bp(this.vertexSrc,Rs.defaultVertexPrecision,Ke.HIGH),this.fragmentSrc=Bp(this.fragmentSrc,Rs.defaultFragmentPrecision,Bb())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Ib}static get defaultFragmentSrc(){return Cb}static from(t,e,r){const s=t+e;let n=Sp[s];return n||(Sp[s]=n=new Rs(t,e,r)),n}};Gu.defaultVertexPrecision=Ke.HIGH,Gu.defaultFragmentPrecision=qr.apple.device?Ke.HIGH:Ke.MEDIUM;let Kr=Gu,Lb=0;class cr{constructor(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Lb++,this.static=!!e,this.ubo=!!r,t instanceof Zt?(this.buffer=t,this.buffer.type=Br.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Zt(new Float32Array(1)),this.buffer.type=Br.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,r){if(!this.ubo)this.uniforms[t]=new cr(e,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,r){return new cr(t,e,r)}static uboFrom(t,e){return new cr(t,e??!0,!0)}}class Fr{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof cr?this.uniformGroup=e:this.uniformGroup=new cr(e):this.uniformGroup=new cr({}),this.disposeRunner=new ur("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const r in e.uniforms){const s=e.uniforms[r];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,r){const s=Kr.from(t,e);return new Fr(s,r)}}class Ub{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=n;this.defaultGroupCache[t]=cr.from({uSamplers:r},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Kr(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Lt,default:this.defaultGroupCache[t]};return new Fr(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let r=0;r<t;r++)r>0&&(e+=`
else `),r<t-1&&(e+=`if(vTextureId < ${r}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Hu{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Gb(){return!qr.apple.device}function Hb(i){let t=!0;const e=tt.ADAPTER.getNavigator();if(qr.tablet||qr.phone){if(qr.apple.device){const r=e.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(t=!1)}if(qr.android.device){const r=e.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(t=!1)}}return t?i:4}class al{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var zb=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,$b=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Cn=class nr extends al{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=ng,this.vertexSize=6,this.state=Lr.for2d(),this.size=nr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Hb(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Gb(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return bt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return $b}static get defaultFragmentTemplate(){return zb}setShaderGenerator({vertex:t=nr.defaultVertexSrc,fragment:e=nr.defaultFragmentTemplate}={}){this.shaderGenerator=new Ub(t,e)}contextChange(){const t=this.renderer.gl;tt.PREFER_ENV===is.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),nr.defaultMaxTextures),this.maxTextures=yb(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=nr,r=this.size/4,s=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new ku);for(;e.length<s;)e.push(new Hu);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,r=nr._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,l=this.renderer.textureGC.count;let h=++gt._globalBatch,u=0,d=r[0],p=0;s.copyBoundTextures(n,e);for(let g=0;g<this._bufferSize;++g){const y=t[g];t[g]=null,y._batchEnabled!==h&&(d.count>=e&&(s.boundArray(d,n,h,e),this.buildDrawCalls(d,p,g),p=g,d=r[++u],++h),y._batchEnabled=h,y.touched=l,d.elements[d.count++]=y)}d.count>0&&(s.boundArray(d,n,h,e),this.buildDrawCalls(d,p,this._bufferSize),++u,++h);for(let g=0;g<n.length;g++)n[g]=null;gt._globalBatch=h}buildDrawCalls(t,e,r){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:l,vertexSize:h}=this,u=nr._drawCallPool;let d=this._dcIndex,p=this._aIndex,g=this._iIndex,y=u[d];y.start=this._iIndex,y.texArray=t;for(let v=e;v<r;++v){const x=s[v],b=x._texture.baseTexture,T=eg[b.alphaMode?1:0][x.blendMode];s[v]=null,e<v&&y.blend!==T&&(y.size=g-y.start,e=v,y=u[++d],y.texArray=t,y.start=g),this.packInterleavedGeometry(x,n,l,p,g),p+=x.vertexData.length/2*h,g+=x.indices.length,y.blend=T}e<r&&(y.size=g-y.start,++d),this._dcIndex=d,this._aIndex=p,this._iIndex=g}bindAndClearTexArray(t){const e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;nr.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:r}=this.renderer,s=nr._drawCallPool;let n=null;for(let l=0;l<t;l++){const{texArray:h,type:u,size:d,start:p,blend:g}=s[l];n!==h&&(n=h,this.bindAndClearTexArray(h)),this.state.blendMode=g,r.set(this.state),e.drawElements(u,d,e.UNSIGNED_SHORT,p*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),nr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Oo(Math.ceil(t/8)),r=Tp(e),s=e*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new Fu(s*this.vertexSize*4)),n}getIndexBuffer(t){const e=Oo(Math.ceil(t/12)),r=Tp(e),s=e*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(s)),n}packInterleavedGeometry(t,e,r,s,n){const{uint32View:l,float32View:h}=e,u=s/this.vertexSize,d=t.uvs,p=t.indices,g=t.vertexData,y=t._texture.baseTexture._batchLocation,v=Math.min(t.worldAlpha,1),x=Nt.shared.setValue(t._tintRGB).toPremultiplied(v,t._texture.baseTexture.alphaMode>0);for(let b=0;b<g.length;b+=2)h[s++]=g[b],h[s++]=g[b+1],h[s++]=d[b],h[s++]=d[b+1],l[s++]=x,h[s++]=y;for(let b=0;b<p.length;b++)r[n++]=u+p[b]}};Cn.defaultBatchSize=4096,Cn.extension={name:"batch",type:Q.RendererPlugin},Cn._drawCallPool=[],Cn._textureArrayPool=[];let Vi=Cn;ot.add(Vi);var Wb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,jb=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const zu=class In extends Fr{constructor(t,e,r){const s=Kr.from(t||In.defaultVertexSrc,e||In.defaultFragmentSrc);super(s,r),this.padding=0,this.resolution=In.defaultResolution,this.multisample=In.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Lr}apply(t,e,r,s,n){t.applyFilter(this,e,r,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return jb}static get defaultFragmentSrc(){return Wb}};zu.defaultResolution=1,zu.defaultMultisample=te.NONE;let Se=zu;class Uo{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Nt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:r,backgroundAlpha:s}=t,n=r??e;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Uo.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Uo.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"background"};ot.add(Uo);class cg{constructor(t){this.renderer=t,this.emptyRenderer=new al(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:r}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=r[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,r,s){const{elements:n,ids:l,count:h}=t;let u=0;for(let d=0;d<h;d++){const p=n[d],g=p._batchLocation;if(g>=0&&g<s&&e[g]===p){l[d]=g;continue}for(;u<s;){const y=e[u];if(y&&y._batchEnabled===r&&y._batchLocation===u){u++;continue}l[d]=u,p._batchLocation=u,e[u]=p;break}}}destroy(){this.renderer=null}}cg.extension={type:Q.RendererSystem,name:"batch"};ot.add(cg);let Fp=0;class Go{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Fp++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,r=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Fp++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let r;if(tt.PREFER_ENV>=is.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Go.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Go.extension={type:Q.RendererSystem,name:"context"};ot.add(Go);class $u{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ur("disposeFramebuffer"),this.multisample=te.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new gt(null,{scaleMode:Yr.NEAREST,resolution:1,mipmap:Nr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new gt(null,{scaleMode:Yr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Nr.OFF,format:X.DEPTH_COMPONENT,type:ut.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const s=this.colorTextures[r],n=s.resolution;s.setSize(t/n,e/n)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class dg extends gt{constructor(t={}){if(typeof t=="number"){const e=arguments[0],r=arguments[1],s=arguments[2],n=arguments[3];t={width:e,height:r,scaleMode:s,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=te.NONE),super(null,t),this.mipmap=Nr.OFF,this.valid=!0,this._clear=new Nt([0,0,0,0]),this.framebuffer=new $u(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ei extends $n{constructor(t){const e=t,r=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,s=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(r,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=pb(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}upload(t,e,r,s){const n=t.gl,l=e.realWidth,h=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Me.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&r.width===l&&r.height===h?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,r.type,s):(r.width=l,r.height=h,n.texImage2D(e.target,0,r.internalFormat,e.format,r.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(e,r),super.update()}dispose(){this.source=null}}class fg extends ei{constructor(t,e){if(e=e||{},typeof t=="string"){const r=new Image;ei.crossOrigin(r,t,e.crossorigin),r.src=t,t=r}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??tt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,r)=>{const s=this.source;this.url=s.src;const n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=l=>{r(l),this.onError.emit(l)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,r=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Me.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,r){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,r,this.bitmap),!this.preserveBitmap){let s=!0;const n=e._glTextures;for(const l in n){const h=n[l];if(h!==r&&h.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Ic{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,r){const s=e.width,n=e.height;if(r){const l=t.width/2/s,h=t.height/2/n,u=t.x/s+l,d=t.y/n+h;r=Wt.add(r,Wt.NW),this.x0=u+l*Wt.uX(r),this.y0=d+h*Wt.uY(r),r=Wt.add(r,2),this.x1=u+l*Wt.uX(r),this.y1=d+h*Wt.uY(r),r=Wt.add(r,2),this.x2=u+l*Wt.uX(r),this.y2=d+h*Wt.uY(r),r=Wt.add(r,2),this.x3=u+l*Wt.uX(r),this.y3=d+h*Wt.uY(r)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Ic.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Np=new Ic;function to(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class K extends Yn{constructor(t,e,r,s,n,l,h){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new yt(0,0,1,1)),t instanceof K&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=Np,this.uvMatrix=null,this.orig=r||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=l?new wt(l.x,l.y):new wt(0,0),this.defaultBorders=h,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Sr[e.url]&&K.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,K.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),r=new K(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===Np&&(this._uvs=new Ic),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},r=tt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else if(t instanceof gt){if(!t.cacheId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${h}-${rs()}`,gt.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${h}_${rs()}`}n=t._pixiId}let l=Sr[n];if(s&&r&&!l)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!l&&!(t instanceof gt)?(e.resolution||(e.resolution=ti(t)),l=new K(new gt(t,e)),l.baseTexture.cacheId=n,gt.addToCache(l.baseTexture,n),K.addToCache(l,n)):!l&&t instanceof gt&&(l=new K(t),K.addToCache(l,n)),l}static fromURL(t,e){const r=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=K.from(t,Object.assign({resourceOptions:r},e),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,r,s){return new K(gt.fromBuffer(t,e,r,s))}static fromLoader(t,e,r,s){const n=new gt(t,Object.assign({scaleMode:gt.defaultOptions.scaleMode,resolution:ti(e)},s)),{resource:l}=n;l instanceof fg&&(l.url=e);const h=new K(n);return r||(r=e),gt.addToCache(h.baseTexture,r),K.addToCache(h,r),r!==e&&(gt.addToCache(h.baseTexture,e),K.addToCache(h,e)),h.baseTexture.valid?Promise.resolve(h):new Promise(u=>{h.baseTexture.once("loaded",()=>u(h))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Sr[e]&&Sr[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Sr[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Sr[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Sr[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Sr[t.textureCacheIds[e]]===t&&delete Sr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:r,width:s,height:n}=t,l=e+s>this.baseTexture.width,h=r+n>this.baseTexture.height;if(l||h){const u=l&&h?"and":"or",d=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,p=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${d} ${u} ${p}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return K._EMPTY||(K._EMPTY=new K(new gt),to(K._EMPTY),to(K._EMPTY.baseTexture)),K._EMPTY}static get WHITE(){if(!K._WHITE){const t=tt.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),K._WHITE=new K(gt.from(t)),to(K._WHITE),to(K._WHITE.baseTexture)}return K._WHITE}}class ss extends K{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,r=!0){const s=this.baseTexture.resolution,n=Math.round(t*s)/s,l=Math.round(e*s)/s;this.valid=n>0&&l>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=l,r&&this.baseTexture.resize(n,l),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new ss(new dg(t))}}class pg{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,r=te.NONE){const s=new dg(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new ss(s)}getOptimalTexture(t,e,r=1,s=te.NONE){let n;t=Math.max(Math.ceil(t*r-1e-6),1),e=Math.max(Math.ceil(e*r-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Oo(t),e=Oo(e),n=((t&65535)<<16|e&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let l=this.texturePool[n].pop();return l||(l=this.createTexture(t,e,s)),l.filterPoolKey=n,l.setResolution(r),l}getFilterTexture(t,e,r){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||te.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}pg.SCREEN_KEY=-1;class Xb extends wi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class mg extends wi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Zt(this.vertices),this.uvBuffer=new Zt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let r=0,s=0;return this.uvs[0]=r,this.uvs[1]=s,this.uvs[2]=r+e.width/t.width,this.uvs[3]=s,this.uvs[4]=r+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=r,this.uvs[7]=s+e.height/t.height,r=e.x,s=e.y,this.vertices[0]=r,this.vertices[1]=s,this.vertices[2]=r+e.width,this.vertices[3]=s,this.vertices[4]=r+e.width,this.vertices[5]=s+e.height,this.vertices[6]=r,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Vb{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=te.NONE,this.sourceFrame=new yt,this.destinationFrame=new yt,this.bindingSourceFrame=new yt,this.bindingDestinationFrame=new yt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const eo=[new wt,new wt,new wt,new wt],Zh=new Lt;class gg{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new pg,this.statePool=[],this.quad=new Xb,this.quadUv=new mg,this.tempRect=new yt,this.activeState={},this.globalUniforms=new cr({outputFrame:new yt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const r=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new Vb,l=r.renderTexture;let h,u;if(l.current){const T=l.current;h=T.resolution,u=T.multisample}else h=r.resolution,u=r.multisample;let d=e[0].resolution||h,p=e[0].multisample??u,g=e[0].padding,y=e[0].autoFit,v=e[0].legacy??!0;for(let T=1;T<e.length;T++){const S=e[T];d=Math.min(d,S.resolution||h),p=Math.min(p,S.multisample??u),g=this.useMaxPadding?Math.max(g,S.padding):g+S.padding,y=y&&S.autoFit,v=v||(S.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),s.push(n),n.resolution=d,n.multisample=p,n.legacy=v,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(g);const x=this.tempRect.copyFrom(l.sourceFrame);r.projection.transform&&this.transformAABB(Zh.copyFrom(r.projection.transform).invert(),x),y?(n.sourceFrame.fit(x),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(x)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,l.current?l.current.resolution:r.resolution,l.sourceFrame,l.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,d,p),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const b=this.tempRect;b.x=0,b.y=0,b.width=n.sourceFrame.width,b.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(l.sourceFrame),n.bindingDestinationFrame.copyFrom(l.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,l.bind(n.renderTexture,n.sourceFrame,b),r.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const n=s.inputSize,l=s.inputPixel,h=s.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],l[0]=Math.round(n[0]*e.resolution),l[1]=Math.round(n[1]*e.resolution),l[2]=1/l[0],l[3]=1/l[1],h[0]=.5*l[2],h[1]=.5*l[3],h[2]=e.sourceFrame.width*n[2]-.5*l[2],h[3]=e.sourceFrame.height*n[3]-.5*l[3],e.legacy){const d=s.filterArea;d[0]=e.destinationFrame.width,d[1]=e.destinationFrame.height,d[2]=e.sourceFrame.x,d[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const u=t[t.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,e.renderTexture,u.renderTexture,Rr.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let d=e.renderTexture,p=this.getOptimalFilterTexture(d.width,d.height,e.resolution);p.filterFrame=d.filterFrame;let g=0;for(g=0;g<r.length-1;++g){g===1&&e.multisample>1&&(p=this.getOptimalFilterTexture(d.width,d.height,e.resolution),p.filterFrame=d.filterFrame),r[g].apply(this,d,p,Rr.CLEAR,e);const y=d;d=p,p=y}r[g].apply(this,d,u.renderTexture,Rr.BLEND,e),g>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(d),this.returnFilterTexture(p)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Rr.CLEAR){const{renderTexture:r,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const l=this.tempRect;l.x=0,l.y=0,l.width=t.filterFrame.width,l.height=t.filterFrame.height,r.bind(t,t.filterFrame,l)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=s.stateId&1||this.forceClear;(e===Rr.CLEAR||e===Rr.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,r,s){const n=this.renderer;n.state.set(t.state),this.bindAndClear(r,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(lr.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(lr.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:r,destinationFrame:s}=this.activeState,{orig:n}=e._texture,l=t.set(s.width,0,0,s.height,r.x,r.y),h=e.worldTransform.copyTo(Lt.TEMP_MATRIX);return h.invert(),l.prepend(h),l.scale(1/n.width,1/n.height),l.translate(e.anchor.x,e.anchor.y),l}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,r=1,s=te.NONE){return this.texturePool.getOptimalTexture(t,e,r,s)}getFilterTexture(t,e,r){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||te.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const r=eo[0],s=eo[1],n=eo[2],l=eo[3];r.set(e.left,e.top),s.set(e.left,e.bottom),n.set(e.right,e.top),l.set(e.right,e.bottom),t.apply(r,r),t.apply(s,s),t.apply(n,n),t.apply(l,l);const h=Math.min(r.x,s.x,n.x,l.x),u=Math.min(r.y,s.y,n.y,l.y),d=Math.max(r.x,s.x,n.x,l.x),p=Math.max(r.y,s.y,n.y,l.y);e.x=h,e.y=u,e.width=d-h,e.height=p-u}roundFrame(t,e,r,s,n){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(n){const{a:l,b:h,c:u,d}=n;if((Math.abs(h)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(l)>1e-4||Math.abs(d)>1e-4))return}n=n?Zh.copyFrom(n):Zh.identity(),n.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}gg.extension={type:Q.RendererSystem,name:"filter"};ot.add(gg);class Yb{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=te.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const qb=new yt;class yg{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new $u(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new yt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;tt.PREFER_ENV===is.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,r=0){const{gl:s}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=r),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let l=0;l<t.colorTextures.length;l++){const h=t.colorTextures[l];this.renderer.texture.unbind(h.parentTextureArray||h)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const l=e.width>>r,h=e.height>>r,u=l/e.width;this.setViewport(e.x*u,e.y*u,l,h)}else{const l=t.width>>r,h=t.height>>r;this.setViewport(0,0,l,h)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,r,s){const n=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),s=Math.round(s),(n.width!==r||n.height!==s||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=r,n.height=s,this.gl.viewport(t,e,r,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,r,s,n=gu.COLOR|gu.DEPTH){const{gl:l}=this;l.clearColor(t,e,r,s),l.clear(n)}initFramebuffer(t){const{gl:e}=this,r=new Yb(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r}resizeFramebuffer(t){const{gl:e}=this,r=t.glFramebuffers[this.CONTEXT_UID];if(r.stencil){e.bindRenderbuffer(e.RENDERBUFFER,r.stencil);let l;this.renderer.context.webGLVersion===1?l=e.DEPTH_STENCIL:t.depth&&t.stencil?l=e.DEPTH24_STENCIL8:t.depth?l=e.DEPTH_COMPONENT24:l=e.STENCIL_INDEX8,r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,l,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,l,t.width,t.height)}const s=t.colorTextures;let n=s.length;e.drawBuffers||(n=Math.min(n,1));for(let l=0;l<n;l++){const h=s[l],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),l===0&&r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:r}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let l=n.length;r.drawBuffers||(l=Math.min(l,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||r.createRenderbuffer():s.msaaBuffer&&(r.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const h=[];for(let u=0;u<l;u++){const d=n[u],p=d.parentTextureArray||d;this.renderer.texture.bind(p,0),u===0&&s.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,p._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,s.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+u,d.target,p._glTextures[this.CONTEXT_UID].texture,e),h.push(r.COLOR_ATTACHMENT0+u))}if(h.length>1&&r.drawBuffers(h),t.depthTexture&&this.writeDepthTexture){const u=t.depthTexture;this.renderer.texture.bind(u,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||r.createRenderbuffer();let u,d;this.renderer.context.webGLVersion===1?(u=r.DEPTH_STENCIL_ATTACHMENT,d=r.DEPTH_STENCIL):t.depth&&t.stencil?(u=r.DEPTH_STENCIL_ATTACHMENT,d=r.DEPTH24_STENCIL8):t.depth?(u=r.DEPTH_ATTACHMENT,d=r.DEPTH_COMPONENT24):(u=r.STENCIL_ATTACHMENT,d=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),s.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,d,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,d,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,u,r.RENDERBUFFER,s.stencil)}else s.stencil&&(r.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let r=te.NONE;if(t<=1||e===null)return r;for(let s=0;s<e.length;s++)if(e[s]<=t){r=e[s];break}return r===1&&(r=te.NONE),r}blit(t,e,r){const{current:s,renderer:n,gl:l,CONTEXT_UID:h}=this;if(n.context.webGLVersion!==2||!s)return;const u=s.glFramebuffers[h];if(!u)return;if(!t){if(!u.msaaBuffer)return;const p=s.colorTextures[0];if(!p)return;u.blitFramebuffer||(u.blitFramebuffer=new $u(s.width,s.height),u.blitFramebuffer.addColorTexture(0,p)),t=u.blitFramebuffer,t.colorTextures[0]!==p&&(t.colorTextures[0]=p,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=qb,e.width=s.width,e.height=s.height),r||(r=e);const d=e.width===r.width&&e.height===r.height;this.bind(t),l.bindFramebuffer(l.READ_FRAMEBUFFER,u.framebuffer),l.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,l.COLOR_BUFFER_BIT,d?l.NEAREST:l.LINEAR),l.bindFramebuffer(l.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const r=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!r)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&s.deleteRenderbuffer(r.msaaBuffer),r.stencil&&s.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const r=t.width,s=t.height,n=this.gl,l=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,l);let h,u;this.renderer.context.webGLVersion===1?(h=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH_STENCIL):t.depth?(h=n.DEPTH_STENCIL_ATTACHMENT,u=n.DEPTH24_STENCIL8):(h=n.STENCIL_ATTACHMENT,u=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,u,r,s):n.renderbufferStorage(n.RENDERBUFFER,u,r,s),n.framebufferRenderbuffer(n.FRAMEBUFFER,h,n.RENDERBUFFER,l)}reset(){this.current=this.unknownFramebuffer,this.viewport=new yt}destroy(){this.renderer=null}}yg.extension={type:Q.RendererSystem,name:"framebuffer"};ot.add(yg);const Jh={5126:4,5123:2,5121:1};class vg{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;tt.PREFER_ENV===is.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=()=>r.createVertexArrayOES(),t.bindVertexArray=s=>r.bindVertexArrayOES(s),t.deleteVertexArray=s=>r.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=(s,n)=>r.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,l,h,u)=>r.drawElementsInstancedANGLE(s,n,l,h,u),t.drawArraysInstanced=(s,n,l,h)=>r.drawArraysInstancedANGLE(s,n,l,h)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:r}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);const l=s[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==l&&(this._activeVao=l,this.hasVao?r.bindVertexArray(l):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let r=0;r<t.buffers.length;r++){const s=t.buffers[r];e.update(s)}}checkCompatibility(t,e){const r=t.attributes,s=e.attributeData;for(const n in s)if(!r[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const r=t.attributes,s=e.attributeData,n=["g",t.id];for(const l in r)s[l]&&n.push(l,s[l].location);return n.join("-")}initGeometryVao(t,e,r=!0){const s=this.gl,n=this.CONTEXT_UID,l=this.renderer.buffer,h=e.program;h.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,h);const u=this.getSignature(t,h),d=t.glVertexArrayObjects[this.CONTEXT_UID];let p=d[u];if(p)return d[h.id]=p,p;const g=t.buffers,y=t.attributes,v={},x={};for(const b in g)v[b]=0,x[b]=0;for(const b in y)!y[b].size&&h.attributeData[b]?y[b].size=h.attributeData[b].size:y[b].size||console.warn(`PIXI Geometry attribute '${b}' size cannot be determined (likely the bound shader does not have the attribute)`),v[y[b].buffer]+=y[b].size*Jh[y[b].type];for(const b in y){const T=y[b],S=T.size;T.stride===void 0&&(v[T.buffer]===S*Jh[T.type]?T.stride=0:T.stride=v[T.buffer]),T.start===void 0&&(T.start=x[T.buffer],x[T.buffer]+=S*Jh[T.type])}p=s.createVertexArray(),s.bindVertexArray(p);for(let b=0;b<g.length;b++){const T=g[b];l.bind(T),r&&T._glBuffers[n].refCount++}return this.activateVao(t,h),d[h.id]=p,d[u]=p,s.bindVertexArray(null),l.unbind(Br.ARRAY_BUFFER),p}disposeGeometry(t,e){var h;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const r=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,l=(h=this.renderer)==null?void 0:h.buffer;if(t.disposeRunner.remove(this),!!r){if(l)for(let u=0;u<n.length;u++){const d=n[u]._glBuffers[this.CONTEXT_UID];d&&(d.refCount--,d.refCount===0&&!e&&l.dispose(n[u],e))}if(!e){for(const u in r)if(u[0]==="g"){const d=r[u];this._activeVao===d&&this.unbind(),s.deleteVertexArray(d)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)}activateVao(t,e){const r=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,l=t.buffers,h=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let u=null;for(const d in h){const p=h[d],g=l[p.buffer],y=g._glBuffers[s];if(e.attributeData[d]){u!==y&&(n.bind(g),u=y);const v=e.attributeData[d].location;if(r.enableVertexAttribArray(v),r.vertexAttribPointer(v,p.size,p.type||r.FLOAT,p.normalized,p.stride,p.start),p.instance)if(this.hasInstance)r.vertexAttribDivisor(v,p.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,r,s){const{gl:n}=this,l=this._activeGeometry;if(l.indexBuffer){const h=l.indexBuffer.data.BYTES_PER_ELEMENT,u=h===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;h===2||h===4&&this.canUseUInt32ElementIndex?l.instanced?n.drawElementsInstanced(t,e||l.indexBuffer.data.length,u,(r||0)*h,s||1):n.drawElements(t,e||l.indexBuffer.data.length,u,(r||0)*h):console.warn("unsupported index buffer type: uint32")}else l.instanced?n.drawArraysInstanced(t,r,e||l.getSize(),s||1):n.drawArrays(t,r,e||l.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}vg.extension={type:Q.RendererSystem,name:"geometry"};ot.add(vg);const Op=new Lt;class Pc{constructor(t,e){this._texture=t,this.mapCoord=new Lt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],l=t[s+1];e[s]=n*r.a+l*r.c+r.tx,e[s+1]=n*r.b+l*r.d+r.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(Op.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Op));const l=e.baseTexture,h=this.uClampFrame,u=this.clampMargin/l.resolution,d=this.clampOffset;return h[0]=(e._frame.x+u+d)/l.width,h[1]=(e._frame.y+u+d)/l.height,h[2]=(e._frame.x+e._frame.width-u+d)/l.width,h[3]=(e._frame.y+e._frame.height-u+d)/l.height,this.uClampOffset[0]=d/l.realWidth,this.uClampOffset[1]=d/l.realHeight,this.isSimple=e._frame.width===l.width&&e._frame.height===l.height&&e.rotate===0,!0}}var Kb=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Qb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Zb extends Se{constructor(t,e,r){let s=null;typeof t!="string"&&e===void 0&&r===void 0&&(s=t,t=void 0,e=void 0,r=void 0),super(t||Qb,e||Kb,r),this.maskSprite=s,this.maskMatrix=new Lt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,r,s){const n=this._maskSprite,l=n._texture;l.valid&&(l.uvMatrix||(l.uvMatrix=new Pc(l,0)),l.uvMatrix.update(),this.uniforms.npmAlpha=l.baseTexture.alphaMode?0:1,this.uniforms.mask=l,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(l.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=l.uvMatrix.uClampFrame,t.applyFilter(this,e,r,s))}}class Jb{constructor(t=null){this.type=ie.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Se.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ie.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class _g{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let r=e;if(!r.isMaskData){const n=this.maskDataPool.pop()||new Jb;n.pooled=!0,n.maskObject=e,r=n}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(s),r._colorMask=s?s._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==ie.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case ie.SCISSOR:this.renderer.scissor.push(r);break;case ie.STENCIL:this.renderer.stencil.push(r);break;case ie.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case ie.COLOR:this.pushColorMask(r);break}r.type===ie.SPRITE&&this.maskStack.push(r)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case ie.SCISSOR:this.renderer.scissor.pop(e);break;case ie.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case ie.SPRITE:this.popSpriteMask(e);break;case ie.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===ie.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=ie.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=ie.SCISSOR:t.type=ie.STENCIL:t.type=ie.COLOR}pushSpriteMask(t){const{maskObject:e}=t,r=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Zb])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;const n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,s),r.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(t){const e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}_g.extension={type:Q.RendererSystem,name:"mask"};ot.add(_g);class xg{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,r=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==r&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const kp=new Lt,Lp=[],bg=class wo extends xg{constructor(t){super(t),this.glConst=tt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:r}=t,{renderer:s}=this,n=s.renderTexture,l=r.getBounds(!0,Lp.pop()??new yt);this.roundFrameToPixels(l,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),e&&l.fit(e),t._scissorRectLocal=l}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:r,c:s,d:n}=t;return(Math.abs(r)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||wo.isMatrixRotated(e.worldTransform)||wo.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,s,n){wo.isMatrixRotated(n)||(n=n?kp.copyFrom(n):kp.identity(),n.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Lp.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};bg.extension={type:Q.RendererSystem,name:"scissor"};let t1=bg;ot.add(t1);class Eg extends xg{constructor(t){super(t),this.glConst=tt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:r}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,s,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=r?r._colorMask:15;s!==0&&(r._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(r._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Eg.extension={type:Q.RendererSystem,name:"stencil"};ot.add(Eg);class Tg{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Tg.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_plugin"};ot.add(Tg);class wg{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Lt,this.transform=null}update(t,e,r,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,s),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,r,s){const n=this.projectionMatrix,l=s?-1:1;n.identity(),n.a=1/e.width*2,n.d=l*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-l-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}wg.extension={type:Q.RendererSystem,name:"projection"};ot.add(wg);const e1=new nl,Up=new yt;class Sg{constructor(t){this.renderer=t,this._tempMatrix=new Lt}generateTexture(t,e){const{region:r,...s}=e||{},n=(r==null?void 0:r.copyTo(Up))||t.getLocalBounds(Up,!0),l=s.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/l),n.height=Math.max(n.height,1/l),s.width=n.width,s.height=n.height,s.resolution=l,s.multisample??(s.multisample=this.renderer.multisample);const h=ss.create(s);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const u=t.transform;return t.transform=e1,this.renderer.render(t,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=u,h}destroy(){}}Sg.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"textureGenerator"};ot.add(Sg);const Gi=new yt,wn=new yt;class Ag{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new yt,this.destinationFrame=new yt,this.viewportFrame=new yt}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,r){const s=this.renderer;this.current=t;let n,l,h;t?(n=t.baseTexture,h=n.resolution,e||(Gi.width=t.frame.width,Gi.height=t.frame.height,e=Gi),r||(wn.x=t.frame.x,wn.y=t.frame.y,wn.width=e.width,wn.height=e.height,r=wn),l=n.framebuffer):(h=s.resolution,e||(Gi.width=s._view.screen.width,Gi.height=s._view.screen.height,e=Gi),r||(r=Gi,r.width=e.width,r.height=e.height));const u=this.viewportFrame;u.x=r.x*h,u.y=r.y*h,u.width=r.width*h,u.height=r.height*h,t||(u.y=s.view.height-(u.y+u.height)),u.ceil(),this.renderer.framebuffer.bind(l,u),this.renderer.projection.update(r,e,h,!l),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)}clear(t,e){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=Nt.shared.setValue(t||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const n=this.destinationFrame,l=this.current?this.current.baseTexture:this.renderer._view.screen,h=n.width!==l.width||n.height!==l.height;if(h){let{x:u,y:d,width:p,height:g}=this.viewportFrame;u=Math.round(u),d=Math.round(d),p=Math.round(p),g=Math.round(g),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(u,d,p,g)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),h&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Ag.extension={type:Q.RendererSystem,name:"renderTexture"};ot.add(Ag);class r1{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function i1(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const n=t.getActiveAttrib(i,s);if(n.name.startsWith("gl_"))continue;const l=ug(t,n.type),h={type:l,name:n.name,size:hg(l),location:t.getAttribLocation(i,n.name)};e[n.name]=h}return e}function s1(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let s=0;s<r;s++){const n=t.getActiveUniform(i,s),l=n.name.replace(/\[.*?\]$/,""),h=!!n.name.match(/\[.*?\]$/),u=ug(t,n.type);e[l]={name:l,index:s,type:u,size:n.size,isArray:h,value:og(u,n.size)}}return e}function n1(i,t){var h;const e=Rp(i,i.VERTEX_SHADER,t.vertexSrc),r=Rp(i,i.FRAGMENT_SHADER,t.fragmentSrc),s=i.createProgram();i.attachShader(s,e),i.attachShader(s,r);const n=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(n&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||Fb(i,s,e,r),t.attributeData=i1(s,i),t.uniformData=s1(s,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const u=Object.keys(t.attributeData);u.sort((d,p)=>d>p?1:-1);for(let d=0;d<u.length;d++)t.attributeData[u[d]].location=d,i.bindAttribLocation(s,d,u[d]);i.linkProgram(s)}i.deleteShader(e),i.deleteShader(r);const l={};for(const u in t.uniformData){const d=t.uniformData[u];l[u]={location:i.getUniformLocation(s,u),value:og(d.type,d.size)}}return new r1(s,l)}function a1(i,t,e,r,s){e.buffer.update(s)}const o1={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Cg={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function l1(i){const t=i.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,r=0,s=0;for(let n=0;n<t.length;n++){const l=t[n];if(e=Cg[l.data.type],l.data.size>1&&(e=Math.max(e,16)*l.data.size),l.dataLen=e,r%e!==0&&r<16){const h=r%e%16;r+=h,s+=h}r+e>16?(s=Math.ceil(s/16)*16,l.offset=s,s+=e,r=e):(l.offset=s,r+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function h1(i,t){const e=[];for(const r in i)t[r]&&e.push(t[r]);return e.sort((r,s)=>r.index-s.index),e}function u1(i,t){if(!i.autoManage)return{size:0,syncFunc:a1};const e=h1(i.uniforms,t),{uboElements:r,size:s}=l1(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let l=0;l<r.length;l++){const h=r[l],u=i.uniforms[h.data.name],d=h.data.name;let p=!1;for(let g=0;g<Hs.length;g++){const y=Hs[g];if(y.codeUbo&&y.test(h.data,u)){n.push(`offset = ${h.offset/4};`,Hs[g].codeUbo(h.data.name,u)),p=!0;break}}if(!p)if(h.data.size>1){const g=hg(h.data.type),y=Math.max(Cg[h.data.type]/16,1),v=g/y,x=(4-v%4)%4;n.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${h.offset/4};

                t = 0;

                for(var i=0; i < ${h.data.size*y}; i++)
                {
                    for(var j = 0; j < ${v}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${x};
                }

                `)}else{const g=o1[h.data.type];n.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${h.offset/4};
                ${g};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let c1=0;const ro={textureCount:0,uboCount:0};class Ig{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=c1++}systemCheck(){if(!Ob())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const r=t.program,s=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(s.program)),e||(ro.textureCount=0,ro.uboCount=0,this.syncUniformGroup(t.uniformGroup,ro)),s}setUniforms(t){const e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)}syncUniformGroup(t,e){const r=this.getGlProgram();(!t.static||t.dirtyId!==r.uniformDirtyGroups[t.id])&&(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))}syncUniforms(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Mb(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const r=this.getGlProgram();if(!t.static||t.dirtyId!==0||!r.uniformGroups[t.id]){t.dirtyId=0;const s=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),s(r.uniformData,t.uniforms,this.renderer,ro,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])}createSyncBufferGroup(t,e,r){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const l=this.getSignature(t,this.shader.program.uniformData,"ubo");let h=this._uboCache[l];if(h||(h=this._uboCache[l]=u1(t,this.shader.program.uniformData)),t.autoManage){const u=new Float32Array(h.size/4);t.buffer.update(u)}return e.uniformGroups[t.id]=h.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,r){const s=t.uniforms,n=[`${r}-`];for(const l in s)n.push(l),e[l]&&n.push(e[l].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,r=t.program,s=n1(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ig.extension={type:Q.RendererSystem,name:"shader"};ot.add(Ig);class Ho{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.0 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Ho.defaultOptions={hello:!1},Ho.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"startup"};ot.add(Ho);function d1(i,t=[]){return t[pt.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.ADD]=[i.ONE,i.ONE],t[pt.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.NONE]=[0,0],t[pt.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[pt.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[pt.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[pt.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[pt.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[pt.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[pt.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[pt.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[pt.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[pt.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[pt.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const f1=0,p1=1,m1=2,g1=3,y1=4,v1=5,Pg=class Wu{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=pt.NONE,this._blendEq=!1,this.map=[],this.map[f1]=this.setBlend,this.map[p1]=this.setOffset,this.map[m1]=this.setCullFace,this.map[g1]=this.setDepthTest,this.map[y1]=this.setFrontFace,this.map[v1]=this.setDepthMask,this.checks=[],this.defaultState=new Lr,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=d1(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Wu.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Wu.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};Pg.extension={type:Q.RendererSystem,name:"state"};let _1=Pg;ot.add(_1);class x1 extends Yn{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),r=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of r)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ur(e)})}addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const s in this.runners)this.runners[s].add(r);return this}emitWithCustomOptions(t,e){const r=Object.keys(this._systemsHash);t.items.forEach(s=>{const n=r.find(l=>this._systemsHash[l]===s);s[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Pn=class So{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=So.defaultMaxIdle,this.checkCountMax=So.defaultCheckCountMax,this.mode=So.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==_c.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let r=!1;for(let s=0;s<e.length;s++){const n=e[s];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[s]=null,r=!0)}if(r){let s=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[s++]=e[n]);e.length=s}}unload(t){const e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};Pn.defaultMode=_c.AUTO,Pn.defaultMaxIdle=60*60,Pn.defaultCheckCountMax=60*10,Pn.extension={type:Q.RendererSystem,name:"textureGC"};let Yi=Pn;ot.add(Yi);class tu{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ut.UNSIGNED_BYTE,this.internalFormat=X.RGBA,this.samplerType=0}}function b1(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[i.RGB]:J.FLOAT,[i.RGBA]:J.FLOAT,[i.ALPHA]:J.FLOAT,[i.LUMINANCE]:J.FLOAT,[i.LUMINANCE_ALPHA]:J.FLOAT,[i.R8]:J.FLOAT,[i.R8_SNORM]:J.FLOAT,[i.RG8]:J.FLOAT,[i.RG8_SNORM]:J.FLOAT,[i.RGB8]:J.FLOAT,[i.RGB8_SNORM]:J.FLOAT,[i.RGB565]:J.FLOAT,[i.RGBA4]:J.FLOAT,[i.RGB5_A1]:J.FLOAT,[i.RGBA8]:J.FLOAT,[i.RGBA8_SNORM]:J.FLOAT,[i.RGB10_A2]:J.FLOAT,[i.RGB10_A2UI]:J.FLOAT,[i.SRGB8]:J.FLOAT,[i.SRGB8_ALPHA8]:J.FLOAT,[i.R16F]:J.FLOAT,[i.RG16F]:J.FLOAT,[i.RGB16F]:J.FLOAT,[i.RGBA16F]:J.FLOAT,[i.R32F]:J.FLOAT,[i.RG32F]:J.FLOAT,[i.RGB32F]:J.FLOAT,[i.RGBA32F]:J.FLOAT,[i.R11F_G11F_B10F]:J.FLOAT,[i.RGB9_E5]:J.FLOAT,[i.R8I]:J.INT,[i.R8UI]:J.UINT,[i.R16I]:J.INT,[i.R16UI]:J.UINT,[i.R32I]:J.INT,[i.R32UI]:J.UINT,[i.RG8I]:J.INT,[i.RG8UI]:J.UINT,[i.RG16I]:J.INT,[i.RG16UI]:J.UINT,[i.RG32I]:J.INT,[i.RG32UI]:J.UINT,[i.RGB8I]:J.INT,[i.RGB8UI]:J.UINT,[i.RGB16I]:J.INT,[i.RGB16UI]:J.UINT,[i.RGB32I]:J.INT,[i.RGB32UI]:J.UINT,[i.RGBA8I]:J.INT,[i.RGBA8UI]:J.UINT,[i.RGBA16I]:J.INT,[i.RGBA16UI]:J.UINT,[i.RGBA32I]:J.INT,[i.RGBA32UI]:J.UINT,[i.DEPTH_COMPONENT16]:J.FLOAT,[i.DEPTH_COMPONENT24]:J.FLOAT,[i.DEPTH_COMPONENT32F]:J.FLOAT,[i.DEPTH_STENCIL]:J.FLOAT,[i.DEPTH24_STENCIL8]:J.FLOAT,[i.DEPTH32F_STENCIL8]:J.FLOAT}:t={[i.RGB]:J.FLOAT,[i.RGBA]:J.FLOAT,[i.ALPHA]:J.FLOAT,[i.LUMINANCE]:J.FLOAT,[i.LUMINANCE_ALPHA]:J.FLOAT,[i.DEPTH_STENCIL]:J.FLOAT},t}function E1(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[ut.UNSIGNED_BYTE]:{[X.RGBA]:i.RGBA8,[X.RGB]:i.RGB8,[X.RG]:i.RG8,[X.RED]:i.R8,[X.RGBA_INTEGER]:i.RGBA8UI,[X.RGB_INTEGER]:i.RGB8UI,[X.RG_INTEGER]:i.RG8UI,[X.RED_INTEGER]:i.R8UI,[X.ALPHA]:i.ALPHA,[X.LUMINANCE]:i.LUMINANCE,[X.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[ut.BYTE]:{[X.RGBA]:i.RGBA8_SNORM,[X.RGB]:i.RGB8_SNORM,[X.RG]:i.RG8_SNORM,[X.RED]:i.R8_SNORM,[X.RGBA_INTEGER]:i.RGBA8I,[X.RGB_INTEGER]:i.RGB8I,[X.RG_INTEGER]:i.RG8I,[X.RED_INTEGER]:i.R8I},[ut.UNSIGNED_SHORT]:{[X.RGBA_INTEGER]:i.RGBA16UI,[X.RGB_INTEGER]:i.RGB16UI,[X.RG_INTEGER]:i.RG16UI,[X.RED_INTEGER]:i.R16UI,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[ut.SHORT]:{[X.RGBA_INTEGER]:i.RGBA16I,[X.RGB_INTEGER]:i.RGB16I,[X.RG_INTEGER]:i.RG16I,[X.RED_INTEGER]:i.R16I},[ut.UNSIGNED_INT]:{[X.RGBA_INTEGER]:i.RGBA32UI,[X.RGB_INTEGER]:i.RGB32UI,[X.RG_INTEGER]:i.RG32UI,[X.RED_INTEGER]:i.R32UI,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[ut.INT]:{[X.RGBA_INTEGER]:i.RGBA32I,[X.RGB_INTEGER]:i.RGB32I,[X.RG_INTEGER]:i.RG32I,[X.RED_INTEGER]:i.R32I},[ut.FLOAT]:{[X.RGBA]:i.RGBA32F,[X.RGB]:i.RGB32F,[X.RG]:i.RG32F,[X.RED]:i.R32F,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[ut.HALF_FLOAT]:{[X.RGBA]:i.RGBA16F,[X.RGB]:i.RGB16F,[X.RG]:i.RG16F,[X.RED]:i.R16F},[ut.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:i.RGB565},[ut.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:i.RGBA4},[ut.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:i.RGB5_A1},[ut.UNSIGNED_INT_2_10_10_10_REV]:{[X.RGBA]:i.RGB10_A2,[X.RGBA_INTEGER]:i.RGB10_A2UI},[ut.UNSIGNED_INT_10F_11F_11F_REV]:{[X.RGB]:i.R11F_G11F_B10F},[ut.UNSIGNED_INT_5_9_9_9_REV]:{[X.RGB]:i.RGB9_E5},[ut.UNSIGNED_INT_24_8]:{[X.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[ut.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[X.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[ut.UNSIGNED_BYTE]:{[X.RGBA]:i.RGBA,[X.RGB]:i.RGB,[X.ALPHA]:i.ALPHA,[X.LUMINANCE]:i.LUMINANCE,[X.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[ut.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:i.RGB},[ut.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:i.RGBA},[ut.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:i.RGBA}},t}class Rg{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new gt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=E1(t),this.samplerTypes=b1(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const r=new tu(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new tu(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:r}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<r.length;s++)r[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<r.length;s++)r[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:r,CONTEXT_UID:s}=this;if(r)for(let n=t-1;n>=0;--n){const l=e[n];l&&l._glTextures[s].samplerType!==J.FLOAT&&this.renderer.texture.unbind(l)}}initTexture(t){const e=new tu(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var r;e.internalFormat=((r=this.internalFormats[t.type])==null?void 0:r[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??J.FLOAT,this.webGLVersion===2&&t.type===ut.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const r=this.renderer;if(this.initTextureType(t,e),(s=t.resource)==null?void 0:s.upload(r,t,e))e.samplerType!==J.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,l=t.realHeight,h=r.gl;(e.width!==n||e.height!==l||e.dirtyId<0)&&(e.width=n,e.height=l,h.texImage2D(t.target,0,e.internalFormat,n,l,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:r}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&Gs(this.managedTextures,s,1)}}updateTextureStyle(t){var r;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Nr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Zr.CLAMP:e.wrapMode=t.wrapMode,(r=t.resource)!=null&&r.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const r=this.gl;if(e.mipmap&&t.mipmap!==Nr.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Yr.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Yr.LINEAR){const n=Math.min(t.anisotropicLevel,r.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Yr.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===Yr.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}Rg.extension={type:Q.RendererSystem,name:"texture"};ot.add(Rg);class Mg{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glTransformFeedbacks[r]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:r,renderer:s}=this;e&&s.shader.bind(e),r.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:r,CONTEXT_UID:s}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[s]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];h&&(r.buffer.update(h),h._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,l,h._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const r=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];if(!h)continue;const u=h._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!e&&n.dispose(h,e))}r&&(e||s.deleteTransformFeedback(r),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Mg.extension={type:Q.RendererSystem,name:"transformFeedback"};ot.add(Mg);class zo{constructor(t){this.renderer=t}init(t){this.screen=new yt(0,0,t.width,t.height),this.element=t.view||tt.ADAPTER.createCanvas(),this.resolution=t.resolution||tt.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const r=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=r,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",r,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}zo.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},zo.extension={type:[Q.RendererSystem,Q.CanvasRendererSystem],name:"_view"};ot.add(zo);tt.PREFER_ENV=is.WEBGL2;tt.STRICT_TEXTURE_CACHE=!1;tt.RENDER_OPTIONS={...Go.defaultOptions,...Uo.defaultOptions,...zo.defaultOptions,...Ho.defaultOptions};Object.defineProperties(tt,{WRAP_MODE:{get(){return gt.defaultOptions.wrapMode},set(i){bt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),gt.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return gt.defaultOptions.scaleMode},set(i){bt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),gt.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return gt.defaultOptions.mipmap},set(i){bt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),gt.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return gt.defaultOptions.anisotropicLevel},set(i){bt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),gt.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return bt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Se.defaultResolution},set(i){Se.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return bt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Se.defaultMultisample},set(i){Se.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return Vi.defaultMaxTextures},set(i){bt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Vi.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return Vi.defaultBatchSize},set(i){bt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Vi.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return Vi.canUploadSameBuffer},set(i){bt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Vi.canUploadSameBuffer=i}},GC_MODE:{get(){return Yi.defaultMode},set(i){bt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Yi.defaultMode=i}},GC_MAX_IDLE:{get(){return Yi.defaultMaxIdle},set(i){bt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Yi.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return Yi.defaultCheckCountMax},set(i){bt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Yi.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return Kr.defaultVertexPrecision},set(i){bt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Kr.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return Kr.defaultFragmentPrecision},set(i){bt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Kr.defaultFragmentPrecision=i}}});var Si=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Si||{});class eu{constructor(t,e=null,r=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Dg=class ke{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new eu(null,null,1/0),this.deltaMS=1/ke.targetFPMS,this.elapsedMS=1/ke.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Si.NORMAL){return this._addListener(new eu(t,e,r))}addOnce(t,e,r=Si.NORMAL){return this._addListener(new eu(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ke.targetFPMS;const r=this._head;let s=r.next;for(;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,ke.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ke._shared){const t=ke._shared=new ke;t.autoStart=!0,t._protected=!0}return ke._shared}static get system(){if(!ke._system){const t=ke._system=new ke;t.autoStart=!0,t._protected=!0}return ke._system}};Dg.targetFPMS=.06;let de=Dg;Object.defineProperties(tt,{TARGET_FPMS:{get(){return de.targetFPMS},set(i){bt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),de.targetFPMS=i}}});class Bg{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Si.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?de.shared:new de,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Bg.extension=Q.Application;ot.add(Bg);const Fg=[];ot.handleByList(Q.Renderer,Fg);function T1(i){for(const t of Fg)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var w1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,S1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const A1=w1,Ng=S1;class Og{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{const r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}e>=te.HIGH?this.multisample=te.HIGH:e>=te.MEDIUM?this.multisample=te.MEDIUM:e>=te.LOW?this.multisample=te.LOW:this.multisample=te.NONE}destroy(){}}Og.extension={type:Q.RendererSystem,name:"_multisample"};ot.add(Og);class C1{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class kg{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:r,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,r){const{gl:s,CONTEXT_UID:n}=this;r=r||0;const l=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,l.buffer,r*256,256)}update(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const r=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),r&&(e||s.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:r}=this;return t._glBuffers[e]=new C1(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}kg.extension={type:Q.RendererSystem,name:"buffer"};ot.add(kg);class Lg{constructor(t){this.renderer=t}render(t,e){const r=this.renderer;let s,n,l,h;if(e&&(s=e.renderTexture,n=e.clear,l=e.transform,h=e.skipUpdateTransform),this.renderingToScreen=!s,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=l,!r.context.isLost){if(s||(this.lastObjectRendered=t),!h){const u=t.enableTempParent();t.updateTransform(),t.disableTempParent(u)}r.renderTexture.bind(s),r.batch.currentRenderer.start(),(n??r.background.clearBeforeRender)&&r.renderTexture.clear(),t.render(r),r.batch.currentRenderer.flush(),s&&(e.blit&&r.framebuffer.blit(),s.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Lg.extension={type:Q.RendererSystem,name:"objectRenderer"};ot.add(Lg);const Ao=class ju extends x1{constructor(t){super(),this.type=Cm.WEBGL,t=Object.assign({},tt.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new cr({projectionMatrix:new Lt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:ju.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(bt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=ju.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:Kx()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return bt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return bt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return bt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return bt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};Ao.extension={type:Q.Renderer,priority:1},Ao.__plugins={},Ao.__systems={};let Rc=Ao;ot.handleByMap(Q.RendererPlugin,Rc.__plugins);ot.handleByMap(Q.RendererSystem,Rc.__systems);ot.add(Rc);class Ug extends $n{constructor(t,e){const{width:r,height:s}=e||{};super(r,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const l=new gt;this.items.push(l),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof $n?this.addResourceAt(t[r],r):this.addResourceAt(sg(t[r],e),r))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:r}=this.items[0];return this.resize(e,r),this.update(),Promise.resolve(this)}),this._load}}class I1 extends Ug{constructor(t,e){const{width:r,height:s}=e||{};let n,l;Array.isArray(t)?(n=t,l=t.length):l=t,super(l,{width:r,height:s}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=ks.TEXTURE_2D_ARRAY}upload(t,e,r){const{length:s,itemDirtyIds:n,items:l}=this,{gl:h}=t;r.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,s,0,e.format,r.type,null);for(let u=0;u<s;u++){const d=l[u];n[u]<d.dirtyId&&(n[u]=d.dirtyId,d.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,u,d.resource.width,d.resource.height,1,e.format,r.type,d.resource.source))}return!0}}class P1 extends ei{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Gg=class Rn extends Ug{constructor(t,e){const{width:r,height:s,autoLoad:n,linkBaseTexture:l}=e||{};if(t&&t.length!==Rn.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:s});for(let h=0;h<Rn.SIDES;h++)this.items[h].target=ks.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=l!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=ks.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=ks.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){const s=this.itemDirtyIds;for(let n=0;n<Rn.SIDES;n++){const l=this.items[n];(s[n]<l.dirtyId||r.dirtyId<e.dirtyId)&&(l.valid&&l.resource?(l.resource.upload(t,l,r),s[n]=l.dirtyId):s[n]<-1&&(t.gl.texImage2D(l.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),s[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Rn.SIDES}};Gg.SIDES=6;let R1=Gg;class Ns extends ei{constructor(t,e){e=e||{};let r,s,n;typeof t=="string"?(r=Ns.EMPTY,s=t,n=!0):(r=t,s=null,n=!1),super(r),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const r=await tt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await r.blob();if(this.destroyed)return;const n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Me.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(r){if(this.destroyed)return;e(r),this.onError.emit(r)}}),this._load)}upload(t,e,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Ns._EMPTY=Ns._EMPTY??tt.ADAPTER.createCanvas(0,0),Ns._EMPTY}}const Xu=class Co extends ei{constructor(t,e){e=e||{},super(tt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},Co.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;ei.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/r*e,n=this._overrideHeight||this._overrideWidth/e*r),s=Math.round(s),n=Math.round(n);const l=this.source;l.width=s,l.height=n,l._pixiId=`canvas_${rs()}`,l.getContext("2d").drawImage(t,0,0,e,r,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(t){const e=Co.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&Co.SVG_XML.test(t)}};Xu.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Xu.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Vu=Xu;class M1 extends ei{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const Yu=class qu extends ei{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const r=document.createElement("video");e.autoLoad!==!1&&r.setAttribute("preload","auto"),e.playsinline!==!1&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),e.muted===!0&&(r.setAttribute("muted",""),r.muted=!0),e.loop===!0&&r.setAttribute("loop",""),e.autoPlay!==!1&&r.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];ei.crossOrigin(r,s,e.crossorigin);for(let n=0;n<t.length;++n){const l=document.createElement("source");let{src:h,mime:u}=t[n];if(h=h||t[n],h.startsWith("data:"))u=h.slice(5,h.indexOf(";"));else if(!h.startsWith("blob:")){const d=h.split("?").shift().toLowerCase(),p=d.slice(d.lastIndexOf(".")+1);u=u||qu.MIME_TYPES[p]||`video/${p}`}l.src=h,u&&(l.type=u),r.appendChild(l)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=de.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,r)=>{this.valid?e(this):(this._resolve=e,this._reject=r,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(de.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(de.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(de.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||qu.TYPES.includes(e)}};Yu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Yu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Hg=Yu;Nu.push(Ns,fg,P1,Hg,M1,Vu,el,R1,I1);class $o{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?yt.EMPTY:(t=t||new yt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:r,b:s,c:n,d:l,tx:h,ty:u}=t,d=r*e.x+n*e.y+h,p=s*e.x+l*e.y+u;this.minX=Math.min(this.minX,d),this.maxX=Math.max(this.maxX,d),this.minY=Math.min(this.minY,p),this.maxY=Math.max(this.maxY,p)}addQuad(t){let e=this.minX,r=this.minY,s=this.maxX,n=this.maxY,l=t[0],h=t[1];e=l<e?l:e,r=h<r?h:r,s=l>s?l:s,n=h>n?h:n,l=t[2],h=t[3],e=l<e?l:e,r=h<r?h:r,s=l>s?l:s,n=h>n?h:n,l=t[4],h=t[5],e=l<e?l:e,r=h<r?h:r,s=l>s?l:s,n=h>n?h:n,l=t[6],h=t[7],e=l<e?l:e,r=h<r?h:r,s=l>s?l:s,n=h>n?h:n,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(t,e,r,s,n){this.addFrameMatrix(t.worldTransform,e,r,s,n)}addFrameMatrix(t,e,r,s,n){const l=t.a,h=t.b,u=t.c,d=t.d,p=t.tx,g=t.ty;let y=this.minX,v=this.minY,x=this.maxX,b=this.maxY,T=l*e+u*r+p,S=h*e+d*r+g;y=T<y?T:y,v=S<v?S:v,x=T>x?T:x,b=S>b?S:b,T=l*s+u*r+p,S=h*s+d*r+g,y=T<y?T:y,v=S<v?S:v,x=T>x?T:x,b=S>b?S:b,T=l*e+u*n+p,S=h*e+d*n+g,y=T<y?T:y,v=S<v?S:v,x=T>x?T:x,b=S>b?S:b,T=l*s+u*n+p,S=h*s+d*n+g,y=T<y?T:y,v=S<v?S:v,x=T>x?T:x,b=S>b?S:b,this.minX=y,this.minY=v,this.maxX=x,this.maxY=b}addVertexData(t,e,r){let s=this.minX,n=this.minY,l=this.maxX,h=this.maxY;for(let u=e;u<r;u+=2){const d=t[u],p=t[u+1];s=d<s?d:s,n=p<n?p:n,l=d>l?d:l,h=p>h?p:h}this.minX=s,this.minY=n,this.maxX=l,this.maxY=h}addVertices(t,e,r,s){this.addVerticesMatrix(t.worldTransform,e,r,s)}addVerticesMatrix(t,e,r,s,n=0,l=n){const h=t.a,u=t.b,d=t.c,p=t.d,g=t.tx,y=t.ty;let v=this.minX,x=this.minY,b=this.maxX,T=this.maxY;for(let S=r;S<s;S+=2){const I=e[S],w=e[S+1],C=h*I+d*w+g,N=p*w+u*I+y;v=Math.min(v,C-n),b=Math.max(b,C+n),x=Math.min(x,N-l),T=Math.max(T,N+l)}this.minX=v,this.minY=x,this.maxX=b,this.maxY=T}addBounds(t){const e=this.minX,r=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const r=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,l=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&s<=l){const h=this.minX,u=this.minY,d=this.maxX,p=this.maxY;this.minX=r<h?r:h,this.minY=s<u?s:u,this.maxX=n>d?n:d,this.maxY=l>p?l:p}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const r=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,l=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&s<=l){const h=this.minX,u=this.minY,d=this.maxX,p=this.maxY;this.minX=r<h?r:h,this.minY=s<u?s:u,this.maxX=n>d?n:d,this.maxY=l>p?l:p}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,r,s,n,l){t-=n,e-=l,r+=n,s+=l,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class zt extends Yn{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new nl,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new $o,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let r=0;r<e.length;++r){const s=e[r];Object.defineProperty(zt.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new yt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new $o);const e=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(r==null?void 0:r.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const l=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-n,l}toGlobal(t,e,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,r,s){return e&&(t=e.toGlobal(t,r,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,r=1,s=1,n=0,l=0,h=0,u=0,d=0){return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=s||1,this.rotation=n,this.skew.x=l,this.skew.y=h,this.pivot.x=u,this.pivot.y=d,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new D1),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*wb}set angle(t){this.transform.rotation=t*Sb}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class D1 extends zt{constructor(){super(...arguments),this.sortDirty=null}}zt.prototype.displayObjectUpdateTransform=zt.prototype.updateTransform;const B1=new Lt;function F1(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const zg=class Ku extends zt{constructor(){super(),this.children=[],this.sortableChildren=Ku.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t,this.onChildrenChange(r<s?r:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(t);Gs(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],r=this.children.indexOf(e);if(r===-1)return null;e.parent=null,e.transform._parentID=-1,Gs(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Gs(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const r=t,s=e,n=s-r;let l;if(n>0&&n<=s){l=this.children.splice(r,n);for(let h=0;h<l.length;++h)l[h].parent=null,l[h].transform&&(l[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let h=0;h<l.length;++h)l[h].emit("removed",this),this.emit("childRemoved",l[h],this,h);return l}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,r=this.children.length;e<r;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(F1),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const r=this.children[t];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const r=super.getLocalBounds(t);if(!e)for(let s=0,n=this.children.length;s<n;++s){const l=this.children[s];l.visible&&l.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let r,s;this.cullArea?(r=this.cullArea,s=this.worldTransform):this._render!==Ku.prototype._render&&(r=this.getBounds(!0));const n=t.projection.transform;if(n&&(s?(s=B1.copyFrom(s),s.prepend(n)):s=n),r&&e.intersects(r,s))this._render(t);else if(this.cullArea)return;for(let l=0,h=this.children.length;l<h;++l){const u=this.children[l],d=u.cullable;u.cullable=d||!this.cullArea,u.render(t),u.cullable=d}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let r=0,s=this.children.length;r<s;++r)this.children[r].render(t)}}renderAdvanced(t){var n,l,h;const e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let u=0;u<e.length;u++)e[u].enabled&&this._enabledFilters.push(e[u])}const s=e&&((n=this._enabledFilters)==null?void 0:n.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==ie.NONE));if(s&&t.batch.flush(),e&&((l=this._enabledFilters)!=null&&l.length)&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let u=0,d=this.children.length;u<d;++u)this.children[u].render(t)}s&&t.batch.flush(),r&&t.mask.pop(this),e&&((h=this._enabledFilters)!=null&&h.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,r=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<r.length;++s)r[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};zg.defaultSortableChildren=!1;let Ae=zg;Ae.prototype.containerUpdateTransform=Ae.prototype.updateTransform;Object.defineProperties(tt,{SORTABLE_CHILDREN:{get(){return Ae.defaultSortableChildren},set(i){bt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ae.defaultSortableChildren=i}}});const Sn=new wt,N1=new Uint16Array([0,1,2,0,2,3]);class Ur extends Ae{constructor(t){super(),this._anchor=new Dr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Nt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=pt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||K.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=N1,this.pluginName="batch",this.isSprite=!0,this._roundPixels=tt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=bi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=bi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,r=e.a,s=e.b,n=e.c,l=e.d,h=e.tx,u=e.ty,d=this.vertexData,p=t.trim,g=t.orig,y=this._anchor;let v=0,x=0,b=0,T=0;if(p?(x=p.x-y._x*g.width,v=x+p.width,T=p.y-y._y*g.height,b=T+p.height):(x=-y._x*g.width,v=x+g.width,T=-y._y*g.height,b=T+g.height),d[0]=r*x+n*T+h,d[1]=l*T+s*x+u,d[2]=r*v+n*T+h,d[3]=l*T+s*v+u,d[4]=r*v+n*b+h,d[5]=l*b+s*v+u,d[6]=r*x+n*b+h,d[7]=l*b+s*x+u,this._roundPixels){const S=tt.RESOLUTION;for(let I=0;I<d.length;++I)d[I]=Math.round(d[I]*S)/S}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,r=t.orig,s=this._anchor,n=this.transform.worldTransform,l=n.a,h=n.b,u=n.c,d=n.d,p=n.tx,g=n.ty,y=-s._x*r.width,v=y+r.width,x=-s._y*r.height,b=x+r.height;if(e[0]=l*y+u*x+p,e[1]=d*x+h*y+g,e[2]=l*v+u*x+p,e[3]=d*x+h*v+g,e[4]=l*v+u*b+p,e[5]=d*b+h*v+g,e[6]=l*y+u*b+p,e[7]=d*b+h*y+g,this._roundPixels){const T=tt.RESOLUTION;for(let S=0;S<e.length;++S)e[S]=Math.round(e[S]*T)/T}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new $o),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Sn);const e=this._texture.orig.width,r=this._texture.orig.height,s=-e*this.anchor.x;let n=0;return Sn.x>=s&&Sn.x<s+e&&(n=-r*this.anchor.y,Sn.y>=n&&Sn.y<n+r)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const r=t instanceof K?t:K.from(t,e);return new Ur(r)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=bi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=bi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||K.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const $g=new Lt;zt.prototype._cacheAsBitmap=!1;zt.prototype._cacheData=null;zt.prototype._cacheAsBitmapResolution=null;zt.prototype._cacheAsBitmapMultisample=null;class O1{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(zt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new O1),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});zt.prototype._renderCached=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))};zt.prototype._initCachedDisplayObject=function(i){var y,v;if((y=this._cacheData)!=null&&y.sprite)return;const t=this.alpha;this.alpha=1,i.batch.flush();const e=this.getLocalBounds(new yt,!0);if((v=this.filters)!=null&&v.length){const x=this.filters[0].padding;e.pad(x)}const r=this.cacheAsBitmapResolution||i.resolution;e.ceil(r),e.width=Math.max(e.width,1/r),e.height=Math.max(e.height,1/r);const s=i.renderTexture.current,n=i.renderTexture.sourceFrame.clone(),l=i.renderTexture.destinationFrame.clone(),h=i.projection.transform,u=ss.create({width:e.width,height:e.height,resolution:r,multisample:this.cacheAsBitmapMultisample??i.multisample}),d=`cacheAsBitmap_${rs()}`;this._cacheData.textureCacheId=d,gt.addToCache(u.baseTexture,d),K.addToCache(u,d);const p=this.transform.localTransform.copyTo($g).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:u,clear:!0,transform:p,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=h,i.renderTexture.bind(s,n,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const g=new Ur(u);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(e.x/e.width),g.anchor.y=-(e.y/e.height),g.alpha=t,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=g.containsPoint.bind(g)};zt.prototype._renderCachedCanvas=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))};zt.prototype._initCachedDisplayObjectCanvas=function(i){var p;if((p=this._cacheData)!=null&&p.sprite)return;const t=this.getLocalBounds(new yt,!0),e=this.alpha;this.alpha=1;const r=i.canvasContext.activeContext,s=i._projTransform,n=this.cacheAsBitmapResolution||i.resolution;t.ceil(n),t.width=Math.max(t.width,1/n),t.height=Math.max(t.height,1/n);const l=ss.create({width:t.width,height:t.height,resolution:n}),h=`cacheAsBitmap_${rs()}`;this._cacheData.textureCacheId=h,gt.addToCache(l.baseTexture,h),K.addToCache(l,h);const u=$g;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=t.x,u.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),i.canvasContext.activeContext=r,i._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const d=new Ur(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(t.x/t.width),d.anchor.y=-(t.y/t.height),d.alpha=e,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=d.containsPoint.bind(d)};zt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};zt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};zt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,gt.removeFromCache(this._cacheData.textureCacheId),K.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};zt.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)};zt.prototype.name=null;Ae.prototype.getChildByName=function(i,t){for(let e=0,r=this.children.length;e<r;e++)if(this.children[e].name===i)return this.children[e];if(t)for(let e=0,r=this.children.length;e<r;e++){const s=this.children[e];if(!s.getChildByName)continue;const n=s.getChildByName(i,!0);if(n)return n}return null};zt.prototype.getGlobalPosition=function(i=new wt,t=!1){return this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var k1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class L1 extends Se{constructor(t=1){super(A1,k1,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const U1={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},G1=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function H1(i){const t=U1[i],e=t.length;let r=G1,s="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let l;for(let h=0;h<i;h++){let u=n.replace("%index%",h.toString());l=h,h>=e&&(l=i-h-1),u=u.replace("%value%",t[l].toString()),s+=u,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}const z1=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function $1(i,t){const e=Math.ceil(i/2);let r=z1,s="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let l=0;l<i;l++){let h=n.replace("%index%",l.toString());h=h.replace("%sampleIndex%",`${l-(e-1)}.0`),s+=h,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}class Qu extends Se{constructor(t,e=8,r=4,s=Se.defaultResolution,n=5){const l=$1(n,t),h=H1(n);super(l,h),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=r,this.blur=e}apply(t,e,r,s){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,r,s);else{const n=t.getFilterTexture(),l=t.renderer;let h=e,u=n;this.state.blend=!1,t.applyFilter(this,h,u,Rr.CLEAR);for(let d=1;d<this.passes-1;d++){t.bindAndClear(h,Rr.BLIT),this.uniforms.uSampler=u;const p=u;u=h,h=p,l.shader.bind(this),l.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,r,s),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Wg extends Se{constructor(t=8,e=4,r=Se.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Qu(!0,t,e,r,s),this.blurYFilter=new Qu(!1,t,e,r,s),this.resolution=r,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,r,s){const n=Math.abs(this.blurXFilter.strength),l=Math.abs(this.blurYFilter.strength);if(n&&l){const h=t.getFilterTexture();this.blurXFilter.apply(t,e,h,Rr.CLEAR),this.blurYFilter.apply(t,h,r,s),t.returnFilterTexture(h)}else l?this.blurYFilter.apply(t,e,r,s):this.blurXFilter.apply(t,e,r,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var W1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Zu extends Se{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Ng,W1,t),this.alpha=1}_loadMatrix(t,e=!1){let r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}tint(t,e){const[r,s,n]=Nt.shared.setValue(t).toArray(),l=[r,0,0,0,0,0,s,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(l,e)}greyscale(t,e){const r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const r=Math.cos(t),s=Math.sin(t),n=Math.sqrt,l=1/3,h=n(l),u=r+(1-r)*l,d=l*(1-r)-h*s,p=l*(1-r)+h*s,g=l*(1-r)+h*s,y=r+l*(1-r),v=l*(1-r)-h*s,x=l*(1-r)-h*s,b=l*(1-r)+h*s,T=r+l*(1-r),S=[u,d,p,0,0,g,y,v,0,0,x,b,T,0,0,0,0,0,1,0];this._loadMatrix(S,e)}contrast(t,e){const r=(t||0)+1,s=-.5*(r-1),n=[r,0,0,0,s,0,r,0,0,s,0,0,r,0,s,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const r=t*2/3+1,s=(r-1)*-.5,n=[r,s,s,0,0,s,r,s,0,0,s,s,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,r,s,n){t=t||.2,e=e||.15,r=r||16770432,s=s||3375104;const l=Nt.shared,[h,u,d]=l.setValue(r).toArray(),[p,g,y]=l.setValue(s).toArray(),v=[.3,.59,.11,0,0,h,u,d,t,0,p,g,y,e,0,h-p,u-g,d-y,0,0];this._loadMatrix(v,n)}night(t,e){t=t||.1;const r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,e)}predator(t,e){const r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Zu.prototype.grayscale=Zu.prototype.greyscale;var j1=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,X1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class V1 extends Se{constructor(t,e){const r=new Lt;t.renderable=!1,super(X1,j1,{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=r,e==null&&(e=20),this.scale=new wt(e,e)}apply(t,e,r,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,l=Math.sqrt(n.a*n.a+n.b*n.b),h=Math.sqrt(n.c*n.c+n.d*n.d);l!==0&&h!==0&&(this.uniforms.rotation[0]=n.a/l,this.uniforms.rotation[1]=n.b/l,this.uniforms.rotation[2]=n.c/h,this.uniforms.rotation[3]=n.d/h),t.applyFilter(this,e,r,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var Y1=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,q1=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class K1 extends Se{constructor(){super(q1,Y1)}}var Q1=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Z1 extends Se{constructor(t=.5,e=Math.random()){super(Ng,Q1,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Gp={AlphaFilter:L1,BlurFilter:Wg,BlurFilterPass:Qu,ColorMatrixFilter:Zu,DisplacementFilter:V1,FXAAFilter:K1,NoiseFilter:Z1};Object.entries(Gp).forEach(([i,t])=>{Object.defineProperty(Gp,i,{get(){return bt("7.1.0",`filters.${i} has moved to ${i}`),t}})});class J1{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(de.system.add(this.tickerUpdate,this,Si.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(de.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const _i=new J1;class Qn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Qn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new wt,this.page=new wt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,r,s,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Wo extends Qn{constructor(){super(...arguments),this.client=new wt,this.movement=new wt,this.offset=new wt,this.global=new wt,this.screen=new wt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,r,s,n,l,h,u,d,p,g,y,v,x,b){throw new Error("Method not implemented.")}}class ar extends Wo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class zs extends Wo{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}zs.DOM_DELTA_PIXEL=0,zs.DOM_DELTA_LINE=1,zs.DOM_DELTA_PAGE=2;const tE=2048,eE=new wt,ru=new wt;class rE{constructor(t){this.dispatch=new Yn,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((r,s)=>r.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let r=0,s=e.length;r<s;r++)e[r].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){_i.pauseUpdate=!0;const r=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[r](this.rootTarget,this.rootTarget.eventMode,eE.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,n=r.length-1;s<n;s++)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=r.length-2;s>=0;s--)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,r=this._allInteractiveElements){if(r.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const s=Array.isArray(e)?e:[e];for(let n=r.length-1;n>=0;n--)s.forEach(l=>{t.currentTarget=r[n],this.notifyTarget(t,l)})}propagationPath(t){const e=[t];for(let r=0;r<tE&&t!==this.rootTarget;r++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,r,s,n,l=!1){let h=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(_i.pauseUpdate=!1),t.interactiveChildren&&t.children){const p=t.children;for(let g=p.length-1;g>=0;g--){const y=p[g],v=this.hitTestMoveRecursive(y,this._isInteractive(e)?e:y.eventMode,r,s,n,l||n(t,r));if(v){if(v.length>0&&!v[v.length-1].parent)continue;const x=t.isInteractive();(v.length>0||x)&&(x&&this._allInteractiveElements.push(t),v.push(t)),this._hitElements.length===0&&(this._hitElements=v),h=!0}}}const u=this._isInteractive(e),d=t.isInteractive();return u&&d&&this._allInteractiveElements.push(t),l||this._hitElements.length>0?null:h?this._hitElements:u&&!n(t,r)&&s(t,r)?d?[t]:[]:null}hitTestRecursive(t,e,r,s,n){if(this._interactivePrune(t)||n(t,r))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(_i.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let d=u.length-1;d>=0;d--){const p=u[d],g=this.hitTestRecursive(p,this._isInteractive(e)?e:p.eventMode,r,s,n);if(g){if(g.length>0&&!g[g.length-1].parent)continue;const y=t.isInteractive();return(g.length>0||y)&&g.push(t),g}}}const l=this._isInteractive(e),h=t.isInteractive();return l&&s(t,r)?h?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var r;if(t.hitArea&&(t.worldTransform.applyInverse(e,ru),!t.hitArea.contains(ru.x,ru.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((r=s.containsPoint)!=null&&r.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,l;e=e??t.type;const r=`on${e}`;(l=(n=t.currentTarget)[r])==null||l.call(n,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const r=this.trackingData(t.pointerId);r.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var u,d;if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const r=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.overTargets);if(((u=s.overTargets)==null?void 0:u.length)>0&&n!==e.target){const p=t.type==="mousemove"?"mouseout":"pointerout",g=this.createPointerEvent(t,p,n);if(this.dispatchEvent(g,"pointerout"),r&&this.dispatchEvent(g,"mouseout"),!e.composedPath().includes(n)){const y=this.createPointerEvent(t,"pointerleave",n);for(y.eventPhase=y.AT_TARGET;y.target&&!e.composedPath().includes(y.target);)y.currentTarget=y.target,this.notifyTarget(y),r&&this.notifyTarget(y,"mouseleave"),y.target=y.target.parent;this.freeEvent(y)}this.freeEvent(g)}if(n!==e.target){const p=t.type==="mousemove"?"mouseover":"pointerover",g=this.clonePointerEvent(e,p);this.dispatchEvent(g,"pointerover"),r&&this.dispatchEvent(g,"mouseover");let y=n==null?void 0:n.parent;for(;y&&y!==this.rootTarget.parent&&y!==e.target;)y=y.parent;if(!y||y===this.rootTarget.parent){const v=this.clonePointerEvent(e,"pointerenter");for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==n&&v.target!==this.rootTarget.parent;)v.currentTarget=v.target,this.notifyTarget(v),r&&this.notifyTarget(v,"mouseenter"),v.target=v.target.parent;this.freeEvent(v)}this.freeEvent(g)}const l=[],h=this.enableGlobalMoveEvents??!0;this.moveOnAll?l.push("pointermove"):this.dispatchEvent(e,"pointermove"),h&&l.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?l.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),h&&l.push("globaltouchmove")),r&&(this.moveOnAll?l.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),h&&l.push("globalmousemove"),this.cursor=(d=e.target)==null?void 0:d.cursor),l.length>0&&this.all(e,l),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var l;if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.createPointerEvent(t),s=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),s&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=(l=r.target)==null?void 0:l.cursor);const n=this.clonePointerEvent(r,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),s&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const r=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout");const l=this.createPointerEvent(t,"pointerleave",s);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),r&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(l)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const h=r.button===2;this.dispatchEvent(r,h?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.pressTargetsByButton[t.button]);let l=n;if(n&&!r.composedPath().includes(n)){let h=n;for(;h&&!r.composedPath().includes(h);){if(r.currentTarget=h,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const u=r.button===2;this.notifyTarget(r,u?"rightupoutside":"mouseupoutside")}h=h.parent}delete s.pressTargetsByButton[t.button],l=h}if(l){const h=this.clonePointerEvent(r,"click");h.target=l,h.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});const u=s.clicksByButton[t.button];if(u.target===h.target&&e-u.timeStamp<200?++u.clickCount:u.clickCount=1,u.target=h.target,u.timeStamp=e,h.detail=u.clickCount,h.pointerType==="mouse"){const d=h.button===2;this.dispatchEvent(h,d?"rightclick":"click")}else h.pointerType==="touch"&&this.dispatchEvent(h,"tap");this.dispatchEvent(h,"pointertap"),this.freeEvent(h)}this.freeEvent(r)}mapPointerUpOutside(t){if(!(t instanceof ar)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(r){let n=r;for(;n;)s.currentTarget=n,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof zs)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let r=1;r<t.length&&t[r].parent===e;r++)e=t[r];return e}createPointerEvent(t,e,r){const s=this.allocateEvent(ar);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=r??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(zs);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const r=this.allocateEvent(ar);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=e??r.type,r}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ar&&e instanceof ar&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Wo&&e instanceof Wo&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const r=t.currentTarget._events[e];if(r&&t.currentTarget.isInteractive())if("fn"in r)r.once&&t.currentTarget.removeListener(e,r.fn,void 0,!0),r.fn.call(r.context,t);else for(let s=0,n=r.length;s<n&&!t.propagationImmediatelyStopped;s++)r[s].once&&t.currentTarget.removeListener(e,r[s].fn,void 0,!0),r[s].fn.call(r[s].context,t)}}const iE=1,sE={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Ju=class tc{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new rE(null),_i.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ar(null),this.rootWheelEvent=new zs(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...tc.defaultEventFeatures},{set:(e,r,s)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[r]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:r}=this.renderer;this.setTargetElement(e),this.resolution=r,tc._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.domElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.domElement.style,r);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let r=0,s=e.length;r<s;r++){const n=e[r],l=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,_i.pointerMoved();const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const r=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let n=0,l=s.length;n<l;n++){const h=this.bootstrapEvent(this.rootPointerEvent,s[n]);h.type+=r,this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,_i.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;_i.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;_i.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,r){const s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*n,t.y=(r-s.top)*(this.domElement.height/s.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let r=0,s=t.changedTouches.length;r<s;r++){const n=t.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const r=t;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=iE),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=sE[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Ju.extension={name:"events",type:[Q.RendererSystem,Q.CanvasRendererSystem]},Ju.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let ec=Ju;ot.add(ec);function Hp(i){return i==="dynamic"||i==="static"}const nE={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Hp(ec.defaultEventMode)},set interactive(i){bt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=i,this.eventMode=i?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ec.defaultEventMode},set eventMode(i){this._internalInteractive=Hp(i),this._internalEventMode=i},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof e=="object"?e.signal:void 0,n=typeof e=="object"?e.once===!0:!1,l=typeof t=="function"?void 0:t;i=r?`${i}capture`:i;const h=typeof t=="function"?t:t.handleEvent,u=this;s&&s.addEventListener("abort",()=>{u.off(i,h,l)}),n?u.once(i,h,l):u.on(i,h,l)},removeEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=r?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,s)},dispatchEvent(i){if(!(i instanceof Qn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};zt.mixin(nE);const aE={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};zt.mixin(aE);const oE=9,io=100,lE=0,hE=0,zp=2,$p=1,uE=-1e3,cE=-1e3,dE=2;class jg{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(qr.tablet||qr.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${io}px`,e.style.height=`${io}px`,e.style.position="absolute",e.style.top=`${lE}px`,e.style.left=`${hE}px`,e.style.zIndex=zp.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${$p}px`,t.style.height=`${$p}px`,t.style.position="absolute",t.style.top=`${uE}px`,t.style.left=`${cE}px`,t.style.zIndex=dE.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}update(){const t=performance.now();if(qr.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:r,width:s,height:n}=this.renderer.view.getBoundingClientRect(),{width:l,height:h,resolution:u}=this.renderer,d=s/l*u,p=n/h*u;let g=this.div;g.style.left=`${e}px`,g.style.top=`${r}px`,g.style.width=`${l}px`,g.style.height=`${h}px`;for(let y=0;y<this.children.length;y++){const v=this.children[y];if(v.renderId!==this.renderId)v._accessibleActive=!1,Gs(this.children,y,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,y--;else{g=v._accessibleDiv;let x=v.hitArea;const b=v.worldTransform;v.hitArea?(g.style.left=`${(b.tx+x.x*b.a)*d}px`,g.style.top=`${(b.ty+x.y*b.d)*p}px`,g.style.width=`${x.width*b.a*d}px`,g.style.height=`${x.height*b.d*p}px`):(x=v.getBounds(),this.capHitArea(x),g.style.left=`${x.x*d}px`,g.style.top=`${x.y*p}px`,g.style.width=`${x.width*d}px`,g.style.height=`${x.height*p}px`,g.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(g.title=v.accessibleTitle),g.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&g.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==g.title||v.tabIndex!==g.tabIndex)&&(g.title=v.accessibleTitle,g.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(g))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:r}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>r&&(t.height=r-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${io}px`,e.style.height=`${io}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=zp.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:r}=t.target,s=this.renderer.events.rootBoundary,n=Object.assign(new Qn(s),{target:r});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(l=>s.dispatchEvent(n,l))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===oE&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}jg.extension={name:"accessibility",type:[Q.RendererPlugin,Q.CanvasRendererPlugin]};ot.add(jg);const Xg=class rc{constructor(t){this.stage=new Ae,t=Object.assign({forceCanvas:!1},t),this.renderer=T1(t),rc._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const r=rc._plugins.slice(0);r.reverse(),r.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Xg._plugins=[];let ol=Xg;ot.handleByList(Q.Application,ol._plugins);class Vg{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,r;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:n}=this._resizeTo;e=s,r=n}this.renderer.resize(e,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Vg.extension=Q.Application;ot.add(Vg);const Wp={loader:Q.LoadParser,resolver:Q.ResolveParser,cache:Q.CacheParser,detection:Q.DetectionParser};ot.handle(Q.Asset,i=>{const t=i.ref;Object.entries(Wp).filter(([e])=>!!t[e]).forEach(([e,r])=>ot.add(Object.assign(t[e],{extension:t[e].extension??r})))},i=>{const t=i.ref;Object.keys(Wp).filter(e=>!!t[e]).forEach(e=>ot.remove(t[e]))});class fE{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Qs(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function Ii(i,t){const e=i.split("?")[0],r=se.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const or=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(r=>typeof r=="string"||e?t(r):r):i),ic=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i};function Yg(i,t,e,r,s){const n=t[e];for(let l=0;l<n.length;l++){const h=n[l];e<t.length-1?Yg(i.replace(r[e],h),t,e+1,r,s):s.push(i.replace(r[e],h))}}function pE(i){const t=/\{(.*?)\}/g,e=i.match(t),r=[];if(e){const s=[];e.forEach(n=>{const l=n.substring(1,n.length-1).split(",");s.push(l)}),Yg(i,s,0,e,r)}else r.push(i);return r}const jo=i=>!Array.isArray(i);class mE{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=or(t);let s;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];if(u.test(e)){s=u.getCacheableAssets(r,e);break}}s||(s={},r.forEach(h=>{s[h]=e}));const n=Object.keys(s),l={cacheKeys:n,keys:r};if(r.forEach(h=>{this._cacheMap.set(h,l)}),n.forEach(h=>{this._cache.has(h)&&this._cache.get(h)!==e&&console.warn("[Cache] already has key:",h),this._cache.set(h,s[h])}),e instanceof K){const h=e;r.forEach(u=>{h.baseTexture!==K.EMPTY.baseTexture&&gt.addToCache(h.baseTexture,u),K.addToCache(h,u)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Ki=new mE;class gE{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var l,h;let s=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];if(d.load&&((l=d.test)!=null&&l.call(d,t,e,this))){n=d;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,e,this),r.parser=n;for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];d.parse&&d.parse&&await((h=d.testParse)==null?void 0:h.call(d,s,e,this))&&(s=await d.parse(s,e,this)||s,r.parser=d)}return s})(),r}async load(t,e){this._parsersValidated||this._validateParsers();let r=0;const s={},n=jo(t),l=or(t,d=>({alias:[d],src:d})),h=l.length,u=l.map(async d=>{const p=se.toAbsolute(d.src);if(!s[d.src])try{this.promiseCache[p]||(this.promiseCache[p]=this._getLoadPromiseAndParser(p,d)),s[d.src]=await this.promiseCache[p].promise,e&&e(++r/h)}catch(g){throw delete this.promiseCache[p],delete s[d.src],new Error(`[Loader.load] Failed to load ${p}.
${g}`)}});return await Promise.all(u),n?s[l[0].src]:s}async unload(t){const e=or(t,r=>({alias:[r],src:r})).map(async r=>{var l,h;const s=se.toAbsolute(r.src),n=this.promiseCache[s];if(n){const u=await n.promise;delete this.promiseCache[s],(h=(l=n.parser)==null?void 0:l.unload)==null||h.call(l,u,r,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var dr=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(dr||{});const yE=".json",vE="application/json",_E={extension:{type:Q.LoadParser,priority:dr.Low},name:"loadJson",test(i){return Qs(i,vE)||Ii(i,yE)},async load(i){return await(await tt.ADAPTER.fetch(i)).json()}};ot.add(_E);const xE=".txt",bE="text/plain",EE={name:"loadTxt",extension:{type:Q.LoadParser,priority:dr.Low},test(i){return Qs(i,bE)||Ii(i,xE)},async load(i){return await(await tt.ADAPTER.fetch(i)).text()}};ot.add(EE);const TE=["normal","bold","100","200","300","400","500","600","700","800","900"],wE=[".ttf",".otf",".woff",".woff2"],SE=["font/ttf","font/otf","font/woff","font/woff2"],AE=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function CE(i){const t=se.extname(i),e=se.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let r=e.length>0;for(const n of e)if(!n.match(AE)){r=!1;break}let s=e.join(" ");return r||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}const IE=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function PE(i){return IE.test(i)?i:encodeURI(i)}const RE={extension:{type:Q.LoadParser,priority:dr.Low},name:"loadWebFont",test(i){return Qs(i,SE)||Ii(i,wE)},async load(i,t){var r,s,n;const e=tt.ADAPTER.getFontFaceSet();if(e){const l=[],h=((r=t.data)==null?void 0:r.family)??CE(i),u=((n=(s=t.data)==null?void 0:s.weights)==null?void 0:n.filter(p=>TE.includes(p)))??["normal"],d=t.data??{};for(let p=0;p<u.length;p++){const g=u[p],y=new FontFace(h,`url(${PE(i)})`,{...d,weight:g});await y.load(),e.add(y),l.push(y)}return l.length===1?l[0]:l}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>tt.ADAPTER.getFontFaceSet().delete(t))}};ot.add(RE);const ME=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let $s=null,sc=class extends Worker{constructor(){$s||($s=URL.createObjectURL(new Blob([ME],{type:"application/javascript"}))),super($s)}};sc.revokeObjectURL=function(){$s&&(URL.revokeObjectURL($s),$s=null)};const DE=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Ws=null;class qg extends Worker{constructor(){Ws||(Ws=URL.createObjectURL(new Blob([DE],{type:"application/javascript"}))),super(Ws)}}qg.revokeObjectURL=function(){Ws&&(URL.revokeObjectURL(Ws),Ws=null)};let jp=0,iu;class BE{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=new sc;e.addEventListener("message",r=>{e.terminate(),sc.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){iu===void 0&&(iu=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<iu&&(this._createdWorkers++,t=new qg,t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise((s,n)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:n})});return this.next(),r}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),r=e.id;this.resolveHash[jp]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:jp++,id:r})}}const Xp=new BE;function Zn(i,t,e){i.resource.internal=!0;const r=new K(i),s=()=>{delete t.promiseCache[e],Ki.has(e)&&Ki.remove(e)};return r.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),r.once("destroyed",()=>{i.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),r}const FE=[".jpeg",".jpg",".png",".webp",".avif"],NE=["image/jpeg","image/png","image/webp","image/avif"];async function OE(i){const t=await tt.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const ll={name:"loadTextures",extension:{type:Q.LoadParser,priority:dr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return Qs(i,NE)||Ii(i,FE)},async load(i,t,e){var h;const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let s;r?this.config.preferWorkers&&await Xp.isImageBitmapSupported()?s=await Xp.loadImageBitmap(i):s=await OE(i):s=await new Promise((u,d)=>{const p=new Image;p.crossOrigin=this.config.crossOrigin,p.src=i,p.complete?u(p):(p.onload=()=>u(p),p.onerror=g=>d(g))});const n={...t.data};n.resolution??(n.resolution=ti(i)),r&&((h=n.resourceOptions)==null?void 0:h.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const l=new gt(s,n);return l.resource.src=i,Zn(l,e,i)},unload(i){i.destroy(!0)}};ot.add(ll);const kE=".svg",LE="image/svg+xml",UE={extension:{type:Q.LoadParser,priority:dr.High},name:"loadSVG",test(i){return Qs(i,LE)||Ii(i,kE)},async testParse(i){return Vu.test(i)},async parse(i,t,e){var n;const r=new Vu(i,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await r.load();const s=new gt(r,{resolution:ti(i),...t==null?void 0:t.data});return s.resource.src=t.src,Zn(s,e,t.src)},async load(i,t){return(await tt.ADAPTER.fetch(i)).text()},unload:ll.unload};ot.add(UE);const GE=[".mp4",".m4v",".webm",".ogv"],HE=["video/mp4","video/webm","video/ogg"],zE={name:"loadVideo",extension:{type:Q.LoadParser,priority:dr.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(i){return Qs(i,HE)||Ii(i,GE)},async load(i,t,e){var l;let r;const s=await(await tt.ADAPTER.fetch(i)).blob(),n=URL.createObjectURL(s);try{const h={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions,autoLoad:!0},u=new Hg(n,h);await u.load();const d=new gt(u,{alphaMode:await qx(),resolution:ti(i),...t==null?void 0:t.data});d.resource.src=i,r=Zn(d,e,i),r.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(h){throw URL.revokeObjectURL(n),h}return r},unload(i){i.destroy(!0)}};ot.add(zE);class $E{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,name:r,src:s,srcs:n}=t;return or(e||r||s||n,l=>typeof l=="string"?l:Array.isArray(l)?l.map(h=>(h==null?void 0:h.src)??(h==null?void 0:h.srcs)??h):l!=null&&l.src||l!=null&&l.srcs?l.src??l.srcs:l,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];Array.isArray(e)?e.forEach(s=>{const n=s.src??s.srcs,l=s.alias??s.name;let h;if(typeof l=="string"){const u=this._createBundleAssetId(t,l);r.push(u),h=[l,u]}else{const u=l.map(d=>this._createBundleAssetId(t,d));r.push(...u),h=[...l,...u]}this.add({...s,alias:h,src:n})}):Object.keys(e).forEach(s=>{const n=[s,this._createBundleAssetId(t,s)];if(typeof e[s]=="string")this.add({alias:n,src:e[s]});else if(Array.isArray(e[s]))this.add({alias:n,src:e[s]});else{const l=e[s],h=l.src??l.srcs;this.add({...l,alias:n,src:Array.isArray(h)?h:[h]})}r.push(...n)}),this._bundles[t]=r}add(t,e,r,s,n){const l=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(bt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),l.push({alias:t,src:e,data:r,format:s,loadParser:n})):Array.isArray(t)?l.push(...t):l.push(t);let h;h=u=>{this.hasKey(u)&&console.warn(`[Resolver] already has key: ${u} overwriting`)},or(l).forEach(u=>{const{src:d,srcs:p}=u;let{data:g,format:y,loadParser:v}=u;const x=or(d||p).map(S=>typeof S=="string"?pE(S):Array.isArray(S)?S:[S]),b=this.getAlias(u);Array.isArray(b)?b.forEach(h):h(b);const T=[];x.forEach(S=>{S.forEach(I=>{let w={};if(typeof I!="object"){w.src=I;for(let C=0;C<this._parsers.length;C++){const N=this._parsers[C];if(N.test(I)){w=N.parse(I);break}}}else g=I.data??g,y=I.format??y,v=I.loadParser??v,w={...w,...I};if(!b)throw new Error(`[Resolver] alias is undefined for this asset: ${w.src}`);w=this.buildResolvedAsset(w,{aliases:b,data:g,format:y,loadParser:v}),T.push(w)})}),b.forEach(S=>{this._assetMap[S]=T})})}resolveBundle(t){const e=jo(t);t=or(t);const r={};return t.forEach(s=>{const n=this._bundles[s];if(n){const l=this.resolve(n),h={};for(const u in l){const d=l[u];h[this._extractAssetIdFromBundle(s,u)]=d}r[s]=h}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const s in e)r[s]=e[s].src;return r}return e.src}resolve(t){const e=jo(t);t=or(t);const r={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const l=n[0],h=this._getPreferredOrder(n);h==null||h.priority.forEach(u=>{h.params[u].forEach(d=>{const p=n.filter(g=>g[u]?g[u]===d:!1);p.length&&(n=p)})}),this._resolverHash[s]=n[0]??l}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});r[s]=this._resolverHash[s]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(r.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:r,data:s,loadParser:n,format:l}=e;return(this._basePath||this._rootPath)&&(t.src=se.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=n??t.loadParser,t.format=l??se.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class WE{constructor(){this._detections=[],this._initialized=!1,this.resolver=new $E,this.loader=new gE,this.cache=Ki,this._backgroundLoader=new fE(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,r=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(l=t.texturePreference)==null?void 0:l.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,r,s,n){this.resolver.add(t,e,r,s,n)}async load(t,e){this._initialized||await this.init();const r=jo(t),s=or(t).map(h=>{if(typeof h!="string"){const u=this.resolver.getAlias(h);return u.some(d=>!this.resolver.hasKey(d))&&this.add(h),Array.isArray(u)?u[0]:u}return this.resolver.hasKey(h)||this.add({alias:h,src:h}),h}),n=this.resolver.resolve(s),l=await this._mapLoadToResolve(n,e);return r?l[s[0]]:l}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const s=this.resolver.resolveBundle(t),n={},l=Object.keys(s);let h=0,u=0;const d=()=>{e==null||e(++h/u)},p=l.map(g=>{const y=s[g];return u+=Object.keys(y).length,this._mapLoadToResolve(y,d).then(v=>{n[g]=v})});return await Promise.all(p),r?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ki.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=Ki.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(r,e);this._backgroundLoader.active=!0;const l={};return r.forEach((h,u)=>{const d=n[h.src],p=[h.src];h.alias&&p.push(...h.alias),l[s[u]]=d,Ki.set(p,d)}),l}async unload(t){this._initialized||await this.init();const e=or(t).map(s=>typeof s!="string"?s.src:s),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=or(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{Ki.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,s)=>e.indexOf(r)===s),e}get detections(){return this._detections}get preferWorkers(){return ll.config.preferWorkers}set preferWorkers(t){bt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const so=new WE;ot.handleByList(Q.LoadParser,so.loader.parsers).handleByList(Q.ResolveParser,so.resolver.parsers).handleByList(Q.CacheParser,so.cache.parsers).handleByList(Q.DetectionParser,so.detections);const jE={extension:Q.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof K),getCacheableAssets:(i,t)=>{const e={};return i.forEach(r=>{t.forEach((s,n)=>{e[r+(n===0?"":n+1)]=s})}),e}};ot.add(jE);async function Kg(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const XE={extension:{type:Q.DetectionParser,priority:1},test:async()=>Kg("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};ot.add(XE);const VE={extension:{type:Q.DetectionParser,priority:0},test:async()=>Kg("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};ot.add(VE);const Vp=["png","jpg","jpeg"],YE={extension:{type:Q.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Vp],remove:async i=>i.filter(t=>!Vp.includes(t))};ot.add(YE);const qE="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Mc(i){return qE?!1:document.createElement("video").canPlayType(i)!==""}const KE={extension:{type:Q.DetectionParser,priority:0},test:async()=>Mc("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")};ot.add(KE);const QE={extension:{type:Q.DetectionParser,priority:0},test:async()=>Mc("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")};ot.add(QE);const ZE={extension:{type:Q.DetectionParser,priority:0},test:async()=>Mc("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")};ot.add(ZE);const JE={extension:Q.ResolveParser,test:ll.test,parse:i=>{var t;return{resolution:parseFloat(((t=tt.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:se.extname(i).slice(1),src:i}}};ot.add(JE);var ge=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i[i.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",i[i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",i[i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",i[i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",i))(ge||{});const Xo={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Ar,Ms;function Yp(){Ms={s3tc:Ar.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ar.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ar.getExtension("WEBGL_compressed_texture_etc"),etc1:Ar.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ar.getExtension("WEBGL_compressed_texture_pvrtc")||Ar.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ar.getExtension("WEBGL_compressed_texture_atc"),astc:Ar.getExtension("WEBGL_compressed_texture_astc"),bptc:Ar.getExtension("EXT_texture_compression_bptc")}}const tT={extension:{type:Q.DetectionParser,priority:2},test:async()=>{const i=tt.ADAPTER.createCanvas().getContext("webgl");return i?(Ar=i,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{Ms||Yp();const t=[];for(const e in Ms)Ms[e]&&t.push(e);return[...t,...i]},remove:async i=>(Ms||Yp(),i.filter(t=>!(t in Ms)))};ot.add(tT);class eT extends el{constructor(t,e={width:1,height:1,autoLoad:!0}){let r,s;typeof t=="string"?(r=t,s=new Uint8Array):(r=null,s=t),super(s,e),this.origin=r,this.buffer=s?new Fu(s):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Fu(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class ts extends eT{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=ts._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||ts._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,r){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;s.pixelStorei(s.UNPACK_ALIGNMENT,4);for(let n=0,l=this.levels;n<l;n++){const{levelID:h,levelWidth:u,levelHeight:d,levelBuffer:p}=this._levelBuffers[n];s.compressedTexImage2D(s.TEXTURE_2D,h,this.format,u,d,0,p)}return!0}onBlobLoaded(){this._levelBuffers=ts._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t===36196)return"etc1";if(t===35986||t===35987||t===34798)return"atc";if(t>=36492&&t<=36495)return"bptc";if(t===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,r,s,n,l,h){const u=new Array(r);let d=t.byteOffset,p=l,g=h,y=p+s-1&~(s-1),v=g+n-1&~(n-1),x=y*v*Xo[e];for(let b=0;b<r;b++)u[b]={levelID:b,levelWidth:r>1?p:y,levelHeight:r>1?g:v,levelBuffer:new Uint8Array(t.buffer,d,x)},d+=x,p=p>>1||1,g=g>>1||1,y=p+s-1&~(s-1),v=g+n-1&~(n-1),x=y*v*Xo[e];return u}}const su=4,no=124,rT=32,qp=20,iT=542327876,ao={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},sT={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},oo={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},nT=1,aT=2,oT=4,lT=64,hT=512,uT=131072,cT=827611204,dT=861165636,fT=894720068,pT=808540228,mT=4,gT={[cT]:ge.COMPRESSED_RGBA_S3TC_DXT1_EXT,[dT]:ge.COMPRESSED_RGBA_S3TC_DXT3_EXT,[fT]:ge.COMPRESSED_RGBA_S3TC_DXT5_EXT},yT={70:ge.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ge.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ge.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ge.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ge.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ge.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ge.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ge.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ge.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:ge.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:ge.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:ge.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:ge.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function vT(i){const t=new Uint32Array(i);if(t[0]!==iT)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(i,0,no/Uint32Array.BYTES_PER_ELEMENT),r=e[ao.HEIGHT],s=e[ao.WIDTH],n=e[ao.MIPMAP_COUNT],l=new Uint32Array(i,ao.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,rT/Uint32Array.BYTES_PER_ELEMENT),h=l[nT];if(h&oT){const u=l[sT.FOURCC];if(u!==pT){const I=gT[u],w=su+no,C=new Uint8Array(i,w);return[new ts(C,{format:I,width:s,height:r,levels:n})]}const d=su+no,p=new Uint32Array(t.buffer,d,qp/Uint32Array.BYTES_PER_ELEMENT),g=p[oo.DXGI_FORMAT],y=p[oo.RESOURCE_DIMENSION],v=p[oo.MISC_FLAG],x=p[oo.ARRAY_SIZE],b=yT[g];if(b===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${g}`);if(v===mT)throw new Error("DDSParser does not support cubemap textures");if(y===6)throw new Error("DDSParser does not supported 3D texture data");const T=new Array,S=su+no+qp;if(x===1)T.push(new Uint8Array(i,S));else{const I=Xo[b];let w=0,C=s,N=r;for(let z=0;z<n;z++){const G=Math.max(1,C+3&-4),Y=Math.max(1,N+3&-4),rt=G*Y*I;w+=rt,C=C>>>1,N=N>>>1}let V=S;for(let z=0;z<x;z++)T.push(new Uint8Array(i,V,w)),V+=w}return T.map(I=>new ts(I,{format:b,width:s,height:r,levels:n}))}throw h&lT?new Error("DDSParser does not support uncompressed texture data."):h&hT?new Error("DDSParser does not supported YUV uncompressed texture data."):h&uT?new Error("DDSParser does not support single-channel (lumninance) texture data!"):h&aT?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Kp=[171,75,84,88,32,49,49,187,13,10,26,10],_T=67305985,sr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},nc=64,Qp={[ut.UNSIGNED_BYTE]:1,[ut.UNSIGNED_SHORT]:2,[ut.INT]:4,[ut.UNSIGNED_INT]:4,[ut.FLOAT]:4,[ut.HALF_FLOAT]:8},xT={[X.RGBA]:4,[X.RGB]:3,[X.RG]:2,[X.RED]:1,[X.LUMINANCE]:1,[X.LUMINANCE_ALPHA]:2,[X.ALPHA]:1},bT={[ut.UNSIGNED_SHORT_4_4_4_4]:2,[ut.UNSIGNED_SHORT_5_5_5_1]:2,[ut.UNSIGNED_SHORT_5_6_5]:2};function ET(i,t,e=!1){const r=new DataView(t);if(!TT(i,r))return null;const s=r.getUint32(sr.ENDIANNESS,!0)===_T,n=r.getUint32(sr.GL_TYPE,s),l=r.getUint32(sr.GL_FORMAT,s),h=r.getUint32(sr.GL_INTERNAL_FORMAT,s),u=r.getUint32(sr.PIXEL_WIDTH,s),d=r.getUint32(sr.PIXEL_HEIGHT,s)||1,p=r.getUint32(sr.PIXEL_DEPTH,s)||1,g=r.getUint32(sr.NUMBER_OF_ARRAY_ELEMENTS,s)||1,y=r.getUint32(sr.NUMBER_OF_FACES,s),v=r.getUint32(sr.NUMBER_OF_MIPMAP_LEVELS,s),x=r.getUint32(sr.BYTES_OF_KEY_VALUE_DATA,s);if(d===0||p!==1)throw new Error("Only 2D textures are supported");if(y!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(g!==1)throw new Error("WebGL does not support array textures");const b=4,T=4,S=u+3&-4,I=d+3&-4,w=new Array(g);let C=u*d;n===0&&(C=S*I);let N;if(n!==0?Qp[n]?N=Qp[n]*xT[l]:N=bT[n]:N=Xo[h],N===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const V=e?ST(r,x,s):null;let z=C*N,G=u,Y=d,rt=S,mt=I,Z=nc+x;for(let M=0;M<v;M++){const W=r.getUint32(Z,s);let it=Z+4;for(let ft=0;ft<g;ft++){let nt=w[ft];nt||(nt=w[ft]=new Array(v)),nt[M]={levelID:M,levelWidth:v>1||n!==0?G:rt,levelHeight:v>1||n!==0?Y:mt,levelBuffer:new Uint8Array(t,it,z)},it+=z}Z+=W+4,Z=Z%4!==0?Z+4-Z%4:Z,G=G>>1||1,Y=Y>>1||1,rt=G+b-1&~(b-1),mt=Y+T-1&~(T-1),z=rt*mt*N}return n!==0?{uncompressed:w.map(M=>{let W=M[0].levelBuffer,it=!1;return n===ut.FLOAT?W=new Float32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4):n===ut.UNSIGNED_INT?(it=!0,W=new Uint32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)):n===ut.INT&&(it=!0,W=new Int32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)),{resource:new el(W,{width:M[0].levelWidth,height:M[0].levelHeight}),type:n,format:it?wT(l):l}}),kvData:V}:{compressed:w.map(M=>new ts(null,{format:h,width:u,height:d,levels:v,levelBuffers:M})),kvData:V}}function TT(i,t){for(let e=0;e<Kp.length;e++)if(t.getUint8(e)!==Kp[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function wT(i){switch(i){case X.RGBA:return X.RGBA_INTEGER;case X.RGB:return X.RGB_INTEGER;case X.RG:return X.RG_INTEGER;case X.RED:return X.RED_INTEGER;default:return i}}function ST(i,t,e){const r=new Map;let s=0;for(;s<t;){const n=i.getUint32(nc+s,e),l=nc+s+4,h=3-(n+3)%4;if(n===0||n>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let u=0;for(;u<n&&i.getUint8(l+u)!==0;u++);if(u===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const d=new TextDecoder().decode(new Uint8Array(i.buffer,l,u)),p=new DataView(i.buffer,l+u+1,n-u-1);r.set(d,p),s+=4+n+h}return r}const AT={extension:{type:Q.LoadParser,priority:dr.High},name:"loadDDS",test(i){return Ii(i,".dds")},async load(i,t,e){const r=await(await tt.ADAPTER.fetch(i)).arrayBuffer(),s=vT(r).map(n=>{const l=new gt(n,{mipmap:Nr.OFF,alphaMode:Me.NO_PREMULTIPLIED_ALPHA,resolution:ti(i),...t.data});return Zn(l,e,i)});return s.length===1?s[0]:s},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};ot.add(AT);const CT={extension:{type:Q.LoadParser,priority:dr.High},name:"loadKTX",test(i){return Ii(i,".ktx")},async load(i,t,e){const r=await(await tt.ADAPTER.fetch(i)).arrayBuffer(),{compressed:s,uncompressed:n,kvData:l}=ET(i,r),h=s??n,u={mipmap:Nr.OFF,alphaMode:Me.NO_PREMULTIPLIED_ALPHA,resolution:ti(i),...t.data},d=h.map(p=>{h===n&&Object.assign(u,{type:p.type,format:p.format});const g=p.resource??p,y=new gt(g,u);return y.ktxKeyValueData=l,Zn(y,e,i)});return d.length===1?d[0]:d},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};ot.add(CT);const IT={extension:Q.ResolveParser,test:i=>{const t=se.extname(i).slice(1);return["basis","ktx","dds"].includes(t)},parse:i=>{var e,r;const t=se.extname(i).slice(1);if(t==="ktx"){const s=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx",".bptc.ktx"];if(s.some(n=>i.endsWith(n)))return{resolution:parseFloat(((e=tt.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:s.find(n=>i.endsWith(n)),src:i}}return{resolution:parseFloat(((r=tt.RETINA_PREFIX.exec(i))==null?void 0:r[1])??"1"),format:t,src:i}}};ot.add(IT);const lo=new yt,PT=4,Qg=class Mn{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,r,s){const n=new Image;return n.src=await this.base64(t,e,r,s),n}async base64(t,e,r,s){const n=this.canvas(t,s);if(n.toBlob!==void 0)return new Promise((l,h)=>{n.toBlob(u=>{if(!u){h(new Error("ICanvas.toBlob failed!"));return}const d=new FileReader;d.onload=()=>l(d.result),d.onerror=h,d.readAsDataURL(u)},e,r)});if(n.toDataURL!==void 0)return n.toDataURL(e,r);if(n.convertToBlob!==void 0){const l=await n.convertToBlob({type:e,quality:r});return new Promise((h,u)=>{const d=new FileReader;d.onload=()=>h(d.result),d.onerror=u,d.readAsDataURL(l)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:r,width:s,height:n,flipY:l,premultipliedAlpha:h}=this._rawPixels(t,e);l&&Mn._flipY(r,s,n),h&&Mn._unpremultiplyAlpha(r);const u=new cb(s,n,1),d=new ImageData(new Uint8ClampedArray(r.buffer),s,n);return u.context.putImageData(d,0,0),u.canvas}pixels(t,e){const{pixels:r,width:s,height:n,flipY:l,premultipliedAlpha:h}=this._rawPixels(t,e);return l&&Mn._flipY(r,s,n),h&&Mn._unpremultiplyAlpha(r),r}_rawPixels(t,e){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let s,n=!1,l=!1,h,u=!1;t&&(t instanceof ss?h=t:(h=r.generateTexture(t,{region:e,resolution:r.resolution,multisample:r.multisample}),u=!0,e&&(lo.width=e.width,lo.height=e.height,e=lo)));const d=r.gl;if(h){if(s=h.baseTexture.resolution,e=e??h.frame,n=!1,l=h.baseTexture.alphaMode>0&&h.baseTexture.format===X.RGBA,!u){r.renderTexture.bind(h);const v=h.framebuffer.glFramebuffers[r.CONTEXT_UID];v.blitFramebuffer&&r.framebuffer.bind(v.blitFramebuffer)}}else s=r.resolution,e||(e=lo,e.width=r.width/s,e.height=r.height/s),n=!0,l=this._rendererPremultipliedAlpha,r.renderTexture.bind();const p=Math.max(Math.round(e.width*s),1),g=Math.max(Math.round(e.height*s),1),y=new Uint8Array(PT*p*g);return d.readPixels(Math.round(e.x*s),Math.round(e.y*s),p,g,d.RGBA,d.UNSIGNED_BYTE,y),u&&(h==null||h.destroy(!0)),{pixels:y,width:p,height:g,flipY:n,premultipliedAlpha:l}}destroy(){this.renderer=null}static _flipY(t,e,r){const s=e<<2,n=r>>1,l=new Uint8Array(s);for(let h=0;h<n;h++){const u=h*s,d=(r-h-1)*s;l.set(t.subarray(u,u+s)),t.copyWithin(u,d,d+s),t.set(l,d)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let r=0;r<e;r+=4){const s=t[r+3];if(s!==0){const n=255.001/s;t[r]=t[r]*n+.5,t[r+1]=t[r+1]*n+.5,t[r+2]=t[r+2]*n+.5}}}};Qg.extension={name:"extract",type:Q.RendererSystem};let RT=Qg;ot.add(RT);const Vo={build(i){const t=i.points;let e,r,s,n,l,h;if(i.type===ye.CIRC){const x=i.shape;e=x.x,r=x.y,l=h=x.radius,s=n=0}else if(i.type===ye.ELIP){const x=i.shape;e=x.x,r=x.y,l=x.width,h=x.height,s=n=0}else{const x=i.shape,b=x.width/2,T=x.height/2;e=x.x+b,r=x.y+T,l=h=Math.max(0,Math.min(x.radius,Math.min(b,T))),s=b-l,n=T-h}if(!(l>=0&&h>=0&&s>=0&&n>=0)){t.length=0;return}const u=Math.ceil(2.3*Math.sqrt(l+h)),d=u*8+(s?4:0)+(n?4:0);if(t.length=d,d===0)return;if(u===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=r+n,t[2]=t[4]=e-s,t[5]=t[7]=r-n;return}let p=0,g=u*4+(s?2:0)+2,y=g,v=d;{const x=s+l,b=n,T=e+x,S=e-x,I=r+b;if(t[p++]=T,t[p++]=I,t[--g]=I,t[--g]=S,n){const w=r-b;t[y++]=S,t[y++]=w,t[--v]=w,t[--v]=T}}for(let x=1;x<u;x++){const b=Math.PI/2*(x/u),T=s+Math.cos(b)*l,S=n+Math.sin(b)*h,I=e+T,w=e-T,C=r+S,N=r-S;t[p++]=I,t[p++]=C,t[--g]=C,t[--g]=w,t[y++]=w,t[y++]=N,t[--v]=N,t[--v]=I}{const x=s,b=n+h,T=e+x,S=e-x,I=r+b,w=r-b;t[p++]=T,t[p++]=I,t[--v]=w,t[--v]=T,s&&(t[p++]=S,t[p++]=I,t[--v]=w,t[--v]=S)}},triangulate(i,t){const e=i.points,r=t.points,s=t.indices;if(e.length===0)return;let n=r.length/2;const l=n;let h,u;if(i.type!==ye.RREC){const p=i.shape;h=p.x,u=p.y}else{const p=i.shape;h=p.x+p.width/2,u=p.y+p.height/2}const d=i.matrix;r.push(i.matrix?d.a*h+d.c*u+d.tx:h,i.matrix?d.b*h+d.d*u+d.ty:u),n++,r.push(e[0],e[1]);for(let p=2;p<e.length;p+=2)r.push(e[p],e[p+1]),s.push(n++,l,n);s.push(l+1,l,n)}};function Zp(i,t=!1){const e=i.length;if(e<6)return;let r=0;for(let s=0,n=i[e-2],l=i[e-1];s<e;s+=2){const h=i[s],u=i[s+1];r+=(h-n)*(u+l),n=h,l=u}if(!t&&r>0||t&&r<=0){const s=e/2;for(let n=s+s%2;n<e;n+=2){const l=e-n-2,h=e-n-1,u=n,d=n+1;[i[l],i[u]]=[i[u],i[l]],[i[h],i[d]]=[i[d],i[h]]}}}const Zg={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const r=i.holes,s=t.points,n=t.indices;if(e.length>=6){Zp(e,!1);const l=[];for(let d=0;d<r.length;d++){const p=r[d];Zp(p.points,!0),l.push(e.length/2),e=e.concat(p.points)}const h=_v(e,l,2);if(!h)return;const u=s.length/2;for(let d=0;d<h.length;d+=3)n.push(h[d]+u),n.push(h[d+1]+u),n.push(h[d+2]+u);for(let d=0;d<e.length;d++)s.push(e[d])}}},MT={build(i){const t=i.shape,e=t.x,r=t.y,s=t.width,n=t.height,l=i.points;l.length=0,s>=0&&n>=0&&l.push(e,r,e+s,r,e+s,r+n,e,r+n)},triangulate(i,t){const e=i.points,r=t.points;if(e.length===0)return;const s=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},DT={build(i){Vo.build(i)},triangulate(i,t){Vo.triangulate(i,t)}};var qe=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(qe||{}),Ei=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(Ei||{});const Ys={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Jp{static curveTo(t,e,r,s,n,l){const h=l[l.length-2],u=l[l.length-1]-e,d=h-t,p=s-e,g=r-t,y=Math.abs(u*g-d*p);if(y<1e-8||n===0)return(l[l.length-2]!==t||l[l.length-1]!==e)&&l.push(t,e),null;const v=u*u+d*d,x=p*p+g*g,b=u*p+d*g,T=n*Math.sqrt(v)/y,S=n*Math.sqrt(x)/y,I=T*b/v,w=S*b/x,C=T*g+S*d,N=T*p+S*u,V=d*(S+I),z=u*(S+I),G=g*(T+w),Y=p*(T+w),rt=Math.atan2(z-N,V-C),mt=Math.atan2(Y-N,G-C);return{cx:C+t,cy:N+e,radius:n,startAngle:rt,endAngle:mt,anticlockwise:d*p>g*u}}static arc(t,e,r,s,n,l,h,u,d){const p=h-l,g=Ys._segmentsCount(Math.abs(p)*n,Math.ceil(Math.abs(p)/Lo)*40),y=p/(g*2),v=y*2,x=Math.cos(y),b=Math.sin(y),T=g-1,S=T%1/T;for(let I=0;I<=T;++I){const w=I+S*I,C=y+l+v*w,N=Math.cos(C),V=-Math.sin(C);d.push((x*N+b*V)*n+r,(x*-V+b*N)*n+s)}}}class BT{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Dc{static curveLength(t,e,r,s,n,l,h,u){let d=0,p=0,g=0,y=0,v=0,x=0,b=0,T=0,S=0,I=0,w=0,C=t,N=e;for(let V=1;V<=10;++V)p=V/10,g=p*p,y=g*p,v=1-p,x=v*v,b=x*v,T=b*t+3*x*p*r+3*v*g*n+y*h,S=b*e+3*x*p*s+3*v*g*l+y*u,I=C-T,w=N-S,C=T,N=S,d+=Math.sqrt(I*I+w*w);return d}static curveTo(t,e,r,s,n,l,h){const u=h[h.length-2],d=h[h.length-1];h.length-=2;const p=Ys._segmentsCount(Dc.curveLength(u,d,t,e,r,s,n,l));let g=0,y=0,v=0,x=0,b=0;h.push(u,d);for(let T=1,S=0;T<=p;++T)S=T/p,g=1-S,y=g*g,v=y*g,x=S*S,b=x*S,h.push(v*u+3*y*S*t+3*g*x*r+b*n,v*d+3*y*S*e+3*g*x*s+b*l)}}function tm(i,t,e,r,s,n,l,h){const u=i-e*s,d=t-r*s,p=i+e*n,g=t+r*n;let y,v;l?(y=r,v=-e):(y=-r,v=e);const x=u+y,b=d+v,T=p+y,S=g+v;return h.push(x,b,T,S),2}function Hi(i,t,e,r,s,n,l,h){const u=e-i,d=r-t;let p=Math.atan2(u,d),g=Math.atan2(s-i,n-t);h&&p<g?p+=Math.PI*2:!h&&p>g&&(g+=Math.PI*2);let y=p;const v=g-p,x=Math.abs(v),b=Math.sqrt(u*u+d*d),T=(15*x*Math.sqrt(b)/Math.PI>>0)+1,S=v/T;if(y+=S,h){l.push(i,t,e,r);for(let I=1,w=y;I<T;I++,w+=S)l.push(i,t,i+Math.sin(w)*b,t+Math.cos(w)*b);l.push(i,t,s,n)}else{l.push(e,r,i,t);for(let I=1,w=y;I<T;I++,w+=S)l.push(i+Math.sin(w)*b,t+Math.cos(w)*b,i,t);l.push(s,n,i,t)}return T*2}function FT(i,t){const e=i.shape;let r=i.points||e.points.slice();const s=t.closePointEps;if(r.length===0)return;const n=i.lineStyle,l=new wt(r[0],r[1]),h=new wt(r[r.length-2],r[r.length-1]),u=e.type!==ye.POLY||e.closeStroke,d=Math.abs(l.x-h.x)<s&&Math.abs(l.y-h.y)<s;if(u){r=r.slice(),d&&(r.pop(),r.pop(),h.set(r[r.length-2],r[r.length-1]));const nt=(l.x+h.x)*.5,k=(h.y+l.y)*.5;r.unshift(nt,k),r.push(nt,k)}const p=t.points,g=r.length/2;let y=r.length;const v=p.length/2,x=n.width/2,b=x*x,T=n.miterLimit*n.miterLimit;let S=r[0],I=r[1],w=r[2],C=r[3],N=0,V=0,z=-(I-C),G=S-w,Y=0,rt=0,mt=Math.sqrt(z*z+G*G);z/=mt,G/=mt,z*=x,G*=x;const Z=n.alignment,M=(1-Z)*2,W=Z*2;u||(n.cap===Ei.ROUND?y+=Hi(S-z*(M-W)*.5,I-G*(M-W)*.5,S-z*M,I-G*M,S+z*W,I+G*W,p,!0)+2:n.cap===Ei.SQUARE&&(y+=tm(S,I,z,G,M,W,!0,p))),p.push(S-z*M,I-G*M,S+z*W,I+G*W);for(let nt=1;nt<g-1;++nt){S=r[(nt-1)*2],I=r[(nt-1)*2+1],w=r[nt*2],C=r[nt*2+1],N=r[(nt+1)*2],V=r[(nt+1)*2+1],z=-(I-C),G=S-w,mt=Math.sqrt(z*z+G*G),z/=mt,G/=mt,z*=x,G*=x,Y=-(C-V),rt=w-N,mt=Math.sqrt(Y*Y+rt*rt),Y/=mt,rt/=mt,Y*=x,rt*=x;const k=w-S,et=I-C,F=w-N,H=V-C,ct=k*F+et*H,Et=et*F-H*k,_t=Et<0;if(Math.abs(Et)<.001*Math.abs(ct)){p.push(w-z*M,C-G*M,w+z*W,C+G*W),ct>=0&&(n.join===qe.ROUND?y+=Hi(w,C,w-z*M,C-G*M,w-Y*M,C-rt*M,p,!1)+4:y+=2,p.push(w-Y*W,C-rt*W,w+Y*M,C+rt*M));continue}const Dt=(-z+S)*(-G+C)-(-z+w)*(-G+I),Pt=(-Y+N)*(-rt+C)-(-Y+w)*(-rt+V),Bt=(k*Pt-F*Dt)/Et,ne=(H*Dt-et*Pt)/Et,fe=(Bt-w)*(Bt-w)+(ne-C)*(ne-C),Xt=w+(Bt-w)*M,xt=C+(ne-C)*M,Ot=w-(Bt-w)*W,At=C-(ne-C)*W,Ue=Math.min(k*k+et*et,F*F+H*H),Ge=_t?M:W,Ri=Ue+Ge*Ge*b,fl=fe<=Ri;let ns=n.join;if(ns===qe.MITER&&fe/b>T&&(ns=qe.BEVEL),fl)switch(ns){case qe.MITER:{p.push(Xt,xt,Ot,At);break}case qe.BEVEL:{_t?p.push(Xt,xt,w+z*W,C+G*W,Xt,xt,w+Y*W,C+rt*W):p.push(w-z*M,C-G*M,Ot,At,w-Y*M,C-rt*M,Ot,At),y+=2;break}case qe.ROUND:{_t?(p.push(Xt,xt,w+z*W,C+G*W),y+=Hi(w,C,w+z*W,C+G*W,w+Y*W,C+rt*W,p,!0)+4,p.push(Xt,xt,w+Y*W,C+rt*W)):(p.push(w-z*M,C-G*M,Ot,At),y+=Hi(w,C,w-z*M,C-G*M,w-Y*M,C-rt*M,p,!1)+4,p.push(w-Y*M,C-rt*M,Ot,At));break}}else{switch(p.push(w-z*M,C-G*M,w+z*W,C+G*W),ns){case qe.MITER:{_t?p.push(Ot,At,Ot,At):p.push(Xt,xt,Xt,xt),y+=2;break}case qe.ROUND:{_t?y+=Hi(w,C,w+z*W,C+G*W,w+Y*W,C+rt*W,p,!0)+2:y+=Hi(w,C,w-z*M,C-G*M,w-Y*M,C-rt*M,p,!1)+2;break}}p.push(w-Y*M,C-rt*M,w+Y*W,C+rt*W),y+=2}}S=r[(g-2)*2],I=r[(g-2)*2+1],w=r[(g-1)*2],C=r[(g-1)*2+1],z=-(I-C),G=S-w,mt=Math.sqrt(z*z+G*G),z/=mt,G/=mt,z*=x,G*=x,p.push(w-z*M,C-G*M,w+z*W,C+G*W),u||(n.cap===Ei.ROUND?y+=Hi(w-z*(M-W)*.5,C-G*(M-W)*.5,w-z*M,C-G*M,w+z*W,C+G*W,p,!1)+2:n.cap===Ei.SQUARE&&(y+=tm(w,C,z,G,M,W,!1,p)));const it=t.indices,ft=Ys.epsilon*Ys.epsilon;for(let nt=v;nt<y+v-2;++nt)S=p[nt*2],I=p[nt*2+1],w=p[(nt+1)*2],C=p[(nt+1)*2+1],N=p[(nt+2)*2],V=p[(nt+2)*2+1],!(Math.abs(S*(C-V)+w*(V-I)+N*(I-C))<ft)&&it.push(nt,nt+1,nt+2)}function NT(i,t){let e=0;const r=i.shape,s=i.points||r.points,n=r.type!==ye.POLY||r.closeStroke;if(s.length===0)return;const l=t.points,h=t.indices,u=s.length/2,d=l.length/2;let p=d;for(l.push(s[0],s[1]),e=1;e<u;e++)l.push(s[e*2],s[e*2+1]),h.push(p,p+1),p++;n&&h.push(p,d)}function em(i,t){i.lineStyle.native?NT(i,t):FT(i,t)}class Bc{static curveLength(t,e,r,s,n,l){const h=t-2*r+n,u=e-2*s+l,d=2*r-2*t,p=2*s-2*e,g=4*(h*h+u*u),y=4*(h*d+u*p),v=d*d+p*p,x=2*Math.sqrt(g+y+v),b=Math.sqrt(g),T=2*g*b,S=2*Math.sqrt(v),I=y/b;return(T*x+b*y*(x-S)+(4*v*g-y*y)*Math.log((2*b+I+x)/(I+S)))/(4*T)}static curveTo(t,e,r,s,n){const l=n[n.length-2],h=n[n.length-1],u=Ys._segmentsCount(Bc.curveLength(l,h,t,e,r,s));let d=0,p=0;for(let g=1;g<=u;++g){const y=g/u;d=l+(t-l)*y,p=h+(e-h)*y,n.push(d+(t+(r-t)*y-d)*y,p+(e+(s-e)*y-p)*y)}}}const nu={[ye.POLY]:Zg,[ye.CIRC]:Vo,[ye.ELIP]:Vo,[ye.RECT]:MT,[ye.RREC]:DT},rm=[],ho=[];class Yo{constructor(t,e=null,r=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new Yo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Ss=new wt,Jg=class ty extends ng{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new $o,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ho.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),rm.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,s=null){const n=new Yo(t,e,r,s);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new Yo(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=s.lineStyle,s.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const s=e[r];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Ss):Ss.copyFrom(t),s.shape.contains(Ss.x,Ss.y))){let n=!1;if(s.holes){for(let l=0;l<s.holes.length;l++)if(s.holes[l].shape.contains(Ss.x,Ss.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let r=null,s=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],s=r.style);for(let u=this.shapeIndex;u<e.length;u++){this.shapeIndex++;const d=e[u],p=d.fillStyle,g=d.lineStyle;nu[d.type].build(d),d.matrix&&this.transformPoints(d.points,d.matrix),(p.visible||g.visible)&&this.processHoles(d.holes);for(let y=0;y<2;y++){const v=y===0?p:g;if(!v.visible)continue;const x=v.texture.baseTexture,b=this.indices.length,T=this.points.length/2;x.wrapMode=Zr.REPEAT,y===0?this.processFill(d):this.processLine(d);const S=this.points.length/2-T;S!==0&&(r&&!this._compareStyles(s,v)&&(r.end(b,T),r=null),r||(r=rm.pop()||new BT,r.begin(v,b,T),this.batches.push(r),s=v),this.addUvs(this.points,t,v.texture,T,S,v.matrix))}}const n=this.indices.length,l=this.points.length/2;if(r&&r.end(n,l),this.batches.length===0){this.batchable=!0;return}const h=l>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const r=this.graphicsData[t],s=r.fillStyle,n=r.lineStyle;if(s&&!s.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,r=t.length;e<r;e++){const s=t[e];for(let n=0;n<s.size;n++){const l=s.start+n;this.indicesUint16[l]=this.indicesUint16[l]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<ty.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++gt._globalBatch;for(let g=0;g<this.drawCalls.length;g++)this.drawCalls[g].texArray.clear(),ho.push(this.drawCalls[g]);this.drawCalls.length=0;const e=this.colors,r=this.textureIds;let s=ho.pop();s||(s=new ku,s.texArray=new Hu),s.texArray.count=0,s.start=0,s.size=0,s.type=lr.TRIANGLES;let n=0,l=null,h=0,u=!1,d=lr.TRIANGLES,p=0;this.drawCalls.push(s);for(let g=0;g<this.batches.length;g++){const y=this.batches[g],v=8,x=y.style,b=x.texture.baseTexture;u!==!!x.native&&(u=!!x.native,d=u?lr.LINES:lr.TRIANGLES,l=null,n=v,t++),l!==b&&(l=b,b._batchEnabled!==t&&(n===v&&(t++,n=0,s.size>0&&(s=ho.pop(),s||(s=new ku,s.texArray=new Hu),this.drawCalls.push(s)),s.start=p,s.size=0,s.texArray.count=0,s.type=d),b.touched=1,b._batchEnabled=t,b._batchLocation=n,b.wrapMode=Zr.REPEAT,s.texArray.elements[s.texArray.count++]=b,n++)),s.size+=y.size,p+=y.size,h=b._batchLocation,this.addColors(e,x.color,x.alpha,y.attribSize,y.attribStart),this.addTextureIds(r,h,y.attribSize,y.attribStart)}gt._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,r=this.colors,s=this.textureIds,n=new ArrayBuffer(t.length*3*4),l=new Float32Array(n),h=new Uint32Array(n);let u=0;for(let d=0;d<t.length/2;d++)l[u++]=t[d*2],l[u++]=t[d*2+1],l[u++]=e[d*2],l[u++]=e[d*2+1],h[u++]=r[d],l[u++]=s[d];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Zg.triangulate(t,this):nu[t.type].triangulate(t,this)}processLine(t){em(t,this);for(let e=0;e<t.holes.length;e++)em(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e];nu[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const s=t[r*2],n=t[r*2+1];t[r*2]=e.a*s+e.c*n+e.tx,t[r*2+1]=e.b*s+e.d*n+e.ty}}addColors(t,e,r,s,n=0){const l=Nt.shared.setValue(e).toLittleEndianNumber(),h=Nt.shared.setValue(l).toPremultiplied(r);t.length=Math.max(t.length,n+s);for(let u=0;u<s;u++)t[n+u]=h}addTextureIds(t,e,r,s=0){t.length=Math.max(t.length,s+r);for(let n=0;n<r;n++)t[s+n]=e}addUvs(t,e,r,s,n,l=null){let h=0;const u=e.length,d=r.frame;for(;h<n;){let g=t[(s+h)*2],y=t[(s+h)*2+1];if(l){const v=l.a*g+l.c*y+l.tx;y=l.b*g+l.d*y+l.ty,g=v}h++,e.push(g/d.width,y/d.height)}const p=r.baseTexture;(d.width<p.width||d.height<p.height)&&this.adjustUvs(e,r,u,n)}adjustUvs(t,e,r,s){const n=e.baseTexture,l=1e-6,h=r+s*2,u=e.frame,d=u.width/n.width,p=u.height/n.height;let g=u.x/u.width,y=u.y/u.height,v=Math.floor(t[r]+l),x=Math.floor(t[r+1]+l);for(let b=r+2;b<h;b+=2)v=Math.min(v,Math.floor(t[b]+l)),x=Math.min(x,Math.floor(t[b+1]+l));g-=v,y-=x;for(let b=r;b<h;b+=2)t[b]=(t[b]+g)*d,t[b+1]=(t[b+1]+y)*p}};Jg.BATCHABLE_SIZE=100;let OT=Jg;class hl{constructor(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new hl;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Fc extends hl{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ei.BUTT,this.join=qe.MITER,this.miterLimit=10}clone(){const t=new Fc;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ei.BUTT,this.join=qe.MITER,this.miterLimit=10}}const au={},ac=class Io extends Ae{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new hl,this._lineStyle=new Fc,this._matrix=null,this._holeMode=!1,this.state=Lr.for2d(),this._geometry=t||new OT,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Nt(16777215),this.blendMode=pt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Io(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r,s=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:r,alignment:s,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:K.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ei.BUTT,join:qe.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.width>0&&t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:r},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Ji,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Ji,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,s=r[r.length-2],n=r[r.length-1];return(s!==t||n!==e)&&r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,s){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),Bc.curveTo(t,e,r,s,n),this}bezierCurveTo(t,e,r,s,n,l){return this._initCurve(),Dc.curveTo(t,e,r,s,n,l,this.currentPath.points),this}arcTo(t,e,r,s,n){this._initCurve(t,e);const l=this.currentPath.points,h=Jp.curveTo(t,e,r,s,n,l);if(h){const{cx:u,cy:d,radius:p,startAngle:g,endAngle:y,anticlockwise:v}=h;this.arc(u,d,p,g,y,v)}return this}arc(t,e,r,s,n,l=!1){if(s===n)return this;if(!l&&n<=s?n+=Lo:l&&s<=n&&(s+=Lo),n-s===0)return this;const h=t+Math.cos(s)*r,u=e+Math.sin(s)*r,d=this._geometry.closePointEps;let p=this.currentPath?this.currentPath.points:null;if(p){const g=Math.abs(p[p.length-2]-h),y=Math.abs(p[p.length-1]-u);g<d&&y<d||p.push(h,u)}else this.moveTo(h,u),p=this.currentPath.points;return Jp.arc(h,u,t,e,r,s,n,l,p),this}beginFill(t=0,e){return this.beginTextureFill({texture:K.WHITE,color:t,alpha:e})}normalizeColor(t){const e=Nt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:K.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:r},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,s){return this.drawShape(new yt(t,e,r,s))}drawRoundedRect(t,e,r,s,n){return this.drawShape(new sl(t,e,r,s,n))}drawCircle(t,e,r){return this.drawShape(new rl(t,e,r))}drawEllipse(t,e,r,s){return this.drawShape(new il(t,e,r,s))}drawPolygon(...t){let e,r=!0;const s=t[0];s.points?(r=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;const n=new Ji(e);return n.closeStroke=r,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===ye.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let s=0;s<r;s++){const n=t.batches[s],l=n.style.color,h=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),u=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),d=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),p={vertexData:h,blendMode:e,indices:d,uvs:u,_batchRGB:Nt.shared.setValue(l).toRgbArray(),_tintRGB:l,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=p}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){const e=this._resolveDirectShader(t),r=this._geometry,s=this.worldAlpha,n=e.uniforms,l=r.drawCalls;n.translationMatrix=this.transform.worldTransform,Nt.shared.setValue(this._tintColor).premultiply(s).toArray(n.tint),t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(let h=0,u=l.length;h<u;h++)this._renderDrawCallDirect(t,r.drawCalls[h])}_renderDrawCallDirect(t,e){const{texArray:r,type:s,size:n,start:l}=e,h=r.count;for(let u=0;u<h;u++)t.texture.bind(r.elements[u],u);t.geometry.draw(s,n,l)}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;if(!e){if(!au[r]){const{maxTextures:s}=t.plugins[r],n=new Int32Array(s);for(let u=0;u<s;u++)n[u]=u;const l={tint:new Float32Array([1,1,1,1]),translationMatrix:new Lt,default:cr.from({uSamplers:n},!0)},h=t.plugins[r]._shader.program;au[r]=new Fr(h,l)}e=au[r]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:s,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,r,s,n)}containsPoint(t){return this.worldTransform.applyInverse(t,Io._TEMP_POINT),this._geometry.containsPoint(Io._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=Nt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,s=e.b,n=e.c,l=e.d,h=e.tx,u=e.ty,d=this._geometry.points,p=this.vertexData;let g=0;for(let y=0;y<d.length;y+=2){const v=d[y],x=d[y+1];p[g++]=r*v+n*x+h,p[g++]=l*x+s*v+u}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};ac.curves=Ys,ac._TEMP_POINT=new wt;let Un=ac;class kT{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const ou=new wt,im=new Ji,ey=class ry extends Ae{constructor(t,e,r,s=lr.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=r||Lr.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=tt.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===lr.TRIANGLES&&e.length<ry.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,n=s.a,l=s.b,h=s.c,u=s.d,d=s.tx,p=s.ty,g=this.vertexData;for(let y=0;y<g.length/2;y++){const v=e[y*2],x=e[y*2+1];g[y*2]=n*v+h*x+d,g[y*2+1]=l*v+u*x+p}if(this._roundPixels){const y=tt.RESOLUTION;for(let v=0;v<g.length;++v)g[v]=Math.round(g[v]*y)/y}this.vertexDirty=r}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new kT(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,ou);const e=this.geometry.getBuffer("aVertexPosition").data,r=im.points,s=this.geometry.getIndex().data,n=s.length,l=this.drawMode===4?3:1;for(let h=0;h+2<n;h+=l){const u=s[h]*2,d=s[h+1]*2,p=s[h+2]*2;if(r[0]=e[u],r[1]=e[u+1],r[2]=e[d],r[3]=e[d+1],r[4]=e[p],r[5]=e[p+1],im.contains(ou.x,ou.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};ey.BATCHABLE_SIZE=100;let Wn=ey;class ul extends wi{constructor(t,e,r){super();const s=new Zt(t),n=new Zt(e,!0),l=new Zt(r,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,ut.FLOAT).addAttribute("aTextureCoord",n,2,!1,ut.FLOAT).addIndex(l),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var LT=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,UT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class jn extends Fr{constructor(t,e){const r={uSampler:t,alpha:1,uTextureMatrix:Lt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(r,e.uniforms),super(e.program||Kr.from(UT,LT),r),this._colorDirty=!1,this.uvMatrix=new Pc(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new Nt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;Nt.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class GT extends ul{constructor(t=100,e=100,r=10,s=10){super(),this.segWidth=r,this.segHeight=s,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],r=[],s=[],n=this.segWidth-1,l=this.segHeight-1,h=this.width/n,u=this.height/l;for(let p=0;p<t;p++){const g=p%this.segWidth,y=p/this.segWidth|0;e.push(g*h,y*u),r.push(g/n,y/l)}const d=n*l;for(let p=0;p<d;p++){const g=p%n,y=p/n|0,v=y*this.segWidth+g,x=y*this.segWidth+g+1,b=(y+1)*this.segWidth+g,T=(y+1)*this.segWidth+g+1;s.push(v,x,b,x,T,b)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class HT extends ul{constructor(t=200,e,r=0){super(new Float32Array(e.length*4),new Float32Array(e.length*4),new Uint16Array((e.length-1)*6)),this.points=e,this._width=t,this.textureScale=r,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),s=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));const n=r.data,l=s.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let h=0,u=t[0];const d=this._width*this.textureScale,p=t.length;for(let y=0;y<p;y++){const v=y*4;if(this.textureScale>0){const x=u.x-t[y].x,b=u.y-t[y].y,T=Math.sqrt(x*x+b*b);u=t[y],h+=T/d}else h=y/(p-1);n[v]=h,n[v+1]=0,n[v+2]=h,n[v+3]=1}let g=0;for(let y=0;y<p-1;y++){const v=y*2;l[g++]=v,l[g++]=v+1,l[g++]=v+2,l[g++]=v+2,l[g++]=v+1,l[g++]=v+3}r.update(),s.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],r,s=0,n=0;const l=this.buffers[0].data,h=t.length,u=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let d=0;d<h;d++){const p=t[d],g=d*4;d<t.length-1?r=t[d+1]:r=p,n=-(r.x-e.x),s=r.y-e.y;const y=Math.sqrt(s*s+n*n);y<1e-6?(s=0,n=0):(s/=y,n/=y,s*=u,n*=u),l[g]=p.x+s,l[g+1]=p.y+n,l[g+2]=p.x-s,l[g+3]=p.y-n,e=p}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class zT extends Wn{constructor(t,e,r){const s=new GT(t.width,t.height,e,r),n=new jn(K.WHITE);super(s,n),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:r}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==r)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const uo=10;class $T extends zT{constructor(t,e,r,s,n){var l,h,u,d;super(K.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e??((l=t.defaultBorders)==null?void 0:l.left)??uo,this._rightWidth=s??((h=t.defaultBorders)==null?void 0:h.right)??uo,this._topHeight=r??((u=t.defaultBorders)==null?void 0:u.top)??uo,this._bottomHeight=n??((d=t.defaultBorders)==null?void 0:d.bottom)??uo,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,s=this._height>r?1:this._height/r;return Math.min(e,s)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const r=1/this._origWidth,s=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=s*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class WT extends Wn{constructor(t=K.EMPTY,e,r,s,n){const l=new ul(e,r,s);l.getBuffer("aVertexPosition").static=!1;const h=new jn(t);super(l,h,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class jT extends Wn{constructor(t,e,r=0){const s=new HT(t.height,e,r),n=new jn(t);r>0&&(t.baseTexture.wrapMode=Zr.REPEAT),super(s,n),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}class XT extends Ae{constructor(t=1500,e,r=16384,s=!1){super();const n=16384;r>n&&(r=n),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=r,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=pt.NORMAL,this.autoResize=s,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new Nt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class sm{constructor(t,e,r){this.geometry=new wi,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||ut.FLOAT,offset:n.offset},e[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Zt(hb(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];h.offset=e,e+=h.size,this.dynamicStride+=h.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Zt(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];h.offset=s,s+=h.size,this.staticStride+=h.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Zt(this.staticData,!0,!1);for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];t.addAttribute(h.attributeName,this.dynamicBuffer,0,h.type===ut.UNSIGNED_BYTE,h.type,this.dynamicStride*4,h.offset*4)}for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];t.addAttribute(h.attributeName,this.staticBuffer,0,h.type===ut.UNSIGNED_BYTE,h.type,this.staticStride*4,h.offset*4)}}uploadDynamic(t,e,r){for(let s=0;s<this.dynamicProperties.length;s++){const n=this.dynamicProperties[s];n.uploadFunction(t,e,r,n.type===ut.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,r){for(let s=0;s<this.staticProperties.length;s++){const n=this.staticProperties[s];n.uploadFunction(t,e,r,n.type===ut.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var VT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,YT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class iy extends al{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Lt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:ut.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Fr.from(YT,VT,{}),this.state=Lr.for2d()}render(t){const e=t.children,r=t._maxSize,s=t._batchSize,n=this.renderer;let l=e.length;if(l===0)return;l>r&&!t.autoResize&&(l=r);let h=t._buffers;h||(h=t._buffers=this.generateBuffers(t));const u=e[0]._texture.baseTexture,d=u.alphaMode>0;this.state.blendMode=rg(t.blendMode,d),n.state.set(this.state);const p=n.gl,g=t.worldTransform.copyTo(this.tempMatrix);g.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=g.toArray(!0),this.shader.uniforms.uColor=Nt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,d).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);let y=!1;for(let v=0,x=0;v<l;v+=s,x+=1){let b=l-v;b>s&&(b=s),x>=h.length&&h.push(this._generateOneMoreBuffer(t));const T=h[x];T.uploadDynamic(e,v,b);const S=t._bufferUpdateIDs[x]||0;y=y||T._updateID<S,y&&(T._updateID=t._updateID,T.uploadStatic(e,v,b)),n.geometry.bind(T.geometry),p.drawElements(p.TRIANGLES,b*6,p.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],r=t._maxSize,s=t._batchSize,n=t._properties;for(let l=0;l<r;l+=s)e.push(new sm(this.properties,n,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,r=t._properties;return new sm(this.properties,r,e)}uploadVertices(t,e,r,s,n,l){let h=0,u=0,d=0,p=0;for(let g=0;g<r;++g){const y=t[e+g],v=y._texture,x=y.scale.x,b=y.scale.y,T=v.trim,S=v.orig;T?(u=T.x-y.anchor.x*S.width,h=u+T.width,p=T.y-y.anchor.y*S.height,d=p+T.height):(h=S.width*(1-y.anchor.x),u=S.width*-y.anchor.x,d=S.height*(1-y.anchor.y),p=S.height*-y.anchor.y),s[l]=u*x,s[l+1]=p*b,s[l+n]=h*x,s[l+n+1]=p*b,s[l+n*2]=h*x,s[l+n*2+1]=d*b,s[l+n*3]=u*x,s[l+n*3+1]=d*b,l+=n*4}}uploadPosition(t,e,r,s,n,l){for(let h=0;h<r;h++){const u=t[e+h].position;s[l]=u.x,s[l+1]=u.y,s[l+n]=u.x,s[l+n+1]=u.y,s[l+n*2]=u.x,s[l+n*2+1]=u.y,s[l+n*3]=u.x,s[l+n*3+1]=u.y,l+=n*4}}uploadRotation(t,e,r,s,n,l){for(let h=0;h<r;h++){const u=t[e+h].rotation;s[l]=u,s[l+n]=u,s[l+n*2]=u,s[l+n*3]=u,l+=n*4}}uploadUvs(t,e,r,s,n,l){for(let h=0;h<r;++h){const u=t[e+h]._texture._uvs;u?(s[l]=u.x0,s[l+1]=u.y0,s[l+n]=u.x1,s[l+n+1]=u.y1,s[l+n*2]=u.x2,s[l+n*2+1]=u.y2,s[l+n*3]=u.x3,s[l+n*3+1]=u.y3,l+=n*4):(s[l]=0,s[l+1]=0,s[l+n]=0,s[l+n+1]=0,s[l+n*2]=0,s[l+n*2+1]=0,s[l+n*3]=0,s[l+n*3+1]=0,l+=n*4)}}uploadTint(t,e,r,s,n,l){for(let h=0;h<r;++h){const u=t[e+h],d=Nt.shared.setValue(u._tintRGB).toPremultiplied(u.alpha,u.texture.baseTexture.alphaMode>0);s[l]=d,s[l+n]=d,s[l+n*2]=d,s[l+n*3]=d,l+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}iy.extension={name:"particle",type:Q.RendererPlugin};ot.add(iy);var cl=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(cl||{});const co={willReadFrequently:!0},Cr=class ht{static get experimentalLetterSpacingSupported(){let t=ht._experimentalLetterSpacingSupported;if(t!==void 0){const e=tt.ADAPTER.getCanvasRenderingContext2D().prototype;t=ht._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,s,n,l,h,u,d){this.text=t,this.style=e,this.width=r,this.height=s,this.lines=n,this.lineWidths=l,this.lineHeight=h,this.maxLineWidth=u,this.fontProperties=d}static measureText(t,e,r,s=ht._canvas){r=r??e.wordWrap;const n=e.toFontString(),l=ht.measureFont(n);l.fontSize===0&&(l.fontSize=e.fontSize,l.ascent=e.fontSize);const h=s.getContext("2d",co);h.font=n;const u=(r?ht.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),d=new Array(u.length);let p=0;for(let x=0;x<u.length;x++){const b=ht._measureText(u[x],e.letterSpacing,h);d[x]=b,p=Math.max(p,b)}let g=p+e.strokeThickness;e.dropShadow&&(g+=e.dropShadowDistance);const y=e.lineHeight||l.fontSize+e.strokeThickness;let v=Math.max(y,l.fontSize+e.strokeThickness*2)+e.leading+(u.length-1)*(y+e.leading);return e.dropShadow&&(v+=e.dropShadowDistance),new ht(t,e,g,v,u,d,y+e.leading,p,l)}static _measureText(t,e,r){let s=!1;ht.experimentalLetterSpacingSupported&&(ht.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,s=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(t).width;return n>0&&(s?n-=e:n+=(ht.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,r=ht._canvas){const s=r.getContext("2d",co);let n=0,l="",h="";const u=Object.create(null),{letterSpacing:d,whiteSpace:p}=e,g=ht.collapseSpaces(p),y=ht.collapseNewlines(p);let v=!g;const x=e.wordWrapWidth+d,b=ht.tokenize(t);for(let T=0;T<b.length;T++){let S=b[T];if(ht.isNewline(S)){if(!y){h+=ht.addLine(l),v=!g,l="",n=0;continue}S=" "}if(g){const w=ht.isBreakingSpace(S),C=ht.isBreakingSpace(l[l.length-1]);if(w&&C)continue}const I=ht.getFromCache(S,d,u,s);if(I>x)if(l!==""&&(h+=ht.addLine(l),l="",n=0),ht.canBreakWords(S,e.breakWords)){const w=ht.wordWrapSplit(S);for(let C=0;C<w.length;C++){let N=w[C],V=N,z=1;for(;w[C+z];){const Y=w[C+z];if(!ht.canBreakChars(V,Y,S,C,e.breakWords))N+=Y;else break;V=Y,z++}C+=z-1;const G=ht.getFromCache(N,d,u,s);G+n>x&&(h+=ht.addLine(l),v=!1,l="",n=0),l+=N,n+=G}}else{l.length>0&&(h+=ht.addLine(l),l="",n=0);const w=T===b.length-1;h+=ht.addLine(S,!w),v=!1,l="",n=0}else I+n>x&&(v=!1,h+=ht.addLine(l),l="",n=0),(l.length>0||!ht.isBreakingSpace(S)||v)&&(l+=S,n+=I)}return h+=ht.addLine(l,!1),h}static addLine(t,e=!0){return t=ht.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,r,s){let n=r[t];return typeof n!="number"&&(n=ht._measureText(t,e,s)+e,r[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!ht.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:ht._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:ht._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let r="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const n=t[s],l=t[s+1];if(ht.isBreakingSpace(n,l)||ht.isNewline(n)){r!==""&&(e.push(r),r=""),e.push(n);continue}r+=n}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,s,n){return!0}static wordWrapSplit(t){return ht.graphemeSegmenter(t)}static measureFont(t){if(ht._fonts[t])return ht._fonts[t];const e={ascent:0,descent:0,fontSize:0},r=ht._canvas,s=ht._context;s.font=t;const n=ht.METRICS_STRING+ht.BASELINE_SYMBOL,l=Math.ceil(s.measureText(n).width);let h=Math.ceil(s.measureText(ht.BASELINE_SYMBOL).width);const u=Math.ceil(ht.HEIGHT_MULTIPLIER*h);if(h=h*ht.BASELINE_MULTIPLIER|0,l===0||u===0)return ht._fonts[t]=e,e;r.width=l,r.height=u,s.fillStyle="#f00",s.fillRect(0,0,l,u),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(n,0,h);const d=s.getImageData(0,0,l,u).data,p=d.length,g=l*4;let y=0,v=0,x=!1;for(y=0;y<h;++y){for(let b=0;b<g;b+=4)if(d[v+b]!==255){x=!0;break}if(!x)v+=g;else break}for(e.ascent=h-y,v=p-g,x=!1,y=u;y>h;--y){for(let b=0;b<g;b+=4)if(d[v+b]!==255){x=!0;break}if(!x)v-=g;else break}return e.descent=y-h,e.fontSize=e.ascent+e.descent,ht._fonts[t]=e,e}static clearMetrics(t=""){t?delete ht._fonts[t]:ht._fonts={}}static get _canvas(){var t;if(!ht.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if((t=r.getContext("2d",co))!=null&&t.measureText)return ht.__canvas=r,r;e=tt.ADAPTER.createCanvas()}catch{e=tt.ADAPTER.createCanvas()}e.width=e.height=10,ht.__canvas=e}return ht.__canvas}static get _context(){return ht.__context||(ht.__context=ht._canvas.getContext("2d",co)),ht.__context}};Cr.METRICS_STRING="|ÉqÅ",Cr.BASELINE_SYMBOL="M",Cr.BASELINE_MULTIPLIER=1.4,Cr.HEIGHT_MULTIPLIER=2,Cr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})(),Cr.experimentalLetterSpacing=!1,Cr._fonts={},Cr._newlines=[10,13],Cr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let vi=Cr;const qT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],sy=class Dn{constructor(t){this.styleID=0,this.reset(),hu(this,t,t)}clone(){const t={};return hu(t,this,Dn.defaultStyle),new Dn(t)}reset(){hu(this,Dn.defaultStyle,Dn.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=lu(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=lu(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){KT(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=lu(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let s=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!qT.includes(s)&&(s=`"${s}"`),e[r]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};sy.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:cl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ai=sy;function lu(i){const t=Nt.shared,e=r=>{const s=t.setValue(r);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(i)?i.map(e):e(i)}function KT(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function hu(i,t,e){for(const r in e)Array.isArray(t[r])?i[r]=t[r].slice():i[r]=t[r]}const QT={texture:!0,children:!1,baseTexture:!0},ny=class oc extends Ur{constructor(t,e,r){let s=!1;r||(r=tt.ADAPTER.createCanvas(),s=!0),r.width=3,r.height=3;const n=K.from(r);n.orig=new yt,n.trim=new yt,super(n),this._ownCanvas=s,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=oc.defaultResolution??tt.RESOLUTION,this._autoResolution=oc.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return vi.experimentalLetterSpacing}static set experimentalLetterSpacing(t){bt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),vi.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const r=this.context,s=vi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=s.width,l=s.height,h=s.lines,u=s.lineHeight,d=s.lineWidths,p=s.maxLineWidth,g=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,l)+e.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;let y,v;const x=e.dropShadow?2:1;for(let b=0;b<x;++b){const T=e.dropShadow&&b===0,S=T?Math.ceil(Math.max(1,l)+e.padding*2):0,I=S*this._resolution;if(T){r.fillStyle="black",r.strokeStyle="black";const C=e.dropShadowColor,N=e.dropShadowBlur*this._resolution,V=e.dropShadowDistance*this._resolution;r.shadowColor=Nt.shared.setValue(C).setAlpha(e.dropShadowAlpha).toRgbaString(),r.shadowBlur=N,r.shadowOffsetX=Math.cos(e.dropShadowAngle)*V,r.shadowOffsetY=Math.sin(e.dropShadowAngle)*V+I}else r.fillStyle=this._generateFillStyle(e,h,s),r.strokeStyle=e.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let w=(u-g.fontSize)/2;u-g.fontSize<0&&(w=0);for(let C=0;C<h.length;C++)y=e.strokeThickness/2,v=e.strokeThickness/2+C*u+g.ascent+w,e.align==="right"?y+=p-d[C]:e.align==="center"&&(y+=(p-d[C])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[C],y+e.padding,v+e.padding-S,!0),e.fill&&this.drawLetterSpacing(h[C],y+e.padding,v+e.padding-S)}this.updateTexture()}drawLetterSpacing(t,e,r,s=!1){const n=this._style.letterSpacing;let l=!1;if(vi.experimentalLetterSpacingSupported&&(vi.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,l=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||l){s?this.context.strokeText(t,e,r):this.context.fillText(t,e,r);return}let h=e;const u=vi.graphemeSegmenter(t);let d=this.context.measureText(t).width,p=0;for(let g=0;g<u.length;++g){const y=u[g];s?this.context.strokeText(y,h,r):this.context.fillText(y,h,r);let v="";for(let x=g+1;x<u.length;++x)v+=u[x];p=this.context.measureText(v).width,h+=d-p+n,d=p}}updateTexture(){const t=this.canvas;if(this._style.trim){const l=fb(t);l.data&&(t.width=l.width,t.height=l.height,this.context.putImageData(l.data,0,0))}const e=this._texture,r=this._style,s=r.trim?0:r.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,r){const s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let n;const l=t.dropShadow?t.dropShadowDistance:0,h=t.padding||0,u=this.canvas.width/this._resolution-l-h*2,d=this.canvas.height/this._resolution-l-h*2,p=s.slice(),g=t.fillGradientStops.slice();if(!g.length){const y=p.length+1;for(let v=1;v<y;++v)g.push(v/y)}if(p.unshift(s[0]),g.unshift(0),p.push(s[s.length-1]),g.push(1),t.fillGradientType===cl.LINEAR_VERTICAL){n=this.context.createLinearGradient(u/2,h,u/2,d+h);const y=r.fontProperties.fontSize+t.strokeThickness;for(let v=0;v<e.length;v++){const x=r.lineHeight*(v-1)+y,b=r.lineHeight*v;let T=b;v>0&&x>b&&(T=(b+x)/2);const S=b+y,I=r.lineHeight*(v+1);let w=S;v+1<e.length&&I<S&&(w=(S+I)/2);const C=(w-T)/d;for(let N=0;N<p.length;N++){let V=0;typeof g[N]=="number"?V=g[N]:V=N/p.length;let z=Math.min(1,Math.max(0,T/d+V*C));z=Number(z.toFixed(5)),n.addColorStop(z,p[N])}}}else{n=this.context.createLinearGradient(h,d/2,u+h,d/2);const y=p.length+1;let v=1;for(let x=0;x<p.length;x++){let b;typeof g[x]=="number"?b=g[x]:b=v/y,n.addColorStop(b,p[x]),v++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},QT,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=bi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=bi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof Ai?this._style=t:this._style=new Ai(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};ny.defaultAutoResolution=!0;let Nc=ny;class ZT{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function JT(i,t){var r;let e=!1;if((r=i==null?void 0:i._textures)!=null&&r.length){for(let s=0;s<i._textures.length;s++)if(i._textures[s]instanceof K){const n=i._textures[s].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function tw(i,t){if(i.baseTexture instanceof gt){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function ew(i,t){if(i._texture&&i._texture instanceof K){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function rw(i,t){return t instanceof Nc?(t.updateText(!0),!0):!1}function iw(i,t){if(t instanceof Ai){const e=t.toFontString();return vi.measureFont(e),!0}return!1}function sw(i,t){if(i instanceof Nc){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function nw(i,t){return i instanceof Ai?(t.includes(i)||t.push(i),!0):!1}const ay=class oy{constructor(t){this.limiter=new ZT(oy.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(sw),this.registerFindHook(nw),this.registerFindHook(JT),this.registerFindHook(tw),this.registerFindHook(ew),this.registerUploadHook(rw),this.registerUploadHook(iw)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,de.system.addOnce(this.tick,this,Si.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)de.system.addOnce(this.tick,this,Si.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,r=t.length;e<r;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Ae)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&de.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};ay.uploadsPerFrame=4;let lc=ay;Object.defineProperties(tt,{UPLOADS_PER_FRAME:{get(){return lc.uploadsPerFrame},set(i){bt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),lc.uploadsPerFrame=i}}});function ly(i,t){return t instanceof gt?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function aw(i,t){if(!(t instanceof Un))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:r}=e;for(let s=0;s<r.length;s++){const{texture:n}=r[s].style;n&&ly(i,n.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function ow(i,t){return i instanceof Un?(t.push(i),!0):!1}class hy extends lc{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(ow),this.registerUploadHook(ly),this.registerUploadHook(aw)}}hy.extension={name:"prepare",type:Q.RendererSystem};ot.add(hy);class Xn extends Ur{constructor(t,e=!0){super(t[0]instanceof K?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(de.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(de.shared.add(this.update,this,Si.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=e/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let r=0;r<t.length;++r)e.push(K.from(t[r]));return new Xn(e)}static fromImages(t){const e=[];for(let r=0;r<t.length;++r)e.push(K.from(t[r]));return new Xn(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof K)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(de.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(de.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const An=new wt;class Oc extends Ur{constructor(t,e=100,r=100){super(t),this.tileTransform=new nl,this._width=e,this._height=r,this.uvMatrix=this.texture.uvMatrix||new Pc(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;!e||!e.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,s)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,An);const e=this._width,r=this._height,s=-e*this.anchor._x;if(An.x>=s&&An.x<s+e){const n=-r*this.anchor._y;if(An.y>=n&&An.y<n+r)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const r=t instanceof K?t:K.from(t,e);return new Oc(r,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var lw=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,hw=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,uw=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,nm=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,cw=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const fo=new Lt;class uy extends al{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new mg,this.state=Lr.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Fr.from(nm,cw,e),this.shader=t.context.webGLVersion>1?Fr.from(hw,lw,e):Fr.from(nm,uw,e)}render(t){const e=this.renderer,r=this.quad;let s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,l=t.uvRespectAnchor?t.anchor.y:0;s=r.uvs,s[0]=s[6]=-n,s[1]=s[3]=-l,s[2]=s[4]=1-n,s[5]=s[7]=1-l,r.invalidate();const h=t._texture,u=h.baseTexture,d=u.alphaMode>0,p=t.tileTransform.localTransform,g=t.uvMatrix;let y=u.isPowerOfTwo&&h.frame.width===u.width&&h.frame.height===u.height;y&&(u._glTextures[e.CONTEXT_UID]?y=u.wrapMode!==Zr.CLAMP:u.wrapMode===Zr.CLAMP&&(u.wrapMode=Zr.REPEAT));const v=y?this.simpleShader:this.shader,x=h.width,b=h.height,T=t._width,S=t._height;fo.set(p.a*x/T,p.b*x/S,p.c*b/T,p.d*b/S,p.tx/T,p.ty/S),fo.invert(),y?fo.prepend(g.mapCoord):(v.uniforms.uMapCoord=g.mapCoord.toArray(!0),v.uniforms.uClampFrame=g.uClampFrame,v.uniforms.uClampOffset=g.uClampOffset),v.uniforms.uTransform=fo.toArray(!0),v.uniforms.uColor=Nt.shared.setValue(t.tint).premultiply(t.worldAlpha,d).toArray(v.uniforms.uColor),v.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),v.uniforms.uSampler=h,e.shader.bind(v),e.geometry.bind(r),this.state.blendMode=rg(t.blendMode,d),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}uy.extension={name:"tilingSprite",type:Q.RendererPlugin};ot.add(uy);const cy=class Bn{constructor(t,e,r){this.linkedSheets=[],(t instanceof gt||t instanceof K)&&(t={texture:t,data:e,resolutionFilename:r});const{texture:s,data:n,resolutionFilename:l=null,cachePrefix:h=""}=t;this.cachePrefix=h,this._texture=s instanceof K?s:null,this.baseTexture=s instanceof gt?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;const u=this.baseTexture.resource;this.resolution=this._updateResolution(l||(u?u.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let r=ti(t,null);return r===null&&(r=typeof e=="number"?e:parseFloat(e??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Bn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const r=Bn.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const s=this._frameKeys[e],n=this._frames[s],l=n.frame;if(l){let h=null,u=null;const d=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,p=new yt(0,0,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution);n.rotated?h=new yt(Math.floor(l.x)/this.resolution,Math.floor(l.y)/this.resolution,Math.floor(l.h)/this.resolution,Math.floor(l.w)/this.resolution):h=new yt(Math.floor(l.x)/this.resolution,Math.floor(l.y)/this.resolution,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(u=new yt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution)),this.textures[s]=new K(this.baseTexture,h,p,u,n.rotated?2:0,n.anchor,n.borders),K.addToCache(this.textures[s],this.cachePrefix+s.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const s=t[e][r];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Bn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Bn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};cy.BATCH_SIZE=1e3;let am=cy;const dw=["jpg","png","jpeg","avif","webp"];function dy(i,t,e){const r={};if(i.forEach(s=>{r[s]=t}),Object.keys(t.textures).forEach(s=>{r[`${t.cachePrefix}${s}`]=t.textures[s]}),!e){const s=se.dirname(i[0]);t.linkedSheets.forEach((n,l)=>{Object.assign(r,dy([`${s}/${t.data.meta.related_multi_packs[l]}`],n,!0))})}return r}const fw={extension:Q.Asset,cache:{test:i=>i instanceof am,getCacheableAssets:(i,t)=>dy(i,t,!1)},resolver:{test:i=>{const t=i.split("?")[0].split("."),e=t.pop(),r=t.pop();return e==="json"&&dw.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=tt.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:Q.LoadParser,priority:dr.Normal},async testParse(i,t){return se.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var p,g;const{texture:r,imageFilename:s,cachePrefix:n}=(t==null?void 0:t.data)??{};let l=se.dirname(t.src);l&&l.lastIndexOf("/")!==l.length-1&&(l+="/");let h;if(r&&r.baseTexture)h=r;else{const y=ic(l+(s??i.meta.image),t.src);h=(await e.load([y]))[y]}const u=new am({texture:h.baseTexture,data:i,resolutionFilename:t.src,cachePrefix:n});await u.parse();const d=(p=i==null?void 0:i.meta)==null?void 0:p.related_multi_packs;if(Array.isArray(d)){const y=[];for(const x of d){if(typeof x!="string")continue;let b=l+x;(g=t.data)!=null&&g.ignoreMultiPack||(b=ic(b,t.src),y.push(e.load({src:b,data:{ignoreMultiPack:!0}})))}const v=await Promise.all(y);u.linkedSheets=v,v.forEach(x=>{x.linkedSheets=[u].concat(u.linkedSheets.filter(b=>b!==x))})}return u},unload(i){i.destroy(!0)}}};ot.add(fw);class qo{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Po{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const l=e[n].match(/^[a-z]+/gm)[0],h=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),u={};for(const d in h){const p=h[d].split("="),g=p[0],y=p[1].replace(/"/gm,""),v=parseFloat(y),x=isNaN(v)?y:v;u[g]=x}r[l].push(u)}const s=new qo;return r.info.forEach(n=>s.info.push({face:n.face,size:parseInt(n.size,10)})),r.common.forEach(n=>s.common.push({lineHeight:parseInt(n.lineHeight,10)})),r.page.forEach(n=>s.page.push({id:parseInt(n.id,10),file:n.file})),r.char.forEach(n=>s.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),r.kerning.forEach(n=>s.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),r.distanceField.forEach(n=>s.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),s}}class hc{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new qo,r=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),l=t.getElementsByTagName("char"),h=t.getElementsByTagName("kerning"),u=t.getElementsByTagName("distanceField");for(let d=0;d<r.length;d++)e.info.push({face:r[d].getAttribute("face"),size:parseInt(r[d].getAttribute("size"),10)});for(let d=0;d<s.length;d++)e.common.push({lineHeight:parseInt(s[d].getAttribute("lineHeight"),10)});for(let d=0;d<n.length;d++)e.page.push({id:parseInt(n[d].getAttribute("id"),10)||0,file:n[d].getAttribute("file")});for(let d=0;d<l.length;d++){const p=l[d];e.char.push({id:parseInt(p.getAttribute("id"),10),page:parseInt(p.getAttribute("page"),10)||0,x:parseInt(p.getAttribute("x"),10),y:parseInt(p.getAttribute("y"),10),width:parseInt(p.getAttribute("width"),10),height:parseInt(p.getAttribute("height"),10),xoffset:parseInt(p.getAttribute("xoffset"),10),yoffset:parseInt(p.getAttribute("yoffset"),10),xadvance:parseInt(p.getAttribute("xadvance"),10)})}for(let d=0;d<h.length;d++)e.kerning.push({first:parseInt(h[d].getAttribute("first"),10),second:parseInt(h[d].getAttribute("second"),10),amount:parseInt(h[d].getAttribute("amount"),10)});for(let d=0;d<u.length;d++)e.distanceField.push({fieldType:u[d].getAttribute("fieldType"),distanceRange:parseInt(u[d].getAttribute("distanceRange"),10)});return e}}class uc{static test(t){return typeof t=="string"&&t.includes("<font>")?hc.test(tt.ADAPTER.parseXML(t)):!1}static parse(t){return hc.parse(tt.ADAPTER.parseXML(t))}}const uu=[Po,hc,uc];function pw(i){for(let t=0;t<uu.length;t++)if(uu[t].test(i))return uu[t];return null}function mw(i,t,e,r,s,n){const l=e.fill;if(Array.isArray(l)){if(l.length===1)return l[0]}else return l;let h;const u=e.dropShadow?e.dropShadowDistance:0,d=e.padding||0,p=i.width/r-u-d*2,g=i.height/r-u-d*2,y=l.slice(),v=e.fillGradientStops.slice();if(!v.length){const x=y.length+1;for(let b=1;b<x;++b)v.push(b/x)}if(y.unshift(l[0]),v.unshift(0),y.push(l[l.length-1]),v.push(1),e.fillGradientType===cl.LINEAR_VERTICAL){h=t.createLinearGradient(p/2,d,p/2,g+d);let x=0;const b=(n.fontProperties.fontSize+e.strokeThickness)/g;for(let T=0;T<s.length;T++){const S=n.lineHeight*T;for(let I=0;I<y.length;I++){let w=0;typeof v[I]=="number"?w=v[I]:w=I/y.length;const C=S/g+w*b;let N=Math.max(x,C);N=Math.min(N,1),h.addColorStop(N,y[I]),x=N}}}else{h=t.createLinearGradient(d,g/2,p+d,g/2);const x=y.length+1;let b=1;for(let T=0;T<y.length;T++){let S;typeof v[T]=="number"?S=v[T]:S=b/x,h.addColorStop(S,y[T]),b++}}return h}function gw(i,t,e,r,s,n,l){const h=e.text,u=e.fontProperties;t.translate(r,s),t.scale(n,n);const d=l.strokeThickness/2,p=-(l.strokeThickness/2);if(t.font=l.toFontString(),t.lineWidth=l.strokeThickness,t.textBaseline=l.textBaseline,t.lineJoin=l.lineJoin,t.miterLimit=l.miterLimit,t.fillStyle=mw(i,t,l,n,[h],e),t.strokeStyle=l.stroke,l.dropShadow){const g=l.dropShadowColor,y=l.dropShadowBlur*n,v=l.dropShadowDistance*n;t.shadowColor=Nt.shared.setValue(g).setAlpha(l.dropShadowAlpha).toRgbaString(),t.shadowBlur=y,t.shadowOffsetX=Math.cos(l.dropShadowAngle)*v,t.shadowOffsetY=Math.sin(l.dropShadowAngle)*v}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;l.stroke&&l.strokeThickness&&t.strokeText(h,d,p+e.lineHeight-u.descent),l.fill&&t.fillText(h,d,p+e.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Ro(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function fy(i){return Array.from?Array.from(i):i.split("")}function yw(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,r=i.length;e<r;e++){const s=i[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const n=s[0].charCodeAt(0),l=s[1].charCodeAt(0);if(l<n)throw new Error("[BitmapFont]: Invalid character range.");for(let h=n,u=l;h<=u;h++)t.push(String.fromCharCode(h))}else t.push(...fy(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const mi=class Ir{constructor(t,e,r){var p;const[s]=t.info,[n]=t.common,[l]=t.page,[h]=t.distanceField,u=ti(l.file),d={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=n.lineHeight/u,this.chars={},this.pageTextures=d;for(let g=0;g<t.page.length;g++){const{id:y,file:v}=t.page[g];d[y]=e instanceof Array?e[g]:e[v],h!=null&&h.fieldType&&h.fieldType!=="none"&&(d[y].baseTexture.alphaMode=Me.NO_PREMULTIPLIED_ALPHA,d[y].baseTexture.mipmap=Nr.OFF)}for(let g=0;g<t.char.length;g++){const{id:y,page:v}=t.char[g];let{x,y:b,width:T,height:S,xoffset:I,yoffset:w,xadvance:C}=t.char[g];x/=u,b/=u,T/=u,S/=u,I/=u,w/=u,C/=u;const N=new yt(x+d[v].frame.x/u,b+d[v].frame.y/u,T,S);this.chars[y]={xOffset:I,yOffset:w,xAdvance:C,kerning:{},texture:new K(d[v].baseTexture,N),page:v}}for(let g=0;g<t.kerning.length;g++){let{first:y,second:v,amount:x}=t.kerning[g];y/=u,v/=u,x/=u,this.chars[v]&&(this.chars[v].kerning[y]=x)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((p=h==null?void 0:h.fieldType)==null?void 0:p.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,r){let s;if(t instanceof qo)s=t;else{const l=pw(t);if(!l)throw new Error("Unrecognized data format for font.");s=l.parse(t)}e instanceof K&&(e=[e]);const n=new Ir(s,e,r);return Ir.available[n.font]=n,n}static uninstall(t){const e=Ir.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ir.available[t]}static from(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:n,resolution:l,textureWidth:h,textureHeight:u,...d}=Object.assign({},Ir.defaultOptions,r),p=yw(s),g=e instanceof Ai?e:new Ai(e),y=h,v=new qo;v.info[0]={face:g.fontFamily,size:g.fontSize},v.common[0]={lineHeight:g.fontSize};let x=0,b=0,T,S,I,w=0;const C=[];for(let V=0;V<p.length;V++){T||(T=tt.ADAPTER.createCanvas(),T.width=h,T.height=u,S=T.getContext("2d"),I=new gt(T,{resolution:l,...d}),C.push(new K(I)),v.page.push({id:C.length-1,file:""}));const z=p[V],G=vi.measureText(z,g,!1,T),Y=G.width,rt=Math.ceil(G.height),mt=Math.ceil((g.fontStyle==="italic"?2:1)*Y);if(b>=u-rt*l){if(b===0)throw new Error(`[BitmapFont] textureHeight ${u}px is too small (fontFamily: '${g.fontFamily}', fontSize: ${g.fontSize}px, char: '${z}')`);--V,T=null,S=null,I=null,b=0,x=0,w=0;continue}if(w=Math.max(rt+G.fontProperties.descent,w),mt*l+x>=y){if(x===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${g.fontFamily}', fontSize: ${g.fontSize}px, char: '${z}')`);--V,b+=w*l,b=Math.ceil(b),x=0,w=0;continue}gw(T,S,G,x,b,l,g);const Z=Ro(G.text);v.char.push({id:Z,page:C.length-1,x:x/l,y:b/l,width:mt,height:rt,xoffset:0,yoffset:0,xadvance:Y-(g.dropShadow?g.dropShadowDistance:0)-(g.stroke?g.strokeThickness:0)}),x+=(mt+2*n)*l,x=Math.ceil(x)}if(!(r!=null&&r.skipKerning))for(let V=0,z=p.length;V<z;V++){const G=p[V];for(let Y=0;Y<z;Y++){const rt=p[Y],mt=S.measureText(G).width,Z=S.measureText(rt).width,M=S.measureText(G+rt).width-(mt+Z);M&&v.kerning.push({first:Ro(G),second:Ro(rt),amount:M})}}const N=new Ir(v,C,!0);return Ir.available[t]!==void 0&&Ir.uninstall(t),Ir.available[t]=N,N}};mi.ALPHA=[["a","z"],["A","Z"]," "],mi.NUMERIC=[["0","9"]],mi.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],mi.ASCII=[[" ","~"]],mi.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:mi.ALPHANUMERIC},mi.available={};let gi=mi;var vw=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,_w=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const om=[],lm=[],hm=[],py=class my extends Ae{constructor(t,e={}){super();const{align:r,tint:s,maxWidth:n,letterSpacing:l,fontName:h,fontSize:u}=Object.assign({},my.styleDefaults,e);if(!gi.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new Nt(s),this._font=void 0,this._fontName=h,this._fontSize=u,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=l,this._anchor=new Dr(()=>{this.dirty=!0},this,0,0),this._roundPixels=tt.ROUND_PIXELS,this.dirty=!0,this._resolution=tt.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var mt;const t=gi.available[this._fontName],e=this.fontSize,r=e/t.size,s=new wt,n=[],l=[],h=[],u=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",d=fy(u),p=this._maxWidth*t.size/e,g=t.distanceFieldType==="none"?om:lm;let y=null,v=0,x=0,b=0,T=-1,S=0,I=0,w=0,C=0;for(let Z=0;Z<d.length;Z++){const M=d[Z],W=Ro(M);if(/(?:\s)/.test(M)&&(T=Z,S=v,C++),M==="\r"||M===`
`){l.push(v),h.push(-1),x=Math.max(x,v),++b,++I,s.x=0,s.y+=t.lineHeight,y=null,C=0;continue}const it=t.chars[W];if(!it)continue;y&&it.kerning[y]&&(s.x+=it.kerning[y]);const ft=hm.pop()||{texture:K.EMPTY,line:0,charCode:0,prevSpaces:0,position:new wt};ft.texture=it.texture,ft.line=b,ft.charCode=W,ft.position.x=Math.round(s.x+it.xOffset+this._letterSpacing/2),ft.position.y=Math.round(s.y+it.yOffset),ft.prevSpaces=C,n.push(ft),v=ft.position.x+Math.max(it.xAdvance-it.xOffset,it.texture.orig.width),s.x+=it.xAdvance+this._letterSpacing,w=Math.max(w,it.yOffset+it.texture.height),y=W,T!==-1&&p>0&&s.x>p&&(++I,Gs(n,1+T-I,1+Z-T),Z=T,T=-1,l.push(S),h.push(n.length>0?n[n.length-1].prevSpaces:0),x=Math.max(x,S),b++,s.x=0,s.y+=t.lineHeight,y=null,C=0)}const N=d[d.length-1];N!=="\r"&&N!==`
`&&(/(?:\s)/.test(N)&&(v=S),l.push(v),x=Math.max(x,v),h.push(-1));const V=[];for(let Z=0;Z<=b;Z++){let M=0;this._align==="right"?M=x-l[Z]:this._align==="center"?M=(x-l[Z])/2:this._align==="justify"&&(M=h[Z]<0?0:(x-l[Z])/h[Z]),V.push(M)}const z=n.length,G={},Y=[],rt=this._activePagesMeshData;g.push(...rt);for(let Z=0;Z<z;Z++){const M=n[Z].texture,W=M.baseTexture.uid;if(!G[W]){let it=g.pop();if(!it){const nt=new ul;let k,et;t.distanceFieldType==="none"?(k=new jn(K.EMPTY),et=pt.NORMAL):(k=new jn(K.EMPTY,{program:Kr.from(_w,vw),uniforms:{uFWidth:0}}),et=pt.NORMAL_NPM);const F=new Wn(nt,k);F.blendMode=et,it={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:F,vertices:null,uvs:null,indices:null}}it.index=0,it.indexCount=0,it.vertexCount=0,it.uvsCount=0,it.total=0;const{_textureCache:ft}=this;ft[W]=ft[W]||new K(M.baseTexture),it.mesh.texture=ft[W],it.mesh.tint=this._tintColor.value,Y.push(it),G[W]=it}G[W].total++}for(let Z=0;Z<rt.length;Z++)Y.includes(rt[Z])||this.removeChild(rt[Z].mesh);for(let Z=0;Z<Y.length;Z++)Y[Z].mesh.parent!==this&&this.addChild(Y[Z].mesh);this._activePagesMeshData=Y;for(const Z in G){const M=G[Z],W=M.total;if(!(((mt=M.indices)==null?void 0:mt.length)>6*W)||M.vertices.length<Wn.BATCHABLE_SIZE*2)M.vertices=new Float32Array(4*2*W),M.uvs=new Float32Array(4*2*W),M.indices=new Uint16Array(6*W);else{const it=M.total,ft=M.vertices;for(let nt=it*4*2;nt<ft.length;nt++)ft[nt]=0}M.mesh.size=6*W}for(let Z=0;Z<z;Z++){const M=n[Z];let W=M.position.x+V[M.line]*(this._align==="justify"?M.prevSpaces:1);this._roundPixels&&(W=Math.round(W));const it=W*r,ft=M.position.y*r,nt=M.texture,k=G[nt.baseTexture.uid],et=nt.frame,F=nt._uvs,H=k.index++;k.indices[H*6+0]=0+H*4,k.indices[H*6+1]=1+H*4,k.indices[H*6+2]=2+H*4,k.indices[H*6+3]=0+H*4,k.indices[H*6+4]=2+H*4,k.indices[H*6+5]=3+H*4,k.vertices[H*8+0]=it,k.vertices[H*8+1]=ft,k.vertices[H*8+2]=it+et.width*r,k.vertices[H*8+3]=ft,k.vertices[H*8+4]=it+et.width*r,k.vertices[H*8+5]=ft+et.height*r,k.vertices[H*8+6]=it,k.vertices[H*8+7]=ft+et.height*r,k.uvs[H*8+0]=F.x0,k.uvs[H*8+1]=F.y0,k.uvs[H*8+2]=F.x1,k.uvs[H*8+3]=F.y1,k.uvs[H*8+4]=F.x2,k.uvs[H*8+5]=F.y2,k.uvs[H*8+6]=F.x3,k.uvs[H*8+7]=F.y3}this._textWidth=x*r,this._textHeight=(s.y+t.lineHeight)*r;for(const Z in G){const M=G[Z];if(this.anchor.x!==0||this.anchor.y!==0){let nt=0;const k=this._textWidth*this.anchor.x,et=this._textHeight*this.anchor.y;for(let F=0;F<M.total;F++)M.vertices[nt++]-=k,M.vertices[nt++]-=et,M.vertices[nt++]-=k,M.vertices[nt++]-=et,M.vertices[nt++]-=k,M.vertices[nt++]-=et,M.vertices[nt++]-=k,M.vertices[nt++]-=et}this._maxLineHeight=w*r;const W=M.mesh.geometry.getBuffer("aVertexPosition"),it=M.mesh.geometry.getBuffer("aTextureCoord"),ft=M.mesh.geometry.getIndex();W.data=M.vertices,it.data=M.uvs,ft.data=M.indices,W.update(),it.update(),ft.update()}for(let Z=0;Z<n.length;Z++)hm.push(n[Z]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:r,size:s}=gi.available[this._fontName];if(r!=="none"){const{a:n,b:l,c:h,d:u}=this.worldTransform,d=Math.sqrt(n*n+l*l),p=Math.sqrt(h*h+u*u),g=(Math.abs(d)+Math.abs(p))/2,y=this.fontSize/s,v=t._view.resolution;for(const x of this._activePagesMeshData)x.mesh.shader.uniforms.uFWidth=g*e*y*v}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=gi.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!gi.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??gi.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,r=gi.available[this._fontName].distanceFieldType==="none"?om:lm;r.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],r.filter(s=>e[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=K.EMPTY});for(const s in e)e[s].destroy(),delete e[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};py.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let xw=py;const bw=[".xml",".fnt"],Ew={extension:{type:Q.LoadParser,priority:dr.Normal},name:"loadBitmapFont",test(i){return bw.includes(se.extname(i).toLowerCase())},async testParse(i){return Po.test(i)||uc.test(i)},async parse(i,t,e){const r=Po.test(i)?Po.parse(i):uc.parse(i),{src:s}=t,{page:n}=r,l=[];for(let d=0;d<n.length;++d){const p=n[d].file;let g=se.join(se.dirname(s),p);g=ic(g,s),l.push(g)}const h=await e.load(l),u=l.map(d=>h[d]);return gi.install(r,u,!0)},async load(i,t){return(await tt.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};ot.add(Ew);const cc=class Ds extends Ai{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Ds(Object.keys(Ds.defaultOptions).reduce((e,r)=>({...e,[r]:t[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Ds.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:r}=Ds;if(r[t]){const s=r[t];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return tt.ADAPTER.fetch(t).then(s=>s.blob()).then(async s=>new Promise((n,l)=>{const h=URL.createObjectURL(s),u=new FileReader;u.onload=()=>n([h,u.result]),u.onerror=l,u.readAsDataURL(s)})).then(async([s,n])=>{const l=Object.assign({family:se.basename(t,se.extname(t)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);r[t]=l,this._fonts.push(l),this.styleID++;const h=new FontFace(l.family,`url(${l.src})`,{weight:l.weight,style:l.style,display:l.display});l.fontFace=h,await h.load(),document.fonts.add(h),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(r=>!this._overrides.includes(r));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(r=>this._overrides.includes(r));e.length>0&&(this._overrides=this._overrides.filter(r=>!e.includes(r)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=ob(t)),typeof t=="number"?ab(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const n=`${r}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,Ds.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=tt.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};cc.availableFonts={},cc.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let cu=cc;const po=class Bs extends Ur{constructor(t="",e={}){super(K.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const r=new Image,s=K.from(r,{scaleMode:tt.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new yt,s.trim=new yt,this.texture=s;const n="http://www.w3.org/2000/svg",l="http://www.w3.org/1999/xhtml",h=document.createElementNS(n,"svg"),u=document.createElementNS(n,"foreignObject"),d=document.createElementNS(l,"div"),p=document.createElementNS(l,"style");u.setAttribute("width","10000"),u.setAttribute("height","10000"),u.style.overflow="hidden",h.appendChild(u),this.maxWidth=Bs.defaultMaxWidth,this.maxHeight=Bs.defaultMaxHeight,this._domElement=d,this._styleElement=p,this._svgRoot=h,this._foreignObject=u,this._foreignObject.appendChild(p),this._foreignObject.appendChild(d),this._image=r,this._loadImage=new Image,this._autoResolution=Bs.defaultAutoResolution,this._resolution=Bs.defaultResolution??tt.RESOLUTION,this.text=t,this.style=e}measureText(t){var p,g;const{text:e,style:r,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:r.toCSS(s)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:l,height:h}=n;(l>this.maxWidth||h>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const u=Math.min(this.maxWidth,Math.ceil(l)),d=Math.min(this.maxHeight,Math.ceil(h));return this._svgRoot.setAttribute("width",u.toString()),this._svgRoot.setAttribute("height",d.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:(p=this._style)==null?void 0:p.toCSS(s)}),this._styleElement.textContent=(g=this._style)==null?void 0:g.toGlobalCSS()),{width:u+r.padding*2,height:d+r.padding*2}}async updateText(t=!0){const{style:e,_image:r,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:l}=this.measureText();r.width=s.width=Math.ceil(Math.max(1,n)),r.height=s.height=Math.ceil(Math.max(1,l)),this._updateID++;const h=this._updateID;await new Promise(u=>{s.onload=async()=>{if(h<this._updateID){u();return}await e.onBeforeDraw(),r.src=s.src,s.onload=null,s.src="",this.updateTexture(),u()};const d=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(d)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:r,resolution:s}=this,{padding:n}=t,{baseTexture:l}=e;e.trim.width=e._frame.width=r.width/s,e.trim.height=e._frame.height=r.height/s,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),l.setRealSize(r.width,r.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var r,s,n,l,h;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Bs.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((r=this._style)==null||r.cleanFonts()),this._style=e,(s=this._svgRoot)==null||s.remove(),this._svgRoot=e,(n=this._domElement)==null||n.remove(),this._domElement=e,(l=this._foreignObject)==null||l.remove(),this._foreignObject=e,(h=this._styleElement)==null||h.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=bi(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=bi(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof cu?(this.ownsStyle=!1,this._style=t):t instanceof Ai?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=cu.from(t)):(this.ownsStyle=!0,this._style=new cu(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};po.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},po.defaultMaxWidth=2024,po.defaultMaxHeight=2024,po.defaultAutoResolution=!0;var gy={exports:{}};function Le(i){return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(i)}function yy(i){var t=function(e,r){if(Le(e)!=="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,r||"default");if(Le(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}(i,"string");return Le(t)==="symbol"?t:String(t)}function Qt(i,t,e){return(t=yy(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function du(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=i[e];return r}function ri(i){return function(t){if(Array.isArray(t))return du(t)}(i)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(i)||function(t,e){if(t){if(typeof t=="string")return du(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?du(t,e):void 0}}(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Yt(i,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s]}var Tw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ww(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Sw=function(i){return i==null};function Fn(i){var t=[];if(i===void 0)return t;if(typeof i=="string")t=i.split(",");else if(typeof i=="number")t=[i];else if(Array.isArray(i))t=ri(i);else{if(i===null||Le(i)!=="object")return t;t=[i&&(i==null?void 0:i.x)||0,i&&(i==null?void 0:i.y)||0]}return t.filter(function(e){return!Sw(e)&&!isNaN(e)}).map(Number)}function um(i,t){if(i.length!==t.length)return!1;for(var e=0;e<i.length;e++)if(i[e]!==t[e])return!1;return!0}function fu(i){return i instanceof wt||i instanceof Dr}var Ko=["click","mousedown","mousemove","mouseout","mouseover","mouseup","mouseupoutside","tap","touchstart","touchmove","touchend","touchendoutside","pointercancel","pointerout","pointerover","pointertap","pointerdown","pointerup","pointerupoutside","pointermove","rightclick","rightdown","rightup","rightupoutside","touchcancel","touchendoutside","touchmove","touchstart"];function pu(i,t,e){if(fu(i[t])&&fu(e))i[t].copyFrom(e);else if(fu(i[t])){var r=Fn(e);Yt(r!==void 0&&r.length>0&&r.length<3,"The property `%s` is a `PIXI.Point` or `PIXI.ObservablePoint` and must be set to a comma-separated string of either 1 or 2 coordinates, a 1 or 2 element array containing coordinates, or a PIXI Point/ObservablePoint. If only one coordinate is given then X and Y will be set to the provided value. Received: `%s` of type `%s`.",t,JSON.stringify(e),Le(e)),i[t].set(r.shift(),r.shift())}else i[t]=e}var As,vy=function(i){var t,e=i;if(!Array.isArray(e)){if(t=i,Object.prototype.toString.call(t)!=="[object Object]")throw new Error("collection needs to be an Array or Object");e=Object.keys(i)}var r={};return e.forEach(function(s){r[s]=!0}),function(s){return r[s]!==void 0}},_y=function(i){return function(){return!i.apply(void 0,arguments)}},dc="children",Aw=(Qt(As={},dc,!0),Qt(As,"parent",!0),Qt(As,"worldAlpha",!0),Qt(As,"worldTransform",!0),Qt(As,"worldVisible",!0),As),fc={alpha:1,buttonMode:!1,cacheAsBitmap:!1,cursor:null,filterArea:null,filters:null,hitArea:null,interactive:!1,mask:null,pivot:0,position:0,renderable:!0,rotation:0,scale:1,skew:0,transform:null,visible:!0,x:0,y:0},Or=function(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=function(h){return requestAnimationFrame(function(){var u,d;h==null||(u=h.__reactpixi)===null||u===void 0||(d=u.root)===null||d===void 0||d.emit("__REACT_PIXI_REQUEST_RENDER__")})},s=function(h,u){if(e.hasOwnProperty(h))return Yt(u.typeofs.some(function(d){return Le(e[h])===d})||u.instanceofs.some(function(d){return e[h]instanceof d}),"".concat(i," ").concat(h," prop is invalid")),e[h]};if(e.texture)return Yt(e.texture instanceof K,"".concat(i," texture needs to be typeof `Texture`")),e.texture;var n=s("image",{typeofs:["string"],instanceofs:[HTMLImageElement]})||s("video",{typeofs:["string"],instanceofs:[HTMLVideoElement]})||s("source",{typeofs:["string","number"],instanceofs:[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement,K]});Yt(!!n,"".concat(i," could not get texture from props"));var l=K.from(n);return l.__reactpixi={root:t},l.once("update",r),l.once("loaded",r),l.valid&&r(l),l},Cw=_y(vy([].concat(ri(Object.keys(Aw)),ri(Ko))));function kr(i,t,e){var r=!1;if(Yt(zt.prototype.isPrototypeOf(i),"instance needs to be typeof `DisplayObject`, got `%s`",Le(i)),!e.ignoreEvents)for(var s=typeof i.removeListener=="function",n=typeof i.on=="function",l=0;l<Ko.length;l++){var h=Ko[l];t[h]!==e[h]&&(r=!0,typeof t[h]=="function"&&s&&i.removeListener(h,t[h]),typeof e[h]=="function"&&n&&i.on(h,e[h]))}var u=Object.keys(e||{});if(e.overwriteProps){for(var d=0;d<u.length;d++){var p=u[d];t[p]!==e[p]&&(r=!0,pu(i,p,e[p]))}return r}for(var g=u.filter(Cw),y=0;y<g.length;y++){var v=g[y],x=e[v];e[v]!==t[v]&&(r=!0),x!==void 0?pu(i,v,x):v in fc?(console.warn("setting default value: ".concat(v,", from: ").concat(i[v]," to: ").concat(x," for"),i),r=!0,pu(i,v,fc[v])):console.warn("ignoring prop: ".concat(v,", from ").concat(i[v]," to ").concat(x," for"),i)}return r}var Iw=function(i,t){var e=t.text,r=t.style;return new xw(e,r)},Pw=function(){return new Ae};function Pi(i,t){if(i==null)return{};var e,r,s=function(l,h){if(l==null)return{};var u,d,p={},g=Object.keys(l);for(d=0;d<g.length;d++)u=g[d],h.indexOf(u)>=0||(p[u]=l[u]);return p}(i,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);for(r=0;r<n.length;r++)e=n[r],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(i,e)&&(s[e]=i[e])}return s}var Rw=["draw","geometry"],Mw=function(i,t){var e=t.geometry;Yt(!e||e instanceof Un,"Graphics geometry needs to be a `PIXI.Graphics`");var r=e?new Un(e.geometry):new Un;return r.applyProps=function(s,n,l){var h=l.draw;l.geometry;var u=kr(s,n,Pi(l,Rw));return n.draw!==h&&typeof h=="function"&&(u=!0,h.call(r,r)),u},r},Dw=["image","texture"],Bw=function(i,t){var e=t.leftWidth,r=e===void 0?10:e,s=t.topHeight,n=s===void 0?10:s,l=t.rightWidth,h=l===void 0?10:l,u=t.bottomHeight,d=u===void 0?10:u,p=Or("NineSlicePlane",i,t),g=new $T(p,r,n,h,d);return g.applyProps=function(y,v,x){var b=x.image,T=x.texture,S=kr(y,v,Pi(x,Dw));return(b||T)&&(T!==v.texture&&(S=!0),y.texture=Or("NineSlicePlane",i,x)),S},g};function cm(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),e.push.apply(e,r)}return e}function mo(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?cm(Object(e),!0).forEach(function(r){Qt(i,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):cm(Object(e)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(e,r))})}return i}var Fw=function(i,t){var e=t.maxSize,r=e===void 0?1500:e,s=t.batchSize,n=s===void 0?16384:s,l=t.autoResize,h=l!==void 0&&l,u=mo(mo({},{vertices:!1,scale:!0,position:!0,rotation:!0,uvs:!0,tint:!0}),t.properties||{}),d=mo(mo({},{children:!1,texture:!1,baseTexture:!1}),t.destroyOptions||{}),p=new XT(r,u,n,h);return p.willUnmount=function(g,y,v){g.destroy(d)},p},Nw=["image","texture"],Ow=function(i,t){var e=new Ur(Or("Sprite",i,t));return e.applyProps=function(r,s,n){var l=n.image,h=n.texture,u=kr(r,s,Pi(n,Nw));return(h&&s.texture!==n.texture||l&&s.image!==n.image)&&(s.texture!==n.texture&&(u=!0),r.texture=Or("Sprite",i,n)),u},e},kw=["textures","isPlaying","initialFrame","images"],Lw=function(i,t){var e=t.textures,r=t.images,s=t.isPlaying,n=s===void 0||s,l=t.initialFrame,h=function(d){return d.map(function(p){return Yt(p instanceof K||(p==null?void 0:p.texture),"AnimationSprite texture needs to be an array of `PIXI.Texture` or `{ texture: PIXI.Texture, time:\n                number }`"),p})},u=r?Xn.fromImages(r):new Xn(h(e));return u[n?"gotoAndPlay":"gotoAndStop"](l||0),u.applyProps=function(d,p,g){var y=g.textures,v=g.isPlaying,x=g.initialFrame,b=g.images,T=kr(d,p,Pi(g,kw));if(b&&p.images!==b){for(var S=[],I=0;I<b.length;++I)S.push(K.from(b[I]));d.textures=S,T=!0}if(y&&p.textures!==y&&(d.textures=h(y),T=!0),v!==p.isPlaying||x!==p.initialFrame){var w=typeof x=="number"?x:u.currentFrame||0;u[v?"gotoAndPlay":"gotoAndStop"](w),T=!0}return T},u},Uw=function(i,t){var e=t.text,r=e===void 0?"":e,s=t.style,n=s===void 0?{}:s,l=t.isSprite,h=new Nc(r,n);return l?(h.updateText(),new Ur(h.texture)):h},Gw=["tileScale","tilePosition","image","texture"],Hw=function(i,t){var e=t.width,r=e===void 0?100:e,s=t.height,n=s===void 0?100:s,l=Or("TilingSprite",i,t),h=new Oc(l,r,n);return h.applyProps=function(u,d,p){var g=p.tileScale,y=p.tilePosition,v=p.image,x=p.texture,b=kr(u,d,Pi(p,Gw));if(y){var T,S=Fn(y);(T=u.tilePosition).set.apply(T,ri(S)),b=!um(Fn(d.tilePosition),S)||b}if(g){var I,w=Fn(g);(I=u.tileScale).set.apply(I,ri(w)),b=!um(Fn(d.tileScale),w)||b}return(v||x)&&(x!==d.texture&&(b=!0),u.texture=Or("Sprite",i,p)),b},h},zw=["image","texture"],$w=function(i,t){var e=Or("Mesh",i,t),r=t.vertices,s=t.uvs,n=t.indices,l=t.drawMode,h=l===void 0?lr.TRIANGLES:l,u=new WT(e,r,s,n,h);return u.applyProps=function(d,p,g){var y=g.image,v=g.texture,x=kr(d,p,Pi(g,zw));return(y||v)&&(v!==p.texture&&(x=!0),d.texture=Or("Mesh",i,g)),x},u},Ww=["image","texture"],jw=function(i,t){var e=Or("SimpleRope",i,t),r=t.points,s=new jT(e,r);return s.applyProps=function(n,l,h){var u=h.image,d=h.texture,p=Pi(h,Ww);Yt(Array.isArray(h.points),"SimpleRope points needs to be %s","Array<PIXI.Point>");var g=kr(n,l,p);return(u||d)&&(d!==l.texture&&(g=!0),n.texture=Or("SimpleRope",i,h)),g},s},Xw=Object.freeze({__proto__:null,BitmapText:Iw,Container:Pw,Graphics:Mw,NineSlicePlane:Bw,ParticleContainer:Fw,Sprite:Ow,Text:Uw,TilingSprite:Hw,SimpleMesh:$w,SimpleRope:jw,AnimatedSprite:Lw});function dm(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),e.push.apply(e,r)}return e}function fm(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?dm(Object(e),!0).forEach(function(r){Qt(i,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):dm(Object(e)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(e,r))})}return i}var De={BitmapText:"BitmapText",Container:"Container",Graphics:"Graphics",NineSlicePlane:"NineSlicePlane",ParticleContainer:"ParticleContainer",Sprite:"Sprite",AnimatedSprite:"AnimatedSprite",Text:"Text",TilingSprite:"TilingSprite",SimpleMesh:"SimpleMesh",SimpleRope:"SimpleRope"},Vw=Object.keys(De).reduce(function(i,t){return fm(fm({},i),{},Qt({},t,Xw[t]))},{}),xy={};function Yw(i,t){return Yt(!!i,"Expect type to be defined, got `%s`",i),Yt(!De[i],"Component `%s` could not be created, already exists in default components.",i),xy[i]=t,i}var pm,mm,gm,ym,pc={},mc={},qw={get exports(){return mc},set exports(i){mc=i}},vm={};function Kw(){return mm||(mm=1,qw.exports=(pm||(pm=1,function(i){function t(k,et){var F=k.length;k.push(et);t:for(;0<F;){var H=F-1>>>1,ct=k[H];if(!(0<s(ct,et)))break t;k[H]=et,k[F]=ct,F=H}}function e(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var et=k[0],F=k.pop();if(F!==et){k[0]=F;t:for(var H=0,ct=k.length,Et=ct>>>1;H<Et;){var _t=2*(H+1)-1,Dt=k[_t],Pt=_t+1,Bt=k[Pt];if(0>s(Dt,F))Pt<ct&&0>s(Bt,Dt)?(k[H]=Bt,k[Pt]=F,H=Pt):(k[H]=Dt,k[_t]=F,H=_t);else{if(!(Pt<ct&&0>s(Bt,F)))break t;k[H]=Bt,k[Pt]=F,H=Pt}}}return et}function s(k,et){var F=k.sortIndex-et.sortIndex;return F!==0?F:k.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;i.unstable_now=function(){return n.now()}}else{var l=Date,h=l.now();i.unstable_now=function(){return l.now()-h}}var u=[],d=[],p=1,g=null,y=3,v=!1,x=!1,b=!1,T=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function w(k){for(var et=e(d);et!==null;){if(et.callback===null)r(d);else{if(!(et.startTime<=k))break;r(d),et.sortIndex=et.expirationTime,t(u,et)}et=e(d)}}function C(k){if(b=!1,w(k),!x)if(e(u)!==null)x=!0,ft(N);else{var et=e(d);et!==null&&nt(C,et.startTime-k)}}function N(k,et){x=!1,b&&(b=!1,S(Y),Y=-1),v=!0;var F=y;try{for(w(et),g=e(u);g!==null&&(!(g.expirationTime>et)||k&&!Z());){var H=g.callback;if(typeof H=="function"){g.callback=null,y=g.priorityLevel;var ct=H(g.expirationTime<=et);et=i.unstable_now(),typeof ct=="function"?g.callback=ct:g===e(u)&&r(u),w(et)}else r(u);g=e(u)}if(g!==null)var Et=!0;else{var _t=e(d);_t!==null&&nt(C,_t.startTime-et),Et=!1}return Et}finally{g=null,y=F,v=!1}}typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var V,z=!1,G=null,Y=-1,rt=5,mt=-1;function Z(){return!(i.unstable_now()-mt<rt)}function M(){if(G!==null){var k=i.unstable_now();mt=k;var et=!0;try{et=G(!0,k)}finally{et?V():(z=!1,G=null)}}else z=!1}if(typeof I=="function")V=function(){I(M)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,it=W.port2;W.port1.onmessage=M,V=function(){it.postMessage(null)}}else V=function(){T(M,0)};function ft(k){G=k,z||(z=!0,V())}function nt(k,et){Y=T(function(){k(i.unstable_now())},et)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(k){k.callback=null},i.unstable_continueExecution=function(){x||v||(x=!0,ft(N))},i.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):rt=0<k?Math.floor(1e3/k):5},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_getFirstCallbackNode=function(){return e(u)},i.unstable_next=function(k){switch(y){case 1:case 2:case 3:var et=3;break;default:et=y}var F=y;y=et;try{return k()}finally{y=F}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(k,et){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var F=y;y=k;try{return et()}finally{y=F}},i.unstable_scheduleCallback=function(k,et,F){var H=i.unstable_now();switch(F=typeof F=="object"&&F!==null&&typeof(F=F.delay)=="number"&&0<F?H+F:H,k){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return k={id:p++,callback:et,priorityLevel:k,startTime:F,expirationTime:ct=F+ct,sortIndex:-1},F>H?(k.sortIndex=F,t(d,k),e(u)===null&&k===e(d)&&(b?(S(Y),Y=-1):b=!0,nt(C,F-H))):(k.sortIndex=ct,t(u,k),x||v||(x=!0,ft(N))),k},i.unstable_shouldYield=Z,i.unstable_wrapCallback=function(k){var et=y;return function(){var F=y;y=et;try{return k.apply(this,arguments)}finally{y=F}}}}(vm)),vm)),mc}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Qw(){return ym||(ym=1,gm=function(i){var t={},e=Qr,r=Kw(),s=Object.assign;function n(a){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),C=Symbol.iterator;function N(a){return a===null||typeof a!="object"?null:typeof(a=C&&a[C]||a["@@iterator"])=="function"?a:null}function V(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case p:return"StrictMode";case b:return"Suspense";case T:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case v:return(a.displayName||"Context")+".Consumer";case y:return(a._context.displayName||"Context")+".Provider";case x:var o=a.render;return(a=a.displayName)||(a=(a=o.displayName||o.name||"")!==""?"ForwardRef("+a+")":"ForwardRef"),a;case S:return(o=a.displayName||null)!==null?o:V(a.type)||"Memo";case I:o=a._payload,a=a._init;try{return V(a(o))}catch{}}return null}function z(a){var o=a.type;switch(a.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=(a=o.render).displayName||a.name||"",o.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(o);case 8:return o===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function G(a){var o=a,c=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do 4098&(o=a).flags&&(c=o.return),a=o.return;while(a)}return o.tag===3?c:null}function Y(a){if(G(a)!==a)throw Error(n(188))}function rt(a){var o=a.alternate;if(!o){if((o=G(a))===null)throw Error(n(188));return o!==a?null:a}for(var c=a,f=o;;){var m=c.return;if(m===null)break;var _=m.alternate;if(_===null){if((f=m.return)!==null){c=f;continue}break}if(m.child===_.child){for(_=m.child;_;){if(_===c)return Y(m),a;if(_===f)return Y(m),o;_=_.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=_;else{for(var E=!1,A=m.child;A;){if(A===c){E=!0,c=m,f=_;break}if(A===f){E=!0,f=m,c=_;break}A=A.sibling}if(!E){for(A=_.child;A;){if(A===c){E=!0,c=_,f=m;break}if(A===f){E=!0,f=_,c=m;break}A=A.sibling}if(!E)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:o}function mt(a){return(a=rt(a))!==null?Z(a):null}function Z(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var o=Z(a);if(o!==null)return o;a=a.sibling}return null}function M(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var o=M(a);if(o!==null)return o}a=a.sibling}return null}var W,it=Array.isArray,ft=i.getPublicInstance,nt=i.getRootHostContext,k=i.getChildHostContext,et=i.prepareForCommit,F=i.resetAfterCommit,H=i.createInstance,ct=i.appendInitialChild,Et=i.finalizeInitialChildren,_t=i.prepareUpdate,Dt=i.shouldSetTextContent,Pt=i.createTextInstance,Bt=i.scheduleTimeout,ne=i.cancelTimeout,fe=i.noTimeout,Xt=i.isPrimaryRenderer,xt=i.supportsMutation,Ot=i.supportsPersistence,At=i.supportsHydration,Ue=i.getInstanceFromNode,Ge=i.preparePortalMount,Ri=i.getCurrentEventPriority,fl=i.detachDeletedInstance,ns=i.supportsMicrotasks,Py=i.scheduleMicrotask,Zs=i.supportsTestSelectors,Ry=i.findFiberRoot,My=i.getBoundingRect,Dy=i.getTextContent,Js=i.isHiddenSubtree,By=i.matchAccessibilityRole,Fy=i.setFocusIfFocusable,Ny=i.setupIntersectionObserver,Oy=i.appendChild,ky=i.appendChildToContainer,Ly=i.commitTextUpdate,Uy=i.commitMount,Gy=i.commitUpdate,Hy=i.insertBefore,zy=i.insertInContainerBefore,$y=i.removeChild,Wy=i.removeChildFromContainer,kc=i.resetTextContent,jy=i.hideInstance,Xy=i.hideTextInstance,Vy=i.unhideInstance,Yy=i.unhideTextInstance,qy=i.clearContainer,Ky=i.cloneInstance,Lc=i.createContainerChildSet,Uc=i.appendChildToContainerChildSet,Qy=i.finalizeContainerChildren,pl=i.replaceContainerChildren,Gc=i.cloneHiddenInstance,Hc=i.cloneHiddenTextInstance,Zy=i.canHydrateInstance,Jy=i.canHydrateTextInstance,t0=i.canHydrateSuspenseInstance,zc=i.isSuspenseInstancePending,ml=i.isSuspenseInstanceFallback,e0=i.getSuspenseInstanceFallbackErrorDetails,r0=i.registerSuspenseInstanceRetry,Jn=i.getNextHydratableSibling,i0=i.getFirstHydratableChild,s0=i.getFirstHydratableChildWithinContainer,n0=i.getFirstHydratableChildWithinSuspenseInstance,a0=i.hydrateInstance,o0=i.hydrateTextInstance,l0=i.hydrateSuspenseInstance,h0=i.getNextHydratableInstanceAfterSuspenseInstance,u0=i.commitHydratedContainer,c0=i.commitHydratedSuspenseInstance,d0=i.clearSuspenseBoundary,f0=i.clearSuspenseBoundaryFromContainer,p0=i.shouldDeleteUnhydratedTailInstances,m0=i.didNotMatchHydratedContainerTextInstance,g0=i.didNotMatchHydratedTextInstance;function tn(a){if(W===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);W=o&&o[1]||""}return`
`+W+a}var gl=!1;function yl(a,o){if(!a||gl)return"";gl=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(B){var f=B}Reflect.construct(a,[],o)}else{try{o.call()}catch(B){f=B}a.call(o.prototype)}else{try{throw Error()}catch(B){f=B}a()}}catch(B){if(B&&f&&typeof B.stack=="string"){for(var m=B.stack.split(`
`),_=f.stack.split(`
`),E=m.length-1,A=_.length-1;1<=E&&0<=A&&m[E]!==_[A];)A--;for(;1<=E&&0<=A;E--,A--)if(m[E]!==_[A]){if(E!==1||A!==1)do if(E--,0>--A||m[E]!==_[A]){var R=`
`+m[E].replace(" at new "," at ");return a.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",a.displayName)),R}while(1<=E&&0<=A);break}}}finally{gl=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:"")?tn(a):""}var y0=Object.prototype.hasOwnProperty,vl=[],as=-1;function ii(a){return{current:a}}function Ut(a){0>as||(a.current=vl[as],vl[as]=null,as--)}function Ft(a,o){as++,vl[as]=a.current,a.current=o}var si={},ve=ii(si),Ce=ii(!1),Mi=si;function os(a,o){var c=a.type.contextTypes;if(!c)return si;var f=a.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var m,_={};for(m in c)_[m]=o[m];return f&&((a=a.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,a.__reactInternalMemoizedMaskedChildContext=_),_}function Be(a){return(a=a.childContextTypes)!=null}function _l(){Ut(Ce),Ut(ve)}function $c(a,o,c){if(ve.current!==si)throw Error(n(168));Ft(ve,o),Ft(Ce,c)}function Wc(a,o,c){var f=a.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return c;for(var m in f=f.getChildContext())if(!(m in o))throw Error(n(108,z(a)||"Unknown",m));return s({},c,f)}function ta(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||si,Mi=ve.current,Ft(ve,a),Ft(Ce,Ce.current),!0}function jc(a,o,c){var f=a.stateNode;if(!f)throw Error(n(169));c?(a=Wc(a,o,Mi),f.__reactInternalMemoizedMergedChildContext=a,Ut(Ce),Ut(ve),Ft(ve,a)):Ut(Ce),Ft(Ce,c)}var Ze=Math.clz32?Math.clz32:function(a){return(a>>>=0)===0?32:31-(v0(a)/_0|0)|0},v0=Math.log,_0=Math.LN2,xl=64,bl=4194304;function en(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&a;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&a;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ea(a,o){var c=a.pendingLanes;if(c===0)return 0;var f=0,m=a.suspendedLanes,_=a.pingedLanes,E=268435455&c;if(E!==0){var A=E&~m;A!==0?f=en(A):(_&=E)!==0&&(f=en(_))}else(E=c&~m)!==0?f=en(E):_!==0&&(f=en(_));if(f===0)return 0;if(o!==0&&o!==f&&!(o&m)&&((m=f&-f)>=(_=o&-o)||m===16&&4194240&_))return o;if(4&f&&(f|=16&c),(o=a.entangledLanes)!==0)for(a=a.entanglements,o&=f;0<o;)m=1<<(c=31-Ze(o)),f|=a[c],o&=~m;return f}function x0(a,o){switch(a){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;default:return-1}}function El(a){return(a=-1073741825&a.pendingLanes)!==0?a:1073741824&a?1073741824:0}function Xc(){var a=xl;return!(4194240&(xl<<=1))&&(xl=64),a}function Tl(a){for(var o=[],c=0;31>c;c++)o.push(a);return o}function rn(a,o,c){a.pendingLanes|=o,o!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),(a=a.eventTimes)[o=31-Ze(o)]=c}function wl(a,o){var c=a.entangledLanes|=o;for(a=a.entanglements;c;){var f=31-Ze(c),m=1<<f;m&o|a[f]&o&&(a[f]|=o),c&=~m}}var Ct=0;function Vc(a){return 1<(a&=-a)?4<a?268435455&a?16:536870912:4:1}var Sl=r.unstable_scheduleCallback,Yc=r.unstable_cancelCallback,b0=r.unstable_shouldYield,E0=r.unstable_requestPaint,ae=r.unstable_now,Al=r.unstable_ImmediatePriority,T0=r.unstable_UserBlockingPriority,qc=r.unstable_NormalPriority,w0=r.unstable_IdlePriority,ra=null,fr=null,Je=typeof Object.is=="function"?Object.is:function(a,o){return a===o&&(a!==0||1/a==1/o)||a!=a&&o!=o},Gr=null,ia=!1,Cl=!1;function Kc(a){Gr===null?Gr=[a]:Gr.push(a)}function pr(){if(!Cl&&Gr!==null){Cl=!0;var a=0,o=Ct;try{var c=Gr;for(Ct=1;a<c.length;a++){var f=c[a];do f=f(!0);while(f!==null)}Gr=null,ia=!1}catch(m){throw Gr!==null&&(Gr=Gr.slice(a+1)),Sl(Al,pr),m}finally{Ct=o,Cl=!1}}return null}var ls=[],hs=0,sa=null,na=0,He=[],ze=0,Di=null,mr=1,Hr="";function Bi(a,o){ls[hs++]=na,ls[hs++]=sa,sa=a,na=o}function Qc(a,o,c){He[ze++]=mr,He[ze++]=Hr,He[ze++]=Di,Di=a;var f=mr;a=Hr;var m=32-Ze(f)-1;f&=~(1<<m),c+=1;var _=32-Ze(o)+m;if(30<_){var E=m-m%5;_=(f&(1<<E)-1).toString(32),f>>=E,m-=E,mr=1<<32-Ze(o)+m|c<<m|f,Hr=_+a}else mr=1<<_|c<<m|f,Hr=a}function Il(a){a.return!==null&&(Bi(a,1),Qc(a,1,0))}function Pl(a){for(;a===sa;)sa=ls[--hs],ls[hs]=null,na=ls[--hs],ls[hs]=null;for(;a===Di;)Di=He[--ze],He[ze]=null,Hr=He[--ze],He[ze]=null,mr=He[--ze],He[ze]=null}var Fe=null,$e=null,Gt=!1,sn=!1,tr=null;function Zc(a,o){var c=Ye(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=a,(o=a.deletions)===null?(a.deletions=[c],a.flags|=16):o.push(c)}function Jc(a,o){switch(a.tag){case 5:return(o=Zy(o,a.type,a.pendingProps))!==null&&(a.stateNode=o,Fe=a,$e=i0(o),!0);case 6:return(o=Jy(o,a.pendingProps))!==null&&(a.stateNode=o,Fe=a,$e=null,!0);case 13:if((o=t0(o))!==null){var c=Di!==null?{id:mr,overflow:Hr}:null;return a.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},(c=Ye(18,null,null,0)).stateNode=o,c.return=a,a.child=c,Fe=a,$e=null,!0}return!1;default:return!1}}function Rl(a){return(1&a.mode)!=0&&(128&a.flags)==0}function Ml(a){if(Gt){var o=$e;if(o){var c=o;if(!Jc(a,o)){if(Rl(a))throw Error(n(418));o=Jn(c);var f=Fe;o&&Jc(a,o)?Zc(f,c):(a.flags=-4097&a.flags|2,Gt=!1,Fe=a)}}else{if(Rl(a))throw Error(n(418));a.flags=-4097&a.flags|2,Gt=!1,Fe=a}}}function td(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Fe=a}function aa(a){if(!At||a!==Fe)return!1;if(!Gt)return td(a),Gt=!0,!1;if(a.tag!==3&&(a.tag!==5||p0(a.type)&&!Dt(a.type,a.memoizedProps))){var o=$e;if(o){if(Rl(a))throw ed(),Error(n(418));for(;o;)Zc(a,o),o=Jn(o)}}if(td(a),a.tag===13){if(!At)throw Error(n(316));if(!(a=(a=a.memoizedState)!==null?a.dehydrated:null))throw Error(n(317));$e=h0(a)}else $e=Fe?Jn(a.stateNode):null;return!0}function ed(){for(var a=$e;a;)a=Jn(a)}function us(){At&&($e=Fe=null,sn=Gt=!1)}function Dl(a){tr===null?tr=[a]:tr.push(a)}var S0=l.ReactCurrentBatchConfig;function oa(a,o){if(Je(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var c=Object.keys(a),f=Object.keys(o);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!y0.call(o,m)||!Je(a[m],o[m]))return!1}return!0}function A0(a){switch(a.tag){case 5:return tn(a.type);case 16:return tn("Lazy");case 13:return tn("Suspense");case 19:return tn("SuspenseList");case 0:case 2:case 15:return a=yl(a.type,!1);case 11:return a=yl(a.type.render,!1);case 1:return a=yl(a.type,!0);default:return""}}function er(a,o){if(a&&a.defaultProps){for(var c in o=s({},o),a=a.defaultProps)o[c]===void 0&&(o[c]=a[c]);return o}return o}var la=ii(null),ha=null,cs=null,Bl=null;function Fl(){Bl=cs=ha=null}function rd(a,o,c){Xt?(Ft(la,o._currentValue),o._currentValue=c):(Ft(la,o._currentValue2),o._currentValue2=c)}function Nl(a){var o=la.current;Ut(la),Xt?a._currentValue=o:a._currentValue2=o}function Ol(a,o,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),a===c)break;a=a.return}}function ds(a,o){ha=a,Bl=cs=null,(a=a.dependencies)!==null&&a.firstContext!==null&&(a.lanes&o&&(Ie=!0),a.firstContext=null)}function We(a){var o=Xt?a._currentValue:a._currentValue2;if(Bl!==a)if(a={context:a,memoizedValue:o,next:null},cs===null){if(ha===null)throw Error(n(308));cs=a,ha.dependencies={lanes:0,firstContext:a}}else cs=cs.next=a;return o}var Fi=null;function kl(a){Fi===null?Fi=[a]:Fi.push(a)}function id(a,o,c,f){var m=o.interleaved;return m===null?(c.next=c,kl(o)):(c.next=m.next,m.next=c),o.interleaved=c,gr(a,f)}function gr(a,o){a.lanes|=o;var c=a.alternate;for(c!==null&&(c.lanes|=o),c=a,a=a.return;a!==null;)a.childLanes|=o,(c=a.alternate)!==null&&(c.childLanes|=o),c=a,a=a.return;return c.tag===3?c.stateNode:null}var ni=!1;function Ll(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sd(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function zr(a,o){return{eventTime:a,lane:o,tag:0,payload:null,callback:null,next:null}}function ai(a,o,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(2&St)!=0){var m=f.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),f.pending=o,gr(a,c)}return(m=f.interleaved)===null?(o.next=o,kl(f)):(o.next=m.next,m.next=o),f.interleaved=o,gr(a,c)}function ua(a,o,c){if((o=o.updateQueue)!==null&&(o=o.shared,(4194240&c)!=0)){var f=o.lanes;c|=f&=a.pendingLanes,o.lanes=c,wl(a,c)}}function nd(a,o){var c=a.updateQueue,f=a.alternate;if(f!==null&&c===(f=f.updateQueue)){var m=null,_=null;if((c=c.firstBaseUpdate)!==null){do{var E={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};_===null?m=_=E:_=_.next=E,c=c.next}while(c!==null);_===null?m=_=o:_=_.next=o}else m=_=o;return c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:_,shared:f.shared,effects:f.effects},void(a.updateQueue=c)}(a=c.lastBaseUpdate)===null?c.firstBaseUpdate=o:a.next=o,c.lastBaseUpdate=o}function ca(a,o,c,f){var m=a.updateQueue;ni=!1;var _=m.firstBaseUpdate,E=m.lastBaseUpdate,A=m.shared.pending;if(A!==null){m.shared.pending=null;var R=A,B=R.next;R.next=null,E===null?_=B:E.next=B,E=R;var L=a.alternate;L!==null&&(A=(L=L.updateQueue).lastBaseUpdate)!==E&&(A===null?L.firstBaseUpdate=B:A.next=B,L.lastBaseUpdate=R)}if(_!==null){var q=m.baseState;for(E=0,L=B=R=null,A=_;;){var O=A.lane,j=A.eventTime;if((f&O)===O){L!==null&&(L=L.next={eventTime:j,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});t:{var at=a,vt=A;switch(O=o,j=c,vt.tag){case 1:if(typeof(at=vt.payload)=="function"){q=at.call(j,q,O);break t}q=at;break t;case 3:at.flags=-65537&at.flags|128;case 0:if((O=typeof(at=vt.payload)=="function"?at.call(j,q,O):at)==null)break t;q=s({},q,O);break t;case 2:ni=!0}}A.callback!==null&&A.lane!==0&&(a.flags|=64,(O=m.effects)===null?m.effects=[A]:O.push(A))}else j={eventTime:j,lane:O,tag:A.tag,payload:A.payload,callback:A.callback,next:null},L===null?(B=L=j,R=q):L=L.next=j,E|=O;if((A=A.next)===null){if((A=m.shared.pending)===null)break;A=(O=A).next,O.next=null,m.lastBaseUpdate=O,m.shared.pending=null}}if(L===null&&(R=q),m.baseState=R,m.firstBaseUpdate=B,m.lastBaseUpdate=L,(o=m.shared.interleaved)!==null){m=o;do E|=m.lane,m=m.next;while(m!==o)}else _===null&&(m.shared.lanes=0);Oi|=E,a.lanes=E,a.memoizedState=q}}function ad(a,o,c){if(a=o.effects,o.effects=null,a!==null)for(o=0;o<a.length;o++){var f=a[o],m=f.callback;if(m!==null){if(f.callback=null,f=c,typeof m!="function")throw Error(n(191,m));m.call(f)}}}var od=new e.Component().refs;function Ul(a,o,c,f){c=(c=c(f,o=a.memoizedState))==null?o:s({},o,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var da={isMounted:function(a){return!!(a=a._reactInternals)&&G(a)===a},enqueueSetState:function(a,o,c){a=a._reactInternals;var f=be(),m=ui(a),_=zr(f,m);_.payload=o,c!=null&&(_.callback=c),(o=ai(a,_,m))!==null&&(Ve(o,a,m,f),ua(o,a,m))},enqueueReplaceState:function(a,o,c){a=a._reactInternals;var f=be(),m=ui(a),_=zr(f,m);_.tag=1,_.payload=o,c!=null&&(_.callback=c),(o=ai(a,_,m))!==null&&(Ve(o,a,m,f),ua(o,a,m))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var c=be(),f=ui(a),m=zr(c,f);m.tag=2,o!=null&&(m.callback=o),(o=ai(a,m,f))!==null&&(Ve(o,a,f,c),ua(o,a,f))}};function ld(a,o,c,f,m,_,E){return typeof(a=a.stateNode).shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,_,E):!o.prototype||!o.prototype.isPureReactComponent||!oa(c,f)||!oa(m,_)}function hd(a,o,c){var f=!1,m=si,_=o.contextType;return typeof _=="object"&&_!==null?_=We(_):(m=Be(o)?Mi:ve.current,_=(f=(f=o.contextTypes)!=null)?os(a,m):si),o=new o(c,_),a.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=da,a.stateNode=o,o._reactInternals=a,f&&((a=a.stateNode).__reactInternalMemoizedUnmaskedChildContext=m,a.__reactInternalMemoizedMaskedChildContext=_),o}function ud(a,o,c,f){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,f),o.state!==a&&da.enqueueReplaceState(o,o.state,null)}function Gl(a,o,c,f){var m=a.stateNode;m.props=c,m.state=a.memoizedState,m.refs=od,Ll(a);var _=o.contextType;typeof _=="object"&&_!==null?m.context=We(_):(_=Be(o)?Mi:ve.current,m.context=os(a,_)),m.state=a.memoizedState,typeof(_=o.getDerivedStateFromProps)=="function"&&(Ul(a,o,_,c),m.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&da.enqueueReplaceState(m,m.state,null),ca(a,c,m,f),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308)}function nn(a,o,c){if((a=c.ref)!==null&&typeof a!="function"&&typeof a!="object"){if(c._owner){if(c=c._owner){if(c.tag!==1)throw Error(n(309));var f=c.stateNode}if(!f)throw Error(n(147,a));var m=f,_=""+a;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===_?o.ref:(o=function(E){var A=m.refs;A===od&&(A=m.refs={}),E===null?delete A[_]:A[_]=E},o._stringRef=_,o)}if(typeof a!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,a))}return a}function fa(a,o){throw a=Object.prototype.toString.call(o),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a))}function cd(a){return(0,a._init)(a._payload)}function dd(a){function o(U,P){if(a){var D=U.deletions;D===null?(U.deletions=[P],U.flags|=16):D.push(P)}}function c(U,P){if(!a)return null;for(;P!==null;)o(U,P),P=P.sibling;return null}function f(U,P){for(U=new Map;P!==null;)P.key!==null?U.set(P.key,P):U.set(P.index,P),P=P.sibling;return U}function m(U,P){return(U=di(U,P)).index=0,U.sibling=null,U}function _(U,P,D){return U.index=D,a?(D=U.alternate)!==null?(D=D.index)<P?(U.flags|=2,P):D:(U.flags|=2,P):(U.flags|=1048576,P)}function E(U){return a&&U.alternate===null&&(U.flags|=2),U}function A(U,P,D,$){return P===null||P.tag!==6?((P=Ah(D,U.mode,$)).return=U,P):((P=m(P,D)).return=U,P)}function R(U,P,D,$){var dt=D.type;return dt===d?L(U,P,D.props.children,$,D.key):P!==null&&(P.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===I&&cd(dt)===P.type)?(($=m(P,D.props)).ref=nn(U,P,D),$.return=U,$):(($=Ua(D.type,D.key,D.props,null,U.mode,$)).ref=nn(U,P,D),$.return=U,$)}function B(U,P,D,$){return P===null||P.tag!==4||P.stateNode.containerInfo!==D.containerInfo||P.stateNode.implementation!==D.implementation?((P=Ch(D,U.mode,$)).return=U,P):((P=m(P,D.children||[])).return=U,P)}function L(U,P,D,$,dt){return P===null||P.tag!==7?((P=Ui(D,U.mode,$,dt)).return=U,P):((P=m(P,D)).return=U,P)}function q(U,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return(P=Ah(""+P,U.mode,D)).return=U,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case h:return(D=Ua(P.type,P.key,P.props,null,U.mode,D)).ref=nn(U,null,P),D.return=U,D;case u:return(P=Ch(P,U.mode,D)).return=U,P;case I:return q(U,(0,P._init)(P._payload),D)}if(it(P)||N(P))return(P=Ui(P,U.mode,D,null)).return=U,P;fa(U,P)}return null}function O(U,P,D,$){var dt=P!==null?P.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return dt!==null?null:A(U,P,""+D,$);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case h:return D.key===dt?R(U,P,D,$):null;case u:return D.key===dt?B(U,P,D,$):null;case I:return O(U,P,(dt=D._init)(D._payload),$)}if(it(D)||N(D))return dt!==null?null:L(U,P,D,$,null);fa(U,D)}return null}function j(U,P,D,$,dt){if(typeof $=="string"&&$!==""||typeof $=="number")return A(P,U=U.get(D)||null,""+$,dt);if(typeof $=="object"&&$!==null){switch($.$$typeof){case h:return R(P,U=U.get($.key===null?D:$.key)||null,$,dt);case u:return B(P,U=U.get($.key===null?D:$.key)||null,$,dt);case I:return j(U,P,D,(0,$._init)($._payload),dt)}if(it($)||N($))return L(P,U=U.get(D)||null,$,dt,null);fa(P,$)}return null}function at(U,P,D,$){for(var dt=null,Rt=null,lt=P,It=P=0,me=null;lt!==null&&It<D.length;It++){lt.index>It?(me=lt,lt=null):me=lt.sibling;var Mt=O(U,lt,D[It],$);if(Mt===null){lt===null&&(lt=me);break}a&&lt&&Mt.alternate===null&&o(U,lt),P=_(Mt,P,It),Rt===null?dt=Mt:Rt.sibling=Mt,Rt=Mt,lt=me}if(It===D.length)return c(U,lt),Gt&&Bi(U,It),dt;if(lt===null){for(;It<D.length;It++)(lt=q(U,D[It],$))!==null&&(P=_(lt,P,It),Rt===null?dt=lt:Rt.sibling=lt,Rt=lt);return Gt&&Bi(U,It),dt}for(lt=f(U,lt);It<D.length;It++)(me=j(lt,U,It,D[It],$))!==null&&(a&&me.alternate!==null&&lt.delete(me.key===null?It:me.key),P=_(me,P,It),Rt===null?dt=me:Rt.sibling=me,Rt=me);return a&&lt.forEach(function(fi){return o(U,fi)}),Gt&&Bi(U,It),dt}function vt(U,P,D,$){var dt=N(D);if(typeof dt!="function")throw Error(n(150));if((D=dt.call(D))==null)throw Error(n(151));for(var Rt=dt=null,lt=P,It=P=0,me=null,Mt=D.next();lt!==null&&!Mt.done;It++,Mt=D.next()){lt.index>It?(me=lt,lt=null):me=lt.sibling;var fi=O(U,lt,Mt.value,$);if(fi===null){lt===null&&(lt=me);break}a&&lt&&fi.alternate===null&&o(U,lt),P=_(fi,P,It),Rt===null?dt=fi:Rt.sibling=fi,Rt=fi,lt=me}if(Mt.done)return c(U,lt),Gt&&Bi(U,It),dt;if(lt===null){for(;!Mt.done;It++,Mt=D.next())(Mt=q(U,Mt.value,$))!==null&&(P=_(Mt,P,It),Rt===null?dt=Mt:Rt.sibling=Mt,Rt=Mt);return Gt&&Bi(U,It),dt}for(lt=f(U,lt);!Mt.done;It++,Mt=D.next())(Mt=j(lt,U,It,Mt.value,$))!==null&&(a&&Mt.alternate!==null&&lt.delete(Mt.key===null?It:Mt.key),P=_(Mt,P,It),Rt===null?dt=Mt:Rt.sibling=Mt,Rt=Mt);return a&&lt.forEach(function(K0){return o(U,K0)}),Gt&&Bi(U,It),dt}return function U(P,D,$,dt){if(typeof $=="object"&&$!==null&&$.type===d&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case h:t:{for(var Rt=$.key,lt=D;lt!==null;){if(lt.key===Rt){if((Rt=$.type)===d){if(lt.tag===7){c(P,lt.sibling),(D=m(lt,$.props.children)).return=P,P=D;break t}}else if(lt.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===I&&cd(Rt)===lt.type){c(P,lt.sibling),(D=m(lt,$.props)).ref=nn(P,lt,$),D.return=P,P=D;break t}c(P,lt);break}o(P,lt),lt=lt.sibling}$.type===d?((D=Ui($.props.children,P.mode,dt,$.key)).return=P,P=D):((dt=Ua($.type,$.key,$.props,null,P.mode,dt)).ref=nn(P,D,$),dt.return=P,P=dt)}return E(P);case u:t:{for(lt=$.key;D!==null;){if(D.key===lt){if(D.tag===4&&D.stateNode.containerInfo===$.containerInfo&&D.stateNode.implementation===$.implementation){c(P,D.sibling),(D=m(D,$.children||[])).return=P,P=D;break t}c(P,D);break}o(P,D),D=D.sibling}(D=Ch($,P.mode,dt)).return=P,P=D}return E(P);case I:return U(P,D,(lt=$._init)($._payload),dt)}if(it($))return at(P,D,$,dt);if(N($))return vt(P,D,$,dt);fa(P,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,D!==null&&D.tag===6?(c(P,D.sibling),(D=m(D,$)).return=P,P=D):(c(P,D),(D=Ah($,P.mode,dt)).return=P,P=D),E(P)):c(P,D)}}var fs=dd(!0),fd=dd(!1),an={},je=ii(an),on=ii(an),ps=ii(an);function yr(a){if(a===an)throw Error(n(174));return a}function Hl(a,o){Ft(ps,o),Ft(on,a),Ft(je,an),a=nt(o),Ut(je),Ft(je,a)}function ms(){Ut(je),Ut(on),Ut(ps)}function pd(a){var o=yr(ps.current),c=yr(je.current);c!==(o=k(c,a.type,o))&&(Ft(on,a),Ft(je,o))}function zl(a){on.current===a&&(Ut(je),Ut(on))}var Vt=ii(0);function pa(a){for(var o=a;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&((c=c.dehydrated)===null||zc(c)||ml(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(128&o.flags)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var $l=[];function Wl(){for(var a=0;a<$l.length;a++){var o=$l[a];Xt?o._workInProgressVersionPrimary=null:o._workInProgressVersionSecondary=null}$l.length=0}var ma=l.ReactCurrentDispatcher,jl=l.ReactCurrentBatchConfig,Ni=0,$t=null,oe=null,le=null,ga=!1,ln=!1,hn=0,C0=0;function _e(){throw Error(n(321))}function Xl(a,o){if(o===null)return!1;for(var c=0;c<o.length&&c<a.length;c++)if(!Je(a[c],o[c]))return!1;return!0}function Vl(a,o,c,f,m,_){if(Ni=_,$t=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ma.current=a===null||a.memoizedState===null?M0:D0,a=c(f,m),ln){_=0;do{if(ln=!1,hn=0,25<=_)throw Error(n(301));_+=1,le=oe=null,o.updateQueue=null,ma.current=B0,a=c(f,m)}while(ln)}if(ma.current=_a,o=oe!==null&&oe.next!==null,Ni=0,le=oe=$t=null,ga=!1,o)throw Error(n(300));return a}function Yl(){var a=hn!==0;return hn=0,a}function vr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return le===null?$t.memoizedState=le=a:le=le.next=a,le}function Xe(){if(oe===null){var a=$t.alternate;a=a!==null?a.memoizedState:null}else a=oe.next;var o=le===null?$t.memoizedState:le.next;if(o!==null)le=o,oe=a;else{if(a===null)throw Error(n(310));a={memoizedState:(oe=a).memoizedState,baseState:oe.baseState,baseQueue:oe.baseQueue,queue:oe.queue,next:null},le===null?$t.memoizedState=le=a:le=le.next=a}return le}function un(a,o){return typeof o=="function"?o(a):o}function ql(a){var o=Xe(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=oe,m=f.baseQueue,_=c.pending;if(_!==null){if(m!==null){var E=m.next;m.next=_.next,_.next=E}f.baseQueue=m=_,c.pending=null}if(m!==null){_=m.next,f=f.baseState;var A=E=null,R=null,B=_;do{var L=B.lane;if((Ni&L)===L)R!==null&&(R=R.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),f=B.hasEagerState?B.eagerState:a(f,B.action);else{var q={lane:L,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};R===null?(A=R=q,E=f):R=R.next=q,$t.lanes|=L,Oi|=L}B=B.next}while(B!==null&&B!==_);R===null?E=f:R.next=A,Je(f,o.memoizedState)||(Ie=!0),o.memoizedState=f,o.baseState=E,o.baseQueue=R,c.lastRenderedState=f}if((a=c.interleaved)!==null){m=a;do _=m.lane,$t.lanes|=_,Oi|=_,m=m.next;while(m!==a)}else m===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Kl(a){var o=Xe(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,_=o.memoizedState;if(m!==null){c.pending=null;var E=m=m.next;do _=a(_,E.action),E=E.next;while(E!==m);Je(_,o.memoizedState)||(Ie=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),c.lastRenderedState=_}return[_,f]}function md(){}function gd(a,o){var c=$t,f=Xe(),m=o(),_=!Je(f.memoizedState,m);if(_&&(f.memoizedState=m,Ie=!0),f=f.queue,Ql(_d.bind(null,c,f,a),[a]),f.getSnapshot!==o||_||le!==null&&1&le.memoizedState.tag){if(c.flags|=2048,cn(9,vd.bind(null,c,f,m,o),void 0,null),he===null)throw Error(n(349));30&Ni||yd(c,o,m)}return m}function yd(a,o,c){a.flags|=16384,a={getSnapshot:o,value:c},(o=$t.updateQueue)===null?(o={lastEffect:null,stores:null},$t.updateQueue=o,o.stores=[a]):(c=o.stores)===null?o.stores=[a]:c.push(a)}function vd(a,o,c,f){o.value=c,o.getSnapshot=f,xd(o)&&bd(a)}function _d(a,o,c){return c(function(){xd(o)&&bd(a)})}function xd(a){var o=a.getSnapshot;a=a.value;try{var c=o();return!Je(a,c)}catch{return!0}}function bd(a){var o=gr(a,1);o!==null&&Ve(o,a,1,-1)}function Ed(a){var o=vr();return typeof a=="function"&&(a=a()),o.memoizedState=o.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:un,lastRenderedState:a},o.queue=a,a=a.dispatch=R0.bind(null,$t,a),[o.memoizedState,a]}function cn(a,o,c,f){return a={tag:a,create:o,destroy:c,deps:f,next:null},(o=$t.updateQueue)===null?(o={lastEffect:null,stores:null},$t.updateQueue=o,o.lastEffect=a.next=a):(c=o.lastEffect)===null?o.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,o.lastEffect=a),a}function Td(){return Xe().memoizedState}function ya(a,o,c,f){var m=vr();$t.flags|=a,m.memoizedState=cn(1|o,c,void 0,f===void 0?null:f)}function va(a,o,c,f){var m=Xe();f=f===void 0?null:f;var _=void 0;if(oe!==null){var E=oe.memoizedState;if(_=E.destroy,f!==null&&Xl(f,E.deps))return void(m.memoizedState=cn(o,c,_,f))}$t.flags|=a,m.memoizedState=cn(1|o,c,_,f)}function wd(a,o){return ya(8390656,8,a,o)}function Ql(a,o){return va(2048,8,a,o)}function Sd(a,o){return va(4,2,a,o)}function Ad(a,o){return va(4,4,a,o)}function Cd(a,o){return typeof o=="function"?(a=a(),o(a),function(){o(null)}):o!=null?(a=a(),o.current=a,function(){o.current=null}):void 0}function Id(a,o,c){return c=c!=null?c.concat([a]):null,va(4,4,Cd.bind(null,o,a),c)}function Zl(){}function Pd(a,o){var c=Xe();o=o===void 0?null:o;var f=c.memoizedState;return f!==null&&o!==null&&Xl(o,f[1])?f[0]:(c.memoizedState=[a,o],a)}function Rd(a,o){var c=Xe();o=o===void 0?null:o;var f=c.memoizedState;return f!==null&&o!==null&&Xl(o,f[1])?f[0]:(a=a(),c.memoizedState=[a,o],a)}function Md(a,o,c){return 21&Ni?(Je(c,o)||(c=Xc(),$t.lanes|=c,Oi|=c,a.baseState=!0),o):(a.baseState&&(a.baseState=!1,Ie=!0),a.memoizedState=c)}function I0(a,o){var c=Ct;Ct=c!==0&&4>c?c:4,a(!0);var f=jl.transition;jl.transition={};try{a(!1),o()}finally{Ct=c,jl.transition=f}}function Dd(){return Xe().memoizedState}function P0(a,o,c){var f=ui(a);c={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null},Bd(a)?Fd(o,c):(c=id(a,o,c,f))!==null&&(Ve(c,a,f,be()),Nd(c,o,f))}function R0(a,o,c){var f=ui(a),m={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null};if(Bd(a))Fd(o,m);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer)!==null)try{var E=o.lastRenderedState,A=_(E,c);if(m.hasEagerState=!0,m.eagerState=A,Je(A,E)){var R=o.interleaved;return R===null?(m.next=m,kl(o)):(m.next=R.next,R.next=m),void(o.interleaved=m)}}catch{}(c=id(a,o,m,f))!==null&&(Ve(c,a,f,m=be()),Nd(c,o,f))}}function Bd(a){var o=a.alternate;return a===$t||o!==null&&o===$t}function Fd(a,o){ln=ga=!0;var c=a.pending;c===null?o.next=o:(o.next=c.next,c.next=o),a.pending=o}function Nd(a,o,c){if(4194240&c){var f=o.lanes;c|=f&=a.pendingLanes,o.lanes=c,wl(a,c)}}var _a={readContext:We,useCallback:_e,useContext:_e,useEffect:_e,useImperativeHandle:_e,useInsertionEffect:_e,useLayoutEffect:_e,useMemo:_e,useReducer:_e,useRef:_e,useState:_e,useDebugValue:_e,useDeferredValue:_e,useTransition:_e,useMutableSource:_e,useSyncExternalStore:_e,useId:_e,unstable_isNewReconciler:!1},M0={readContext:We,useCallback:function(a,o){return vr().memoizedState=[a,o===void 0?null:o],a},useContext:We,useEffect:wd,useImperativeHandle:function(a,o,c){return c=c!=null?c.concat([a]):null,ya(4194308,4,Cd.bind(null,o,a),c)},useLayoutEffect:function(a,o){return ya(4194308,4,a,o)},useInsertionEffect:function(a,o){return ya(4,2,a,o)},useMemo:function(a,o){var c=vr();return o=o===void 0?null:o,a=a(),c.memoizedState=[a,o],a},useReducer:function(a,o,c){var f=vr();return o=c!==void 0?c(o):o,f.memoizedState=f.baseState=o,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:o},f.queue=a,a=a.dispatch=P0.bind(null,$t,a),[f.memoizedState,a]},useRef:function(a){return a={current:a},vr().memoizedState=a},useState:Ed,useDebugValue:Zl,useDeferredValue:function(a){return vr().memoizedState=a},useTransition:function(){var a=Ed(!1),o=a[0];return a=I0.bind(null,a[1]),vr().memoizedState=a,[o,a]},useMutableSource:function(){},useSyncExternalStore:function(a,o,c){var f=$t,m=vr();if(Gt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),he===null)throw Error(n(349));30&Ni||yd(f,o,c)}m.memoizedState=c;var _={value:c,getSnapshot:o};return m.queue=_,wd(_d.bind(null,f,_,a),[a]),f.flags|=2048,cn(9,vd.bind(null,f,_,c,o),void 0,null),c},useId:function(){var a=vr(),o=he.identifierPrefix;if(Gt){var c=Hr;o=":"+o+"R"+(c=(mr&~(1<<32-Ze(mr)-1)).toString(32)+c),0<(c=hn++)&&(o+="H"+c.toString(32)),o+=":"}else o=":"+o+"r"+(c=C0++).toString(32)+":";return a.memoizedState=o},unstable_isNewReconciler:!1},D0={readContext:We,useCallback:Pd,useContext:We,useEffect:Ql,useImperativeHandle:Id,useInsertionEffect:Sd,useLayoutEffect:Ad,useMemo:Rd,useReducer:ql,useRef:Td,useState:function(){return ql(un)},useDebugValue:Zl,useDeferredValue:function(a){return Md(Xe(),oe.memoizedState,a)},useTransition:function(){return[ql(un)[0],Xe().memoizedState]},useMutableSource:md,useSyncExternalStore:gd,useId:Dd,unstable_isNewReconciler:!1},B0={readContext:We,useCallback:Pd,useContext:We,useEffect:Ql,useImperativeHandle:Id,useInsertionEffect:Sd,useLayoutEffect:Ad,useMemo:Rd,useReducer:Kl,useRef:Td,useState:function(){return Kl(un)},useDebugValue:Zl,useDeferredValue:function(a){var o=Xe();return oe===null?o.memoizedState=a:Md(o,oe.memoizedState,a)},useTransition:function(){return[Kl(un)[0],Xe().memoizedState]},useMutableSource:md,useSyncExternalStore:gd,useId:Dd,unstable_isNewReconciler:!1};function gs(a,o){try{var c="",f=o;do c+=A0(f),f=f.return;while(f);var m=c}catch(_){m=`
Error generating stack: `+_.message+`
`+_.stack}return{value:a,source:o,stack:m,digest:null}}function Jl(a,o,c){return{value:a,source:null,stack:c??null,digest:o??null}}function th(a,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var F0=typeof WeakMap=="function"?WeakMap:Map;function Od(a,o,c){(c=zr(-1,c)).tag=3,c.payload={element:null};var f=o.value;return c.callback=function(){Ba||(Ba=!0,_h=f),th(0,o)},c}function kd(a,o,c){(c=zr(-1,c)).tag=3;var f=a.type.getDerivedStateFromError;if(typeof f=="function"){var m=o.value;c.payload=function(){return f(m)},c.callback=function(){th(0,o)}}var _=a.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(c.callback=function(){th(0,o),typeof f!="function"&&(li===null?li=new Set([this]):li.add(this));var E=o.stack;this.componentDidCatch(o.value,{componentStack:E!==null?E:""})}),c}function Ld(a,o,c){var f=a.pingCache;if(f===null){f=a.pingCache=new F0;var m=new Set;f.set(o,m)}else(m=f.get(o))===void 0&&(m=new Set,f.set(o,m));m.has(c)||(m.add(c),a=$0.bind(null,a,o,c),o.then(a,a))}function Ud(a){do{var o;if((o=a.tag===13)&&(o=(o=a.memoizedState)===null||o.dehydrated!==null),o)return a;a=a.return}while(a!==null);return null}function Gd(a,o,c,f,m){return 1&a.mode?(a.flags|=65536,a.lanes=m,a):(a===o?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:((o=zr(-1,1)).tag=2,ai(c,o,1))),c.lanes|=1),a)}var N0=l.ReactCurrentOwner,Ie=!1;function Pe(a,o,c,f){o.child=a===null?fd(o,null,c,f):fs(o,a.child,c,f)}function Hd(a,o,c,f,m){c=c.render;var _=o.ref;return ds(o,m),f=Vl(a,o,c,f,_,m),c=Yl(),a===null||Ie?(Gt&&c&&Il(o),o.flags|=1,Pe(a,o,f,m),o.child):(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~m,$r(a,o,m))}function zd(a,o,c,f,m){if(a===null){var _=c.type;return typeof _!="function"||Sh(_)||_.defaultProps!==void 0||c.compare!==null||c.defaultProps!==void 0?((a=Ua(c.type,null,f,o,o.mode,m)).ref=o.ref,a.return=o,o.child=a):(o.tag=15,o.type=_,$d(a,o,_,f,m))}if(_=a.child,(a.lanes&m)==0){var E=_.memoizedProps;if((c=(c=c.compare)!==null?c:oa)(E,f)&&a.ref===o.ref)return $r(a,o,m)}return o.flags|=1,(a=di(_,f)).ref=o.ref,a.return=o,o.child=a}function $d(a,o,c,f,m){if(a!==null){var _=a.memoizedProps;if(oa(_,f)&&a.ref===o.ref){if(Ie=!1,o.pendingProps=f=_,(a.lanes&m)==0)return o.lanes=a.lanes,$r(a,o,m);131072&a.flags&&(Ie=!0)}}return eh(a,o,c,f,m)}function Wd(a,o,c){var f=o.pendingProps,m=f.children,_=a!==null?a.memoizedState:null;if(f.mode==="hidden")if(!(1&o.mode))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ft(vs,Ne),Ne|=c;else{if(!(1073741824&c))return a=_!==null?_.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:a,cachePool:null,transitions:null},o.updateQueue=null,Ft(vs,Ne),Ne|=a,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=_!==null?_.baseLanes:c,Ft(vs,Ne),Ne|=f}else _!==null?(f=_.baseLanes|c,o.memoizedState=null):f=c,Ft(vs,Ne),Ne|=f;return Pe(a,o,m,c),o.child}function jd(a,o){var c=o.ref;(a===null&&c!==null||a!==null&&a.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function eh(a,o,c,f,m){var _=Be(c)?Mi:ve.current;return _=os(o,_),ds(o,m),c=Vl(a,o,c,f,_,m),f=Yl(),a===null||Ie?(Gt&&f&&Il(o),o.flags|=1,Pe(a,o,c,m),o.child):(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~m,$r(a,o,m))}function Xd(a,o,c,f,m){if(Be(c)){var _=!0;ta(o)}else _=!1;if(ds(o,m),o.stateNode===null)Ta(a,o),hd(o,c,f),Gl(o,c,f,m),f=!0;else if(a===null){var E=o.stateNode,A=o.memoizedProps;E.props=A;var R=E.context,B=c.contextType;typeof B=="object"&&B!==null?B=We(B):B=os(o,B=Be(c)?Mi:ve.current);var L=c.getDerivedStateFromProps,q=typeof L=="function"||typeof E.getSnapshotBeforeUpdate=="function";q||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==f||R!==B)&&ud(o,E,f,B),ni=!1;var O=o.memoizedState;E.state=O,ca(o,f,E,m),R=o.memoizedState,A!==f||O!==R||Ce.current||ni?(typeof L=="function"&&(Ul(o,c,L,f),R=o.memoizedState),(A=ni||ld(o,c,A,f,O,R,B))?(q||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(o.flags|=4194308)):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=R),E.props=f,E.state=R,E.context=B,f=A):(typeof E.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{E=o.stateNode,sd(a,o),A=o.memoizedProps,B=o.type===o.elementType?A:er(o.type,A),E.props=B,q=o.pendingProps,O=E.context,typeof(R=c.contextType)=="object"&&R!==null?R=We(R):R=os(o,R=Be(c)?Mi:ve.current);var j=c.getDerivedStateFromProps;(L=typeof j=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==q||O!==R)&&ud(o,E,f,R),ni=!1,O=o.memoizedState,E.state=O,ca(o,f,E,m);var at=o.memoizedState;A!==q||O!==at||Ce.current||ni?(typeof j=="function"&&(Ul(o,c,j,f),at=o.memoizedState),(B=ni||ld(o,c,B,f,O,at,R)||!1)?(L||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(f,at,R),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(f,at,R)),typeof E.componentDidUpdate=="function"&&(o.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof E.componentDidUpdate!="function"||A===a.memoizedProps&&O===a.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&O===a.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=at),E.props=f,E.state=at,E.context=R,f=B):(typeof E.componentDidUpdate!="function"||A===a.memoizedProps&&O===a.memoizedState||(o.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&O===a.memoizedState||(o.flags|=1024),f=!1)}return rh(a,o,c,f,_,m)}function rh(a,o,c,f,m,_){jd(a,o);var E=(128&o.flags)!=0;if(!f&&!E)return m&&jc(o,c,!1),$r(a,o,_);f=o.stateNode,N0.current=o;var A=E&&typeof c.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,a!==null&&E?(o.child=fs(o,a.child,null,_),o.child=fs(o,null,A,_)):Pe(a,o,A,_),o.memoizedState=f.state,m&&jc(o,c,!0),o.child}function Vd(a){var o=a.stateNode;o.pendingContext?$c(0,o.pendingContext,o.pendingContext!==o.context):o.context&&$c(0,o.context,!1),Hl(a,o.containerInfo)}function Yd(a,o,c,f,m){return us(),Dl(m),o.flags|=256,Pe(a,o,c,f),o.child}var dn,fn,xa,ba,ih={dehydrated:null,treeContext:null,retryLane:0};function sh(a){return{baseLanes:a,cachePool:null,transitions:null}}function qd(a,o,c){var f,m=o.pendingProps,_=Vt.current,E=!1,A=(128&o.flags)!=0;if((f=A)||(f=(a===null||a.memoizedState!==null)&&(2&_)!=0),f?(E=!0,o.flags&=-129):a!==null&&a.memoizedState===null||(_|=1),Ft(Vt,1&_),a===null)return Ml(o),(a=o.memoizedState)!==null&&(a=a.dehydrated)!==null?(1&o.mode?ml(a)?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(A=m.children,a=m.fallback,E?(m=o.mode,E=o.child,A={mode:"hidden",children:A},!(1&m)&&E!==null?(E.childLanes=0,E.pendingProps=A):E=Ga(A,m,0,null),a=Ui(a,m,c,null),E.return=o,a.return=o,E.sibling=a,o.child=E,o.child.memoizedState=sh(c),o.memoizedState=ih,a):nh(o,A));if((_=a.memoizedState)!==null&&(f=_.dehydrated)!==null)return function(B,L,q,O,j,at,vt){if(q)return 256&L.flags?(L.flags&=-257,Ea(B,L,vt,O=Jl(Error(n(422))))):L.memoizedState!==null?(L.child=B.child,L.flags|=128,null):(at=O.fallback,j=L.mode,O=Ga({mode:"visible",children:O.children},j,0,null),(at=Ui(at,j,vt,null)).flags|=2,O.return=L,at.return=L,O.sibling=at,L.child=O,1&L.mode&&fs(L,B.child,null,vt),L.child.memoizedState=sh(vt),L.memoizedState=ih,at);if(!(1&L.mode))return Ea(B,L,vt,null);if(ml(j))return O=e0(j).digest,at=Error(n(419)),O=Jl(at,O,void 0),Ea(B,L,vt,O);if(q=(vt&B.childLanes)!=0,Ie||q){if((O=he)!==null){switch(vt&-vt){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}(j=j&(O.suspendedLanes|vt)?0:j)!==0&&j!==at.retryLane&&(at.retryLane=j,gr(B,j),Ve(O,B,j,-1))}return wh(),Ea(B,L,vt,O=Jl(Error(n(421))))}return zc(j)?(L.flags|=128,L.child=B.child,L=W0.bind(null,B),r0(j,L),null):(B=at.treeContext,At&&($e=n0(j),Fe=L,Gt=!0,tr=null,sn=!1,B!==null&&(He[ze++]=mr,He[ze++]=Hr,He[ze++]=Di,mr=B.id,Hr=B.overflow,Di=L)),L=nh(L,O.children),L.flags|=4096,L)}(a,o,A,m,f,_,c);if(E){E=m.fallback,A=o.mode,f=(_=a.child).sibling;var R={mode:"hidden",children:m.children};return!(1&A)&&o.child!==_?((m=o.child).childLanes=0,m.pendingProps=R,o.deletions=null):(m=di(_,R)).subtreeFlags=14680064&_.subtreeFlags,f!==null?E=di(f,E):(E=Ui(E,A,c,null)).flags|=2,E.return=o,m.return=o,m.sibling=E,o.child=m,m=E,E=o.child,A=(A=a.child.memoizedState)===null?sh(c):{baseLanes:A.baseLanes|c,cachePool:null,transitions:A.transitions},E.memoizedState=A,E.childLanes=a.childLanes&~c,o.memoizedState=ih,m}return a=(E=a.child).sibling,m=di(E,{mode:"visible",children:m.children}),!(1&o.mode)&&(m.lanes=c),m.return=o,m.sibling=null,a!==null&&((c=o.deletions)===null?(o.deletions=[a],o.flags|=16):c.push(a)),o.child=m,o.memoizedState=null,m}function nh(a,o){return(o=Ga({mode:"visible",children:o},a.mode,0,null)).return=a,a.child=o}function Ea(a,o,c,f){return f!==null&&Dl(f),fs(o,a.child,null,c),(a=nh(o,o.pendingProps.children)).flags|=2,o.memoizedState=null,a}function Kd(a,o,c){a.lanes|=o;var f=a.alternate;f!==null&&(f.lanes|=o),Ol(a.return,o,c)}function ah(a,o,c,f,m){var _=a.memoizedState;_===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=f,_.tail=c,_.tailMode=m)}function Qd(a,o,c){var f=o.pendingProps,m=f.revealOrder,_=f.tail;if(Pe(a,o,f.children,c),(2&(f=Vt.current))!=0)f=1&f|2,o.flags|=128;else{if(a!==null&&128&a.flags)t:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Kd(a,c,o);else if(a.tag===19)Kd(a,c,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break t;for(;a.sibling===null;){if(a.return===null||a.return===o)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}if(Ft(Vt,f),(1&o.mode)==0)o.memoizedState=null;else switch(m){case"forwards":for(c=o.child,m=null;c!==null;)(a=c.alternate)!==null&&pa(a)===null&&(m=c),c=c.sibling;(c=m)===null?(m=o.child,o.child=null):(m=c.sibling,c.sibling=null),ah(o,!1,m,c,_);break;case"backwards":for(c=null,m=o.child,o.child=null;m!==null;){if((a=m.alternate)!==null&&pa(a)===null){o.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}ah(o,!0,c,null,_);break;case"together":ah(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ta(a,o){!(1&o.mode)&&a!==null&&(a.alternate=null,o.alternate=null,o.flags|=2)}function $r(a,o,c){if(a!==null&&(o.dependencies=a.dependencies),Oi|=o.lanes,(c&o.childLanes)==0)return null;if(a!==null&&o.child!==a.child)throw Error(n(153));if(o.child!==null){for(c=di(a=o.child,a.pendingProps),o.child=c,c.return=o;a.sibling!==null;)a=a.sibling,(c=c.sibling=di(a,a.pendingProps)).return=o;c.sibling=null}return o.child}function _r(a){a.flags|=4}function Zd(a,o){if(a!==null&&a.child===o.child)return!0;if(16&o.flags)return!1;for(a=o.child;a!==null;){if(12854&a.flags||12854&a.subtreeFlags)return!1;a=a.sibling}return!0}if(xt)dn=function(a,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)ct(a,c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},fn=function(){},xa=function(a,o,c,f,m){if((a=a.memoizedProps)!==f){var _=o.stateNode,E=yr(je.current);c=_t(_,c,a,f,m,E),(o.updateQueue=c)&&_r(o)}},ba=function(a,o,c,f){c!==f&&_r(o)};else if(Ot){dn=function(a,o,c,f){for(var m=o.child;m!==null;){if(m.tag===5){var _=m.stateNode;c&&f&&(_=Gc(_,m.type,m.memoizedProps,m)),ct(a,_)}else if(m.tag===6)_=m.stateNode,c&&f&&(_=Hc(_,m.memoizedProps,m)),ct(a,_);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)(_=m.child)!==null&&(_.return=m),dn(a,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};var Jd=function(a,o,c,f){for(var m=o.child;m!==null;){if(m.tag===5){var _=m.stateNode;c&&f&&(_=Gc(_,m.type,m.memoizedProps,m)),Uc(a,_)}else if(m.tag===6)_=m.stateNode,c&&f&&(_=Hc(_,m.memoizedProps,m)),Uc(a,_);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)(_=m.child)!==null&&(_.return=m),Jd(a,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};fn=function(a,o){var c=o.stateNode;if(!Zd(a,o)){a=c.containerInfo;var f=Lc(a);Jd(f,o,!1,!1),c.pendingChildren=f,_r(o),Qy(a,f)}},xa=function(a,o,c,f,m){var _=a.stateNode,E=a.memoizedProps;if((a=Zd(a,o))&&E===f)o.stateNode=_;else{var A=o.stateNode,R=yr(je.current),B=null;E!==f&&(B=_t(A,c,E,f,m,R)),a&&B===null?o.stateNode=_:(_=Ky(_,B,c,E,f,o,a,A),Et(_,c,f,m,R)&&_r(o),o.stateNode=_,a?_r(o):dn(_,o,!1,!1))}},ba=function(a,o,c,f){c!==f?(a=yr(ps.current),c=yr(je.current),o.stateNode=Pt(f,a,c,o),_r(o)):o.stateNode=a.stateNode}}else fn=function(){},xa=function(){},ba=function(){};function pn(a,o){if(!Gt)switch(a.tailMode){case"hidden":o=a.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Te(a){var o=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(o)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=14680064&m.subtreeFlags,f|=14680064&m.flags,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,o}function O0(a,o,c){var f=o.pendingProps;switch(Pl(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Te(o),null;case 1:case 17:return Be(o.type)&&_l(),Te(o),null;case 3:return c=o.stateNode,ms(),Ut(Ce),Ut(ve),Wl(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),a!==null&&a.child!==null||(aa(o)?_r(o):a===null||a.memoizedState.isDehydrated&&!(256&o.flags)||(o.flags|=1024,tr!==null&&(Eh(tr),tr=null))),fn(a,o),Te(o),null;case 5:zl(o),c=yr(ps.current);var m=o.type;if(a!==null&&o.stateNode!=null)xa(a,o,m,f,c),a.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(n(166));return Te(o),null}if(a=yr(je.current),aa(o)){if(!At)throw Error(n(175));a=a0(o.stateNode,o.type,o.memoizedProps,c,a,o,!sn),o.updateQueue=a,a!==null&&_r(o)}else{var _=H(m,f,c,a,o);dn(_,o,!1,!1),o.stateNode=_,Et(_,m,f,c,a)&&_r(o)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Te(o),null;case 6:if(a&&o.stateNode!=null)ba(a,o,a.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(a=yr(ps.current),c=yr(je.current),aa(o)){if(!At)throw Error(n(176));if(a=o.stateNode,c=o.memoizedProps,(f=o0(a,c,o,!sn))&&(m=Fe)!==null)switch(m.tag){case 3:m0(m.stateNode.containerInfo,a,c,(1&m.mode)!=0);break;case 5:g0(m.type,m.memoizedProps,m.stateNode,a,c,(1&m.mode)!=0)}f&&_r(o)}else o.stateNode=Pt(f,a,c,o)}return Te(o),null;case 13:if(Ut(Vt),f=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Gt&&$e!==null&&1&o.mode&&!(128&o.flags))ed(),us(),o.flags|=98560,m=!1;else if(m=aa(o),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(!At)throw Error(n(344));if(!(m=(m=o.memoizedState)!==null?m.dehydrated:null))throw Error(n(317));l0(m,o)}else us(),!(128&o.flags)&&(o.memoizedState=null),o.flags|=4;Te(o),m=!1}else tr!==null&&(Eh(tr),tr=null),m=!0;if(!m)return 65536&o.flags?o:null}return 128&o.flags?(o.lanes=c,o):((c=f!==null)!=(a!==null&&a.memoizedState!==null)&&c&&(o.child.flags|=8192,1&o.mode&&(a===null||1&Vt.current?ee===0&&(ee=3):wh())),o.updateQueue!==null&&(o.flags|=4),Te(o),null);case 4:return ms(),fn(a,o),a===null&&Ge(o.stateNode.containerInfo),Te(o),null;case 10:return Nl(o.type._context),Te(o),null;case 19:if(Ut(Vt),(m=o.memoizedState)===null)return Te(o),null;if(f=(128&o.flags)!=0,(_=m.rendering)===null)if(f)pn(m,!1);else{if(ee!==0||a!==null&&128&a.flags)for(a=o.child;a!==null;){if((_=pa(a))!==null){for(o.flags|=128,pn(m,!1),(a=_.updateQueue)!==null&&(o.updateQueue=a,o.flags|=4),o.subtreeFlags=0,a=c,c=o.child;c!==null;)m=a,(f=c).flags&=14680066,(_=f.alternate)===null?(f.childLanes=0,f.lanes=m,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=_.childLanes,f.lanes=_.lanes,f.child=_.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=_.memoizedProps,f.memoizedState=_.memoizedState,f.updateQueue=_.updateQueue,f.type=_.type,m=_.dependencies,f.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),c=c.sibling;return Ft(Vt,1&Vt.current|2),o.child}a=a.sibling}m.tail!==null&&ae()>vh&&(o.flags|=128,f=!0,pn(m,!1),o.lanes=4194304)}else{if(!f)if((a=pa(_))!==null){if(o.flags|=128,f=!0,(a=a.updateQueue)!==null&&(o.updateQueue=a,o.flags|=4),pn(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!Gt)return Te(o),null}else 2*ae()-m.renderingStartTime>vh&&c!==1073741824&&(o.flags|=128,f=!0,pn(m,!1),o.lanes=4194304);m.isBackwards?(_.sibling=o.child,o.child=_):((a=m.last)!==null?a.sibling=_:o.child=_,m.last=_)}return m.tail!==null?(o=m.tail,m.rendering=o,m.tail=o.sibling,m.renderingStartTime=ae(),o.sibling=null,a=Vt.current,Ft(Vt,f?1&a|2:1&a),o):(Te(o),null);case 22:case 23:return Th(),c=o.memoizedState!==null,a!==null&&a.memoizedState!==null!==c&&(o.flags|=8192),c&&1&o.mode?1073741824&Ne&&(Te(o),xt&&6&o.subtreeFlags&&(o.flags|=8192)):Te(o),null;case 24:case 25:return null}throw Error(n(156,o.tag))}function k0(a,o){switch(Pl(o),o.tag){case 1:return Be(o.type)&&_l(),65536&(a=o.flags)?(o.flags=-65537&a|128,o):null;case 3:return ms(),Ut(Ce),Ut(ve),Wl(),65536&(a=o.flags)&&!(128&a)?(o.flags=-65537&a|128,o):null;case 5:return zl(o),null;case 13:if(Ut(Vt),(a=o.memoizedState)!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(n(340));us()}return 65536&(a=o.flags)?(o.flags=-65537&a|128,o):null;case 19:return Ut(Vt),null;case 4:return ms(),null;case 10:return Nl(o.type._context),null;case 22:case 23:return Th(),null;default:return null}}var wa=!1,xe=!1,L0=typeof WeakSet=="function"?WeakSet:Set,st=null;function ys(a,o){var c=a.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(f){Ht(a,o,f)}else c.current=null}function tf(a,o,c){try{c()}catch(f){Ht(a,o,f)}}var ef=!1;function mn(a,o,c){var f=o.updateQueue;if((f=f!==null?f.lastEffect:null)!==null){var m=f=f.next;do{if((m.tag&a)===a){var _=m.destroy;m.destroy=void 0,_!==void 0&&tf(o,c,_)}m=m.next}while(m!==f)}}function Sa(a,o){if((o=(o=o.updateQueue)!==null?o.lastEffect:null)!==null){var c=o=o.next;do{if((c.tag&a)===a){var f=c.create;c.destroy=f()}c=c.next}while(c!==o)}}function oh(a){var o=a.ref;if(o!==null){var c=a.stateNode;a.tag===5?a=ft(c):a=c,typeof o=="function"?o(a):o.current=a}}function rf(a){var o=a.alternate;o!==null&&(a.alternate=null,rf(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode)!==null&&fl(o),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function sf(a){return a.tag===5||a.tag===3||a.tag===4}function nf(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||sf(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(2&a.flags||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(2&a.flags))return a.stateNode}}function lh(a,o,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?zy(c,a,o):ky(c,a);else if(f!==4&&(a=a.child)!==null)for(lh(a,o,c),a=a.sibling;a!==null;)lh(a,o,c),a=a.sibling}function hh(a,o,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?Hy(c,a,o):Oy(c,a);else if(f!==4&&(a=a.child)!==null)for(hh(a,o,c),a=a.sibling;a!==null;)hh(a,o,c),a=a.sibling}var we=null,xr=!1;function br(a,o,c){for(c=c.child;c!==null;)uh(a,o,c),c=c.sibling}function uh(a,o,c){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(ra,c)}catch{}switch(c.tag){case 5:xe||ys(c,o);case 6:if(xt){var f=we,m=xr;we=null,br(a,o,c),xr=m,(we=f)!==null&&(xr?Wy(we,c.stateNode):$y(we,c.stateNode))}else br(a,o,c);break;case 18:xt&&we!==null&&(xr?f0(we,c.stateNode):d0(we,c.stateNode));break;case 4:xt?(f=we,m=xr,we=c.stateNode.containerInfo,xr=!0,br(a,o,c),we=f,xr=m):(Ot&&(f=c.stateNode.containerInfo,m=Lc(f),pl(f,m)),br(a,o,c));break;case 0:case 11:case 14:case 15:if(!xe&&(f=c.updateQueue)!==null&&(f=f.lastEffect)!==null){m=f=f.next;do{var _=m,E=_.destroy;_=_.tag,E!==void 0&&(2&_||4&_)&&tf(c,o,E),m=m.next}while(m!==f)}br(a,o,c);break;case 1:if(!xe&&(ys(c,o),typeof(f=c.stateNode).componentWillUnmount=="function"))try{f.props=c.memoizedProps,f.state=c.memoizedState,f.componentWillUnmount()}catch(A){Ht(c,o,A)}br(a,o,c);break;case 21:br(a,o,c);break;case 22:1&c.mode?(xe=(f=xe)||c.memoizedState!==null,br(a,o,c),xe=f):br(a,o,c);break;default:br(a,o,c)}}function af(a){var o=a.updateQueue;if(o!==null){a.updateQueue=null;var c=a.stateNode;c===null&&(c=a.stateNode=new L0),o.forEach(function(f){var m=j0.bind(null,a,f);c.has(f)||(c.add(f),f.then(m,m))})}}function rr(a,o){var c=o.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];try{var _=a,E=o;if(xt){var A=E;t:for(;A!==null;){switch(A.tag){case 5:we=A.stateNode,xr=!1;break t;case 3:case 4:we=A.stateNode.containerInfo,xr=!0;break t}A=A.return}if(we===null)throw Error(n(160));uh(_,E,m),we=null,xr=!1}else uh(_,E,m);var R=m.alternate;R!==null&&(R.return=null),m.return=null}catch(B){Ht(m,o,B)}}if(12854&o.subtreeFlags)for(o=o.child;o!==null;)of(o,a),o=o.sibling}function of(a,o){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(rr(o,a),Er(a),4&f){try{mn(3,a,a.return),Sa(3,a)}catch(O){Ht(a,a.return,O)}try{mn(5,a,a.return)}catch(O){Ht(a,a.return,O)}}break;case 1:rr(o,a),Er(a),512&f&&c!==null&&ys(c,c.return);break;case 5:if(rr(o,a),Er(a),512&f&&c!==null&&ys(c,c.return),xt){if(32&a.flags){var m=a.stateNode;try{kc(m)}catch(O){Ht(a,a.return,O)}}if(4&f&&(m=a.stateNode)!=null){var _=a.memoizedProps;if(c=c!==null?c.memoizedProps:_,f=a.type,o=a.updateQueue,a.updateQueue=null,o!==null)try{Gy(m,o,f,c,_,a)}catch(O){Ht(a,a.return,O)}}}break;case 6:if(rr(o,a),Er(a),4&f&&xt){if(a.stateNode===null)throw Error(n(162));m=a.stateNode,_=a.memoizedProps,c=c!==null?c.memoizedProps:_;try{Ly(m,c,_)}catch(O){Ht(a,a.return,O)}}break;case 3:if(rr(o,a),Er(a),4&f){if(xt&&At&&c!==null&&c.memoizedState.isDehydrated)try{u0(o.containerInfo)}catch(O){Ht(a,a.return,O)}if(Ot){m=o.containerInfo,_=o.pendingChildren;try{pl(m,_)}catch(O){Ht(a,a.return,O)}}}break;case 4:if(rr(o,a),Er(a),4&f&&Ot){m=(_=a.stateNode).containerInfo,_=_.pendingChildren;try{pl(m,_)}catch(O){Ht(a,a.return,O)}}break;case 13:rr(o,a),Er(a),8192&(m=a.child).flags&&(_=m.memoizedState!==null,m.stateNode.isHidden=_,!_||m.alternate!==null&&m.alternate.memoizedState!==null||(yh=ae())),4&f&&af(a);break;case 22:var E=c!==null&&c.memoizedState!==null;if(1&a.mode?(xe=(c=xe)||E,rr(o,a),xe=c):rr(o,a),Er(a),8192&f){if(c=a.memoizedState!==null,(a.stateNode.isHidden=c)&&!E&&(1&a.mode)!=0)for(st=a,f=a.child;f!==null;){for(o=st=f;st!==null;){var A=(E=st).child;switch(E.tag){case 0:case 11:case 14:case 15:mn(4,E,E.return);break;case 1:ys(E,E.return);var R=E.stateNode;if(typeof R.componentWillUnmount=="function"){var B=E,L=E.return;try{var q=B;R.props=q.memoizedProps,R.state=q.memoizedState,R.componentWillUnmount()}catch(O){Ht(B,L,O)}}break;case 5:ys(E,E.return);break;case 22:if(E.memoizedState!==null){uf(o);continue}}A!==null?(A.return=E,st=A):uf(o)}f=f.sibling}if(xt){t:if(f=null,xt)for(o=a;;){if(o.tag===5){if(f===null){f=o;try{m=o.stateNode,c?jy(m):Vy(o.stateNode,o.memoizedProps)}catch(O){Ht(a,a.return,O)}}}else if(o.tag===6){if(f===null)try{_=o.stateNode,c?Xy(_):Yy(_,o.memoizedProps)}catch(O){Ht(a,a.return,O)}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break t;for(;o.sibling===null;){if(o.return===null||o.return===a)break t;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}}}break;case 19:rr(o,a),Er(a),4&f&&af(a);break;case 21:break;default:rr(o,a),Er(a)}}function Er(a){var o=a.flags;if(2&o){try{if(xt){t:{for(var c=a.return;c!==null;){if(sf(c)){var f=c;break t}c=c.return}throw Error(n(160))}switch(f.tag){case 5:var m=f.stateNode;32&f.flags&&(kc(m),f.flags&=-33),hh(a,nf(a),m);break;case 3:case 4:var _=f.stateNode.containerInfo;lh(a,nf(a),_);break;default:throw Error(n(161))}}}catch(E){Ht(a,a.return,E)}a.flags&=-3}4096&o&&(a.flags&=-4097)}function U0(a,o,c){st=a,lf(a)}function lf(a,o,c){for(var f=(1&a.mode)!=0;st!==null;){var m=st,_=m.child;if(m.tag===22&&f){var E=m.memoizedState!==null||wa;if(!E){var A=m.alternate,R=A!==null&&A.memoizedState!==null||xe;A=wa;var B=xe;if(wa=E,(xe=R)&&!B)for(st=m;st!==null;)R=(E=st).child,E.tag===22&&E.memoizedState!==null?cf(m):R!==null?(R.return=E,st=R):cf(m);for(;_!==null;)st=_,lf(_),_=_.sibling;st=m,wa=A,xe=B}hf(a)}else 8772&m.subtreeFlags&&_!==null?(_.return=m,st=_):hf(a)}}function hf(a){for(;st!==null;){var o=st;if(8772&o.flags){var c=o.alternate;try{if(8772&o.flags)switch(o.tag){case 0:case 11:case 15:xe||Sa(5,o);break;case 1:var f=o.stateNode;if(4&o.flags&&!xe)if(c===null)f.componentDidMount();else{var m=o.elementType===o.type?c.memoizedProps:er(o.type,c.memoizedProps);f.componentDidUpdate(m,c.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var _=o.updateQueue;_!==null&&ad(o,_,f);break;case 3:var E=o.updateQueue;if(E!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=ft(o.child.stateNode);break;case 1:c=o.child.stateNode}ad(o,E,c)}break;case 5:var A=o.stateNode;c===null&&4&o.flags&&Uy(A,o.type,o.memoizedProps,o);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(At&&o.memoizedState===null){var R=o.alternate;if(R!==null){var B=R.memoizedState;if(B!==null){var L=B.dehydrated;L!==null&&c0(L)}}}break;default:throw Error(n(163))}xe||512&o.flags&&oh(o)}catch(q){Ht(o,o.return,q)}}if(o===a){st=null;break}if((c=o.sibling)!==null){c.return=o.return,st=c;break}st=o.return}}function uf(a){for(;st!==null;){var o=st;if(o===a){st=null;break}var c=o.sibling;if(c!==null){c.return=o.return,st=c;break}st=o.return}}function cf(a){for(;st!==null;){var o=st;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{Sa(4,o)}catch(R){Ht(o,c,R)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var m=o.return;try{f.componentDidMount()}catch(R){Ht(o,m,R)}}var _=o.return;try{oh(o)}catch(R){Ht(o,_,R)}break;case 5:var E=o.return;try{oh(o)}catch(R){Ht(o,E,R)}}}catch(R){Ht(o,o.return,R)}if(o===a){st=null;break}var A=o.sibling;if(A!==null){A.return=o.return,st=A;break}st=o.return}}var Aa=0,Ca=1,Ia=2,Pa=3,Ra=4;if(typeof Symbol=="function"&&Symbol.for){var gn=Symbol.for;Aa=gn("selector.component"),Ca=gn("selector.has_pseudo_class"),Ia=gn("selector.role"),Pa=gn("selector.test_id"),Ra=gn("selector.text")}function ch(a){var o=Ue(a);if(o!=null){if(typeof o.memoizedProps["data-testname"]!="string")throw Error(n(364));return o}if((a=Ry(a))===null)throw Error(n(362));return a.stateNode.current}function dh(a,o){switch(o.$$typeof){case Aa:if(a.type===o.value)return!0;break;case Ca:t:{o=o.value,a=[a,0];for(var c=0;c<a.length;){var f=a[c++],m=a[c++],_=o[m];if(f.tag!==5||!Js(f)){for(;_!=null&&dh(f,_);)_=o[++m];if(m===o.length){o=!0;break t}for(f=f.child;f!==null;)a.push(f,m),f=f.sibling}}o=!1}return o;case Ia:if(a.tag===5&&By(a.stateNode,o.value))return!0;break;case Ra:if((a.tag===5||a.tag===6)&&(a=Dy(a))!==null&&0<=a.indexOf(o.value))return!0;break;case Pa:if(a.tag===5&&typeof(a=a.memoizedProps["data-testname"])=="string"&&a.toLowerCase()===o.value.toLowerCase())return!0;break;default:throw Error(n(365))}return!1}function fh(a){switch(a.$$typeof){case Aa:return"<"+(V(a.value)||"Unknown")+">";case Ca:return":has("+(fh(a)||"")+")";case Ia:return'[role="'+a.value+'"]';case Ra:return'"'+a.value+'"';case Pa:return'[data-testname="'+a.value+'"]';default:throw Error(n(365))}}function df(a,o){var c=[];a=[a,0];for(var f=0;f<a.length;){var m=a[f++],_=a[f++],E=o[_];if(m.tag!==5||!Js(m)){for(;E!=null&&dh(m,E);)E=o[++_];if(_===o.length)c.push(m);else for(m=m.child;m!==null;)a.push(m,_),m=m.sibling}}return c}function ph(a,o){if(!Zs)throw Error(n(363));a=df(a=ch(a),o),o=[],a=Array.from(a);for(var c=0;c<a.length;){var f=a[c++];if(f.tag===5)Js(f)||o.push(f.stateNode);else for(f=f.child;f!==null;)a.push(f),f=f.sibling}return o}var G0=Math.ceil,Ma=l.ReactCurrentDispatcher,mh=l.ReactCurrentOwner,qt=l.ReactCurrentBatchConfig,St=0,he=null,Jt=null,pe=0,Ne=0,vs=ii(0),ee=0,yn=null,Oi=0,Da=0,gh=0,vn=null,Oe=null,yh=0,vh=1/0,oi=null;function _s(){vh=ae()+500}var ff,Ba=!1,_h=null,li=null,Fa=!1,hi=null,Na=0,_n=0,xh=null,Oa=-1,ka=0;function be(){return 6&St?ae():Oa!==-1?Oa:Oa=ae()}function ui(a){return 1&a.mode?2&St&&pe!==0?pe&-pe:S0.transition!==null?(ka===0&&(ka=Xc()),ka):(a=Ct)!==0?a:Ri():1}function Ve(a,o,c,f){if(50<_n)throw _n=0,xh=null,Error(n(185));rn(a,c,f),2&St&&a===he||(a===he&&(!(2&St)&&(Da|=c),ee===4&&ci(a,pe)),Re(a,f),c===1&&St===0&&!(1&o.mode)&&(_s(),ia&&pr()))}function Re(a,o){var c=a.callbackNode;(function(m,_){for(var E=m.suspendedLanes,A=m.pingedLanes,R=m.expirationTimes,B=m.pendingLanes;0<B;){var L=31-Ze(B),q=1<<L,O=R[L];O===-1?q&E&&!(q&A)||(R[L]=x0(q,_)):O<=_&&(m.expiredLanes|=q),B&=~q}})(a,o);var f=ea(a,a===he?pe:0);if(f===0)c!==null&&Yc(c),a.callbackNode=null,a.callbackPriority=0;else if(o=f&-f,a.callbackPriority!==o){if(c!=null&&Yc(c),o===1)a.tag===0?function(m){ia=!0,Kc(m)}(mf.bind(null,a)):Kc(mf.bind(null,a)),ns?Py(function(){!(6&St)&&pr()}):Sl(Al,pr),c=null;else{switch(Vc(f)){case 1:c=Al;break;case 4:c=T0;break;case 16:default:c=qc;break;case 536870912:c=w0}c=Tf(c,pf.bind(null,a))}a.callbackPriority=o,a.callbackNode=c}}function pf(a,o){if(Oa=-1,ka=0,(6&St)!=0)throw Error(n(327));var c=a.callbackNode;if(Li()&&a.callbackNode!==c)return null;var f=ea(a,a===he?pe:0);if(f===0)return null;if(30&f||f&a.expiredLanes||o)o=La(a,f);else{o=f;var m=St;St|=2;var _=vf();for(he===a&&pe===o||(oi=null,_s(),ki(a,o));;)try{z0();break}catch(A){yf(a,A)}Fl(),Ma.current=_,St=m,Jt!==null?o=0:(he=null,pe=0,o=ee)}if(o!==0){if(o===2&&(m=El(a))!==0&&(f=m,o=bh(a,m)),o===1)throw c=yn,ki(a,0),ci(a,f),Re(a,ae()),c;if(o===6)ci(a,f);else{if(m=a.current.alternate,(30&f)==0&&!function(A){for(var R=A;;){if(16384&R.flags){var B=R.updateQueue;if(B!==null&&(B=B.stores)!==null)for(var L=0;L<B.length;L++){var q=B[L],O=q.getSnapshot;q=q.value;try{if(!Je(O(),q))return!1}catch{return!1}}}if(B=R.child,16384&R.subtreeFlags&&B!==null)B.return=R,R=B;else{if(R===A)break;for(;R.sibling===null;){if(R.return===null||R.return===A)return!0;R=R.return}R.sibling.return=R.return,R=R.sibling}}return!0}(m)&&((o=La(a,f))===2&&(_=El(a))!==0&&(f=_,o=bh(a,_)),o===1))throw c=yn,ki(a,0),ci(a,f),Re(a,ae()),c;switch(a.finishedWork=m,a.finishedLanes=f,o){case 0:case 1:throw Error(n(345));case 2:case 5:xs(a,Oe,oi);break;case 3:if(ci(a,f),(130023424&f)===f&&10<(o=yh+500-ae())){if(ea(a,0)!==0)break;if(((m=a.suspendedLanes)&f)!==f){be(),a.pingedLanes|=a.suspendedLanes&m;break}a.timeoutHandle=Bt(xs.bind(null,a,Oe,oi),o);break}xs(a,Oe,oi);break;case 4:if(ci(a,f),(4194240&f)===f)break;for(o=a.eventTimes,m=-1;0<f;){var E=31-Ze(f);_=1<<E,(E=o[E])>m&&(m=E),f&=~_}if(f=m,10<(f=(120>(f=ae()-f)?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*G0(f/1960))-f)){a.timeoutHandle=Bt(xs.bind(null,a,Oe,oi),f);break}xs(a,Oe,oi);break;default:throw Error(n(329))}}}return Re(a,ae()),a.callbackNode===c?pf.bind(null,a):null}function bh(a,o){var c=vn;return a.current.memoizedState.isDehydrated&&(ki(a,o).flags|=256),(a=La(a,o))!==2&&(o=Oe,Oe=c,o!==null&&Eh(o)),a}function Eh(a){Oe===null?Oe=a:Oe.push.apply(Oe,a)}function ci(a,o){for(o&=~gh,o&=~Da,a.suspendedLanes|=o,a.pingedLanes&=~o,a=a.expirationTimes;0<o;){var c=31-Ze(o),f=1<<c;a[c]=-1,o&=~f}}function mf(a){if(6&St)throw Error(n(327));Li();var o=ea(a,0);if(!(1&o))return Re(a,ae()),null;var c=La(a,o);if(a.tag!==0&&c===2){var f=El(a);f!==0&&(o=f,c=bh(a,f))}if(c===1)throw c=yn,ki(a,0),ci(a,o),Re(a,ae()),c;if(c===6)throw Error(n(345));return a.finishedWork=a.current.alternate,a.finishedLanes=o,xs(a,Oe,oi),Re(a,ae()),null}function gf(a){hi!==null&&hi.tag===0&&!(6&St)&&Li();var o=St;St|=1;var c=qt.transition,f=Ct;try{if(qt.transition=null,Ct=1,a)return a()}finally{Ct=f,qt.transition=c,!(6&(St=o))&&pr()}}function Th(){Ne=vs.current,Ut(vs)}function ki(a,o){a.finishedWork=null,a.finishedLanes=0;var c=a.timeoutHandle;if(c!==fe&&(a.timeoutHandle=fe,ne(c)),Jt!==null)for(c=Jt.return;c!==null;){var f=c;switch(Pl(f),f.tag){case 1:(f=f.type.childContextTypes)!=null&&_l();break;case 3:ms(),Ut(Ce),Ut(ve),Wl();break;case 5:zl(f);break;case 4:ms();break;case 13:case 19:Ut(Vt);break;case 10:Nl(f.type._context);break;case 22:case 23:Th()}c=c.return}if(he=a,Jt=a=di(a.current,null),pe=Ne=o,ee=0,yn=null,gh=Da=Oi=0,Oe=vn=null,Fi!==null){for(o=0;o<Fi.length;o++)if((f=(c=Fi[o]).interleaved)!==null){c.interleaved=null;var m=f.next,_=c.pending;if(_!==null){var E=_.next;_.next=m,f.next=E}c.pending=f}Fi=null}return a}function yf(a,o){for(;;){var c=Jt;try{if(Fl(),ma.current=_a,ga){for(var f=$t.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}ga=!1}if(Ni=0,le=oe=$t=null,ln=!1,hn=0,mh.current=null,c===null||c.return===null){ee=1,yn=o,Jt=null;break}t:{var _=a,E=c.return,A=c,R=o;if(o=pe,A.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var B=R,L=A,q=L.tag;if(!(1&L.mode)&&(q===0||q===11||q===15)){var O=L.alternate;O?(L.updateQueue=O.updateQueue,L.memoizedState=O.memoizedState,L.lanes=O.lanes):(L.updateQueue=null,L.memoizedState=null)}var j=Ud(E);if(j!==null){j.flags&=-257,Gd(j,E,A,0,o),1&j.mode&&Ld(_,B,o),R=B;var at=(o=j).updateQueue;if(at===null){var vt=new Set;vt.add(R),o.updateQueue=vt}else at.add(R);break t}if(!(1&o)){Ld(_,B,o),wh();break t}R=Error(n(426))}else if(Gt&&1&A.mode){var U=Ud(E);if(U!==null){!(65536&U.flags)&&(U.flags|=256),Gd(U,E,A,0,o),Dl(gs(R,A));break t}}_=R=gs(R,A),ee!==4&&(ee=2),vn===null?vn=[_]:vn.push(_),_=E;do{switch(_.tag){case 3:_.flags|=65536,o&=-o,_.lanes|=o,nd(_,Od(0,R,o));break t;case 1:A=R;var P=_.type,D=_.stateNode;if(!(128&_.flags)&&(typeof P.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(li===null||!li.has(D)))){_.flags|=65536,o&=-o,_.lanes|=o,nd(_,kd(_,A,o));break t}}_=_.return}while(_!==null)}xf(c)}catch($){o=$,Jt===c&&c!==null&&(Jt=c=c.return);continue}break}}function vf(){var a=Ma.current;return Ma.current=_a,a===null?_a:a}function wh(){ee!==0&&ee!==3&&ee!==2||(ee=4),he===null||!(268435455&Oi)&&!(268435455&Da)||ci(he,pe)}function La(a,o){var c=St;St|=2;var f=vf();for(he===a&&pe===o||(oi=null,ki(a,o));;)try{H0();break}catch(m){yf(a,m)}if(Fl(),St=c,Ma.current=f,Jt!==null)throw Error(n(261));return he=null,pe=0,ee}function H0(){for(;Jt!==null;)_f(Jt)}function z0(){for(;Jt!==null&&!b0();)_f(Jt)}function _f(a){var o=ff(a.alternate,a,Ne);a.memoizedProps=a.pendingProps,o===null?xf(a):Jt=o,mh.current=null}function xf(a){var o=a;do{var c=o.alternate;if(a=o.return,(32768&o.flags)==0){if((c=O0(c,o,Ne))!==null)return void(Jt=c)}else{if((c=k0(c,o))!==null)return c.flags&=32767,void(Jt=c);if(a===null)return ee=6,void(Jt=null);a.flags|=32768,a.subtreeFlags=0,a.deletions=null}if((o=o.sibling)!==null)return void(Jt=o);Jt=o=a}while(o!==null);ee===0&&(ee=5)}function xs(a,o,c){var f=Ct,m=qt.transition;try{qt.transition=null,Ct=1,function(_,E,A,R){do Li();while(hi!==null);if(6&St)throw Error(n(327));A=_.finishedWork;var B=_.finishedLanes;if(A===null)return null;if(_.finishedWork=null,_.finishedLanes=0,A===_.current)throw Error(n(177));_.callbackNode=null,_.callbackPriority=0;var L=A.lanes|A.childLanes;if(function(j,at){var vt=j.pendingLanes&~at;j.pendingLanes=at,j.suspendedLanes=0,j.pingedLanes=0,j.expiredLanes&=at,j.mutableReadLanes&=at,j.entangledLanes&=at,at=j.entanglements;var U=j.eventTimes;for(j=j.expirationTimes;0<vt;){var P=31-Ze(vt),D=1<<P;at[P]=0,U[P]=-1,j[P]=-1,vt&=~D}}(_,L),_===he&&(Jt=he=null,pe=0),!(2064&A.subtreeFlags)&&!(2064&A.flags)||Fa||(Fa=!0,Tf(qc,function(){return Li(),null})),L=(15990&A.flags)!=0,(15990&A.subtreeFlags)!=0||L){L=qt.transition,qt.transition=null;var q=Ct;Ct=1;var O=St;St|=4,mh.current=null,function(j,at){for(et(j.containerInfo),st=at;st!==null;)if(at=(j=st).child,(1028&j.subtreeFlags)!=0&&at!==null)at.return=j,st=at;else for(;st!==null;){j=st;try{var vt=j.alternate;if(1024&j.flags)switch(j.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(vt!==null){var U=vt.memoizedProps,P=vt.memoizedState,D=j.stateNode,$=D.getSnapshotBeforeUpdate(j.elementType===j.type?U:er(j.type,U),P);D.__reactInternalSnapshotBeforeUpdate=$}break;case 3:xt&&qy(j.stateNode.containerInfo);break;default:throw Error(n(163))}}catch(dt){Ht(j,j.return,dt)}if((at=j.sibling)!==null){at.return=j.return,st=at;break}st=j.return}vt=ef,ef=!1}(_,A),of(A,_),F(_.containerInfo),_.current=A,U0(A),E0(),St=O,Ct=q,qt.transition=L}else _.current=A;if(Fa&&(Fa=!1,hi=_,Na=B),L=_.pendingLanes,L===0&&(li=null),function(j){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(ra,j,void 0,(128&j.current.flags)==128)}catch{}}(A.stateNode),Re(_,ae()),E!==null)for(R=_.onRecoverableError,A=0;A<E.length;A++)B=E[A],R(B.value,{componentStack:B.stack,digest:B.digest});if(Ba)throw Ba=!1,_=_h,_h=null,_;1&Na&&_.tag!==0&&Li(),L=_.pendingLanes,1&L?_===xh?_n++:(_n=0,xh=_):_n=0,pr()}(a,o,c,f)}finally{qt.transition=m,Ct=f}return null}function Li(){if(hi!==null){var a=Vc(Na),o=qt.transition,c=Ct;try{if(qt.transition=null,Ct=16>a?16:a,hi===null)var f=!1;else{if(a=hi,hi=null,Na=0,(6&St)!=0)throw Error(n(331));var m=St;for(St|=4,st=a.current;st!==null;){var _=st,E=_.child;if(16&st.flags){var A=_.deletions;if(A!==null){for(var R=0;R<A.length;R++){var B=A[R];for(st=B;st!==null;){var L=st;switch(L.tag){case 0:case 11:case 15:mn(8,L,_)}var q=L.child;if(q!==null)q.return=L,st=q;else for(;st!==null;){var O=(L=st).sibling,j=L.return;if(rf(L),L===B){st=null;break}if(O!==null){O.return=j,st=O;break}st=j}}}var at=_.alternate;if(at!==null){var vt=at.child;if(vt!==null){at.child=null;do{var U=vt.sibling;vt.sibling=null,vt=U}while(vt!==null)}}st=_}}if(2064&_.subtreeFlags&&E!==null)E.return=_,st=E;else t:for(;st!==null;){if(2048&(_=st).flags)switch(_.tag){case 0:case 11:case 15:mn(9,_,_.return)}var P=_.sibling;if(P!==null){P.return=_.return,st=P;break t}st=_.return}}var D=a.current;for(st=D;st!==null;){var $=(E=st).child;if(2064&E.subtreeFlags&&$!==null)$.return=E,st=$;else t:for(E=D;st!==null;){if(2048&(A=st).flags)try{switch(A.tag){case 0:case 11:case 15:Sa(9,A)}}catch(Rt){Ht(A,A.return,Rt)}if(A===E){st=null;break t}var dt=A.sibling;if(dt!==null){dt.return=A.return,st=dt;break t}st=A.return}}if(St=m,pr(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(ra,a)}catch{}f=!0}return f}finally{Ct=c,qt.transition=o}}return!1}function bf(a,o,c){a=ai(a,o=Od(0,o=gs(c,o),1),1),o=be(),a!==null&&(rn(a,1,o),Re(a,o))}function Ht(a,o,c){if(a.tag===3)bf(a,a,c);else for(;o!==null;){if(o.tag===3){bf(o,a,c);break}if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(li===null||!li.has(f))){o=ai(o,a=kd(o,a=gs(c,a),1),1),a=be(),o!==null&&(rn(o,1,a),Re(o,a));break}}o=o.return}}function $0(a,o,c){var f=a.pingCache;f!==null&&f.delete(o),o=be(),a.pingedLanes|=a.suspendedLanes&c,he===a&&(pe&c)===c&&(ee===4||ee===3&&(130023424&pe)===pe&&500>ae()-yh?ki(a,0):gh|=c),Re(a,o)}function Ef(a,o){o===0&&(1&a.mode?(o=bl,!(130023424&(bl<<=1))&&(bl=4194304)):o=1);var c=be();(a=gr(a,o))!==null&&(rn(a,o,c),Re(a,c))}function W0(a){var o=a.memoizedState,c=0;o!==null&&(c=o.retryLane),Ef(a,c)}function j0(a,o){var c=0;switch(a.tag){case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;default:throw Error(n(314))}f!==null&&f.delete(o),Ef(a,c)}function Tf(a,o){return Sl(a,o)}function X0(a,o,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ye(a,o,c,f){return new X0(a,o,c,f)}function Sh(a){return!(!(a=a.prototype)||!a.isReactComponent)}function di(a,o){var c=a.alternate;return c===null?((c=Ye(a.tag,o,a.key,a.mode)).elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=o,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=14680064&a.flags,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,o=a.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c}function Ua(a,o,c,f,m,_){var E=2;if(f=a,typeof a=="function")Sh(a)&&(E=1);else if(typeof a=="string")E=5;else t:switch(a){case d:return Ui(c.children,m,_,o);case p:E=8,m|=8;break;case g:return(a=Ye(12,c,o,2|m)).elementType=g,a.lanes=_,a;case b:return(a=Ye(13,c,o,m)).elementType=b,a.lanes=_,a;case T:return(a=Ye(19,c,o,m)).elementType=T,a.lanes=_,a;case w:return Ga(c,m,_,o);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case y:E=10;break t;case v:E=9;break t;case x:E=11;break t;case S:E=14;break t;case I:E=16,f=null;break t}throw Error(n(130,a==null?a:typeof a,""))}return(o=Ye(E,c,o,m)).elementType=a,o.type=f,o.lanes=_,o}function Ui(a,o,c,f){return(a=Ye(7,a,f,o)).lanes=c,a}function Ga(a,o,c,f){return(a=Ye(22,a,f,o)).elementType=w,a.lanes=c,a.stateNode={isHidden:!1},a}function Ah(a,o,c){return(a=Ye(6,a,null,o)).lanes=c,a}function Ch(a,o,c){return(o=Ye(4,a.children!==null?a.children:[],a.key,o)).lanes=c,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}function V0(a,o,c,f,m){this.tag=o,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=fe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tl(0),this.expirationTimes=Tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tl(0),this.identifierPrefix=f,this.onRecoverableError=m,At&&(this.mutableSourceEagerHydrationData=null)}function wf(a,o,c,f,m,_,E,A,R){return a=new V0(a,o,c,A,R),o===1?(o=1,_===!0&&(o|=8)):o=0,_=Ye(3,null,null,o),a.current=_,_.stateNode=a,_.memoizedState={element:f,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ll(_),a}function Sf(a){if(!a)return si;t:{if(G(a=a._reactInternals)!==a||a.tag!==1)throw Error(n(170));var o=a;do{switch(o.tag){case 3:o=o.stateNode.context;break t;case 1:if(Be(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break t}}o=o.return}while(o!==null);throw Error(n(171))}if(a.tag===1){var c=a.type;if(Be(c))return Wc(a,c,o)}return o}function Af(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return(a=mt(o))===null?null:a.stateNode}function Cf(a,o){if((a=a.memoizedState)!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<o?c:o}}function Ha(a,o){Cf(a,o),(a=a.alternate)&&Cf(a,o)}function Y0(a){return(a=mt(a))===null?null:a.stateNode}function q0(){return null}return ff=function(a,o,c){if(a!==null)if(a.memoizedProps!==o.pendingProps||Ce.current)Ie=!0;else{if(!(a.lanes&c)&&!(128&o.flags))return Ie=!1,function(q,O,j){switch(O.tag){case 3:Vd(O),us();break;case 5:pd(O);break;case 1:Be(O.type)&&ta(O);break;case 4:Hl(O,O.stateNode.containerInfo);break;case 10:rd(0,O.type._context,O.memoizedProps.value);break;case 13:var at=O.memoizedState;if(at!==null)return at.dehydrated!==null?(Ft(Vt,1&Vt.current),O.flags|=128,null):j&O.child.childLanes?qd(q,O,j):(Ft(Vt,1&Vt.current),(q=$r(q,O,j))!==null?q.sibling:null);Ft(Vt,1&Vt.current);break;case 19:if(at=(j&O.childLanes)!=0,(128&q.flags)!=0){if(at)return Qd(q,O,j);O.flags|=128}var vt=O.memoizedState;if(vt!==null&&(vt.rendering=null,vt.tail=null,vt.lastEffect=null),Ft(Vt,Vt.current),at)break;return null;case 22:case 23:return O.lanes=0,Wd(q,O,j)}return $r(q,O,j)}(a,o,c);Ie=(131072&a.flags)!=0}else Ie=!1,Gt&&1048576&o.flags&&Qc(o,na,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;Ta(a,o),a=o.pendingProps;var m=os(o,ve.current);ds(o,c),m=Vl(null,o,f,a,m,c);var _=Yl();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Be(f)?(_=!0,ta(o)):_=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Ll(o),m.updater=da,o.stateNode=m,m._reactInternals=o,Gl(o,f,a,c),o=rh(null,o,f,!0,_,c)):(o.tag=0,Gt&&_&&Il(o),Pe(null,o,m,c),o=o.child),o;case 16:f=o.elementType;t:{switch(Ta(a,o),a=o.pendingProps,f=(m=f._init)(f._payload),o.type=f,m=o.tag=function(q){if(typeof q=="function")return Sh(q)?1:0;if(q!=null){if((q=q.$$typeof)===x)return 11;if(q===S)return 14}return 2}(f),a=er(f,a),m){case 0:o=eh(null,o,f,a,c);break t;case 1:o=Xd(null,o,f,a,c);break t;case 11:o=Hd(null,o,f,a,c);break t;case 14:o=zd(null,o,f,er(f.type,a),c);break t}throw Error(n(306,f,""))}return o;case 0:return f=o.type,m=o.pendingProps,eh(a,o,f,m=o.elementType===f?m:er(f,m),c);case 1:return f=o.type,m=o.pendingProps,Xd(a,o,f,m=o.elementType===f?m:er(f,m),c);case 3:t:{if(Vd(o),a===null)throw Error(n(387));f=o.pendingProps,m=(_=o.memoizedState).element,sd(a,o),ca(o,f,null,c);var E=o.memoizedState;if(f=E.element,At&&_.isDehydrated){if(_={element:f,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},o.updateQueue.baseState=_,o.memoizedState=_,256&o.flags){o=Yd(a,o,f,c,m=gs(Error(n(423)),o));break t}if(f!==m){o=Yd(a,o,f,c,m=gs(Error(n(424)),o));break t}for(At&&($e=s0(o.stateNode.containerInfo),Fe=o,Gt=!0,tr=null,sn=!1),c=fd(o,null,f,c),o.child=c;c;)c.flags=-3&c.flags|4096,c=c.sibling}else{if(us(),f===m){o=$r(a,o,c);break t}Pe(a,o,f,c)}o=o.child}return o;case 5:return pd(o),a===null&&Ml(o),f=o.type,m=o.pendingProps,_=a!==null?a.memoizedProps:null,E=m.children,Dt(f,m)?E=null:_!==null&&Dt(f,_)&&(o.flags|=32),jd(a,o),Pe(a,o,E,c),o.child;case 6:return a===null&&Ml(o),null;case 13:return qd(a,o,c);case 4:return Hl(o,o.stateNode.containerInfo),f=o.pendingProps,a===null?o.child=fs(o,null,f,c):Pe(a,o,f,c),o.child;case 11:return f=o.type,m=o.pendingProps,Hd(a,o,f,m=o.elementType===f?m:er(f,m),c);case 7:return Pe(a,o,o.pendingProps,c),o.child;case 8:case 12:return Pe(a,o,o.pendingProps.children,c),o.child;case 10:t:{if(f=o.type._context,m=o.pendingProps,_=o.memoizedProps,rd(0,f,E=m.value),_!==null)if(Je(_.value,E)){if(_.children===m.children&&!Ce.current){o=$r(a,o,c);break t}}else for((_=o.child)!==null&&(_.return=o);_!==null;){var A=_.dependencies;if(A!==null){E=_.child;for(var R=A.firstContext;R!==null;){if(R.context===f){if(_.tag===1){(R=zr(-1,c&-c)).tag=2;var B=_.updateQueue;if(B!==null){var L=(B=B.shared).pending;L===null?R.next=R:(R.next=L.next,L.next=R),B.pending=R}}_.lanes|=c,(R=_.alternate)!==null&&(R.lanes|=c),Ol(_.return,c,o),A.lanes|=c;break}R=R.next}}else if(_.tag===10)E=_.type===o.type?null:_.child;else if(_.tag===18){if((E=_.return)===null)throw Error(n(341));E.lanes|=c,(A=E.alternate)!==null&&(A.lanes|=c),Ol(E,c,o),E=_.sibling}else E=_.child;if(E!==null)E.return=_;else for(E=_;E!==null;){if(E===o){E=null;break}if((_=E.sibling)!==null){_.return=E.return,E=_;break}E=E.return}_=E}Pe(a,o,m.children,c),o=o.child}return o;case 9:return m=o.type,f=o.pendingProps.children,ds(o,c),f=f(m=We(m)),o.flags|=1,Pe(a,o,f,c),o.child;case 14:return m=er(f=o.type,o.pendingProps),zd(a,o,f,m=er(f.type,m),c);case 15:return $d(a,o,o.type,o.pendingProps,c);case 17:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:er(f,m),Ta(a,o),o.tag=1,Be(f)?(a=!0,ta(o)):a=!1,ds(o,c),hd(o,f,m),Gl(o,f,m,c),rh(null,o,f,!0,a,c);case 19:return Qd(a,o,c);case 22:return Wd(a,o,c)}throw Error(n(156,o.tag))},t.attemptContinuousHydration=function(a){if(a.tag===13){var o=gr(a,134217728);o!==null&&Ve(o,a,134217728,be()),Ha(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var o=gr(a,1);o!==null&&Ve(o,a,1,be()),Ha(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var o=ui(a),c=gr(a,o);c!==null&&Ve(c,a,o,be()),Ha(a,o)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var o=a.stateNode;if(o.current.memoizedState.isDehydrated){var c=en(o.pendingLanes);c!==0&&(wl(o,1|c),Re(o,ae()),!(6&St)&&(_s(),pr()))}break;case 13:gf(function(){var f=gr(a,1);if(f!==null){var m=be();Ve(f,a,1,m)}}),Ha(a,1)}},t.batchedUpdates=function(a,o){var c=St;St|=1;try{return a(o)}finally{(St=c)===0&&(_s(),ia&&pr())}},t.createComponentSelector=function(a){return{$$typeof:Aa,value:a}},t.createContainer=function(a,o,c,f,m,_,E){return wf(a,o,!1,null,0,f,0,_,E)},t.createHasPseudoClassSelector=function(a){return{$$typeof:Ca,value:a}},t.createHydrationContainer=function(a,o,c,f,m,_,E,A,R){return(a=wf(c,f,!0,a,0,_,0,A,R)).context=Sf(null),c=a.current,(_=zr(f=be(),m=ui(c))).callback=o??null,ai(c,_,m),a.current.lanes=m,rn(a,m,f),Re(a,f),a},t.createPortal=function(a,o,c){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:f==null?null:""+f,children:a,containerInfo:o,implementation:c}},t.createRoleSelector=function(a){return{$$typeof:Ia,value:a}},t.createTestNameSelector=function(a){return{$$typeof:Pa,value:a}},t.createTextSelector=function(a){return{$$typeof:Ra,value:a}},t.deferredUpdates=function(a){var o=Ct,c=qt.transition;try{return qt.transition=null,Ct=16,a()}finally{Ct=o,qt.transition=c}},t.discreteUpdates=function(a,o,c,f,m){var _=Ct,E=qt.transition;try{return qt.transition=null,Ct=1,a(o,c,f,m)}finally{Ct=_,qt.transition=E,St===0&&_s()}},t.findAllNodes=ph,t.findBoundingRects=function(a,o){if(!Zs)throw Error(n(363));o=ph(a,o),a=[];for(var c=0;c<o.length;c++)a.push(My(o[c]));for(o=a.length-1;0<o;o--)for(var f=(c=a[o]).x,m=f+c.width,_=c.y,E=_+c.height,A=o-1;0<=A;A--)if(o!==A){var R=a[A],B=R.x,L=B+R.width,q=R.y,O=q+R.height;if(f>=B&&_>=q&&m<=L&&E<=O){a.splice(o,1);break}if(!(f!==B||c.width!==R.width||O<_||q>E)){q>_&&(R.height+=q-_,R.y=_),O<E&&(R.height=E-q),a.splice(o,1);break}if(!(_!==q||c.height!==R.height||L<f||B>m)){B>f&&(R.width+=B-f,R.x=f),L<m&&(R.width=m-B),a.splice(o,1);break}}return a},t.findHostInstance=Af,t.findHostInstanceWithNoPortals=function(a){return(a=(a=rt(a))!==null?M(a):null)===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return Af(a)},t.flushControlled=function(a){var o=St;St|=1;var c=qt.transition,f=Ct;try{qt.transition=null,Ct=1,a()}finally{Ct=f,qt.transition=c,(St=o)===0&&(_s(),pr())}},t.flushPassiveEffects=Li,t.flushSync=gf,t.focusWithin=function(a,o){if(!Zs)throw Error(n(363));for(o=df(a=ch(a),o),o=Array.from(o),a=0;a<o.length;){var c=o[a++];if(!Js(c)){if(c.tag===5&&Fy(c.stateNode))return!0;for(c=c.child;c!==null;)o.push(c),c=c.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ct},t.getFindAllNodesFailureDescription=function(a,o){if(!Zs)throw Error(n(363));var c=0,f=[];a=[ch(a),0];for(var m=0;m<a.length;){var _=a[m++],E=a[m++],A=o[E];if((_.tag!==5||!Js(_))&&(dh(_,A)&&(f.push(fh(A)),++E>c&&(c=E)),E<o.length))for(_=_.child;_!==null;)a.push(_,E),_=_.sibling}if(c<o.length){for(a=[];c<o.length;c++)a.push(fh(o[c]));return`findAllNodes was able to match part of the selector:
  `+f.join(" > ")+`

No matching component was found for:
  `+a.join(" > ")}return null},t.getPublicRootInstance=function(a){return(a=a.current).child?a.child.tag===5?ft(a.child.stateNode):a.child.stateNode:null},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:Y0,findFiberByHostInstance:a.findFiberByHostInstance||q0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(o.isDisabled||!o.supportsFiber)a=!0;else{try{ra=o.inject(a),fr=o}catch{}a=!!o.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,o,c,f){if(!Zs)throw Error(n(363));a=ph(a,o);var m=Ny(a,c,f).disconnect;return{disconnect:function(){m()}}},t.registerMutableSourceForHydration=function(a,o){var c=o._getVersion;c=c(o._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[o,c]:a.mutableSourceEagerHydrationData.push(o,c)},t.runWithPriority=function(a,o){var c=Ct;try{return Ct=a,o()}finally{Ct=c}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,o,c,f){var m=o.current,_=be(),E=ui(m);return c=Sf(c),o.context===null?o.context=c:o.pendingContext=c,(o=zr(_,E)).payload={element:a},(f=f===void 0?null:f)!==null&&(o.callback=f),(a=ai(m,o,E))!==null&&(Ve(a,m,E,_),ua(a,m,E)),E},t}),gm}({get exports(){return pc},set exports(i){pc=i}}).exports=Qw();var Zw=ww(pc),by={name:"root",private:!0,workspaces:["packages/*"],scripts:{build:"nx run-many --target=build --all --parallel","build:force":"nx run-many --target=build --all --parallel --skip-nx-cache","build:docs":"nx run @pixi/react-docs:deploy",clean:"rimraf packages/*/dist packages/*/build",lint:"eslint .",prepare:"husky install",prerelease:"./scripts/checkReleaseBranch.mjs && npm run lint && npm run test:force && npm run build:force",release:"lerna publish --no-private",test:"nx run-many --target=test --all --parallel","test:force":"nx run-many --target=test --all --parallel --skip-nx-cache","test:ci":"nx run-many --target=test:ci --all --parallel","test:ci:force":"nx run-many --target=test:ci --all --parallel --skip-nx-cache","test:types":"nx run-many --target=test:types --all --parallel","test:types:force":"nx run-many --target=test:types --all --parallel --skip-nx-cache"},husky:{hooks:{"pre-commit":"lint-staged"}},"lint-staged":{"*.{ts,js,mjs}":["eslint --cache --fix"]},resolutions:{"get-pkg-repo":"4.1.1","hosted-git-info":"^2.1.4"},dependencies:{"@babel/runtime":"^7.14.8","@pixi/app":"^7.1.1","@pixi/constants":"^7.1.1","@pixi/core":"^7.1.1","@pixi/display":"^7.1.1","@pixi/extensions":"^7.1.1","@pixi/graphics":"^7.1.1","@pixi/math":"^7.1.1","@pixi/mesh":"^7.1.1","@pixi/mesh-extras":"^7.1.1","@pixi/particle-container":"^7.1.1","@pixi/sprite":"^7.1.1","@pixi/sprite-animated":"^7.1.1","@pixi/sprite-tiling":"^7.1.1","@pixi/text":"^7.1.1","@pixi/text-bitmap":"^7.1.1","@pixi/ticker":"^7.1.1","@react-spring/animated":"^9.6.1","@react-spring/types":"^9.6.1",react:"^18.0.0","react-dom":"^18.0.0","react-reconciler":"0.29.0","react-spring":"^9.6.1"},devDependencies:{"@babel/cli":"^7.20.7","@babel/core":"^7.20.7","@babel/eslint-parser":"^7.19.1","@babel/plugin-transform-runtime":"^7.19.6","@babel/preset-env":"^7.20.2","@babel/preset-react":"^7.18.6","@nrwl/nx-cloud":"latest","@pixi/eslint-config":"^4.0.1","@rollup/plugin-alias":"^4.0.2","@rollup/plugin-babel":"^6.0.3","@rollup/plugin-commonjs":"^24.0.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.1","@rollup/plugin-replace":"^5.0.2","@rollup/plugin-terser":"^0.2.1","@rollup/plugin-typescript":"^10.0.1","@types/jest":"^29.2.4","@types/react":"17.0.15","@types/react-dom":"17.0.9","@types/react-reconciler":"0.28.2","babel-jest":"^29.3.1","babel-plugin-module-resolver":"4.1.0","cross-env":"^7.0.3",eslint:"^8.29.0","eslint-plugin-react":"^7.31.11",husky:"^8.0.2",jest:"^29.3.1","jest-environment-jsdom":"^29.3.1","jest-extended":"^3.2.0","jest-watch-typeahead":"^2.2.1",lerna:"^6.0.3","lint-staged":"^13.1.0",nx:"15.3.0",rimraf:"^3.0.2",rollup:"^3.7.0","rollup-plugin-filesize":"^9.1.2","rollup-plugin-visualizer":"^5.9.0","ts-jest":"^29.0.3","ts-node":"^10.9.1",typescript:"^4.9.4"}},gc={},go={get exports(){return gc},set exports(i){gc=i}};(function(){var i,t,e,r,s,n;typeof performance<"u"&&performance!==null&&performance.now?go.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(go.exports=function(){return(i()-s)/1e6},t=process.hrtime,r=(i=function(){var l;return 1e9*(l=t())[0]+l[1]})(),n=1e9*process.uptime(),s=r-n):Date.now?(go.exports=function(){return Date.now()-e},e=Date.now()):(go.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(Tw);var _m,Os={},zi={};({get exports(){return Os},set exports(i){Os=i}}).exports=(_m||(_m=1,zi.ConcurrentRoot=1,zi.ContinuousEventPriority=4,zi.DefaultEventPriority=16,zi.DiscreteEventPriority=1,zi.IdleEventPriority=536870912,zi.LegacyRoot=0),zi);var Jw={};function mu(i,t){i.addChild&&(i.addChild(t),typeof t.didMount=="function"&&t.didMount(t,i))}function Ey(i,t){var e,r,s;(e=i.willUnmount)===null||e===void 0||e.call(i,i,t),((r=i.config)===null||r===void 0?void 0:r.destroyChildren)!==!1&&(s=i.children)!==null&&s!==void 0&&s.length&&ri(i.children).forEach(function(n){Ey(n,i)})}function xm(i,t){var e;Ey(t,i),i.removeChild(t);var r=(e=t.config)!==null&&e!==void 0?e:{},s=r.destroy,n=s===void 0||s,l=r.destroyChildren,h=l===void 0||l,u=r.destroyTexture,d=u!==void 0&&u,p=r.destroyBaseTexture,g=p!==void 0&&p;n&&t.destroy({children:h,texture:d,baseTexture:g})}function bm(i,t,e){Yt(t!==e,"pixi-react: PixiFiber cannot insert node before itself"),i.children.indexOf(t)!==-1&&i.removeChild(t);var r=i.getChildIndex(e);i.addChildAt(t,r)}var Em=null,hr=Zw({getRootHostContext:function(){return Jw},getChildHostContext:function(i){return i},getChildHostContextForEventComponent:function(i){return i},getPublicInstance:function(i){return i},getCurrentEventPriority:function(){return function(){var i,t;if(typeof window>"u")return Os.DefaultEventPriority;switch((i=window)===null||i===void 0||(t=i.event)===null||t===void 0?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Os.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Os.ContinuousEventPriority;default:return Os.DefaultEventPriority}}()},prepareForCommit:function(){return null},resetAfterCommit:function(){},createInstance:function(i){var t,e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=Vw[i];if(typeof n=="function"&&(t=n(s,r)),!t){var l=xy[i];l&&((t=l.create(r,{root:s})).didMount=l.didMount?l.didMount.bind(t):void 0,t.willUnmount=l.willUnmount?l.willUnmount.bind(t):void 0,t.applyProps=l.applyProps?l.applyProps.bind(t):void 0,t.config=l.config)}return t&&(t.__reactpixi={root:s},(typeof((e=t)===null||e===void 0?void 0:e.applyProps)=="function"?t.applyProps:kr)(t,{},r)),t},hideInstance:function(i){i.visible=!1},unhideInstance:function(i,t){var e=t==null||!t.hasOwnProperty("visible")||t.visible;i.visible=e},finalizeInitialChildren:function(i,t,e){return!1},prepareUpdate:function(i,t,e,r,s,n){return Em=function(l,h,u,d){var p=null;for(var g in u)!d.hasOwnProperty(g)&&u.hasOwnProperty(g)&&u[g]!==null&&(g===dc||(p||(p=[]),p.push(g,null)));for(var y in d){var v=d[y],x=u!==null?u[y]:void 0;!d.hasOwnProperty(y)||v===x||v===null&&x===null||y===dc||(p||(p=[]),p.push(y,v))}return p}(0,0,e,r)},shouldSetTextContent:function(i,t){return!1},shouldDeprioritizeSubtree:function(i,t){var e=t.alpha===void 0||t.alpha>0,r=t.renderable===void 0||t.renderable===!0,s=t.visible===void 0||t.visible===!0;return!(e&&r&&s)},createTextInstance:function(i,t,e){Yt(!1,'pixi-react: Error trying to add text node "'.concat(i,'"'),"PixiFiber does not support text nodes as children of a Pixi component. To pass a string value to your component, use a property other than children. If you wish to display some text, you can use &lt;Text text={string} /&gt; instead.")},unhideTextInstance:function(i,t){},mountEventComponent:function(){},updateEventComponent:function(){},handleEventTarget:function(){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,noTimeout:-1,warnsIfNotActing:!1,now:gc,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,supportsMicrotasks:!0,scheduleMicrotask:queueMicrotask,appendInitialChild:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=mu.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendInitialChild"}),n},appendChild:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=mu.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChild"}),n},appendChildToContainer:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=mu.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChildToContainer"}),n},removeChild:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=xm.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChild"}),n},removeChildFromContainer:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=xm.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChildFromContainer"}),n},insertBefore:bm,insertInContainerBefore:function(){for(var i,t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var n=bm.apply(null,r);return(i=r[0].__reactpixi)===null||i===void 0||(t=i.root)===null||t===void 0||t.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"insertInContainerBefore"}),n},commitUpdate:function(i,t,e,r,s){var n,l,h=i&&i.applyProps;typeof h!="function"&&(h=kr),(h(i,r,s)||Em)&&((n=i.__reactpixi)===null||n===void 0||(l=n.root)===null||l===void 0||l.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"commitUpdate"}))},commitMount:function(i,t,e,r,s){},commitTextUpdate:function(i,t,e){},resetTextContent:function(i){},clearContainer:function(i){},getFundamentalComponentInstance:function(i){throw new Error("Not yet implemented.")},mountFundamentalComponent:function(i){throw new Error("Not yet implemented.")},shouldUpdateFundamentalComponent:function(i){throw new Error("Not yet implemented.")},unmountFundamentalComponent:function(i){throw new Error("Not yet implemented.")},getInstanceFromNode:function(i){throw new Error("Not yet implemented.")},isOpaqueHydratingObject:function(i){throw new Error("Not yet implemented")},makeOpaqueHydratingObject:function(i){throw new Error("Not yet implemented.")},makeClientIdInDEV:function(i){throw new Error("Not yet implemented")},beforeActiveInstanceBlur:function(i){},afterActiveInstanceBlur:function(){},detachDeletedInstance:function(){},preparePortalMount:function(i){}}),tS=by.dependencies["react-dom"].replace(/[^0-9.]/g,""),eS=by.name;hr.injectIntoDevTools({bundleType:0,version:tS,rendererPackageName:eS,findHostInstanceByFiber:hr.findHostInstance});var Ti=new Map;function Ty(i){if(Yt(Ae.prototype.isPrototypeOf(i),"Invalid argument `container`, expected instance of `PIXI.Container`."),Ti.has(i)){var t=Ti.get(i).pixiFiberContainer;hr.updateContainer(null,t,void 0,function(){Ti.delete(i)})}}function wy(i){Yt(Ae.prototype.isPrototypeOf(i),"Invalid argument `container`, expected instance of `PIXI.Container`.");var t=Ti.get(i);if(Yt(!t,"Pixi React: createRoot should only be called once"),!t){var e=hr.createContainer(i);t={pixiFiberContainer:e,reactRoot:{render:function(r){return hr.updateContainer(r,e,void 0),hr.getPublicRootInstance(e)},unmount:function(){Ty(i),Ti.delete(i)}}},Ti.set(i,t)}return t.reactRoot}function rS(i,t,e){var r;return console.warn("Pixi React Deprecation Warning: render is deprecated, use createRoot instead"),e!==void 0&&console.warn("Pixi React Deprecation Warning: render callback no longer exists in React 18"),Ti.has(t)?r=Ti.get(t).reactRoot:r=wy(t),r.render(i)}function iS(i){Ty(i)}function Vn(){return Vn=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},Vn.apply(this,arguments)}function sS(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function nS(i,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,yy(r.key),r)}}function Xr(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Qo(i,t){return Qo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},Qo(i,t)}function aS(i,t){if(t&&(Le(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xr(i)}function Zo(i){return Zo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zo(i)}var dl=Qr.createContext(null),Sy=dl.Provider,Ay=dl.Consumer,oS=function(i){var t=Qr.forwardRef(function(e,r){return Qr.createElement(Ay,null,function(s){return Qr.createElement(i,Vn({},e,{ref:r,app:s}))})});return t.displayName="withPIXIApp(".concat(i.displayName||i.name,")"),t};function lS(i){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var e,r=Zo(i);if(t){var s=Zo(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return aS(this,e)}}function Tm(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),e.push.apply(e,r)}return e}function yo(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Tm(Object(e),!0).forEach(function(r){Qt(i,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Tm(Object(e)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(e,r))})}return i}var wm=function(){},Cy={width:kt.number,height:kt.number,onMount:kt.func,onUnmount:kt.func,raf:kt.bool,renderOnComponentChange:kt.bool,children:kt.node,options:kt.shape({autoStart:kt.bool,width:kt.number,height:kt.number,useContextAlpha:kt.bool,backgroundAlpha:kt.number,autoDensity:kt.bool,antialias:kt.bool,preserveDrawingBuffer:kt.bool,resolution:kt.number,forceCanvas:kt.bool,backgroundColor:kt.number,clearBeforeRender:kt.bool,powerPreference:kt.string,sharedTicker:kt.bool,sharedLoader:kt.bool,resizeTo:function(i,t){var e=i[t];e&&Yt(e===window||e instanceof HTMLElement,"Invalid prop `resizeTo` of type ".concat(Le(e),", expect `window` or an `HTMLElement`."))},view:function(i,t,e){var r=i[t];r&&Yt(r instanceof HTMLCanvasElement,"Invalid prop `view` of type ".concat(Le(r),", supplied to ").concat(e,", expected `<canvas> Element`"))}})},hS={width:800,height:600,onMount:wm,onUnmount:wm,raf:!0,renderOnComponentChange:!0},yc=function(i){(function(n,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(l&&l.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),l&&Qo(n,l)})(s,Qr.Component);var t,e,r=lS(s);function s(){var n;sS(this,s);for(var l=arguments.length,h=new Array(l),u=0;u<l;u++)h[u]=arguments[u];return Qt(Xr(n=r.call.apply(r,[this].concat(h))),"_canvas",null),Qt(Xr(n),"_mediaQuery",null),Qt(Xr(n),"_ticker",null),Qt(Xr(n),"_needsUpdate",!0),Qt(Xr(n),"app",null),Qt(Xr(n),"updateSize",function(){var d=n.props,p=d.width,g=d.height,y=d.options;y!=null&&y.resolution||(n.app.renderer.resolution=window.devicePixelRatio,n.resetInteractionManager()),n.app.renderer.resize(p,g)}),Qt(Xr(n),"needsRenderUpdate",function(){n._needsUpdate=!0}),Qt(Xr(n),"renderStage",function(){var d=n.props,p=d.renderOnComponentChange;!d.raf&&p&&n._needsUpdate&&(n._needsUpdate=!1,n.app.renderer.render(n.app.stage))}),n}return t=s,(e=[{key:"componentDidMount",value:function(){var n=this.props,l=n.onMount,h=n.width,u=n.height,d=n.options,p=n.raf,g=n.renderOnComponentChange;this.app=new ol(yo(yo({width:h,height:u,view:this._canvas},d),{},{autoDensity:(d==null?void 0:d.autoDensity)!==!1})),this.app.ticker.autoStart=!1,this.app.ticker[p?"start":"stop"](),this.app.stage.__reactpixi={root:this.app.stage},this.mountNode=hr.createContainer(this.app.stage),hr.updateContainer(this.getChildren(),this.mountNode,this),l(this.app),d!=null&&d.autoDensity&&window.matchMedia&&(d==null?void 0:d.resolution)===void 0&&(this._mediaQuery=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.3), (min-resolution: 120dpi)"),this._mediaQuery.addListener(this.updateSize)),g&&!p&&(this._ticker=new de,this._ticker.autoStart=!0,this._ticker.add(this.renderStage),this.app.stage.on("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate)),this.updateSize(),this.renderStage()}},{key:"componentDidUpdate",value:function(n,l,h){var u,d=this.props,p=d.width,g=d.height,y=d.raf,v=d.renderOnComponentChange,x=d.options;(x==null?void 0:x.resolution)!==void 0&&(n==null?void 0:n.options.resolution)!==(x==null?void 0:x.resolution)&&(this.app.renderer.resolution=x.resolution,this.resetInteractionManager()),n.height===g&&n.width===p&&((u=n.options)===null||u===void 0?void 0:u.resolution)===(x==null?void 0:x.resolution)||this.updateSize(),n.raf!==y&&this.app.ticker[y?"start":"stop"](),hr.updateContainer(this.getChildren(),this.mountNode,this),n.width===p&&n.height===g&&n.raf===y&&n.renderOnComponentChange===v&&n.options===x||(this._needsUpdate=!0,this.renderStage())}},{key:"resetInteractionManager",value:function(){var n=this.app.renderer.plugins.interaction;n!=null&&n.resolution&&(n.resolution=this.app.renderer.resolution)}},{key:"getChildren",value:function(){var n=this.props.children;return Qr.createElement(Sy,{value:this.app},n)}},{key:"componentDidCatch",value:function(n,l){console.error("Error occurred in `Stage`."),console.error(n),console.error(l)}},{key:"componentWillUnmount",value:function(){this.props.onUnmount(this.app),this._ticker&&(this._ticker.remove(this.renderStage),this._ticker.destroy()),this.app.stage.off("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate),hr.updateContainer(null,this.mountNode,this),this._mediaQuery&&(this._mediaQuery.removeListener(this.updateSize),this._mediaQuery=null),this.app.destroy()}},{key:"render",value:function(){var n,l,h=this,u=this.props.options;return u&&u.view?(Yt(u.view instanceof HTMLCanvasElement,"options.view needs to be a `HTMLCanvasElement`"),null):Qr.createElement("canvas",Vn({},(n=this.props,l=[].concat(ri(Object.keys(Cy)),ri(Object.keys(fc))),Object.keys(n).filter(function(d){return!l.includes(d)}).reduce(function(d,p){return yo(yo({},d),{},Qt({},p,n[p]))},{})),{ref:function(d){return h._canvas=d}}))}}])&&nS(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),s}();yc.propTypes=Cy,yc.defaultProps=hS;var uS=yc;function Iy(){var i=Vr.useContext(dl);return Yt(i instanceof ol,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider"),i}function cS(i){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],e=Iy();Yt(typeof i=="function","`useTick` needs a callback function."),Yt(e instanceof ol,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider");var r=Vr.useRef(null);Vr.useEffect(function(){r.current=i},[i]),Vr.useEffect(function(){if(t){var s=function(n){return r.current.apply(e.ticker,[n,e.ticker])};return e.ticker.add(s),function(){e.ticker&&e.ticker.remove(s)}}},[t])}function dS(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vc(i,t,e){return vc=dS()?Reflect.construct.bind():function(r,s,n){var l=[null];l.push.apply(l,s);var h=new(Function.bind.apply(r,l));return n&&Qo(h,n.prototype),h},vc.apply(null,arguments)}var fS=["children","apply"];function Sm(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),e.push.apply(e,r)}return e}function vo(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Sm(Object(e),!0).forEach(function(r){Qt(i,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Sm(Object(e)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(e,r))})}return i}var pS=function(i,t){Yt(Le(t)==="object","Second argument needs to be an indexed object with { prop: Filter }");var e=Object.keys(t),r=function(s){var n=s.children,l=s.apply,h=Pi(s,fS),u=Vr.useRef(Vr.useMemo(function(){return e.map(function(g){var y,v=(h==null||(y=h[g])===null||y===void 0?void 0:y.construct)||[];return vc(t[g],ri(v))})},[e])),d=Vr.useMemo(function(){return e.reduce(function(g,y,v){return vo(vo({},g),{},Qt({},y,u.current[v]))},{})},[e]),p=Vr.useMemo(function(){return Object.keys(h).filter(_y(vy(e))).reduce(function(g,y){return vo(vo({},g),{},Qt({},y,h[y]))},{})},[h,e]);return e.forEach(function(g,y){return Object.assign(u.current[y],h[g])}),l&&function(){for(var g=arguments.length,y=new Array(g),v=0;v<g;v++)y[v]=arguments[v];return y.every(function(x){return typeof x=="function"})}(l)&&l.call(i,d),Qr.createElement(i,Vn({},p,{filters:u.current}),n)};return r.displayName="FilterWrapper",r.propTypes={children:kt.node,apply:kt.func},r},mS=De.BitmapText,gS=De.Container,yS=De.Graphics,vS=De.NineSlicePlane,_S=De.ParticleContainer,xS=De.Sprite,bS=De.AnimatedSprite,ES=De.Text,TS=De.TilingSprite,wS=De.SimpleMesh,SS=De.SimpleRope;const AS=Object.freeze(Object.defineProperty({__proto__:null,AnimatedSprite:bS,AppConsumer:Ay,AppContext:dl,AppProvider:Sy,BitmapText:mS,Container:gS,Graphics:yS,NineSlicePlane:vS,ParticleContainer:_S,PixiComponent:Yw,PixiFiber:hr,SimpleMesh:wS,SimpleRope:SS,Sprite:xS,Stage:uS,TYPES:De,Text:ES,TilingSprite:TS,applyDefaultProps:kr,createRoot:wy,eventHandlers:Ko,render:rS,unmountComponentAtNode:iS,useApp:Iy,useTick:cS,withFilters:pS,withPixiApp:oS},Symbol.toStringTag,{value:"Module"})),CS=Q0(AS);gy.exports=CS;var _o=gy.exports;function MS(){const i=Vr.useMemo(()=>new Wg(2),[]);return xn.jsx("div",{className:"route pixi",children:xn.jsxs(_o.Stage,{children:[xn.jsx(_o.Sprite,{image:"https://pixijs.io/pixi-react/img/bunny.png",position:{x:400,y:270},anchor:{x:.5,y:.5}}),xn.jsx(_o.Container,{position:{x:400,y:330},children:xn.jsx(_o.Text,{anchor:{x:.5,y:.5},filters:[i]})})]})})}export{MS as default};
