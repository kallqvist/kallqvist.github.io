var U=Object.defineProperty;var V=(r,e,t)=>e in r?U(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var y=(r,e,t)=>(V(r,typeof e!="symbol"?e+"":e,t),t),G=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var a=(r,e,t)=>(G(r,e,"read from private field"),t?t.call(r):e.get(r)),j=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},F=(r,e,t,m)=>(G(r,e,"write to private field"),m?m.call(r,t):e.set(r,t),t);import{r as l,j as s,F as N,i as X,m as Y,l as H}from"./index-Kqp9EvPw.js";import{G as J,b as K,u as d,a as Q,V as f}from"./index-CyfE-eYX.js";class A extends J{constructor(t){super(t);y(this,"age",0)}getRGBA(){return[255,0,100,255]}}var i,u;class W{constructor(e){j(this,i,void 0);j(this,u,!1);F(this,i,new K({...e,createEmpty:t=>new A(t)}))}start(){F(this,u,!0)}stop(){F(this,u,!1)}isRunning(){return a(this,u)}getGrid(){return a(this,i)}restart(){this.stop(),a(this,i).clear()}step(e){a(this,i).forEach(t=>{t.age+=e})}}i=new WeakMap,u=new WeakMap;function tt(){const r=new f(160,90),e=1/12,t=l.useRef(),[m,P]=d(void 0),h=l.useRef(),p=l.useRef(void 0),[E,S]=d(void 0),[R,k]=d(new f(0,0)),[x,z]=d(!0),[v,w]=d(-1);l.useEffect(()=>(t.current=new W({size:r}),P(t.current.getGrid()),b(),h.current=requestAnimationFrame(C),()=>{h.current!==void 0&&cancelAnimationFrame(h.current)}),[]),l.useEffect(()=>{const n=t.current;n&&(x.current?n.start():n.stop())},[x]);function T(n){n.preventDefault()}function q(){S(void 0),p.current=void 0}function I(n){const c=n.target,{x:o,y:g,width:M,height:B}=c.getBoundingClientRect(),D=new f(o,g),L=new f(M,B);k(new f(n.clientX,n.clientY).subtract(D).divide(L).multiply(r).floor())}function C(n){if(v.current===-1)w(n);else{const c=(n-v.current)/1e3;if(c>e){const o=t.current;if(!o)return;O(o.getGrid()),x.current&&o.step(c),w(n)}}h.current=requestAnimationFrame(C)}function O(n){if(E.current===void 0||!t.current)return;(p.current?n.getPositionsInLine(p.current,R.current):[R.current]).forEach(g=>{n.get(g)&&n.set(g,new A(n))}),p.current=R.current}function b(){const n=t.current;n&&n.restart()}return s.jsxs("div",{className:"route fluid",children:[s.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[s.jsx("button",{onClick:()=>z(n=>!n),children:x.current?s.jsxs(s.Fragment,{children:[s.jsx(N,{}),"stop"]}):s.jsxs(s.Fragment,{children:[s.jsx(X,{}),"start"]})}),s.jsxs("button",{onClick:()=>{var n;return(n=t.current)==null?void 0:n.step(1)},children:[s.jsx(Y,{}),"step"]}),s.jsxs("button",{onClick:()=>b(),children:[s.jsx(H,{}),"reset"]})]}),s.jsx(Q,{grid:m.current,onMouseUp:q,onMouseMove:I,onContextMenu:T})]})}export{tt as default};
