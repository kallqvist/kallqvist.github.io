var K=Object.defineProperty;var Q=(r,n,t)=>n in r?K(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var L=(r,n,t)=>(Q(r,typeof n!="symbol"?n+"":n,t),t),S=(r,n,t)=>{if(!n.has(r))throw TypeError("Cannot "+t)};var f=(r,n,t)=>(S(r,n,"read from private field"),t?t.call(r):n.get(r)),y=(r,n,t)=>{if(n.has(r))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(r):n.set(r,t)},C=(r,n,t,i)=>(S(r,n,"write to private field"),i?i.call(r,t):n.set(r,t),t);var H=(r,n,t)=>(S(r,n,"access private method"),t);import{r as w,j as o,F as Z,i as $,l as ee,m as te}from"./index-XiIlW2la.js";import{G as ne,a as re,n as se,u as R,b as ie,V as s}from"./index-URT-IjsW.js";class G extends ne{constructor(t,i){super(t);L(this,"alive",!1);L(this,"age",0);this.alive=i||!1,this.sleep(),this.color=this.getRGBA()}getRGBA(){return this.alive?[255,0,0,255]:[0,0,0,0]}}var u,m,P,W;class oe{constructor(n){y(this,P);y(this,u,void 0);y(this,m,!1);C(this,u,new re({...n,createEmpty:t=>new G(t)}))}start(){C(this,m,!0)}stop(){C(this,m,!1)}isRunning(){return f(this,m)}getGrid(){return f(this,u)}restart(){f(this,u).clear()}step(n){if(!f(this,m))return;const t=f(this,u).map(i=>i.alive);f(this,u).forEach(i=>{let a=H(this,P,W).call(this,t,i);i.alive!==a&&f(this,u).setAtIndex(i.index,new G(f(this,u),a))})}}u=new WeakMap,m=new WeakMap,P=new WeakSet,W=function(n,t){let i=0;return se.forEach(a=>{if(!t.position)return;const g=f(this,u).position2index(t.position.add(a));n[g]===!0&&i++}),t.alive&&(i<2||i>3)?!1:!t.alive&&i===3?!0:t.alive};function de(){const t=.08333333333333333,i=w.useRef(null),a=w.useRef(),[g,q]=R(void 0),b=w.useRef(),M=w.useRef(void 0),[k,D]=R(void 0),[A,N]=R(new s(0,0)),[j,U]=R(!0),[I,O]=R(-1);w.useEffect(()=>(a.current=new oe({width:160,height:90}),q(a.current.getGrid()),B(),V(),b.current=requestAnimationFrame(T),()=>{b.current!==void 0&&cancelAnimationFrame(b.current)}),[]),w.useEffect(()=>{const e=a.current;e&&(j.current?e.start():e.stop())},[j]);function V(){const e={glider:`01
                001
                111`,grabbyEdge:`001
                001
                011
                0
                1100111
                10101
                011
                0
                011
                10101
                1100111
                0
                011
                001
                001`};function l(d,x){d.trim().split(`
`).forEach((p,E)=>{var v;p=p.trim();for(let F=0;F<p.length;F++)Number.parseInt(p[F])!==0&&((v=g.current)==null||v.set(new s(F,E).add(x),new G(g.current,!0)))})}[new s(0,5),new s(0,26),new s(0,47),new s(0,68)].forEach(d=>{l(e.grabbyEdge,d)}),[new s(30,20),new s(30,30),new s(30,40),new s(30,50),new s(30,60),new s(40,20),new s(40,30),new s(40,40),new s(40,50),new s(40,60),new s(50,20),new s(50,30),new s(50,40),new s(50,50),new s(50,60)].forEach(d=>{l(e.glider,d)})}function X(e){e.preventDefault()}function Y(e){var v;const l=e.target,{x:h,y:c,width:d,height:x}=l.getBoundingClientRect(),p=new s(Math.floor((e.clientX-h)/d*160),Math.floor((e.clientY-c)/x*90)),E=(v=g.current)==null?void 0:v.get(p);E&&D(E.alive?"erase":"add")}function _(){D(void 0),M.current=void 0}function z(e){const l=e.target,{x:h,y:c,width:d,height:x}=l.getBoundingClientRect();N(new s(Math.floor((e.clientX-h)/d*160),Math.floor((e.clientY-c)/x*90)))}function T(e){var l;if(I.current===-1)O(e);else{const h=(e-I.current)/1e3;if(h>t){const c=a.current;if(!c)return;J(c.getGrid()),j.current&&c.step(h),(l=i.current)==null||l.render(),O(e)}}b.current=requestAnimationFrame(T)}function J(e){if(k.current===void 0||!a.current)return;(M.current?e.getPositionsInLine(M.current,A.current):[A.current]).forEach(c=>{e.get(c)&&e.set(c,new G(e,k.current==="add"))}),M.current=A.current}function B(){const e=a.current;e&&e.restart()}return o.jsxs("div",{className:"route game-of-life",children:[o.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[o.jsx("button",{onClick:()=>U(e=>!e),children:j.current?o.jsxs(o.Fragment,{children:[o.jsx(Z,{}),"stop"]}):o.jsxs(o.Fragment,{children:[o.jsx($,{}),"start"]})}),o.jsxs("button",{onClick:()=>{var e;return(e=a.current)==null?void 0:e.step(1)},children:[o.jsx(ee,{}),"step"]}),o.jsxs("button",{onClick:()=>B(),children:[o.jsx(te,{}),"reset"]})]}),o.jsx(ie,{ref:i,grid:g.current,onMouseDown:Y,onMouseUp:_,onMouseMove:z,onContextMenu:X})]})}export{de as default};
