import{r as _,g as Ji,R as T,_ as ji,j as oe}from"./index-dbf61b67.js";function de(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=de(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var qr={exports:{}},Gr={},Qr={exports:{}},Jr={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut=_;function es(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ts=typeof Object.is=="function"?Object.is:es,ns=ut.useState,rs=ut.useEffect,os=ut.useLayoutEffect,is=ut.useDebugValue;function ss(e,t){var n=t(),r=ns({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return os(function(){o.value=n,o.getSnapshot=t,gn(o)&&i({inst:o})},[e,n,t]),rs(function(){return gn(o)&&i({inst:o}),e(function(){gn(o)&&i({inst:o})})},[e]),is(n),n}function gn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ts(e,n)}catch{return!0}}function as(e,t){return t()}var cs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?as:ss;Jr.useSyncExternalStore=ut.useSyncExternalStore!==void 0?ut.useSyncExternalStore:cs;Qr.exports=Jr;var ls=Qr.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rn=_,us=ls;function fs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ds=typeof Object.is=="function"?Object.is:fs,hs=us.useSyncExternalStore,gs=rn.useRef,ps=rn.useEffect,ms=rn.useMemo,ys=rn.useDebugValue;Gr.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=gs(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=ms(function(){function l(g){if(!u){if(u=!0,c=g,g=r(g),o!==void 0&&s.hasValue){var x=s.value;if(o(x,g))return f=x}return f=g}if(x=f,ds(c,g))return x;var p=r(g);return o!==void 0&&o(x,p)?x:(c=g,f=p)}var u=!1,c,f,d=n===void 0?null:n;return[function(){return l(t())},d===null?void 0:function(){return l(d())}]},[t,n,r,o]);var a=hs(e,i[0],i[1]);return ps(function(){s.hasValue=!0,s.value=a},[a]),ys(a),a};qr.exports=Gr;var xs=qr.exports;const ws=Ji(xs),sr=e=>{let t;const n=new Set,r=(l,u)=>{const c=typeof l=="function"?l(t):l;if(!Object.is(c,t)){const f=t;t=u??typeof c!="object"?c:Object.assign({},t,c),n.forEach(d=>d(t,f))}},o=()=>t,a={setState:r,getState:o,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{n.clear()}};return t=e(r,o,a),a},bs=e=>e?sr(e):sr,{useSyncExternalStoreWithSelector:vs}=ws;function jr(e,t=e.getState,n){const r=vs(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return _.useDebugValue(r),r}const ar=(e,t)=>{const n=bs(e),r=(o,i=t)=>jr(n,o,i);return Object.assign(r,n),r},Ss=(e,t)=>e?ar(e,t):ar;function ie(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}var _s={value:()=>{}};function on(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Yt(n)}function Yt(e){this._=e}function Es(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Yt.prototype=on.prototype={constructor:Yt,on:function(e,t){var n=this._,r=Es(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=Ns(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=cr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=cr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Yt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function Ns(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function cr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=_s,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var En="http://www.w3.org/1999/xhtml";const lr={svg:"http://www.w3.org/2000/svg",xhtml:En,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function sn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),lr.hasOwnProperty(t)?{space:lr[t],local:e}:e}function Cs(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===En&&t.documentElement.namespaceURI===En?t.createElement(e):t.createElementNS(n,e)}}function Ms(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function eo(e){var t=sn(e);return(t.local?Ms:Cs)(t)}function As(){}function On(e){return e==null?As:function(){return this.querySelector(e)}}function $s(e){typeof e!="function"&&(e=On(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,u,c=0;c<s;++c)(l=i[c])&&(u=e.call(l,l.__data__,c,i))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new fe(r,this._parents)}function ks(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ts(){return[]}function to(e){return e==null?Ts:function(){return this.querySelectorAll(e)}}function Ps(e){return function(){return ks(e.apply(this,arguments))}}function Ds(e){typeof e=="function"?e=Ps(e):e=to(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(r.push(e.call(l,l.__data__,u,s)),o.push(l));return new fe(r,o)}function no(e){return function(){return this.matches(e)}}function ro(e){return function(t){return t.matches(e)}}var Rs=Array.prototype.find;function zs(e){return function(){return Rs.call(this.children,e)}}function Is(){return this.firstElementChild}function Hs(e){return this.select(e==null?Is:zs(typeof e=="function"?e:ro(e)))}var Bs=Array.prototype.filter;function Os(){return Array.from(this.children)}function Ls(e){return function(){return Bs.call(this.children,e)}}function Vs(e){return this.selectAll(e==null?Os:Ls(typeof e=="function"?e:ro(e)))}function Fs(e){typeof e!="function"&&(e=no(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new fe(r,this._parents)}function oo(e){return new Array(e.length)}function Xs(){return new fe(this._enter||this._groups.map(oo),this._parents)}function Ut(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ut.prototype={constructor:Ut,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ys(e){return function(){return e}}function Ws(e,t,n,r,o,i){for(var s=0,a,l=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new Ut(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function Ks(e,t,n,r,o,i,s){var a,l,u=new Map,c=t.length,f=i.length,d=new Array(c),g;for(a=0;a<c;++a)(l=t[a])&&(d[a]=g=s.call(l,l.__data__,a,t)+"",u.has(g)?o[a]=l:u.set(g,l));for(a=0;a<f;++a)g=s.call(e,i[a],a,i)+"",(l=u.get(g))?(r[a]=l,l.__data__=i[a],u.delete(g)):n[a]=new Ut(e,i[a]);for(a=0;a<c;++a)(l=t[a])&&u.get(d[a])===l&&(o[a]=l)}function Zs(e){return e.__data__}function Us(e,t){if(!arguments.length)return Array.from(this,Zs);var n=t?Ks:Ws,r=this._parents,o=this._groups;typeof e!="function"&&(e=Ys(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),u=0;u<i;++u){var c=r[u],f=o[u],d=f.length,g=qs(e.call(c,c&&c.__data__,u,r)),x=g.length,p=a[u]=new Array(x),v=s[u]=new Array(x),m=l[u]=new Array(d);n(c,f,p,v,m,g,t);for(var E=0,M=0,y,A;E<x;++E)if(y=p[E]){for(E>=M&&(M=E+1);!(A=v[M])&&++M<x;);y._next=A||null}}return s=new fe(s,r),s._enter=a,s._exit=l,s}function qs(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Gs(){return new fe(this._exit||this._groups.map(oo),this._parents)}function Qs(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Js(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var u=n[l],c=r[l],f=u.length,d=a[l]=new Array(f),g,x=0;x<f;++x)(g=u[x]||c[x])&&(d[x]=g);for(;l<o;++l)a[l]=n[l];return new fe(a,this._parents)}function js(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function ea(e){e||(e=ta);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),u,c=0;c<a;++c)(u=s[c])&&(l[c]=u);l.sort(t)}return new fe(o,this._parents).order()}function ta(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function na(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ra(){return Array.from(this)}function oa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function ia(){let e=0;for(const t of this)++e;return e}function sa(){return!this.node()}function aa(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function ca(e){return function(){this.removeAttribute(e)}}function la(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ua(e,t){return function(){this.setAttribute(e,t)}}function fa(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function da(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ha(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ga(e,t){var n=sn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?la:ca:typeof t=="function"?n.local?ha:da:n.local?fa:ua)(n,t))}function io(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pa(e){return function(){this.style.removeProperty(e)}}function ma(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ya(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function xa(e,t,n){return arguments.length>1?this.each((t==null?pa:typeof t=="function"?ya:ma)(e,t,n??"")):ft(this.node(),e)}function ft(e,t){return e.style.getPropertyValue(t)||io(e).getComputedStyle(e,null).getPropertyValue(t)}function wa(e){return function(){delete this[e]}}function ba(e,t){return function(){this[e]=t}}function va(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Sa(e,t){return arguments.length>1?this.each((t==null?wa:typeof t=="function"?va:ba)(e,t)):this.node()[e]}function so(e){return e.trim().split(/^|\s+/)}function Ln(e){return e.classList||new ao(e)}function ao(e){this._node=e,this._names=so(e.getAttribute("class")||"")}ao.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function co(e,t){for(var n=Ln(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function lo(e,t){for(var n=Ln(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function _a(e){return function(){co(this,e)}}function Ea(e){return function(){lo(this,e)}}function Na(e,t){return function(){(t.apply(this,arguments)?co:lo)(this,e)}}function Ca(e,t){var n=so(e+"");if(arguments.length<2){for(var r=Ln(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Na:t?_a:Ea)(n,t))}function Ma(){this.textContent=""}function Aa(e){return function(){this.textContent=e}}function $a(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ka(e){return arguments.length?this.each(e==null?Ma:(typeof e=="function"?$a:Aa)(e)):this.node().textContent}function Ta(){this.innerHTML=""}function Pa(e){return function(){this.innerHTML=e}}function Da(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ra(e){return arguments.length?this.each(e==null?Ta:(typeof e=="function"?Da:Pa)(e)):this.node().innerHTML}function za(){this.nextSibling&&this.parentNode.appendChild(this)}function Ia(){return this.each(za)}function Ha(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ba(){return this.each(Ha)}function Oa(e){var t=typeof e=="function"?e:eo(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function La(){return null}function Va(e,t){var n=typeof e=="function"?e:eo(e),r=t==null?La:typeof t=="function"?t:On(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Fa(){var e=this.parentNode;e&&e.removeChild(this)}function Xa(){return this.each(Fa)}function Ya(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wa(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ka(e){return this.select(e?Wa:Ya)}function Za(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ua(e){return function(t){e.call(this,t,this.__data__)}}function qa(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ga(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Qa(e,t,n){return function(){var r=this.__on,o,i=Ua(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Ja(e,t,n){var r=qa(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(o=0,c=a[l];o<i;++o)if((s=r[o]).type===c.type&&s.name===c.name)return c.value}return}for(a=t?Qa:Ga,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function uo(e,t,n){var r=io(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ja(e,t){return function(){return uo(this,e,t)}}function ec(e,t){return function(){return uo(this,e,t.apply(this,arguments))}}function tc(e,t){return this.each((typeof t=="function"?ec:ja)(e,t))}function*nc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var fo=[null];function fe(e,t){this._groups=e,this._parents=t}function Pt(){return new fe([[document.documentElement]],fo)}function rc(){return this}fe.prototype=Pt.prototype={constructor:fe,select:$s,selectAll:Ds,selectChild:Hs,selectChildren:Vs,filter:Fs,data:Us,enter:Xs,exit:Gs,join:Qs,merge:Js,selection:rc,order:js,sort:ea,call:na,nodes:ra,node:oa,size:ia,empty:sa,each:aa,attr:ga,style:xa,property:Sa,classed:Ca,text:ka,html:Ra,raise:Ia,lower:Ba,append:Oa,insert:Va,remove:Xa,clone:Ka,datum:Za,on:Ja,dispatch:tc,[Symbol.iterator]:nc};function pe(e){return typeof e=="string"?new fe([[document.querySelector(e)]],[document.documentElement]):new fe([[e]],fo)}function oc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ve(e,t){if(e=oc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const ic={passive:!1},Nt={capture:!0,passive:!1};function pn(e){e.stopImmediatePropagation()}function st(e){e.preventDefault(),e.stopImmediatePropagation()}function ho(e){var t=e.document.documentElement,n=pe(e).on("dragstart.drag",st,Nt);"onselectstart"in t?n.on("selectstart.drag",st,Nt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function go(e,t){var n=e.document.documentElement,r=pe(e).on("dragstart.drag",null);t&&(r.on("click.drag",st,Nt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const zt=e=>()=>e;function Nn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Nn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function sc(e){return!e.ctrlKey&&!e.button}function ac(){return this.parentNode}function cc(e,t){return t??{x:e.x,y:e.y}}function lc(){return navigator.maxTouchPoints||"ontouchstart"in this}function uc(){var e=sc,t=ac,n=cc,r=lc,o={},i=on("start","drag","end"),s=0,a,l,u,c,f=0;function d(y){y.on("mousedown.drag",g).filter(r).on("touchstart.drag",v).on("touchmove.drag",m,ic).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(y,A){if(!(c||!e.call(this,y,A))){var I=M(this,t.call(this,y,A),y,A,"mouse");I&&(pe(y.view).on("mousemove.drag",x,Nt).on("mouseup.drag",p,Nt),ho(y.view),pn(y),u=!1,a=y.clientX,l=y.clientY,I("start",y))}}function x(y){if(st(y),!u){var A=y.clientX-a,I=y.clientY-l;u=A*A+I*I>f}o.mouse("drag",y)}function p(y){pe(y.view).on("mousemove.drag mouseup.drag",null),go(y.view,u),st(y),o.mouse("end",y)}function v(y,A){if(e.call(this,y,A)){var I=y.changedTouches,z=t.call(this,y,A),P=I.length,R,L;for(R=0;R<P;++R)(L=M(this,z,y,A,I[R].identifier,I[R]))&&(pn(y),L("start",y,I[R]))}}function m(y){var A=y.changedTouches,I=A.length,z,P;for(z=0;z<I;++z)(P=o[A[z].identifier])&&(st(y),P("drag",y,A[z]))}function E(y){var A=y.changedTouches,I=A.length,z,P;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),z=0;z<I;++z)(P=o[A[z].identifier])&&(pn(y),P("end",y,A[z]))}function M(y,A,I,z,P,R){var L=i.copy(),H=ve(R||I,A),O,N,h;if((h=n.call(y,new Nn("beforestart",{sourceEvent:I,target:d,identifier:P,active:s,x:H[0],y:H[1],dx:0,dy:0,dispatch:L}),z))!=null)return O=h.x-H[0]||0,N=h.y-H[1]||0,function S(b,$,D){var w=H,C;switch(b){case"start":o[P]=S,C=s++;break;case"end":delete o[P],--s;case"drag":H=ve(D||$,A),C=s;break}L.call(b,y,new Nn(b,{sourceEvent:$,subject:h,target:d,identifier:P,active:C,x:H[0]+O,y:H[1]+N,dx:H[0]-w[0],dy:H[1]-w[1],dispatch:L}),z)}}return d.filter=function(y){return arguments.length?(e=typeof y=="function"?y:zt(!!y),d):e},d.container=function(y){return arguments.length?(t=typeof y=="function"?y:zt(y),d):t},d.subject=function(y){return arguments.length?(n=typeof y=="function"?y:zt(y),d):n},d.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:zt(!!y),d):r},d.on=function(){var y=i.on.apply(i,arguments);return y===i?d:y},d.clickDistance=function(y){return arguments.length?(f=(y=+y)*y,d):Math.sqrt(f)},d}function Vn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function po(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Dt(){}var Ct=.7,qt=1/Ct,at="\\s*([+-]?\\d+)\\s*",Mt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fc=/^#([0-9a-f]{3,8})$/,dc=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),hc=new RegExp(`^rgb\\(${Se},${Se},${Se}\\)$`),gc=new RegExp(`^rgba\\(${at},${at},${at},${Mt}\\)$`),pc=new RegExp(`^rgba\\(${Se},${Se},${Se},${Mt}\\)$`),mc=new RegExp(`^hsl\\(${Mt},${Se},${Se}\\)$`),yc=new RegExp(`^hsla\\(${Mt},${Se},${Se},${Mt}\\)$`),ur={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vn(Dt,At,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:fr,formatHex:fr,formatHex8:xc,formatHsl:wc,formatRgb:dr,toString:dr});function fr(){return this.rgb().formatHex()}function xc(){return this.rgb().formatHex8()}function wc(){return mo(this).formatHsl()}function dr(){return this.rgb().formatRgb()}function At(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=fc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?hr(t):n===3?new ce(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?It(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?It(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dc.exec(e))?new ce(t[1],t[2],t[3],1):(t=hc.exec(e))?new ce(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=gc.exec(e))?It(t[1],t[2],t[3],t[4]):(t=pc.exec(e))?It(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=mc.exec(e))?mr(t[1],t[2]/100,t[3]/100,1):(t=yc.exec(e))?mr(t[1],t[2]/100,t[3]/100,t[4]):ur.hasOwnProperty(e)?hr(ur[e]):e==="transparent"?new ce(NaN,NaN,NaN,0):null}function hr(e){return new ce(e>>16&255,e>>8&255,e&255,1)}function It(e,t,n,r){return r<=0&&(e=t=n=NaN),new ce(e,t,n,r)}function bc(e){return e instanceof Dt||(e=At(e)),e?(e=e.rgb(),new ce(e.r,e.g,e.b,e.opacity)):new ce}function Cn(e,t,n,r){return arguments.length===1?bc(e):new ce(e,t,n,r??1)}function ce(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Vn(ce,Cn,po(Dt,{brighter(e){return e=e==null?qt:Math.pow(qt,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ct:Math.pow(Ct,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ce(Ue(this.r),Ue(this.g),Ue(this.b),Gt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gr,formatHex:gr,formatHex8:vc,formatRgb:pr,toString:pr}));function gr(){return`#${Ke(this.r)}${Ke(this.g)}${Ke(this.b)}`}function vc(){return`#${Ke(this.r)}${Ke(this.g)}${Ke(this.b)}${Ke((isNaN(this.opacity)?1:this.opacity)*255)}`}function pr(){const e=Gt(this.opacity);return`${e===1?"rgb(":"rgba("}${Ue(this.r)}, ${Ue(this.g)}, ${Ue(this.b)}${e===1?")":`, ${e})`}`}function Gt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ue(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ke(e){return e=Ue(e),(e<16?"0":"")+e.toString(16)}function mr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new me(e,t,n,r)}function mo(e){if(e instanceof me)return new me(e.h,e.s,e.l,e.opacity);if(e instanceof Dt||(e=At(e)),!e)return new me;if(e instanceof me)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new me(s,a,l,e.opacity)}function Sc(e,t,n,r){return arguments.length===1?mo(e):new me(e,t,n,r??1)}function me(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Vn(me,Sc,po(Dt,{brighter(e){return e=e==null?qt:Math.pow(qt,e),new me(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ct:Math.pow(Ct,e),new me(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ce(mn(e>=240?e-240:e+120,o,r),mn(e,o,r),mn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new me(yr(this.h),Ht(this.s),Ht(this.l),Gt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gt(this.opacity);return`${e===1?"hsl(":"hsla("}${yr(this.h)}, ${Ht(this.s)*100}%, ${Ht(this.l)*100}%${e===1?")":`, ${e})`}`}}));function yr(e){return e=(e||0)%360,e<0?e+360:e}function Ht(e){return Math.max(0,Math.min(1,e||0))}function mn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const yo=e=>()=>e;function _c(e,t){return function(n){return e+n*t}}function Ec(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Nc(e){return(e=+e)==1?xo:function(t,n){return n-t?Ec(t,n,e):yo(isNaN(t)?n:t)}}function xo(e,t){var n=t-e;return n?_c(e,n):yo(isNaN(e)?t:e)}const xr=function e(t){var n=Nc(t);function r(o,i){var s=n((o=Cn(o)).r,(i=Cn(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),u=xo(o.opacity,i.opacity);return function(c){return o.r=s(c),o.g=a(c),o.b=l(c),o.opacity=u(c),o+""}}return r.gamma=e,r}(1);function Pe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yn=new RegExp(Mn.source,"g");function Cc(e){return function(){return e}}function Mc(e){return function(t){return e(t)+""}}function Ac(e,t){var n=Mn.lastIndex=yn.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Mn.exec(e))&&(o=yn.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:Pe(r,o)})),n=yn.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?Mc(l[0].x):Cc(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}var wr=180/Math.PI,An={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wo(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*wr,skewX:Math.atan(l)*wr,scaleX:s,scaleY:a}}var Bt;function $c(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?An:wo(t.a,t.b,t.c,t.d,t.e,t.f)}function kc(e){return e==null||(Bt||(Bt=document.createElementNS("http://www.w3.org/2000/svg","g")),Bt.setAttribute("transform",e),!(e=Bt.transform.baseVal.consolidate()))?An:(e=e.matrix,wo(e.a,e.b,e.c,e.d,e.e,e.f))}function bo(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,c,f,d,g,x){if(u!==f||c!==d){var p=g.push("translate(",null,t,null,n);x.push({i:p-4,x:Pe(u,f)},{i:p-2,x:Pe(c,d)})}else(f||d)&&g.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(o(f)+"rotate(",null,r)-2,x:Pe(u,c)})):c&&f.push(o(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(o(f)+"skewX(",null,r)-2,x:Pe(u,c)}):c&&f.push(o(f)+"skewX("+c+r)}function l(u,c,f,d,g,x){if(u!==f||c!==d){var p=g.push(o(g)+"scale(",null,",",null,")");x.push({i:p-4,x:Pe(u,f)},{i:p-2,x:Pe(c,d)})}else(f!==1||d!==1)&&g.push(o(g)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),i(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(g){for(var x=-1,p=d.length,v;++x<p;)f[(v=d[x]).i]=v.x(g);return f.join("")}}}var Tc=bo($c,"px, ","px)","deg)"),Pc=bo(kc,", ",")",")"),Dc=1e-12;function br(e){return((e=Math.exp(e))+1/e)/2}function Rc(e){return((e=Math.exp(e))-1/e)/2}function zc(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ic=function e(t,n,r){function o(i,s){var a=i[0],l=i[1],u=i[2],c=s[0],f=s[1],d=s[2],g=c-a,x=f-l,p=g*g+x*x,v,m;if(p<Dc)m=Math.log(d/u)/t,v=function(z){return[a+z*g,l+z*x,u*Math.exp(t*z*m)]};else{var E=Math.sqrt(p),M=(d*d-u*u+r*p)/(2*u*n*E),y=(d*d-u*u-r*p)/(2*d*n*E),A=Math.log(Math.sqrt(M*M+1)-M),I=Math.log(Math.sqrt(y*y+1)-y);m=(I-A)/t,v=function(z){var P=z*m,R=br(A),L=u/(n*E)*(R*zc(t*P+A)-Rc(A));return[a+L*g,l+L*x,u*R/br(t*P+A)]}}return v.duration=m*1e3*t/Math.SQRT2,v}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var dt=0,_t=0,xt=0,vo=1e3,Qt,Et,Jt=0,Ge=0,an=0,$t=typeof performance=="object"&&performance.now?performance:Date,So=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Fn(){return Ge||(So(Hc),Ge=$t.now()+an)}function Hc(){Ge=0}function jt(){this._call=this._time=this._next=null}jt.prototype=_o.prototype={constructor:jt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Fn():+n)+(t==null?0:+t),!this._next&&Et!==this&&(Et?Et._next=this:Qt=this,Et=this),this._call=e,this._time=n,$n()},stop:function(){this._call&&(this._call=null,this._time=1/0,$n())}};function _o(e,t,n){var r=new jt;return r.restart(e,t,n),r}function Bc(){Fn(),++dt;for(var e=Qt,t;e;)(t=Ge-e._time)>=0&&e._call.call(void 0,t),e=e._next;--dt}function vr(){Ge=(Jt=$t.now())+an,dt=_t=0;try{Bc()}finally{dt=0,Lc(),Ge=0}}function Oc(){var e=$t.now(),t=e-Jt;t>vo&&(an-=t,Jt=e)}function Lc(){for(var e,t=Qt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qt=n);Et=e,$n(r)}function $n(e){if(!dt){_t&&(_t=clearTimeout(_t));var t=e-Ge;t>24?(e<1/0&&(_t=setTimeout(vr,e-$t.now()-an)),xt&&(xt=clearInterval(xt))):(xt||(Jt=$t.now(),xt=setInterval(Oc,vo)),dt=1,So(vr))}}function Sr(e,t,n){var r=new jt;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Vc=on("start","end","cancel","interrupt"),Fc=[],Eo=0,_r=1,kn=2,Wt=3,Er=4,Tn=5,Kt=6;function cn(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Xc(e,n,{name:t,index:r,group:o,on:Vc,tween:Fc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Eo})}function Xn(e,t){var n=xe(e,t);if(n.state>Eo)throw new Error("too late; already scheduled");return n}function _e(e,t){var n=xe(e,t);if(n.state>Wt)throw new Error("too late; already running");return n}function xe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Xc(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=_o(i,0,n.time);function i(u){n.state=_r,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var c,f,d,g;if(n.state!==_r)return l();for(c in r)if(g=r[c],g.name===n.name){if(g.state===Wt)return Sr(s);g.state===Er?(g.state=Kt,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[c]):+c<t&&(g.state=Kt,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[c])}if(Sr(function(){n.state===Wt&&(n.state=Er,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=kn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===kn){for(n.state=Wt,o=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(g=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=g);o.length=f+1}}function a(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Tn,1),f=-1,d=o.length;++f<d;)o[f].call(e,c);n.state===Tn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Kt,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Zt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>kn&&r.state<Tn,r.state=Kt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function Yc(e){return this.each(function(){Zt(this,e)})}function Wc(e,t){var n,r;return function(){var o=_e(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Kc(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=_e(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,u=o.length;l<u;++l)if(o[l].name===t){o[l]=a;break}l===u&&o.push(a)}i.tween=o}}function Zc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=xe(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Wc:Kc)(n,e,t))}function Yn(e,t,n){var r=e._id;return e.each(function(){var o=_e(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return xe(o,r).value[t]}}function No(e,t){var n;return(typeof t=="number"?Pe:t instanceof At?xr:(n=At(t))?(t=n,xr):Ac)(e,t)}function Uc(e){return function(){this.removeAttribute(e)}}function qc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Gc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Qc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Jc(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function jc(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function el(e,t){var n=sn(e),r=n==="transform"?Pc:No;return this.attrTween(e,typeof t=="function"?(n.local?jc:Jc)(n,r,Yn(this,"attr."+e,t)):t==null?(n.local?qc:Uc)(n):(n.local?Qc:Gc)(n,r,t))}function tl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function nl(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function rl(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&nl(e,i)),n}return o._value=t,o}function ol(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&tl(e,i)),n}return o._value=t,o}function il(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=sn(e);return this.tween(n,(r.local?rl:ol)(r,t))}function sl(e,t){return function(){Xn(this,e).delay=+t.apply(this,arguments)}}function al(e,t){return t=+t,function(){Xn(this,e).delay=t}}function cl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?sl:al)(t,e)):xe(this.node(),t).delay}function ll(e,t){return function(){_e(this,e).duration=+t.apply(this,arguments)}}function ul(e,t){return t=+t,function(){_e(this,e).duration=t}}function fl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ll:ul)(t,e)):xe(this.node(),t).duration}function dl(e,t){if(typeof t!="function")throw new Error;return function(){_e(this,e).ease=t}}function hl(e){var t=this._id;return arguments.length?this.each(dl(t,e)):xe(this.node(),t).ease}function gl(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;_e(this,e).ease=n}}function pl(e){if(typeof e!="function")throw new Error;return this.each(gl(this._id,e))}function ml(e){typeof e!="function"&&(e=no(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new Me(r,this._parents,this._name,this._id)}function yl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],u=n[a],c=l.length,f=s[a]=new Array(c),d,g=0;g<c;++g)(d=l[g]||u[g])&&(f[g]=d);for(;a<r;++a)s[a]=t[a];return new Me(s,this._parents,this._name,this._id)}function xl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function wl(e,t,n){var r,o,i=xl(t)?Xn:_e;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function bl(e,t){var n=this._id;return arguments.length<2?xe(this.node(),n).on.on(e):this.each(wl(n,e,t))}function vl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Sl(){return this.on("end.remove",vl(this._id))}function _l(e){var t=this._name,n=this._id;typeof e!="function"&&(e=On(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,u=i[s]=new Array(l),c,f,d=0;d<l;++d)(c=a[d])&&(f=e.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),u[d]=f,cn(u[d],t,n,d,u,xe(c,n)));return new Me(i,this._parents,t,n)}function El(e){var t=this._name,n=this._id;typeof e!="function"&&(e=to(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var d=e.call(c,c.__data__,f,l),g,x=xe(c,n),p=0,v=d.length;p<v;++p)(g=d[p])&&cn(g,t,n,p,d,x);i.push(d),s.push(c)}return new Me(i,s,t,n)}var Nl=Pt.prototype.constructor;function Cl(){return new Nl(this._groups,this._parents)}function Ml(e,t){var n,r,o;return function(){var i=ft(this,e),s=(this.style.removeProperty(e),ft(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function Co(e){return function(){this.style.removeProperty(e)}}function Al(e,t,n){var r,o=n+"",i;return function(){var s=ft(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function $l(e,t,n){var r,o,i;return function(){var s=ft(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),ft(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function kl(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=_e(this,e),u=l.on,c=l.value[i]==null?a||(a=Co(t)):void 0;(u!==n||o!==c)&&(r=(n=u).copy()).on(s,o=c),l.on=r}}function Tl(e,t,n){var r=(e+="")=="transform"?Tc:No;return t==null?this.styleTween(e,Ml(e,r)).on("end.style."+e,Co(e)):typeof t=="function"?this.styleTween(e,$l(e,r,Yn(this,"style."+e,t))).each(kl(this._id,e)):this.styleTween(e,Al(e,r,t),n).on("end.style."+e,null)}function Pl(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Dl(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Pl(e,s,n)),r}return i._value=t,i}function Rl(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Dl(e,t,n??""))}function zl(e){return function(){this.textContent=e}}function Il(e){return function(){var t=e(this);this.textContent=t??""}}function Hl(e){return this.tween("text",typeof e=="function"?Il(Yn(this,"text",e)):zl(e==null?"":e+""))}function Bl(e){return function(t){this.textContent=e.call(this,t)}}function Ol(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Bl(o)),t}return r._value=e,r}function Ll(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Ol(e))}function Vl(){for(var e=this._name,t=this._id,n=Mo(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,u=0;u<a;++u)if(l=s[u]){var c=xe(l,t);cn(l,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Me(r,this._parents,e,n)}function Fl(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var u=_e(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),o===0&&i()})}var Xl=0;function Me(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Mo(){return++Xl}var Ne=Pt.prototype;Me.prototype={constructor:Me,select:_l,selectAll:El,selectChild:Ne.selectChild,selectChildren:Ne.selectChildren,filter:ml,merge:yl,selection:Cl,transition:Vl,call:Ne.call,nodes:Ne.nodes,node:Ne.node,size:Ne.size,empty:Ne.empty,each:Ne.each,on:bl,attr:el,attrTween:il,style:Tl,styleTween:Rl,text:Hl,textTween:Ll,remove:Sl,tween:Zc,delay:cl,duration:fl,ease:hl,easeVarying:pl,end:Fl,[Symbol.iterator]:Ne[Symbol.iterator]};function Yl(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Wl={time:null,delay:0,duration:250,ease:Yl};function Kl(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Zl(e){var t,n;e instanceof Me?(t=e._id,e=e._name):(t=Mo(),(n=Wl).time=Fn(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&cn(l,e,t,u,s,n||Kl(l,t));return new Me(r,this._parents,e,t)}Pt.prototype.interrupt=Yc;Pt.prototype.transition=Zl;const Ot=e=>()=>e;function Ul(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ce(e,t,n){this.k=e,this.x=t,this.y=n}Ce.prototype={constructor:Ce,scale:function(e){return e===1?this:new Ce(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ce(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ze=new Ce(1,0,0);Ce.prototype;function xn(e){e.stopImmediatePropagation()}function wt(e){e.preventDefault(),e.stopImmediatePropagation()}function ql(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Gl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Nr(){return this.__zoom||ze}function Ql(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Jl(){return navigator.maxTouchPoints||"ontouchstart"in this}function jl(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function eu(){var e=ql,t=Gl,n=jl,r=Ql,o=Jl,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Ic,u=on("start","zoom","end"),c,f,d,g=500,x=150,p=0,v=10;function m(h){h.property("__zoom",Nr).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",L).filter(o).on("touchstart.zoom",H).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(h,S,b,$){var D=h.selection?h.selection():h;D.property("__zoom",Nr),h!==D?A(h,S,b,$):D.interrupt().each(function(){I(this,arguments).event($).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},m.scaleBy=function(h,S,b,$){m.scaleTo(h,function(){var D=this.__zoom.k,w=typeof S=="function"?S.apply(this,arguments):S;return D*w},b,$)},m.scaleTo=function(h,S,b,$){m.transform(h,function(){var D=t.apply(this,arguments),w=this.__zoom,C=b==null?y(D):typeof b=="function"?b.apply(this,arguments):b,k=w.invert(C),B=typeof S=="function"?S.apply(this,arguments):S;return n(M(E(w,B),C,k),D,s)},b,$)},m.translateBy=function(h,S,b,$){m.transform(h,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof b=="function"?b.apply(this,arguments):b),t.apply(this,arguments),s)},null,$)},m.translateTo=function(h,S,b,$,D){m.transform(h,function(){var w=t.apply(this,arguments),C=this.__zoom,k=$==null?y(w):typeof $=="function"?$.apply(this,arguments):$;return n(ze.translate(k[0],k[1]).scale(C.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof b=="function"?-b.apply(this,arguments):-b),w,s)},$,D)};function E(h,S){return S=Math.max(i[0],Math.min(i[1],S)),S===h.k?h:new Ce(S,h.x,h.y)}function M(h,S,b){var $=S[0]-b[0]*h.k,D=S[1]-b[1]*h.k;return $===h.x&&D===h.y?h:new Ce(h.k,$,D)}function y(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function A(h,S,b,$){h.on("start.zoom",function(){I(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event($).end()}).tween("zoom",function(){var D=this,w=arguments,C=I(D,w).event($),k=t.apply(D,w),B=b==null?y(k):typeof b=="function"?b.apply(D,w):b,V=Math.max(k[1][0]-k[0][0],k[1][1]-k[0][1]),F=D.__zoom,K=typeof S=="function"?S.apply(D,w):S,Z=l(F.invert(B).concat(V/F.k),K.invert(B).concat(V/K.k));return function(U){if(U===1)U=K;else{var q=Z(U),Q=V/q[2];U=new Ce(Q,B[0]-q[0]*Q,B[1]-q[1]*Q)}C.zoom(null,U)}})}function I(h,S,b){return!b&&h.__zooming||new z(h,S)}function z(h,S){this.that=h,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(h,S),this.taps=0}z.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,S){return this.mouse&&h!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var S=pe(this.that).datum();u.call(h,this.that,new Ul(h,{sourceEvent:this.sourceEvent,target:m,type:h,transform:this.that.__zoom,dispatch:u}),S)}};function P(h,...S){if(!e.apply(this,arguments))return;var b=I(this,S).event(h),$=this.__zoom,D=Math.max(i[0],Math.min(i[1],$.k*Math.pow(2,r.apply(this,arguments)))),w=ve(h);if(b.wheel)(b.mouse[0][0]!==w[0]||b.mouse[0][1]!==w[1])&&(b.mouse[1]=$.invert(b.mouse[0]=w)),clearTimeout(b.wheel);else{if($.k===D)return;b.mouse=[w,$.invert(w)],Zt(this),b.start()}wt(h),b.wheel=setTimeout(C,x),b.zoom("mouse",n(M(E($,D),b.mouse[0],b.mouse[1]),b.extent,s));function C(){b.wheel=null,b.end()}}function R(h,...S){if(d||!e.apply(this,arguments))return;var b=h.currentTarget,$=I(this,S,!0).event(h),D=pe(h.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",V,!0),w=ve(h,b),C=h.clientX,k=h.clientY;ho(h.view),xn(h),$.mouse=[w,this.__zoom.invert(w)],Zt(this),$.start();function B(F){if(wt(F),!$.moved){var K=F.clientX-C,Z=F.clientY-k;$.moved=K*K+Z*Z>p}$.event(F).zoom("mouse",n(M($.that.__zoom,$.mouse[0]=ve(F,b),$.mouse[1]),$.extent,s))}function V(F){D.on("mousemove.zoom mouseup.zoom",null),go(F.view,$.moved),wt(F),$.event(F).end()}}function L(h,...S){if(e.apply(this,arguments)){var b=this.__zoom,$=ve(h.changedTouches?h.changedTouches[0]:h,this),D=b.invert($),w=b.k*(h.shiftKey?.5:2),C=n(M(E(b,w),$,D),t.apply(this,S),s);wt(h),a>0?pe(this).transition().duration(a).call(A,C,$,h):pe(this).call(m.transform,C,$,h)}}function H(h,...S){if(e.apply(this,arguments)){var b=h.touches,$=b.length,D=I(this,S,h.changedTouches.length===$).event(h),w,C,k,B;for(xn(h),C=0;C<$;++C)k=b[C],B=ve(k,this),B=[B,this.__zoom.invert(B),k.identifier],D.touch0?!D.touch1&&D.touch0[2]!==B[2]&&(D.touch1=B,D.taps=0):(D.touch0=B,w=!0,D.taps=1+!!c);c&&(c=clearTimeout(c)),w&&(D.taps<2&&(f=B[0],c=setTimeout(function(){c=null},g)),Zt(this),D.start())}}function O(h,...S){if(this.__zooming){var b=I(this,S).event(h),$=h.changedTouches,D=$.length,w,C,k,B;for(wt(h),w=0;w<D;++w)C=$[w],k=ve(C,this),b.touch0&&b.touch0[2]===C.identifier?b.touch0[0]=k:b.touch1&&b.touch1[2]===C.identifier&&(b.touch1[0]=k);if(C=b.that.__zoom,b.touch1){var V=b.touch0[0],F=b.touch0[1],K=b.touch1[0],Z=b.touch1[1],U=(U=K[0]-V[0])*U+(U=K[1]-V[1])*U,q=(q=Z[0]-F[0])*q+(q=Z[1]-F[1])*q;C=E(C,Math.sqrt(U/q)),k=[(V[0]+K[0])/2,(V[1]+K[1])/2],B=[(F[0]+Z[0])/2,(F[1]+Z[1])/2]}else if(b.touch0)k=b.touch0[0],B=b.touch0[1];else return;b.zoom("touch",n(M(C,k,B),b.extent,s))}}function N(h,...S){if(this.__zooming){var b=I(this,S).event(h),$=h.changedTouches,D=$.length,w,C;for(xn(h),d&&clearTimeout(d),d=setTimeout(function(){d=null},g),w=0;w<D;++w)C=$[w],b.touch0&&b.touch0[2]===C.identifier?delete b.touch0:b.touch1&&b.touch1[2]===C.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),b.taps===2&&(C=ve(C,this),Math.hypot(f[0]-C[0],f[1]-C[1])<v)){var k=pe(this).on("dblclick.zoom");k&&k.apply(this,arguments)}}}return m.wheelDelta=function(h){return arguments.length?(r=typeof h=="function"?h:Ot(+h),m):r},m.filter=function(h){return arguments.length?(e=typeof h=="function"?h:Ot(!!h),m):e},m.touchable=function(h){return arguments.length?(o=typeof h=="function"?h:Ot(!!h),m):o},m.extent=function(h){return arguments.length?(t=typeof h=="function"?h:Ot([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),m):t},m.scaleExtent=function(h){return arguments.length?(i[0]=+h[0],i[1]=+h[1],m):[i[0],i[1]]},m.translateExtent=function(h){return arguments.length?(s[0][0]=+h[0][0],s[1][0]=+h[1][0],s[0][1]=+h[0][1],s[1][1]=+h[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(h){return arguments.length?(n=h,m):n},m.duration=function(h){return arguments.length?(a=+h,m):a},m.interpolate=function(h){return arguments.length?(l=h,m):l},m.on=function(){var h=u.on.apply(u,arguments);return h===u?m:h},m.clickDistance=function(h){return arguments.length?(p=(h=+h)*h,m):Math.sqrt(p)},m.tapDistance=function(h){return arguments.length?(v=+h,m):v},m}const ln=_.createContext(null),tu=ln.Provider,Ae={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Ao=Ae.error001();function j(e,t){const n=_.useContext(ln);if(n===null)throw new Error(Ao);return jr(n,e,t)}const ne=()=>{const e=_.useContext(ln);if(e===null)throw new Error(Ao);return _.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},nu=e=>e.userSelectionActive?"none":"all";function ru({position:e,children:t,className:n,style:r,...o}){const i=j(nu),s=`${e}`.split("-");return T.createElement("div",{className:de(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o},t)}function ou({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:T.createElement(ru,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev"},T.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const iu=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...c})=>{const f=_.useRef(null),[d,g]=_.useState({x:0,y:0,width:0,height:0}),x=de(["react-flow__edge-textwrapper",u]);return _.useEffect(()=>{if(f.current){const p=f.current.getBBox();g({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:T.createElement("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:x,visibility:d.width?"visible":"hidden",...c},o&&T.createElement("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),T.createElement("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:f,style:r},n),l)};var su=_.memo(iu);const Wn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ht=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Kn=(e={x:0,y:0},t)=>({x:ht(e.x,t[0][0],t[1][0]),y:ht(e.y,t[0][1],t[1][1])}),Cr=(e,t,n)=>e<t?ht(Math.abs(e-t),1,50)/50:e>n?-ht(Math.abs(e-n),1,50)/50:0,$o=(e,t)=>{const n=Cr(e.x,35,t.width-35)*20,r=Cr(e.y,35,t.height-35)*20;return[n,r]},ko=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},au=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Zn=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),cu=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Mr=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Pn=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},lu=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),te=Symbol.for("internals"),To=["Enter"," ","Escape"],uu=(e,t)=>{},fu=e=>"nativeEvent"in e;function Dn(e){var o,i;const t=fu(e)?e.nativeEvent:e,n=((i=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Po=e=>"clientX"in e,Ie=(e,t)=>{var i,s;const n=Po(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},en=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Rt=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:f,markerStart:d,interactionWidth:g=20})=>T.createElement(T.Fragment,null,T.createElement("path",{id:e,style:c,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:d}),g&&T.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),o&&he(n)&&he(r)?T.createElement(su,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u}):null);Rt.displayName="BaseEdge";function bt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function Do({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Ro({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+o*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+r*.125,c=Math.abs(l-e),f=Math.abs(u-t);return[l,u,c,f]}var Qe;(function(e){e.Strict="strict",e.Loose="loose"})(Qe||(Qe={}));var Ze;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ze||(Ze={}));var kt;(function(e){e.Partial="partial",e.Full="full"})(kt||(kt={}));var Re;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Re||(Re={}));var tn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(tn||(tn={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));function Ar({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===X.Left||e===X.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function zo({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top}){const[s,a]=Ar({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,u]=Ar({pos:i,x1:r,y1:o,x2:e,y2:t}),[c,f,d,g]=Ro({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${a} ${l},${u} ${r},${o}`,c,f,d,g]}const Un=_.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:i=X.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:x,interactionWidth:p})=>{const[v,m,E]=zo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return T.createElement(Rt,{path:v,labelX:m,labelY:E,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:x,interactionWidth:p})});Un.displayName="SimpleBezierEdge";const $r={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},du=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},kr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function hu({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:r=X.Top,center:o,offset:i}){const s=$r[t],a=$r[r],l={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},c=du({source:l,sourcePosition:t,target:u}),f=c.x!==0?"x":"y",d=c[f];let g=[],x,p;const v={x:0,y:0},m={x:0,y:0},[E,M,y,A]=Do({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*a[f]===-1){x=o.x||E,p=o.y||M;const z=[{x,y:l.y},{x,y:u.y}],P=[{x:l.x,y:p},{x:u.x,y:p}];s[f]===d?g=f==="x"?z:P:g=f==="x"?P:z}else{const z=[{x:l.x,y:u.y}],P=[{x:u.x,y:l.y}];if(f==="x"?g=s.x===d?P:z:g=s.y===d?z:P,t===r){const N=Math.abs(e[f]-n[f]);if(N<=i){const h=Math.min(i-1,i-N);s[f]===d?v[f]=(l[f]>e[f]?-1:1)*h:m[f]=(u[f]>n[f]?-1:1)*h}}if(t!==r){const N=f==="x"?"y":"x",h=s[f]===a[N],S=l[N]>u[N],b=l[N]<u[N];(s[f]===1&&(!h&&S||h&&b)||s[f]!==1&&(!h&&b||h&&S))&&(g=f==="x"?z:P)}const R={x:l.x+v.x,y:l.y+v.y},L={x:u.x+m.x,y:u.y+m.y},H=Math.max(Math.abs(R.x-g[0].x),Math.abs(L.x-g[0].x)),O=Math.max(Math.abs(R.y-g[0].y),Math.abs(L.y-g[0].y));H>=O?(x=(R.x+L.x)/2,p=g[0].y):(x=g[0].x,p=(R.y+L.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...g,{x:u.x+m.x,y:u.y+m.y},n],x,p,y,A]}function gu(e,t,n,r){const o=Math.min(kr(e,t)/2,kr(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,c=e.y<n.y?1:-1;return`L ${i+o*u},${s}Q ${i},${s} ${i},${s+o*c}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function Rn({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top,borderRadius:s=5,centerX:a,centerY:l,offset:u=20}){const[c,f,d,g,x]=hu({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:u});return[c.reduce((v,m,E)=>{let M="";return E>0&&E<c.length-1?M=gu(c[E-1],m,c[E+1],s):M=`${E===0?"M":"L"}${m.x} ${m.y}`,v+=M,v},""),f,d,g,x]}const un=_.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,sourcePosition:f=X.Bottom,targetPosition:d=X.Top,markerEnd:g,markerStart:x,pathOptions:p,interactionWidth:v})=>{const[m,E,M]=Rn({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:d,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset});return T.createElement(Rt,{path:m,labelX:E,labelY:M,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:g,markerStart:x,interactionWidth:v})});un.displayName="SmoothStepEdge";const qn=_.memo(e=>{var t;return T.createElement(un,{...e,pathOptions:_.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});qn.displayName="StepEdge";function pu({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Do({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const Gn=_.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:f,markerStart:d,interactionWidth:g})=>{const[x,p,v]=pu({sourceX:e,sourceY:t,targetX:n,targetY:r});return T.createElement(Rt,{path:x,labelX:p,labelY:v,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:f,markerStart:d,interactionWidth:g})});Gn.displayName="StraightEdge";function Lt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Tr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case X.Left:return[t-Lt(t-r,i),n];case X.Right:return[t+Lt(r-t,i),n];case X.Top:return[t,n-Lt(n-o,i)];case X.Bottom:return[t,n+Lt(o-n,i)]}}function Io({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top,curvature:s=.25}){const[a,l]=Tr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[u,c]=Tr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[f,d,g,x]=Ro({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${e},${t} C${a},${l} ${u},${c} ${r},${o}`,f,d,g,x]}const nn=_.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:i=X.Top,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:x,pathOptions:p,interactionWidth:v})=>{const[m,E,M]=Io({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:p==null?void 0:p.curvature});return T.createElement(Rt,{path:m,labelX:E,labelY:M,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:x,interactionWidth:v})});nn.displayName="BezierEdge";const Qn=_.createContext(null),mu=Qn.Provider;Qn.Consumer;const yu=()=>_.useContext(Qn),xu=e=>"id"in e&&"source"in e&&"target"in e,wu=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,zn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,bu=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Ho=(e,t)=>{if(!e.source||!e.target)return t;let n;return xu(e)?n={...e}:n={...e,id:wu(e)},bu(n,t)?t:t.concat(n)},Bo=({x:e,y:t},[n,r,o],i,[s,a])=>{const l={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(l.x/s),y:a*Math.round(l.y/a)}:l},vu=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),ct=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},Jn=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:i,y:s}=ct(o,t).positionAbsolute;return au(r,Zn({x:i,y:s,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return cu(n)},Oo=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const l={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(c=>{const{width:f,height:d,selectable:g=!0,hidden:x=!1}=c;if(s&&!g||x)return!1;const{positionAbsolute:p}=ct(c,a),v={x:p.x,y:p.y,width:f||0,height:d||0},m=Pn(l,v),E=typeof f>"u"||typeof d>"u"||f===null||d===null,M=i&&m>0,y=(f||0)*(d||0);(E||M||m>=y||c.dragging)&&u.push(c)}),u},Lo=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Vo=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),u=ht(l,r,o),c=e.x+e.width/2,f=e.y+e.height/2,d=t/2-c*u,g=n/2-f*u;return[d,g,u]},We=(e,t=0)=>e.transition().duration(t);function Pr(e,t,n,r){return(t[n]||[]).reduce((o,i)=>{var s,a;return`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+i.x+i.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+i.y+i.height/2}),o},[])}function Su(e,t,n,r,o,i){const{x:s,y:a}=Ie(e),u=t.elementsFromPoint(s,a).find(x=>x.classList.contains("react-flow__handle"));if(u){const x=u.getAttribute("data-nodeid");if(x){const p=jn(void 0,u),v=u.getAttribute("data-handleid"),m=i({nodeId:x,id:v,type:p});if(m)return{handle:{id:v,type:p,nodeId:x,x:n.x,y:n.y},validHandleResult:m}}}let c=[],f=1/0;if(o.forEach(x=>{const p=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(p<=r){const v=i(x);p<=f&&(p<f?c=[{handle:x,validHandleResult:v}]:p===f&&c.push({handle:x,validHandleResult:v}),f=p)}}),!c.length)return{handle:null,validHandleResult:Fo()};if(c.length===1)return c[0];const d=c.some(({validHandleResult:x})=>x.isValid),g=c.some(({handle:x})=>x.type==="target");return c.find(({handle:x,validHandleResult:p})=>g?x.type==="target":d?p.isValid:!0)||c[0]}const _u={source:null,target:null,sourceHandle:null,targetHandle:null},Fo=()=>({handleDomNode:null,isValid:!1,connection:_u,endHandle:null});function Xo(e,t,n,r,o,i,s){const a=o==="target",l=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Fo(),handleDomNode:l};if(l){const c=jn(void 0,l),f=l.getAttribute("data-nodeid"),d=l.getAttribute("data-handleid"),g=l.classList.contains("connectable"),x=l.classList.contains("connectableend"),p={source:a?f:n,sourceHandle:a?d:r,target:a?n:f,targetHandle:a?r:d};u.connection=p,g&&x&&(t===Qe.Strict?a&&c==="source"||!a&&c==="target":f!==n||d!==r)&&(u.endHandle={nodeId:f,handleId:d,type:c},u.isValid=i(p))}return u}function Eu({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,i)=>{if(i[te]){const{handleBounds:s}=i[te];let a=[],l=[];s&&(a=Pr(i,s,"source",`${t}-${n}-${r}`),l=Pr(i,s,"target",`${t}-${n}-${r}`)),o.push(...a,...l)}return o},[])}function jn(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function wn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Nu(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Yo({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:l,onEdgeUpdateEnd:u}){const c=ko(e.target),{connectionMode:f,domNode:d,autoPanOnConnect:g,connectionRadius:x,onConnectStart:p,panBy:v,getNodes:m,cancelConnection:E}=i();let M=0,y;const{x:A,y:I}=Ie(e),z=c==null?void 0:c.elementFromPoint(A,I),P=jn(l,z),R=d==null?void 0:d.getBoundingClientRect();if(!R||!P)return;let L,H=Ie(e,R),O=!1,N=null,h=!1,S=null;const b=Eu({nodes:m(),nodeId:n,handleId:t,handleType:P}),$=()=>{if(!g)return;const[C,k]=$o(H,R);v({x:C,y:k}),M=requestAnimationFrame($)};s({connectionPosition:H,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:P,connectionStartHandle:{nodeId:n,handleId:t,type:P},connectionEndHandle:null}),p==null||p(e,{nodeId:n,handleId:t,handleType:P});function D(C){const{transform:k}=i();H=Ie(C,R);const{handle:B,validHandleResult:V}=Su(C,c,Bo(H,k,!1,[1,1]),x,b,F=>Xo(F,f,n,t,o?"target":"source",a,c));if(y=B,O||($(),O=!0),S=V.handleDomNode,N=V.connection,h=V.isValid,s({connectionPosition:y&&h?vu({x:y.x,y:y.y},k):H,connectionStatus:Nu(!!y,h),connectionEndHandle:V.endHandle}),!y&&!h&&!S)return wn(L);N.source!==N.target&&S&&(wn(L),L=S,S.classList.add("connecting","react-flow__handle-connecting"),S.classList.toggle("valid",h),S.classList.toggle("react-flow__handle-valid",h))}function w(C){var k,B;(y||S)&&N&&h&&(r==null||r(N)),(B=(k=i()).onConnectEnd)==null||B.call(k,C),l&&(u==null||u(C)),wn(L),E(),cancelAnimationFrame(M),O=!1,h=!1,N=null,S=null,c.removeEventListener("mousemove",D),c.removeEventListener("mouseup",w),c.removeEventListener("touchmove",D),c.removeEventListener("touchend",w)}c.addEventListener("mousemove",D),c.addEventListener("mouseup",w),c.addEventListener("touchmove",D),c.addEventListener("touchend",w)}const Dr=()=>!0,Cu=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Mu=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s}=r;return{connecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},Wo=_.forwardRef(({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:u,onMouseDown:c,onTouchStart:f,...d},g)=>{var R,L;const x=s||null,p=e==="target",v=ne(),m=yu(),{connectOnClick:E,noPanClassName:M}=j(Cu,ie),{connecting:y,clickConnecting:A}=j(Mu(m,x,e),ie);m||(L=(R=v.getState()).onError)==null||L.call(R,"010",Ae.error010());const I=H=>{const{defaultEdgeOptions:O,onConnect:N,hasDefaultEdges:h}=v.getState(),S={...O,...H};if(h){const{edges:b,setEdges:$}=v.getState();$(Ho(S,b))}N==null||N(S),a==null||a(S)},z=H=>{if(!m)return;const O=Po(H);o&&(O&&H.button===0||!O)&&Yo({event:H,handleId:x,nodeId:m,onConnect:I,isTarget:p,getState:v.getState,setState:v.setState,isValidConnection:n||v.getState().isValidConnection||Dr}),O?c==null||c(H):f==null||f(H)},P=H=>{const{onClickConnectStart:O,onClickConnectEnd:N,connectionClickStartHandle:h,connectionMode:S,isValidConnection:b}=v.getState();if(!m||!h&&!o)return;if(!h){O==null||O(H,{nodeId:m,handleId:x,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:m,type:e,handleId:x}});return}const $=ko(H.target),D=n||b||Dr,{connection:w,isValid:C}=Xo({nodeId:m,id:x,type:e},S,h.nodeId,h.handleId||null,h.type,D,$);C&&I(w),N==null||N(H),v.setState({connectionClickStartHandle:null})};return T.createElement("div",{"data-handleid":x,"data-nodeid":m,"data-handlepos":t,"data-id":`${m}-${x}-${e}`,className:de(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",M,u,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:i,connecting:A,connectionindicator:r&&(o&&!y||i&&y)}]),onMouseDown:z,onTouchStart:z,onClick:E?P:void 0,ref:g,...d},l)});Wo.displayName="Handle";var qe=_.memo(Wo);const Ko=({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:r=X.Bottom})=>T.createElement(T.Fragment,null,T.createElement(qe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,T.createElement(qe,{type:"source",position:r,isConnectable:t}));Ko.displayName="DefaultNode";var In=_.memo(Ko);const Zo=({data:e,isConnectable:t,sourcePosition:n=X.Bottom})=>T.createElement(T.Fragment,null,e==null?void 0:e.label,T.createElement(qe,{type:"source",position:n,isConnectable:t}));Zo.displayName="InputNode";var Uo=_.memo(Zo);const qo=({data:e,isConnectable:t,targetPosition:n=X.Top})=>T.createElement(T.Fragment,null,T.createElement(qe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);qo.displayName="OutputNode";var Go=_.memo(qo);const er=()=>null;er.displayName="GroupNode";const Au=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),Vt=e=>e.id;function $u(e,t){return ie(e.selectedNodes.map(Vt),t.selectedNodes.map(Vt))&&ie(e.selectedEdges.map(Vt),t.selectedEdges.map(Vt))}const Qo=_.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:r}=j(Au,$u);return _.useEffect(()=>{var i,s;const o={nodes:n,edges:r};e==null||e(o),(s=(i=t.getState()).onSelectionChange)==null||s.call(i,o)},[n,r,e]),null});Qo.displayName="SelectionListener";const ku=e=>!!e.onSelectionChange;function Tu({onSelectionChange:e}){const t=j(ku);return e||t?T.createElement(Qo,{onSelectionChange:e}):null}const Pu=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function tt(e,t){_.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function W(e,t,n){_.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Du=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:c,nodesFocusable:f,edgesFocusable:d,edgesUpdatable:g,elevateNodesOnSelect:x,minZoom:p,maxZoom:v,nodeExtent:m,onNodesChange:E,onEdgesChange:M,elementsSelectable:y,connectionMode:A,snapGrid:I,snapToGrid:z,translateExtent:P,connectOnClick:R,defaultEdgeOptions:L,fitView:H,fitViewOptions:O,onNodesDelete:N,onEdgesDelete:h,onNodeDrag:S,onNodeDragStart:b,onNodeDragStop:$,onSelectionDrag:D,onSelectionDragStart:w,onSelectionDragStop:C,noPanClassName:k,nodeOrigin:B,rfId:V,autoPanOnConnect:F,autoPanOnNodeDrag:K,onError:Z,connectionRadius:U,isValidConnection:q,nodeDragThreshold:Q})=>{const{setNodes:J,setEdges:se,setDefaultNodesAndEdges:ge,setMinZoom:we,setMaxZoom:ee,setTranslateExtent:G,setNodeExtent:ae,reset:le}=j(Pu,ie),Y=ne();return _.useEffect(()=>{const He=r==null?void 0:r.map(Be=>({...Be,...L}));return ge(n,He),()=>{le()}},[]),W("defaultEdgeOptions",L,Y.setState),W("connectionMode",A,Y.setState),W("onConnect",o,Y.setState),W("onConnectStart",i,Y.setState),W("onConnectEnd",s,Y.setState),W("onClickConnectStart",a,Y.setState),W("onClickConnectEnd",l,Y.setState),W("nodesDraggable",u,Y.setState),W("nodesConnectable",c,Y.setState),W("nodesFocusable",f,Y.setState),W("edgesFocusable",d,Y.setState),W("edgesUpdatable",g,Y.setState),W("elementsSelectable",y,Y.setState),W("elevateNodesOnSelect",x,Y.setState),W("snapToGrid",z,Y.setState),W("snapGrid",I,Y.setState),W("onNodesChange",E,Y.setState),W("onEdgesChange",M,Y.setState),W("connectOnClick",R,Y.setState),W("fitViewOnInit",H,Y.setState),W("fitViewOnInitOptions",O,Y.setState),W("onNodesDelete",N,Y.setState),W("onEdgesDelete",h,Y.setState),W("onNodeDrag",S,Y.setState),W("onNodeDragStart",b,Y.setState),W("onNodeDragStop",$,Y.setState),W("onSelectionDrag",D,Y.setState),W("onSelectionDragStart",w,Y.setState),W("onSelectionDragStop",C,Y.setState),W("noPanClassName",k,Y.setState),W("nodeOrigin",B,Y.setState),W("rfId",V,Y.setState),W("autoPanOnConnect",F,Y.setState),W("autoPanOnNodeDrag",K,Y.setState),W("onError",Z,Y.setState),W("connectionRadius",U,Y.setState),W("isValidConnection",q,Y.setState),W("nodeDragThreshold",Q,Y.setState),tt(e,J),tt(t,se),tt(p,we),tt(v,ee),tt(P,G),tt(m,ae),null},Rr={display:"none"},Ru={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Jo="react-flow__node-desc",jo="react-flow__edge-desc",zu="react-flow__aria-live",Iu=e=>e.ariaLiveMessage;function Hu({rfId:e}){const t=j(Iu);return T.createElement("div",{id:`${zu}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ru},t)}function Bu({rfId:e,disableKeyboardA11y:t}){return T.createElement(T.Fragment,null,T.createElement("div",{id:`${Jo}-${e}`,style:Rr},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),T.createElement("div",{id:`${jo}-${e}`,style:Rr},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&T.createElement(Hu,{rfId:e}))}var Tt=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=_.useState(!1),o=_.useRef(!1),i=_.useRef(new Set([])),[s,a]=_.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),c=u.reduce((f,d)=>f.concat(...d),[]);return[u,c]}return[[],[]]},[e]);return _.useEffect(()=>{const l=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||l;if(e!==null){const c=g=>{if(o.current=g.ctrlKey||g.metaKey||g.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&Dn(g))return!1;const p=Ir(g.code,a);i.current.add(g[p]),zr(s,i.current,!1)&&(g.preventDefault(),r(!0))},f=g=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Dn(g))return!1;const p=Ir(g.code,a);zr(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(g[p]),g.key==="Meta"&&i.current.clear(),o.current=!1},d=()=>{i.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",c),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",d),()=>{u==null||u.removeEventListener("keydown",c),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",d)}}},[e,r]),n};function zr(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Ir(e,t){return t.includes(e)?"code":"key"}function ei(e,t,n,r){var s,a;if(!e.parentNode)return n;const o=t.get(e.parentNode),i=ct(o,r);return ei(o,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((s=o[te])==null?void 0:s.z)??0)>(n.z??0)?((a=o[te])==null?void 0:a.z)??0:n.z??0},r)}function ti(e,t,n){e.forEach(r=>{var o;if(r.parentNode&&!e.has(r.parentNode))throw new Error(`Parent node ${r.parentNode} not found`);if(r.parentNode||n!=null&&n[r.id]){const{x:i,y:s,z:a}=ei(r,e,{...r.position,z:((o=r[te])==null?void 0:o.z)??0},t);r.positionAbsolute={x:i,y:s},r[te].z=a,n!=null&&n[r.id]&&(r[te].isParent=!0)}})}function bn(e,t,n,r){const o=new Map,i={},s=r?1e3:0;return e.forEach(a=>{var f;const l=(he(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),c={width:u==null?void 0:u.width,height:u==null?void 0:u.height,...a,positionAbsolute:{x:a.position.x,y:a.position.y}};a.parentNode&&(c.parentNode=a.parentNode,i[a.parentNode]=!0),Object.defineProperty(c,te,{enumerable:!1,value:{handleBounds:(f=u==null?void 0:u[te])==null?void 0:f.handleBounds,z:l}}),o.set(a.id,c)}),ti(o,n,i),o}function ni(e,t={}){const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:c,nodeOrigin:f}=e(),d=t.initial&&!u&&c;if(a&&l&&(d||!t.initial)){const x=n().filter(v=>{var E;const m=t.includeHiddenNodes?v.width&&v.height:!v.hidden;return(E=t.nodes)!=null&&E.length?m&&t.nodes.some(M=>M.id===v.id):m}),p=x.every(v=>v.width&&v.height);if(x.length>0&&p){const v=Jn(x,f),[m,E,M]=Vo(v,r,o,t.minZoom??i,t.maxZoom??s,t.padding??.1),y=ze.translate(m,E).scale(M);return typeof t.duration=="number"&&t.duration>0?a.transform(We(l,t.duration),y):a.transform(l,y),!0}}return!1}function Ou(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[te]:r[te],selected:n.selected})}),new Map(t)}function Lu(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Ft({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:u}=n();e!=null&&e.length&&(l&&r({nodeInternals:Ou(e,o)}),s==null||s(e)),t!=null&&t.length&&(u&&r({edges:Lu(t,i)}),a==null||a(t))}const nt=()=>{},Vu={zoomIn:nt,zoomOut:nt,zoomTo:nt,getZoom:()=>1,setViewport:nt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:nt,fitBounds:nt,project:e=>e,viewportInitialized:!1},Fu=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Xu=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=j(Fu,ie);return _.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(We(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(We(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(We(n,i==null?void 0:i.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{const[s,a,l]=e.getState().transform,u=ze.translate(o.x??s,o.y??a).scale(o.zoom??l);t.transform(We(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>ni(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:l,maxZoom:u}=e.getState(),c=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:u,f=a/2-o*c,d=l/2-i*c,g=ze.translate(f,d).scale(c);t.transform(We(n,s==null?void 0:s.duration),g)},fitBounds:(o,i)=>{const{width:s,height:a,minZoom:l,maxZoom:u}=e.getState(),[c,f,d]=Vo(o,s,a,l,u,(i==null?void 0:i.padding)??.1),g=ze.translate(c,f).scale(d);t.transform(We(n,i==null?void 0:i.duration),g)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return Bo(o,i,s,a)},viewportInitialized:!0}:Vu,[t,n])};function ri(){const e=Xu(),t=ne(),n=_.useCallback(()=>t.getState().getNodes().map(p=>({...p})),[]),r=_.useCallback(p=>t.getState().nodeInternals.get(p),[]),o=_.useCallback(()=>{const{edges:p=[]}=t.getState();return p.map(v=>({...v}))},[]),i=_.useCallback(p=>{const{edges:v=[]}=t.getState();return v.find(m=>m.id===p)},[]),s=_.useCallback(p=>{const{getNodes:v,setNodes:m,hasDefaultNodes:E,onNodesChange:M}=t.getState(),y=v(),A=typeof p=="function"?p(y):p;if(E)m(A);else if(M){const I=A.length===0?y.map(z=>({type:"remove",id:z.id})):A.map(z=>({item:z,type:"reset"}));M(I)}},[]),a=_.useCallback(p=>{const{edges:v=[],setEdges:m,hasDefaultEdges:E,onEdgesChange:M}=t.getState(),y=typeof p=="function"?p(v):p;if(E)m(y);else if(M){const A=y.length===0?v.map(I=>({type:"remove",id:I.id})):y.map(I=>({item:I,type:"reset"}));M(A)}},[]),l=_.useCallback(p=>{const v=Array.isArray(p)?p:[p],{getNodes:m,setNodes:E,hasDefaultNodes:M,onNodesChange:y}=t.getState();if(M){const I=[...m(),...v];E(I)}else if(y){const A=v.map(I=>({item:I,type:"add"}));y(A)}},[]),u=_.useCallback(p=>{const v=Array.isArray(p)?p:[p],{edges:m=[],setEdges:E,hasDefaultEdges:M,onEdgesChange:y}=t.getState();if(M)E([...m,...v]);else if(y){const A=v.map(I=>({item:I,type:"add"}));y(A)}},[]),c=_.useCallback(()=>{const{getNodes:p,edges:v=[],transform:m}=t.getState(),[E,M,y]=m;return{nodes:p().map(A=>({...A})),edges:v.map(A=>({...A})),viewport:{x:E,y:M,zoom:y}}},[]),f=_.useCallback(({nodes:p,edges:v})=>{const{nodeInternals:m,getNodes:E,edges:M,hasDefaultNodes:y,hasDefaultEdges:A,onNodesDelete:I,onEdgesDelete:z,onNodesChange:P,onEdgesChange:R}=t.getState(),L=(p||[]).map(S=>S.id),H=(v||[]).map(S=>S.id),O=E().reduce((S,b)=>{const $=!L.includes(b.id)&&b.parentNode&&S.find(w=>w.id===b.parentNode);return(typeof b.deletable=="boolean"?b.deletable:!0)&&(L.includes(b.id)||$)&&S.push(b),S},[]),N=M.filter(S=>typeof S.deletable=="boolean"?S.deletable:!0),h=N.filter(S=>H.includes(S.id));if(O||h){const S=Lo(O,N),b=[...h,...S],$=b.reduce((D,w)=>(D.includes(w.id)||D.push(w.id),D),[]);if((A||y)&&(A&&t.setState({edges:M.filter(D=>!$.includes(D.id))}),y&&(O.forEach(D=>{m.delete(D.id)}),t.setState({nodeInternals:new Map(m)}))),$.length>0&&(z==null||z(b),R&&R($.map(D=>({id:D,type:"remove"})))),O.length>0&&(I==null||I(O),P)){const D=O.map(w=>({id:w.id,type:"remove"}));P(D)}}},[]),d=_.useCallback(p=>{const v=lu(p),m=v?null:t.getState().nodeInternals.get(p.id);return[v?p:Mr(m),m,v]},[]),g=_.useCallback((p,v=!0,m)=>{const[E,M,y]=d(p);return E?(m||t.getState().getNodes()).filter(A=>{if(!y&&(A.id===M.id||!A.positionAbsolute))return!1;const I=Mr(A),z=Pn(I,E);return v&&z>0||z>=p.width*p.height}):[]},[]),x=_.useCallback((p,v,m=!0)=>{const[E]=d(p);if(!E)return!1;const M=Pn(E,v);return m&&M>0||M>=p.width*p.height},[]);return _.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:l,addEdges:u,toObject:c,deleteElements:f,getIntersectingNodes:g,isNodeIntersecting:x}),[e,n,r,o,i,s,a,l,u,c,f,g,x])}const Yu={actInsideInputWithModifier:!1};var Wu=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:r}=ri(),o=Tt(e,Yu),i=Tt(t);_.useEffect(()=>{if(o){const{edges:s,getNodes:a}=n.getState(),l=a().filter(c=>c.selected),u=s.filter(c=>c.selected);r({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),_.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Ku(e){const t=ne();_.useEffect(()=>{let n;const r=()=>{var i,s;if(!e.current)return;const o=Wn(e.current);(o.height===0||o.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",Ae.error004())),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const tr={position:"absolute",width:"100%",height:"100%",top:0,left:0},Zu=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Xt=e=>({x:e.x,y:e.y,zoom:e.k}),rt=(e,t)=>e.target.closest(`.${t}`),Hr=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Br=e=>{const t=e.ctrlKey&&en()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Uu=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),qu=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Ze.Free,zoomOnDoubleClick:u=!0,elementsSelectable:c,panOnDrag:f=!0,defaultViewport:d,translateExtent:g,minZoom:x,maxZoom:p,zoomActivationKeyCode:v,preventScrolling:m=!0,children:E,noWheelClassName:M,noPanClassName:y})=>{const A=_.useRef(),I=ne(),z=_.useRef(!1),P=_.useRef(!1),R=_.useRef(null),L=_.useRef({x:0,y:0,zoom:0}),{d3Zoom:H,d3Selection:O,d3ZoomHandler:N,userSelectionActive:h}=j(Uu,ie),S=Tt(v),b=_.useRef(0),$=_.useRef(!1),D=_.useRef();return Ku(R),_.useEffect(()=>{if(R.current){const w=R.current.getBoundingClientRect(),C=eu().scaleExtent([x,p]).translateExtent(g),k=pe(R.current).call(C),B=ze.translate(d.x,d.y).scale(ht(d.zoom,x,p)),V=[[0,0],[w.width,w.height]],F=C.constrain()(B,V,g);C.transform(k,F),C.wheelDelta(Br),I.setState({d3Zoom:C,d3Selection:k,d3ZoomHandler:k.on("wheel.zoom"),transform:[F.x,F.y,F.k],domNode:R.current.closest(".react-flow")})}},[]),_.useEffect(()=>{O&&H&&(s&&!S&&!h?O.on("wheel.zoom",w=>{if(rt(w,M))return!1;w.preventDefault(),w.stopImmediatePropagation();const C=O.property("__zoom").k||1,k=en();if(w.ctrlKey&&i&&k){const Q=ve(w),J=Br(w),se=C*Math.pow(2,J);H.scaleTo(O,se,Q,w);return}const B=w.deltaMode===1?20:1;let V=l===Ze.Vertical?0:w.deltaX*B,F=l===Ze.Horizontal?0:w.deltaY*B;!k&&w.shiftKey&&l!==Ze.Vertical&&(V=w.deltaY*B,F=0),H.translateBy(O,-(V/C)*a,-(F/C)*a,{internal:!0});const K=Xt(O.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:U,onViewportChangeEnd:q}=I.getState();clearTimeout(D.current),$.current||($.current=!0,t==null||t(w,K),Z==null||Z(K)),$.current&&(e==null||e(w,K),U==null||U(K),D.current=setTimeout(()=>{n==null||n(w,K),q==null||q(K),$.current=!1},150))},{passive:!1}):typeof N<"u"&&O.on("wheel.zoom",function(w,C){if(!m||rt(w,M))return null;w.preventDefault(),N.call(this,w,C)},{passive:!1}))},[h,s,l,O,H,N,S,i,m,M,t,e,n]),_.useEffect(()=>{H&&H.on("start",w=>{var B,V;if(!w.sourceEvent||w.sourceEvent.internal)return null;b.current=(B=w.sourceEvent)==null?void 0:B.button;const{onViewportChangeStart:C}=I.getState(),k=Xt(w.transform);z.current=!0,L.current=k,((V=w.sourceEvent)==null?void 0:V.type)==="mousedown"&&I.setState({paneDragging:!0}),C==null||C(k),t==null||t(w.sourceEvent,k)})},[H,t]),_.useEffect(()=>{H&&(h&&!z.current?H.on("zoom",null):h||H.on("zoom",w=>{var k;const{onViewportChange:C}=I.getState();if(I.setState({transform:[w.transform.x,w.transform.y,w.transform.k]}),P.current=!!(r&&Hr(f,b.current??0)),(e||C)&&!((k=w.sourceEvent)!=null&&k.internal)){const B=Xt(w.transform);C==null||C(B),e==null||e(w.sourceEvent,B)}}))},[h,H,e,f,r]),_.useEffect(()=>{H&&H.on("end",w=>{if(!w.sourceEvent||w.sourceEvent.internal)return null;const{onViewportChangeEnd:C}=I.getState();if(z.current=!1,I.setState({paneDragging:!1}),r&&Hr(f,b.current??0)&&!P.current&&r(w.sourceEvent),P.current=!1,(n||C)&&Zu(L.current,w.transform)){const k=Xt(w.transform);L.current=k,clearTimeout(A.current),A.current=setTimeout(()=>{C==null||C(k),n==null||n(w.sourceEvent,k)},s?150:0)}})},[H,s,f,n,r]),_.useEffect(()=>{H&&H.filter(w=>{const C=S||o,k=i&&w.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&w.button===1&&w.type==="mousedown"&&(rt(w,"react-flow__node")||rt(w,"react-flow__edge")))return!0;if(!f&&!C&&!s&&!u&&!i||h||!u&&w.type==="dblclick"||rt(w,M)&&w.type==="wheel"||rt(w,y)&&(w.type!=="wheel"||s&&w.type==="wheel")||!i&&w.ctrlKey&&w.type==="wheel"||!C&&!s&&!k&&w.type==="wheel"||!f&&(w.type==="mousedown"||w.type==="touchstart")||Array.isArray(f)&&!f.includes(w.button)&&(w.type==="mousedown"||w.type==="touchstart"))return!1;const B=Array.isArray(f)&&f.includes(w.button)||!w.button||w.button<=1;return(!w.ctrlKey||w.type==="wheel")&&B})},[h,H,o,i,s,u,f,c,S]),T.createElement("div",{className:"react-flow__renderer",ref:R,style:tr},E)},Gu=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Qu(){const{userSelectionActive:e,userSelectionRect:t}=j(Gu,ie);return e&&t?T.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Or(e,t){const n=e.find(r=>r.id===t.parentNode);if(n){const r=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(r>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,r>0&&(n.style.width+=r),o>0&&(n.style.height+=o),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function oi(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.filter(a=>a.id===o.id);if(i.length===0)return r.push(o),r;const s={...o};for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&Or(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&Or(r,s);break}case"remove":return r}return r.push(s),r},n)}function ii(e,t){return oi(e,t)}function Ju(e,t){return oi(e,t)}const De=(e,t)=>({id:e,type:"select",selected:t});function it(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(De(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(De(r.id,!1))),n},[])}const vn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},ju=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),si=_.memo(({isSelecting:e,selectionMode:t=kt.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:c,children:f})=>{const d=_.useRef(null),g=ne(),x=_.useRef(0),p=_.useRef(0),v=_.useRef(),{userSelectionActive:m,elementsSelectable:E,dragging:M}=j(ju,ie),y=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,p.current=0},A=N=>{i==null||i(N),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},I=N=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){N.preventDefault();return}s==null||s(N)},z=a?N=>a(N):void 0,P=N=>{const{resetSelectedElements:h,domNode:S}=g.getState();if(v.current=S==null?void 0:S.getBoundingClientRect(),!E||!e||N.button!==0||N.target!==d.current||!v.current)return;const{x:b,y:$}=Ie(N,v.current);h(),g.setState({userSelectionRect:{width:0,height:0,startX:b,startY:$,x:b,y:$}}),r==null||r(N)},R=N=>{const{userSelectionRect:h,nodeInternals:S,edges:b,transform:$,onNodesChange:D,onEdgesChange:w,nodeOrigin:C,getNodes:k}=g.getState();if(!e||!v.current||!h)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const B=Ie(N,v.current),V=h.startX??0,F=h.startY??0,K={...h,x:B.x<V?B.x:V,y:B.y<F?B.y:F,width:Math.abs(B.x-V),height:Math.abs(B.y-F)},Z=k(),U=Oo(S,K,$,t===kt.Partial,!0,C),q=Lo(U,b).map(J=>J.id),Q=U.map(J=>J.id);if(x.current!==Q.length){x.current=Q.length;const J=it(Z,Q);J.length&&(D==null||D(J))}if(p.current!==q.length){p.current=q.length;const J=it(b,q);J.length&&(w==null||w(J))}g.setState({userSelectionRect:K})},L=N=>{if(N.button!==0)return;const{userSelectionRect:h}=g.getState();!m&&h&&N.target===d.current&&(A==null||A(N)),g.setState({nodesSelectionActive:x.current>0}),y(),o==null||o(N)},H=N=>{m&&(g.setState({nodesSelectionActive:x.current>0}),o==null||o(N)),y()},O=E&&(e||m);return T.createElement("div",{className:de(["react-flow__pane",{dragging:M,selection:e}]),onClick:O?void 0:vn(A,d),onContextMenu:vn(I,d),onWheel:vn(z,d),onMouseEnter:O?void 0:l,onMouseDown:O?P:void 0,onMouseMove:O?R:u,onMouseUp:O?L:void 0,onMouseLeave:O?H:c,ref:d,style:tr},f,T.createElement(Qu,null))});si.displayName="Pane";function ai(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:ai(n,t):!1}function Lr(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function ef(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||!ai(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>{var i,s;return{id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=o.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((s=o.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode,width:o.width,height:o.height,expandParent:o.expandParent}})}function tf(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function ci(e,t,n,r,o=[0,0],i){const s=tf(e,e.extent||r);let a=s;if(e.extent==="parent"&&!e.expandParent)if(e.parentNode&&e.width&&e.height){const c=n.get(e.parentNode),{x:f,y:d}=ct(c,o).positionAbsolute;a=c&&he(f)&&he(d)&&he(c.width)&&he(c.height)?[[f+e.width*o[0],d+e.height*o[1]],[f+c.width-e.width+e.width*o[0],d+c.height-e.height+e.height*o[1]]]:a}else i==null||i("005",Ae.error005()),a=s;else if(e.extent&&e.parentNode&&e.extent!=="parent"){const c=n.get(e.parentNode),{x:f,y:d}=ct(c,o).positionAbsolute;a=[[e.extent[0][0]+f,e.extent[0][1]+d],[e.extent[1][0]+f,e.extent[1][1]+d]]}let l={x:0,y:0};if(e.parentNode){const c=n.get(e.parentNode);l=ct(c,o).positionAbsolute}const u=a&&a!=="parent"?Kn(t,a):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function Sn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Vr=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n,...Wn(l)}})};function vt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Hn({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:l}=t.getState(),u=a.get(e);if(!u){l==null||l("012",Ae.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var c;return(c=r==null?void 0:r.current)==null?void 0:c.blur()})):o([e])}function nf(){const e=ne();return _.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?o[0]*Math.round(l.x/o[0]):l.x,ySnapped:i?o[1]*Math.round(l.y/o[1]):l.y,...l}},[])}function _n(e){return(t,n,r)=>e==null?void 0:e(t,r)}function li({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const a=ne(),[l,u]=_.useState(!1),c=_.useRef([]),f=_.useRef({x:null,y:null}),d=_.useRef(0),g=_.useRef(null),x=_.useRef({x:0,y:0}),p=_.useRef(null),v=_.useRef(!1),m=_.useRef(!1),E=nf();return _.useEffect(()=>{if(e!=null&&e.current){const M=pe(e.current),y=({x:z,y:P})=>{const{nodeInternals:R,onNodeDrag:L,onSelectionDrag:H,updateNodePositions:O,nodeExtent:N,snapGrid:h,snapToGrid:S,nodeOrigin:b,onError:$}=a.getState();f.current={x:z,y:P};let D=!1,w={x:0,y:0,x2:0,y2:0};if(c.current.length>1&&N){const k=Jn(c.current,b);w=Zn(k)}if(c.current=c.current.map(k=>{const B={x:z-k.distance.x,y:P-k.distance.y};S&&(B.x=h[0]*Math.round(B.x/h[0]),B.y=h[1]*Math.round(B.y/h[1]));const V=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];c.current.length>1&&N&&!k.extent&&(V[0][0]=k.positionAbsolute.x-w.x+N[0][0],V[1][0]=k.positionAbsolute.x+(k.width??0)-w.x2+N[1][0],V[0][1]=k.positionAbsolute.y-w.y+N[0][1],V[1][1]=k.positionAbsolute.y+(k.height??0)-w.y2+N[1][1]);const F=ci(k,B,R,V,b,$);return D=D||k.position.x!==F.position.x||k.position.y!==F.position.y,k.position=F.position,k.positionAbsolute=F.positionAbsolute,k}),!D)return;O(c.current,!0,!0),u(!0);const C=o?L:_n(H);if(C&&p.current){const[k,B]=Sn({nodeId:o,dragItems:c.current,nodeInternals:R});C(p.current,k,B)}},A=()=>{if(!g.current)return;const[z,P]=$o(x.current,g.current);if(z!==0||P!==0){const{transform:R,panBy:L}=a.getState();f.current.x=(f.current.x??0)-z/R[2],f.current.y=(f.current.y??0)-P/R[2],L({x:z,y:P})&&y(f.current)}d.current=requestAnimationFrame(A)},I=z=>{var b;const{nodeInternals:P,multiSelectionActive:R,nodesDraggable:L,unselectNodesAndEdges:H,onNodeDragStart:O,onSelectionDragStart:N}=a.getState();m.current=!0;const h=o?O:_n(N);(!s||!i)&&!R&&o&&((b=P.get(o))!=null&&b.selected||H()),o&&i&&s&&Hn({id:o,store:a,nodeRef:e});const S=E(z);if(f.current=S,c.current=ef(P,L,S,o),h&&c.current){const[$,D]=Sn({nodeId:o,dragItems:c.current,nodeInternals:P});h(z.sourceEvent,$,D)}};if(t)M.on(".drag",null);else{const z=uc().on("start",P=>{const{domNode:R,nodeDragThreshold:L}=a.getState();L===0&&I(P);const H=E(P);f.current=H,g.current=(R==null?void 0:R.getBoundingClientRect())||null,x.current=Ie(P.sourceEvent,g.current)}).on("drag",P=>{var O,N;const R=E(P),{autoPanOnNodeDrag:L,nodeDragThreshold:H}=a.getState();if(!v.current&&m.current&&L&&(v.current=!0,A()),!m.current){const h=R.xSnapped-(((O=f==null?void 0:f.current)==null?void 0:O.x)??0),S=R.ySnapped-(((N=f==null?void 0:f.current)==null?void 0:N.y)??0);Math.sqrt(h*h+S*S)>H&&I(P)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&c.current&&m.current&&(p.current=P.sourceEvent,x.current=Ie(P.sourceEvent,g.current),y(R))}).on("end",P=>{if(m.current&&(u(!1),v.current=!1,m.current=!1,cancelAnimationFrame(d.current),c.current)){const{updateNodePositions:R,nodeInternals:L,onNodeDragStop:H,onSelectionDragStop:O}=a.getState(),N=o?H:_n(O);if(R(c.current,!1,!1),N){const[h,S]=Sn({nodeId:o,dragItems:c.current,nodeInternals:L});N(P.sourceEvent,h,S)}}}).filter(P=>{const R=P.target;return!P.button&&(!n||!Lr(R,`.${n}`,e))&&(!r||Lr(R,r,e))});return M.call(z),()=>{M.on(".drag",null)}}}},[e,t,n,r,i,a,o,s,E]),l}function ui(){const e=ne();return _.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:l,onError:u,nodesDraggable:c}=e.getState(),f=s().filter(E=>E.selected&&(E.draggable||c&&typeof E.draggable>"u")),d=a?l[0]:5,g=a?l[1]:5,x=n.isShiftPressed?4:1,p=n.x*d*x,v=n.y*g*x,m=f.map(E=>{if(E.positionAbsolute){const M={x:E.positionAbsolute.x+p,y:E.positionAbsolute.y+v};a&&(M.x=l[0]*Math.round(M.x/l[0]),M.y=l[1]*Math.round(M.y/l[1]));const{positionAbsolute:y,position:A}=ci(E,M,r,o,void 0,u);E.position=A,E.positionAbsolute=y}return E});i(m,!0,!1)},[])}const lt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var St=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:l,selected:u,onClick:c,onMouseEnter:f,onMouseMove:d,onMouseLeave:g,onContextMenu:x,onDoubleClick:p,style:v,className:m,isDraggable:E,isSelectable:M,isConnectable:y,isFocusable:A,selectNodesOnDrag:I,sourcePosition:z,targetPosition:P,hidden:R,resizeObserver:L,dragHandle:H,zIndex:O,isParent:N,noDragClassName:h,noPanClassName:S,initialized:b,disableKeyboardA11y:$,ariaLabel:D,rfId:w})=>{const C=ne(),k=_.useRef(null),B=_.useRef(z),V=_.useRef(P),F=_.useRef(r),K=M||E||c||f||d||g,Z=ui(),U=vt(n,C.getState,f),q=vt(n,C.getState,d),Q=vt(n,C.getState,g),J=vt(n,C.getState,x),se=vt(n,C.getState,p),ge=G=>{const{nodeDragThreshold:ae}=C.getState();if(M&&(!I||!E||ae>0)&&Hn({id:n,store:C,nodeRef:k}),c){const le=C.getState().nodeInternals.get(n);le&&c(G,{...le})}},we=G=>{if(!Dn(G))if(To.includes(G.key)&&M){const ae=G.key==="Escape";Hn({id:n,store:C,unselect:ae,nodeRef:k})}else!$&&E&&u&&Object.prototype.hasOwnProperty.call(lt,G.key)&&(C.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),Z({x:lt[G.key].x,y:lt[G.key].y,isShiftPressed:G.shiftKey}))};_.useEffect(()=>{if(k.current&&!R){const G=k.current;return L==null||L.observe(G),()=>L==null?void 0:L.unobserve(G)}},[R]),_.useEffect(()=>{const G=F.current!==r,ae=B.current!==z,le=V.current!==P;k.current&&(G||ae||le)&&(G&&(F.current=r),ae&&(B.current=z),le&&(V.current=P),C.getState().updateNodeDimensions([{id:n,nodeElement:k.current,forceUpdate:!0}]))},[n,r,z,P]);const ee=li({nodeRef:k,disabled:R||!E,noDragClassName:h,handleSelector:H,nodeId:n,isSelectable:M,selectNodesOnDrag:I});return R?null:T.createElement("div",{className:de(["react-flow__node",`react-flow__node-${r}`,{[S]:E},m,{selected:u,selectable:M,parent:N,dragging:ee}]),ref:k,style:{zIndex:O,transform:`translate(${a}px,${l}px)`,pointerEvents:K?"all":"none",visibility:b?"visible":"hidden",...v},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:U,onMouseMove:q,onMouseLeave:Q,onContextMenu:J,onClick:ge,onDoubleClick:se,onKeyDown:A?we:void 0,tabIndex:A?0:void 0,role:A?"button":void 0,"aria-describedby":$?void 0:`${Jo}-${w}`,"aria-label":D},T.createElement(mu,{value:n},T.createElement(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:u,isConnectable:y,sourcePosition:z,targetPosition:P,dragging:ee,dragHandle:H,zIndex:O})))};return t.displayName="NodeWrapper",_.memo(t)};const rf=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Jn(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function of({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ne(),{width:o,height:i,x:s,y:a,transformString:l,userSelectionActive:u}=j(rf,ie),c=ui(),f=_.useRef(null);if(_.useEffect(()=>{var x;n||(x=f.current)==null||x.focus({preventScroll:!0})},[n]),li({nodeRef:f}),u||!o||!i)return null;const d=e?x=>{const p=r.getState().getNodes().filter(v=>v.selected);e(x,p)}:void 0,g=x=>{Object.prototype.hasOwnProperty.call(lt,x.key)&&c({x:lt[x.key].x,y:lt[x.key].y,isShiftPressed:x.shiftKey})};return T.createElement("div",{className:de(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},T.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:g,style:{width:o,height:i,top:a,left:s}}))}var sf=_.memo(of);const af=e=>e.nodesSelectionActive,fi=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:l,onMoveStart:u,onMoveEnd:c,selectionKeyCode:f,selectionOnDrag:d,selectionMode:g,onSelectionStart:x,onSelectionEnd:p,multiSelectionKeyCode:v,panActivationKeyCode:m,zoomActivationKeyCode:E,elementsSelectable:M,zoomOnScroll:y,zoomOnPinch:A,panOnScroll:I,panOnScrollSpeed:z,panOnScrollMode:P,zoomOnDoubleClick:R,panOnDrag:L,defaultViewport:H,translateExtent:O,minZoom:N,maxZoom:h,preventScrolling:S,onSelectionContextMenu:b,noWheelClassName:$,noPanClassName:D,disableKeyboardA11y:w})=>{const C=j(af),k=Tt(f),V=Tt(m)||L,F=k||d&&V!==!0;return Wu({deleteKeyCode:a,multiSelectionKeyCode:v}),T.createElement(qu,{onMove:l,onMoveStart:u,onMoveEnd:c,onPaneContextMenu:i,elementsSelectable:M,zoomOnScroll:y,zoomOnPinch:A,panOnScroll:I,panOnScrollSpeed:z,panOnScrollMode:P,zoomOnDoubleClick:R,panOnDrag:!k&&V,defaultViewport:H,translateExtent:O,minZoom:N,maxZoom:h,zoomActivationKeyCode:E,preventScrolling:S,noWheelClassName:$,noPanClassName:D},T.createElement(si,{onSelectionStart:x,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:V,isSelecting:!!F,selectionMode:g},e,C&&T.createElement(sf,{onSelectionContextMenu:b,noPanClassName:D,disableKeyboardA11y:w})))};fi.displayName="FlowRenderer";var cf=_.memo(fi);function lf(e){return j(_.useCallback(n=>e?Oo(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function uf(e){const t={input:St(e.input||Uo),default:St(e.default||In),output:St(e.output||Go),group:St(e.group||er)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=St(e[i]||In),o),n);return{...t,...r}}const ff=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},df=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),di=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i,onError:s}=j(df,ie),a=lf(e.onlyRenderVisibleElements),l=_.useRef(),u=_.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const c=new ResizeObserver(f=>{const d=f.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));i(d)});return l.current=c,c},[]);return _.useEffect(()=>()=>{var c;(c=l==null?void 0:l.current)==null||c.disconnect()},[]),T.createElement("div",{className:"react-flow__nodes",style:tr},a.map(c=>{var A,I;let f=c.type||"default";e.nodeTypes[f]||(s==null||s("003",Ae.error003(f)),f="default");const d=e.nodeTypes[f]||e.nodeTypes.default,g=!!(c.draggable||t&&typeof c.draggable>"u"),x=!!(c.selectable||o&&typeof c.selectable>"u"),p=!!(c.connectable||n&&typeof c.connectable>"u"),v=!!(c.focusable||r&&typeof c.focusable>"u"),m=e.nodeExtent?Kn(c.positionAbsolute,e.nodeExtent):c.positionAbsolute,E=(m==null?void 0:m.x)??0,M=(m==null?void 0:m.y)??0,y=ff({x:E,y:M,width:c.width??0,height:c.height??0,origin:e.nodeOrigin});return T.createElement(d,{key:c.id,id:c.id,className:c.className,style:c.style,type:f,data:c.data,sourcePosition:c.sourcePosition||X.Bottom,targetPosition:c.targetPosition||X.Top,hidden:c.hidden,xPos:E,yPos:M,xPosOrigin:y.x,yPosOrigin:y.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!c.selected,isDraggable:g,isSelectable:x,isConnectable:p,isFocusable:v,resizeObserver:u,dragHandle:c.dragHandle,zIndex:((A=c[te])==null?void 0:A.z)??0,isParent:!!((I=c[te])!=null&&I.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!c.width&&!!c.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:c.ariaLabel})}))};di.displayName="NodeRenderer";var hf=_.memo(di);const gf=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,pf=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,Fr="react-flow__edgeupdater",Xr=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>T.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:de([Fr,`${Fr}-${a}`]),cx:gf(t,r,e),cy:pf(n,r,e),r,stroke:"transparent",fill:"transparent"}),mf=()=>!0;var ot=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:l,animated:u,label:c,labelStyle:f,labelShowBg:d,labelBgStyle:g,labelBgPadding:x,labelBgBorderRadius:p,style:v,source:m,target:E,sourceX:M,sourceY:y,targetX:A,targetY:I,sourcePosition:z,targetPosition:P,elementsSelectable:R,hidden:L,sourceHandleId:H,targetHandleId:O,onContextMenu:N,onMouseEnter:h,onMouseMove:S,onMouseLeave:b,edgeUpdaterRadius:$,onEdgeUpdate:D,onEdgeUpdateStart:w,onEdgeUpdateEnd:C,markerEnd:k,markerStart:B,rfId:V,ariaLabel:F,isFocusable:K,isUpdatable:Z,pathOptions:U,interactionWidth:q})=>{const Q=_.useRef(null),[J,se]=_.useState(!1),[ge,we]=_.useState(!1),ee=ne(),G=_.useMemo(()=>`url(#${zn(B,V)})`,[B,V]),ae=_.useMemo(()=>`url(#${zn(k,V)})`,[k,V]);if(L)return null;const le=re=>{var be;const{edges:ue,addSelectedEdges:Ve,unselectNodesAndEdges:Fe,multiSelectionActive:Xe}=ee.getState(),Ee=ue.find(mt=>mt.id===n);Ee&&(R&&(ee.setState({nodesSelectionActive:!1}),Ee.selected&&Xe?(Fe({nodes:[],edges:[Ee]}),(be=Q.current)==null||be.blur()):Ve([n])),s&&s(re,Ee))},Y=bt(n,ee.getState,a),He=bt(n,ee.getState,N),Be=bt(n,ee.getState,h),gt=bt(n,ee.getState,S),Je=bt(n,ee.getState,b),Oe=(re,ue)=>{if(re.button!==0)return;const{edges:Ve,isValidConnection:Fe}=ee.getState(),Xe=ue?E:m,Ee=(ue?O:H)||null,be=ue?"target":"source",mt=Fe||mf,fn=ue,yt=Ve.find(Ye=>Ye.id===n);we(!0),w==null||w(re,yt,be);const dn=Ye=>{we(!1),C==null||C(Ye,yt,be)};Yo({event:re,handleId:Ee,nodeId:Xe,onConnect:Ye=>D==null?void 0:D(yt,Ye),isTarget:fn,getState:ee.getState,setState:ee.setState,isValidConnection:mt,edgeUpdaterType:be,onEdgeUpdateEnd:dn})},$e=re=>Oe(re,!0),je=re=>Oe(re,!1),ke=()=>se(!0),Le=()=>se(!1),pt=!R&&!s,et=re=>{var ue;if(To.includes(re.key)&&R){const{unselectNodesAndEdges:Ve,addSelectedEdges:Fe,edges:Xe}=ee.getState();re.key==="Escape"?((ue=Q.current)==null||ue.blur(),Ve({edges:[Xe.find(be=>be.id===n)]})):Fe([n])}};return T.createElement("g",{className:de(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:l,animated:u,inactive:pt,updating:J}]),onClick:le,onDoubleClick:Y,onContextMenu:He,onMouseEnter:Be,onMouseMove:gt,onMouseLeave:Je,onKeyDown:K?et:void 0,tabIndex:K?0:void 0,role:K?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":F===null?void 0:F||`Edge from ${m} to ${E}`,"aria-describedby":K?`${jo}-${V}`:void 0,ref:Q},!ge&&T.createElement(e,{id:n,source:m,target:E,selected:l,animated:u,label:c,labelStyle:f,labelShowBg:d,labelBgStyle:g,labelBgPadding:x,labelBgBorderRadius:p,data:i,style:v,sourceX:M,sourceY:y,targetX:A,targetY:I,sourcePosition:z,targetPosition:P,sourceHandleId:H,targetHandleId:O,markerStart:G,markerEnd:ae,pathOptions:U,interactionWidth:q}),Z&&T.createElement(T.Fragment,null,(Z==="source"||Z===!0)&&T.createElement(Xr,{position:z,centerX:M,centerY:y,radius:$,onMouseDown:$e,onMouseEnter:ke,onMouseOut:Le,type:"source"}),(Z==="target"||Z===!0)&&T.createElement(Xr,{position:P,centerX:A,centerY:I,radius:$,onMouseDown:je,onMouseEnter:ke,onMouseOut:Le,type:"target"})))};return t.displayName="EdgeWrapper",_.memo(t)};function yf(e){const t={default:ot(e.default||nn),straight:ot(e.bezier||Gn),step:ot(e.step||qn),smoothstep:ot(e.step||un),simplebezier:ot(e.simplebezier||Un)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=ot(e[i]||nn),o),n);return{...t,...r}}function Yr(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case X.Top:return{x:r+i/2,y:o};case X.Right:return{x:r+i,y:o+s/2};case X.Bottom:return{x:r+i/2,y:o+s};case X.Left:return{x:r,y:o+s/2}}}function Wr(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const xf=(e,t,n,r,o,i)=>{const s=Yr(n,e,t),a=Yr(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function wf({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const c=Zn({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:s/l[2],height:a/l[2]}),f=Math.max(0,Math.min(c.x2,u.x2)-Math.max(c.x,u.x)),d=Math.max(0,Math.min(c.y2,u.y2)-Math.max(c.y,u.y));return Math.ceil(f*d)>0}function Kr(e){var r,o,i,s,a;const t=((r=e==null?void 0:e[te])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const bf=[{level:0,isMaxLevel:!0,edges:[]}];function vf(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{var c,f;const l=he(a.zIndex);let u=l?a.zIndex:0;if(n){const d=t.get(a.target),g=t.get(a.source),x=a.selected||(d==null?void 0:d.selected)||(g==null?void 0:g.selected),p=Math.max(((c=g==null?void 0:g[te])==null?void 0:c.z)||0,((f=d==null?void 0:d[te])==null?void 0:f.z)||0,1e3);u=(l?a.zIndex:0)+(x?p:0)}return s[u]?s[u].push(a):s[u]=[a],r=u>r?u:r,s},{}),i=Object.entries(o).map(([s,a])=>{const l=+s;return{edges:a,level:l,isMaxLevel:l===r}});return i.length===0?bf:i}function Sf(e,t,n){const r=j(_.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&wf({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return vf(r,t,n)}const _f=({color:e="none",strokeWidth:t=1})=>T.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ef=({color:e="none",strokeWidth:t=1})=>T.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Zr={[tn.Arrow]:_f,[tn.ArrowClosed]:Ef};function Nf(e){const t=ne();return _.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(Zr,e)?Zr[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",Ae.error009(e)),null)},[e])}const Cf=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=Nf(t);return l?T.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},T.createElement(l,{color:n,strokeWidth:s})):null},Mf=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=zn(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},hi=({defaultColor:e,rfId:t})=>{const n=j(_.useCallback(Mf({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return T.createElement("defs",null,n.map(r=>T.createElement(Cf,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};hi.displayName="MarkerDefinitions";var Af=_.memo(hi);const $f=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),gi=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeUpdate:s,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:u,onEdgeMouseLeave:c,onEdgeClick:f,edgeUpdaterRadius:d,onEdgeDoubleClick:g,onEdgeUpdateStart:x,onEdgeUpdateEnd:p,children:v})=>{const{edgesFocusable:m,edgesUpdatable:E,elementsSelectable:M,width:y,height:A,connectionMode:I,nodeInternals:z,onError:P}=j($f,ie),R=Sf(t,z,n);return y?T.createElement(T.Fragment,null,R.map(({level:L,edges:H,isMaxLevel:O})=>T.createElement("svg",{key:L,style:{zIndex:L},width:y,height:A,className:"react-flow__edges react-flow__container"},O&&T.createElement(Af,{defaultColor:e,rfId:r}),T.createElement("g",null,H.map(N=>{const[h,S,b]=Kr(z.get(N.source)),[$,D,w]=Kr(z.get(N.target));if(!b||!w)return null;let C=N.type||"default";o[C]||(P==null||P("011",Ae.error011(C)),C="default");const k=o[C]||o.default,B=I===Qe.Strict?D.target:(D.target??[]).concat(D.source??[]),V=Wr(S.source,N.sourceHandle),F=Wr(B,N.targetHandle),K=(V==null?void 0:V.position)||X.Bottom,Z=(F==null?void 0:F.position)||X.Top,U=!!(N.focusable||m&&typeof N.focusable>"u"),q=typeof s<"u"&&(N.updatable||E&&typeof N.updatable>"u");if(!V||!F)return P==null||P("008",Ae.error008(V,N)),null;const{sourceX:Q,sourceY:J,targetX:se,targetY:ge}=xf(h,V,K,$,F,Z);return T.createElement(k,{key:N.id,id:N.id,className:de([N.className,i]),type:C,data:N.data,selected:!!N.selected,animated:!!N.animated,hidden:!!N.hidden,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,style:N.style,source:N.source,target:N.target,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerEnd:N.markerEnd,markerStart:N.markerStart,sourceX:Q,sourceY:J,targetX:se,targetY:ge,sourcePosition:K,targetPosition:Z,elementsSelectable:M,onEdgeUpdate:s,onContextMenu:a,onMouseEnter:l,onMouseMove:u,onMouseLeave:c,onClick:f,edgeUpdaterRadius:d,onEdgeDoubleClick:g,onEdgeUpdateStart:x,onEdgeUpdateEnd:p,rfId:r,ariaLabel:N.ariaLabel,isFocusable:U,isUpdatable:q,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth})})))),v):null};gi.displayName="EdgeRenderer";var kf=_.memo(gi);const Tf=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Pf({children:e}){const t=j(Tf);return T.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Df(e){const t=ri(),n=_.useRef(!1);_.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Rf={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top},pi=({nodeId:e,handleType:t,style:n,type:r=Re.Bezier,CustomComponent:o,connectionStatus:i})=>{var I,z,P;const{fromNode:s,handleId:a,toX:l,toY:u,connectionMode:c}=j(_.useCallback(R=>({fromNode:R.nodeInternals.get(e),handleId:R.connectionHandleId,toX:(R.connectionPosition.x-R.transform[0])/R.transform[2],toY:(R.connectionPosition.y-R.transform[1])/R.transform[2],connectionMode:R.connectionMode}),[e]),ie),f=(I=s==null?void 0:s[te])==null?void 0:I.handleBounds;let d=f==null?void 0:f[t];if(c===Qe.Loose&&(d=d||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!d)return null;const g=a?d.find(R=>R.id===a):d[0],x=g?g.x+g.width/2:(s.width??0)/2,p=g?g.y+g.height/2:s.height??0,v=(((z=s.positionAbsolute)==null?void 0:z.x)??0)+x,m=(((P=s.positionAbsolute)==null?void 0:P.y)??0)+p,E=g==null?void 0:g.position,M=E?Rf[E]:null;if(!E||!M)return null;if(o)return T.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:g,fromX:v,fromY:m,toX:l,toY:u,fromPosition:E,toPosition:M,connectionStatus:i});let y="";const A={sourceX:v,sourceY:m,sourcePosition:E,targetX:l,targetY:u,targetPosition:M};return r===Re.Bezier?[y]=Io(A):r===Re.Step?[y]=Rn({...A,borderRadius:0}):r===Re.SmoothStep?[y]=Rn(A):r===Re.SimpleBezier?[y]=zo(A):y=`M${v},${m} ${l},${u}`,T.createElement("path",{d:y,fill:"none",className:"react-flow__connection-path",style:n})};pi.displayName="ConnectionLine";const zf=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function If({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:l,connectionStatus:u}=j(zf,ie);return!(o&&i&&a&&s)?null:T.createElement("svg",{style:e,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},T.createElement("g",{className:de(["react-flow__connection",u])},T.createElement(pi,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function Ur(e,t){return _.useRef(null),ne(),_.useMemo(()=>t(e),[e])}const mi=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:c,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:g,onSelectionContextMenu:x,onSelectionStart:p,onSelectionEnd:v,connectionLineType:m,connectionLineStyle:E,connectionLineComponent:M,connectionLineContainerStyle:y,selectionKeyCode:A,selectionOnDrag:I,selectionMode:z,multiSelectionKeyCode:P,panActivationKeyCode:R,zoomActivationKeyCode:L,deleteKeyCode:H,onlyRenderVisibleElements:O,elementsSelectable:N,selectNodesOnDrag:h,defaultViewport:S,translateExtent:b,minZoom:$,maxZoom:D,preventScrolling:w,defaultMarkerColor:C,zoomOnScroll:k,zoomOnPinch:B,panOnScroll:V,panOnScrollSpeed:F,panOnScrollMode:K,zoomOnDoubleClick:Z,panOnDrag:U,onPaneClick:q,onPaneMouseEnter:Q,onPaneMouseMove:J,onPaneMouseLeave:se,onPaneScroll:ge,onPaneContextMenu:we,onEdgeUpdate:ee,onEdgeContextMenu:G,onEdgeMouseEnter:ae,onEdgeMouseMove:le,onEdgeMouseLeave:Y,edgeUpdaterRadius:He,onEdgeUpdateStart:Be,onEdgeUpdateEnd:gt,noDragClassName:Je,noWheelClassName:Oe,noPanClassName:$e,elevateEdgesOnSelect:je,disableKeyboardA11y:ke,nodeOrigin:Le,nodeExtent:pt,rfId:et})=>{const re=Ur(e,uf),ue=Ur(t,yf);return Df(i),T.createElement(cf,{onPaneClick:q,onPaneMouseEnter:Q,onPaneMouseMove:J,onPaneMouseLeave:se,onPaneContextMenu:we,onPaneScroll:ge,deleteKeyCode:H,selectionKeyCode:A,selectionOnDrag:I,selectionMode:z,onSelectionStart:p,onSelectionEnd:v,multiSelectionKeyCode:P,panActivationKeyCode:R,zoomActivationKeyCode:L,elementsSelectable:N,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:k,zoomOnPinch:B,zoomOnDoubleClick:Z,panOnScroll:V,panOnScrollSpeed:F,panOnScrollMode:K,panOnDrag:U,defaultViewport:S,translateExtent:b,minZoom:$,maxZoom:D,onSelectionContextMenu:x,preventScrolling:w,noDragClassName:Je,noWheelClassName:Oe,noPanClassName:$e,disableKeyboardA11y:ke},T.createElement(Pf,null,T.createElement(kf,{edgeTypes:ue,onEdgeClick:a,onEdgeDoubleClick:u,onEdgeUpdate:ee,onlyRenderVisibleElements:O,onEdgeContextMenu:G,onEdgeMouseEnter:ae,onEdgeMouseMove:le,onEdgeMouseLeave:Y,onEdgeUpdateStart:Be,onEdgeUpdateEnd:gt,edgeUpdaterRadius:He,defaultMarkerColor:C,noPanClassName:$e,elevateEdgesOnSelect:!!je,disableKeyboardA11y:ke,rfId:et},T.createElement(If,{style:E,type:m,component:M,containerStyle:y})),T.createElement("div",{className:"react-flow__edgelabel-renderer"}),T.createElement(hf,{nodeTypes:re,onNodeClick:s,onNodeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:g,selectNodesOnDrag:h,onlyRenderVisibleElements:O,noPanClassName:$e,noDragClassName:Je,disableKeyboardA11y:ke,nodeOrigin:Le,nodeExtent:pt,rfId:et})))};mi.displayName="GraphView";var Hf=_.memo(mi);const Bn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Te={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Bn,nodeExtent:Bn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Qe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:uu,isValidConnection:void 0},Bf=()=>Ss((e,t)=>({...Te,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:bn(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?bn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:l,nodeOrigin:u}=t(),c=l==null?void 0:l.querySelector(".react-flow__viewport");if(!c)return;const f=window.getComputedStyle(c),{m22:d}=new window.DOMMatrixReadOnly(f.transform),g=n.reduce((p,v)=>{const m=o.get(v.id);if(m){const E=Wn(v.nodeElement);!!(E.width&&E.height&&(m.width!==E.width||m.height!==E.height||v.forceUpdate))&&(o.set(m.id,{...m,[te]:{...m[te],handleBounds:{source:Vr(".source",v.nodeElement,d,u),target:Vr(".target",v.nodeElement,d,u)}},...E}),p.push({id:m.id,type:"dimensions",dimensions:E}))}return p},[]);ti(o,u);const x=s||i&&!s&&ni(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:x}),(g==null?void 0:g.length)>0&&(r==null||r(g))},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const l={id:a.id,type:"position",dragging:o};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});i(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const u=ii(n,a()),c=bn(u,o,s,l);e({nodeInternals:c})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(l=>De(l,!0)):(s=it(i(),n),a=it(o,[])),Ft({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(l=>De(l,!0)):(s=it(o,n),a=it(i(),[])),Ft({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),s=n||i(),a=r||o,l=s.map(c=>(c.selected=!1,De(c.id,!1))),u=a.map(c=>De(c.id,!1));Ft({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>De(a.id,!1)),s=n.filter(a=>a.selected).map(a=>De(a.id,!1));Ft({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=Kn(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:i,d3Zoom:s,d3Selection:a,translateExtent:l}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=ze.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),c=[[0,0],[o,i]],f=s==null?void 0:s.constrain()(u,c,l);return s.transform(a,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Te.connectionNodeId,connectionHandleId:Te.connectionHandleId,connectionHandleType:Te.connectionHandleType,connectionStatus:Te.connectionStatus,connectionStartHandle:Te.connectionStartHandle,connectionEndHandle:Te.connectionEndHandle}),reset:()=>e({...Te})}),Object.is),yi=({children:e})=>{const t=_.useRef(null);return t.current||(t.current=Bf()),T.createElement(tu,{value:t.current},e)};yi.displayName="ReactFlowProvider";const xi=({children:e})=>_.useContext(ln)?T.createElement(T.Fragment,null,e):T.createElement(yi,null,e);xi.displayName="ReactFlowWrapper";const Of={input:Uo,default:In,output:Go,group:er},Lf={default:nn,straight:Gn,step:qn,smoothstep:un,simplebezier:Un},Vf=[0,0],Ff=[15,15],Xf={x:0,y:0,zoom:1},Yf={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},wi=_.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=Of,edgeTypes:s=Lf,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:c,onMoveStart:f,onMoveEnd:d,onConnect:g,onConnectStart:x,onConnectEnd:p,onClickConnectStart:v,onClickConnectEnd:m,onNodeMouseEnter:E,onNodeMouseMove:M,onNodeMouseLeave:y,onNodeContextMenu:A,onNodeDoubleClick:I,onNodeDragStart:z,onNodeDrag:P,onNodeDragStop:R,onNodesDelete:L,onEdgesDelete:H,onSelectionChange:O,onSelectionDragStart:N,onSelectionDrag:h,onSelectionDragStop:S,onSelectionContextMenu:b,onSelectionStart:$,onSelectionEnd:D,connectionMode:w=Qe.Strict,connectionLineType:C=Re.Bezier,connectionLineStyle:k,connectionLineComponent:B,connectionLineContainerStyle:V,deleteKeyCode:F="Backspace",selectionKeyCode:K="Shift",selectionOnDrag:Z=!1,selectionMode:U=kt.Full,panActivationKeyCode:q="Space",multiSelectionKeyCode:Q=en()?"Meta":"Control",zoomActivationKeyCode:J=en()?"Meta":"Control",snapToGrid:se=!1,snapGrid:ge=Ff,onlyRenderVisibleElements:we=!1,selectNodesOnDrag:ee=!0,nodesDraggable:G,nodesConnectable:ae,nodesFocusable:le,nodeOrigin:Y=Vf,edgesFocusable:He,edgesUpdatable:Be,elementsSelectable:gt,defaultViewport:Je=Xf,minZoom:Oe=.5,maxZoom:$e=2,translateExtent:je=Bn,preventScrolling:ke=!0,nodeExtent:Le,defaultMarkerColor:pt="#b1b1b7",zoomOnScroll:et=!0,zoomOnPinch:re=!0,panOnScroll:ue=!1,panOnScrollSpeed:Ve=.5,panOnScrollMode:Fe=Ze.Free,zoomOnDoubleClick:Xe=!0,panOnDrag:Ee=!0,onPaneClick:be,onPaneMouseEnter:mt,onPaneMouseMove:fn,onPaneMouseLeave:yt,onPaneScroll:dn,onPaneContextMenu:nr,children:Ye,onEdgeUpdate:Si,onEdgeContextMenu:_i,onEdgeDoubleClick:Ei,onEdgeMouseEnter:Ni,onEdgeMouseMove:Ci,onEdgeMouseLeave:Mi,onEdgeUpdateStart:Ai,onEdgeUpdateEnd:$i,edgeUpdaterRadius:ki=10,onNodesChange:Ti,onEdgesChange:Pi,noDragClassName:Di="nodrag",noWheelClassName:Ri="nowheel",noPanClassName:rr="nopan",fitView:zi=!1,fitViewOptions:Ii,connectOnClick:Hi=!0,attributionPosition:Bi,proOptions:Oi,defaultEdgeOptions:Li,elevateNodesOnSelect:Vi=!0,elevateEdgesOnSelect:Fi=!1,disableKeyboardA11y:or=!1,autoPanOnConnect:Xi=!0,autoPanOnNodeDrag:Yi=!0,connectionRadius:Wi=20,isValidConnection:Ki,onError:Zi,style:Ui,id:ir,nodeDragThreshold:qi,...Gi},Qi)=>{const hn=ir||"1";return T.createElement("div",{...Gi,style:{...Ui,...Yf},ref:Qi,className:de(["react-flow",o]),"data-testid":"rf__wrapper",id:ir},T.createElement(xi,null,T.createElement(Hf,{onInit:u,onMove:c,onMoveStart:f,onMoveEnd:d,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:E,onNodeMouseMove:M,onNodeMouseLeave:y,onNodeContextMenu:A,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:s,connectionLineType:C,connectionLineStyle:k,connectionLineComponent:B,connectionLineContainerStyle:V,selectionKeyCode:K,selectionOnDrag:Z,selectionMode:U,deleteKeyCode:F,multiSelectionKeyCode:Q,panActivationKeyCode:q,zoomActivationKeyCode:J,onlyRenderVisibleElements:we,selectNodesOnDrag:ee,defaultViewport:Je,translateExtent:je,minZoom:Oe,maxZoom:$e,preventScrolling:ke,zoomOnScroll:et,zoomOnPinch:re,zoomOnDoubleClick:Xe,panOnScroll:ue,panOnScrollSpeed:Ve,panOnScrollMode:Fe,panOnDrag:Ee,onPaneClick:be,onPaneMouseEnter:mt,onPaneMouseMove:fn,onPaneMouseLeave:yt,onPaneScroll:dn,onPaneContextMenu:nr,onSelectionContextMenu:b,onSelectionStart:$,onSelectionEnd:D,onEdgeUpdate:Si,onEdgeContextMenu:_i,onEdgeDoubleClick:Ei,onEdgeMouseEnter:Ni,onEdgeMouseMove:Ci,onEdgeMouseLeave:Mi,onEdgeUpdateStart:Ai,onEdgeUpdateEnd:$i,edgeUpdaterRadius:ki,defaultMarkerColor:pt,noDragClassName:Di,noWheelClassName:Ri,noPanClassName:rr,elevateEdgesOnSelect:Fi,rfId:hn,disableKeyboardA11y:or,nodeOrigin:Y,nodeExtent:Le}),T.createElement(Du,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:x,onConnectEnd:p,onClickConnectStart:v,onClickConnectEnd:m,nodesDraggable:G,nodesConnectable:ae,nodesFocusable:le,edgesFocusable:He,edgesUpdatable:Be,elementsSelectable:gt,elevateNodesOnSelect:Vi,minZoom:Oe,maxZoom:$e,nodeExtent:Le,onNodesChange:Ti,onEdgesChange:Pi,snapToGrid:se,snapGrid:ge,connectionMode:w,translateExtent:je,connectOnClick:Hi,defaultEdgeOptions:Li,fitView:zi,fitViewOptions:Ii,onNodesDelete:L,onEdgesDelete:H,onNodeDragStart:z,onNodeDrag:P,onNodeDragStop:R,onSelectionDrag:h,onSelectionDragStart:N,onSelectionDragStop:S,noPanClassName:rr,nodeOrigin:Y,rfId:hn,autoPanOnConnect:Xi,autoPanOnNodeDrag:Yi,onError:Zi,connectionRadius:Wi,isValidConnection:Ki,nodeDragThreshold:qi}),T.createElement(Tu,{onSelectionChange:O}),Ye,T.createElement(ou,{proOptions:Oi,position:Bi}),T.createElement(Bu,{rfId:hn,disableKeyboardA11y:or})))});wi.displayName="ReactFlow";function bi(e){return t=>{const[n,r]=_.useState(t),o=_.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const Wf=bi(ii),Kf=bi(Ju);var ye;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ye||(ye={}));function Zf({color:e,dimensions:t,lineWidth:n}){return T.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Uf({color:e,radius:t}){return T.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const qf={[ye.Dots]:"#91919a",[ye.Lines]:"#eee",[ye.Cross]:"#e2e2e2"},Gf={[ye.Dots]:1,[ye.Lines]:1,[ye.Cross]:6},Qf=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function vi({id:e,variant:t=ye.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,style:a,className:l}){const u=_.useRef(null),{transform:c,patternId:f}=j(Qf,ie),d=s||qf[t],g=r||Gf[t],x=t===ye.Dots,p=t===ye.Cross,v=Array.isArray(n)?n:[n,n],m=[v[0]*c[2]||1,v[1]*c[2]||1],E=g*c[2],M=p?[E,E]:m,y=x?[E/i,E/i]:[M[0]/i,M[1]/i];return T.createElement("svg",{className:de(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},T.createElement("pattern",{id:f+e,x:c[0]%m[0],y:c[1]%m[1],width:m[0],height:m[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${y[0]},-${y[1]})`},x?T.createElement(Uf,{color:d,radius:E/i}):T.createElement(Zf,{dimensions:M,color:d,lineWidth:o})),T.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}vi.displayName="Background";var Jf=_.memo(vi);const jf=_.memo(e=>{const{isConnectable:t,data:n,dragging:r}=e,o=ji.chain(["node",r?"dragging":void 0]).compact().join(" ").value();return oe.jsx("div",{className:o,style:{background:"hsl(197.09deg 30% 45%)"},children:oe.jsxs("div",{className:"content",children:[oe.jsx("div",{className:"header",children:"Custom Color Picker Node"}),oe.jsxs("div",{className:"body",children:[oe.jsx(qe,{type:"target",position:X.Left,style:{background:"#555"},onConnect:i=>console.log("handle onConnect",i),isConnectable:t}),oe.jsx("div",{children:oe.jsx("strong",{children:n.color})}),oe.jsx("input",{className:"nodrag",type:"color",onChange:n.onChange,defaultValue:n.color}),oe.jsx(qe,{type:"source",position:X.Right,id:"a",style:{top:10,background:"#555"},isConnectable:t}),oe.jsx(qe,{type:"source",position:X.Right,id:"b",style:{bottom:10,top:"auto",background:"#555"},isConnectable:t})]})]})})});const ed=[{id:"1",position:{x:0,y:0},data:{label:"1"},type:"stuff"},{id:"2",position:{x:200,y:100},data:{label:"2"}}],td=[{id:"e1-2",source:"1",target:"2"}],nd={stuff:jf};function rd(e){const[t,n,r]=Wf(ed),[o,i,s]=Kf(td),a=_.useCallback(l=>{i(u=>Ho(l,u))},[i]);return oe.jsx("div",{className:"graph-editor",children:oe.jsx(wi,{fitView:!0,nodes:t,edges:o,onNodesChange:r,onEdgesChange:s,onConnect:a,nodeTypes:nd,proOptions:{hideAttribution:!0},children:oe.jsx(Jf,{color:"rgba(255, 255, 255, 0.1)"})})})}function id(){return oe.jsx("div",{className:"route graph-edit",children:oe.jsx(rd,{})})}export{id as RouteGraphEdit,id as default};
