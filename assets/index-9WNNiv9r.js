var x=(i,n,e)=>{if(!n.has(i))throw TypeError("Cannot "+e)};var u=(i,n,e)=>(x(i,n,"read from private field"),e?e.call(i):n.get(i)),S=(i,n,e)=>{if(n.has(i))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(i):n.set(i,e)},d=(i,n,e,r)=>(x(i,n,"write to private field"),r?r.call(i,e):n.set(i,e),e);import{r as c,j as s,F as X,l as Y,m as B,n as T}from"./index-kuqyIrry.js";import{S as U,c as V,V as a,G as L,u as y,b as N}from"./index-HgdW4TjL.js";import"./react-spring_web.modern-ij3r5BdC.js";var o;class j extends L{constructor(e,r){super(e);S(this,o,void 0);d(this,o,r.density)}get density(){return u(this,o)}add(e){d(this,o,u(this,o)+e)}step(e){d(this,o,u(this,o)*.99)}getRGBA(){return[255,0,100,Math.min(u(this,o),1)*255]}}o=new WeakMap;class W extends U{createGrid(n){return new V({...n,createEmpty:e=>new j(e,{density:0})})}clear(){super.clear(),this.grid.set(a.create(3,3),new j(this.grid,{density:.5}))}step(n){this.grid.forEach(e=>{e.step(n)}),this.grid.registerChanged(this.grid.getAtXY(0,0)),this.grid.registerChanged(this.grid.getAtXY(...this.grid.size.clone().subtractScalar(1).toArray()))}}function K(){const i=a.create(6,3),n=c.useRef(null),e=c.useRef(void 0),r=100,[h,C]=c.useState(!0),[p,g]=y(void 0),[f,b]=y(a.create(0,0)),[w]=c.useState({pixelScale:r,debugDraw:!0,onDebugDraw:t=>{t.translate(-.5,-.5),t.strokeStyle="white",t.lineWidth=1,t.strokeRect(3*r,2*r,r+1,r+1)}});c.useEffect(()=>{const t=n.current;t&&(h?t.start():t.stop())},[h]);function R(){const t=new W({gridOptions:{size:i}});return t.clear(),t}function F(t){t.preventDefault()}function P(){g("add")}function M(){g(void 0),e.current=void 0}function A(t){const m=t.target,{x:l,y:E,width:O,height:z}=m.getBoundingClientRect(),G=a.create(l,E),I=a.create(O,z);b(a.create(t.clientX,t.clientY).subtract(G).divide(I).multiply(i).floor())}function k({grid:t}){v(t)}function v(t){if(p.current===void 0)return;(e.current?t.getCellsInLine(e.current,f.current):[t.getAtPosition(f.current)]).forEach(l=>{l&&p.current==="add"&&l.add(.02)}),e.current=f.current}function D(){var t;(t=n.current)==null||t.clear()}return s.jsxs("div",{className:"route fluid",children:[s.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[s.jsx("button",{onClick:()=>C(t=>!t),children:h?s.jsxs(s.Fragment,{children:[s.jsx(X,{}),"stop"]}):s.jsxs(s.Fragment,{children:[s.jsx(Y,{}),"start"]})}),s.jsxs("button",{onClick:()=>{var t;return(t=n.current)==null?void 0:t.step(.1)},children:[s.jsx(B,{}),"step"]}),s.jsxs("button",{onClick:()=>D(),children:[s.jsx(T,{}),"reset"]})]}),s.jsx(N,{ref:n,renderOptions:w,initSimulation:R,onStep:k,onPointerDown:P,onPointerUp:M,onPointerMove:A,onContextMenu:F})]})}export{K as default};
