var J=Object.defineProperty;var K=(s,n,t)=>n in s?J(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t;var H=(s,n,t)=>(K(s,typeof n!="symbol"?n+"":n,t),t),L=(s,n,t)=>{if(!n.has(s))throw TypeError("Cannot "+t)};var l=(s,n,t)=>(L(s,n,"read from private field"),t?t.call(s):n.get(s)),E=(s,n,t)=>{if(n.has(s))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(s):n.set(s,t)},F=(s,n,t,r)=>(L(s,n,"write to private field"),r?r.call(s,t):n.set(s,t),t);var W=(s,n,t)=>(L(s,n,"access private method"),t);import{r as x,j as o,F as Q,i as Z,m as $,l as ee}from"./index-gPDt2v28.js";import{G as te,a as ne,n as se,u as v,b as re,V as i}from"./index-wdF-5WWh.js";class y extends te{constructor(t,r){super(t);H(this,"alive",!1);this.alive=r||!1}getRGBA(){return this.alive?[255,0,0,255]:[0,0,0,0]}}var a,m,C,q;class ie{constructor(n){E(this,C);E(this,a,void 0);E(this,m,!1);F(this,a,new ne({...n,createEmpty:t=>new y(t)}))}start(){F(this,m,!0)}stop(){F(this,m,!1)}isRunning(){return l(this,m)}getGrid(){return l(this,a)}restart(){l(this,a).clear()}step(n){if(!l(this,m))return;const t=l(this,a).map(r=>r.alive);l(this,a).forEach(r=>{let d=W(this,C,q).call(this,t,r);r.alive!==d&&l(this,a).setAtIndex(r.index,new y(l(this,a),d))})}}a=new WeakMap,m=new WeakMap,C=new WeakSet,q=function(n,t){let r=0;return se.forEach(d=>{if(!t.position)return;const P=l(this,a).position2index(t.position.add(d));n[P]===!0&&r++}),t.alive&&(r<2||r>3)?!1:!t.alive&&r===3?!0:t.alive};function le(){const t=.08333333333333333,r=x.useRef(),[d,P]=v(void 0),b=x.useRef(),R=x.useRef(void 0),[S,k]=v(void 0),[G,B]=v(new i(0,0)),[A,N]=v(!0),[D,I]=v(-1);x.useEffect(()=>(r.current=new ie({width:160,height:90}),P(r.current.getGrid()),T(),U(),b.current=requestAnimationFrame(O),()=>{b.current!==void 0&&cancelAnimationFrame(b.current)}),[]),x.useEffect(()=>{const e=r.current;e&&(A.current?e.start():e.stop())},[A.current]);function U(){const e={glider:`01
                001
                111`,grabbyEdge:`001
                001
                011
                0
                1100111
                10101
                011
                0
                011
                10101
                1100111
                0
                011
                001
                001`};function c(u,p){u.trim().split(`
`).forEach((g,M)=>{var w;g=g.trim();for(let j=0;j<g.length;j++)Number.parseInt(g[j])!==0&&((w=d.current)==null||w.set(new i(j,M).add(p),new y(d.current,!0)))})}[new i(0,5),new i(0,26),new i(0,47),new i(0,68)].forEach(u=>{c(e.grabbyEdge,u)}),[new i(30,20),new i(30,30),new i(30,40),new i(30,50),new i(30,60),new i(40,20),new i(40,30),new i(40,40),new i(40,50),new i(40,60),new i(50,20),new i(50,30),new i(50,40),new i(50,50),new i(50,60)].forEach(u=>{c(e.glider,u)})}function V(e){e.preventDefault()}function X(e){var w;const c=e.target,{x:f,y:h,width:u,height:p}=c.getBoundingClientRect(),g=new i(Math.floor((e.clientX-f)/u*160),Math.floor((e.clientY-h)/p*90)),M=(w=d.current)==null?void 0:w.get(g);M&&k(M.alive?"erase":"add")}function Y(){k(void 0),R.current=void 0}function _(e){const c=e.target,{x:f,y:h,width:u,height:p}=c.getBoundingClientRect();B(new i(Math.floor((e.clientX-f)/u*160),Math.floor((e.clientY-h)/p*90)))}function O(e){if(D.current===-1)I(e);else{const c=(e-D.current)/1e3;if(c>t){const f=r.current;if(!f)return;z(f.getGrid()),f.step(c),I(e)}}b.current=requestAnimationFrame(O)}function z(e){if(S.current===void 0||!r.current)return;(R.current?e.getPositionsInLine(R.current,G.current):[G.current]).forEach(h=>{e.get(h)&&e.set(h,new y(e,S.current==="add"))}),R.current=G.current}function T(){const e=r.current;e&&e.restart()}return o.jsxs("div",{className:"route game-of-life",children:[o.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[o.jsx("button",{onClick:()=>N(e=>!e),children:A.current?o.jsxs(o.Fragment,{children:[o.jsx(Q,{}),"stop"]}):o.jsxs(o.Fragment,{children:[o.jsx(Z,{}),"start"]})}),o.jsxs("button",{onClick:()=>{var e;return(e=r.current)==null?void 0:e.step(1)},children:[o.jsx($,{}),"step"]}),o.jsxs("button",{onClick:()=>T(),children:[o.jsx(ee,{}),"reset"]})]}),o.jsx(re,{grid:d.current,onMouseDown:X,onMouseUp:Y,onMouseMove:_,onContextMenu:V})]})}export{le as default};
