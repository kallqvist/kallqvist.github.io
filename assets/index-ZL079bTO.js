var G=Object.defineProperty;var O=(i,e,n)=>e in i?G(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var d=(i,e,n)=>(O(i,typeof e!="symbol"?e+"":e,n),n),z=(i,e,n)=>{if(!e.has(i))throw TypeError("Cannot "+n)};var h=(i,e,n)=>(z(i,e,"read from private field"),n?n.call(i):e.get(i)),x=(i,e,n)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,n)};import{r as a,j as s,F as B,l as U,m as V,n as L}from"./index-0fGeCcMT.js";import{G as N,S as T,c as W,V as r,u as m,b as X}from"./index-VhAcvopk.js";import"./react-spring_web.modern-ApfulI3L.js";var u;class p extends N{constructor(n,o){super(n);d(this,"age",0);d(this,"density");x(this,u,Math.random()*7+3);this.density=o.density}step(n){this.age+=n,this.age>h(this,u)&&this.grid.setAtIndex(this.index,this.grid.createEmpty()),this.grid.registerChanged(this)}getRGBA(){return[255,0,100,Math.min(this.age/h(this,u)*155+100,255)]}}u=new WeakMap;class Y extends T{createGrid(e){return new W({...e,createEmpty:n=>new p(n,{density:0})})}clear(){super.clear(),this.grid.set(r.create(3,3),new p(this.grid,{density:.5}))}step(e){this.grid.forEach(n=>{n.step(e)})}}function Q(){const i=r.create(16,9),e=a.useRef(null),n=a.useRef(void 0),[o,g]=a.useState(!0),[y,S]=m(void 0),[l,j]=m(r.create(0,0)),[C]=a.useState({debugDraw:!0,pixelScale:10,onDebugDraw:t=>{t.strokeStyle="white",t.lineWidth=1,t.strokeRect(30,20,11,11)}});a.useEffect(()=>{const t=e.current;t&&(o?t.start():t.stop())},[o]);function b(){const t=new Y({gridOptions:{size:i}});return t.clear(),t}function w(t){t.preventDefault()}function R(){S(void 0),n.current=void 0}function F(t){const f=t.target,{x:c,y:v,width:k,height:E}=f.getBoundingClientRect(),I=r.create(c,v),D=r.create(k,E);j(r.create(t.clientX,t.clientY).subtract(I).divide(D).multiply(i).floor())}function M({grid:t}){P(t)}function P(t){if(y.current===void 0)return;(n.current?t.getCellsInLine(n.current,l.current):[t.getAtPosition(l.current)]).forEach(c=>{c&&t.setAtIndex(c.index,new p(t,{density:.5}))}),n.current=l.current}function A(){var t;(t=e.current)==null||t.clear()}return s.jsxs("div",{className:"route fluid",children:[s.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[s.jsx("button",{onClick:()=>g(t=>!t),children:o?s.jsxs(s.Fragment,{children:[s.jsx(B,{}),"stop"]}):s.jsxs(s.Fragment,{children:[s.jsx(U,{}),"start"]})}),s.jsxs("button",{onClick:()=>{var t;return(t=e.current)==null?void 0:t.step(.1)},children:[s.jsx(V,{}),"step"]}),s.jsxs("button",{onClick:()=>A(),children:[s.jsx(L,{}),"reset"]})]}),s.jsx(X,{ref:e,renderOptions:C,initSimulation:b,onStep:M,onPointerUp:R,onPointerMove:F,onContextMenu:w})]})}export{Q as default};
