var S=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var c=(n,e,t)=>(S(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},d=(n,e,t,s)=>(S(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t);import{r as y,j as p,n as G}from"./index-zDf87eej.js";import{S as F,C as I,G as B,V as m,u as R,b as N}from"./index-PUCwxj4j.js";import"./react-spring_web.modern-YQ7NnBjt.js";var a,r;class U extends B{constructor(t,s){super(t);x(this,a,void 0);x(this,r,void 0);d(this,r,s.density),d(this,a,c(this,r))}get density(){return c(this,r)}add(t){d(this,r,c(this,r)+t),this.grid.registerChanged(this)}diffuse(t,s){const o=s*t*this.grid.size.x*this.grid.size.y,u=this.dir.N(),l=this.dir.E(),h=this.dir.S(),f=this.dir.W();d(this,r,(c(this,a)+o*(((f==null?void 0:f.density)||0)+((l==null?void 0:l.density)||0)+((u==null?void 0:u.density)||0)+((h==null?void 0:h.density)||0)))/(1+4*o)),d(this,a,c(this,r))}step(t){this.diffuse(20,t),this.grid.registerChanged(this)}getRGBA(){return[255,0,100,Math.min(c(this,r),1)*255]}}a=new WeakMap,r=new WeakMap;class V extends F{createGrid(e){return new I({...e,createEmpty:t=>new U(t,{density:0})})}step(e){this.grid.forEachChunkPass(t=>{t.forEach(s=>{s.forEach(o=>o.step(e),{alternateRowDirections:!0})})})}}function Y(){const n=m.create(320,192),e=y.useRef(null),t=y.useRef(void 0),[s,o]=R(void 0),[u,l]=R(m.create(0,0)),[h]=y.useState({});function f(){const i=new V({gridOptions:{size:n}});return i.clear(),i}function v(i){i.preventDefault()}function M(){o("add")}function P(){o(void 0),t.current=void 0}function b(i){const C=i.target,{x:g,y:z,width:A,height:D}=C.getBoundingClientRect(),O=m.create(g,z),k=m.create(A,D);l(m.create(i.clientX,i.clientY).subtract(O).divide(k).multiply(n).floor())}function j({grid:i}){w(i)}function w(i){if(s.current===void 0)return;(t.current?i.getCellsInLine(t.current,u.current,{excludeStart:!0}):[i.getAtPosition(u.current)]).forEach(g=>{g&&s.current==="add"&&g.add(.8)}),t.current=u.current}function E(){var i;(i=e.current)==null||i.clear()}return p.jsxs("div",{className:"route fluid",children:[p.jsx("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:p.jsxs("button",{onClick:()=>E(),children:[p.jsx(G,{}),"reset"]})}),p.jsx(N,{ref:e,renderOptions:h,initSimulation:f,onStep:j,onPointerDown:M,onPointerUp:P,onPointerMove:b,onContextMenu:v})]})}export{Y as default};
