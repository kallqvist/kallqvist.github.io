var N=Object.defineProperty;var J=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var H=(s,e,t)=>(J(s,typeof e!="symbol"?e+"":e,t),t),b=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var a=(s,e,t)=>(b(s,e,"read from private field"),t?t.call(s):e.get(s)),w=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},M=(s,e,t,r)=>(b(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var O=(s,e,t)=>(b(s,e,"access private method"),t);import{r as l,e as K,_ as Q,j as i,F as Z,i as $,l as tt,m as et}from"./index-_yFQUFCz.js";import{G as nt,a as st,n as rt,u as p,V as j,b as it}from"./index-xrDbIVUM.js";class F extends nt{constructor(t,r){super(t);H(this,"alive",!1);this.alive=r||!1,this.sleep(),this.color=this.getRGBA()}getRGBA(){return this.alive?[255,255,255,255]:[0,0,0,0]}}var u,m,C,T;class ot{constructor(e){w(this,C);w(this,u,void 0);w(this,m,!1);M(this,u,new st({...e,createEmpty:t=>new F(t)}))}start(){M(this,m,!0)}stop(){M(this,m,!1)}isRunning(){return a(this,m)}getGrid(){return a(this,u)}restart(){this.stop(),a(this,u).clear()}step(){const e=a(this,u).map(t=>t.alive);a(this,u).forEach(t=>{let r=O(this,C,T).call(this,e,t);t.alive!==r&&a(this,u).setAtIndex(t.index,new F(a(this,u),r))},{})}}u=new WeakMap,m=new WeakMap,C=new WeakSet,T=function(e,t){let r=0;return rt.forEach(c=>{if(!t.position)return;const h=a(this,u).position2index(t.position.add(c));e[h]===!0&&r++}),t.alive&&(r<2||r>3)?!1:!t.alive&&r===3?!0:t.alive};function ut(s,e){if(!l.useContext(K))throw new Error("Hook can't be used outside of a burger menu context");const[r,c]=l.useState([]);l.useEffect(()=>{Q.isEqual(r,e)},[s,e])}function ft(){const t=.08333333333333333,r=l.useRef(null),c=l.useRef(),[h,q]=p(void 0),g=l.useRef(),x=l.useRef(void 0),[A,y]=p(void 0),[E,I]=p(new j(0,0)),[v,W]=p(!0),[P,k]=p(-1);l.useEffect(()=>(c.current=new ot({width:160,height:90}),q(c.current.getGrid()),L(),g.current=requestAnimationFrame(B),()=>{g.current!==void 0&&cancelAnimationFrame(g.current)}),[]),l.useEffect(()=>{const n=c.current;n&&(v.current?n.start():n.stop())},[v]),ut("actions",[{title:"yolo",action:()=>console.log("blerp")}]);function U(n){n.preventDefault()}function V(n){var D;const f=n.target,{x:d,y:o,width:R,height:G}=f.getBoundingClientRect(),z=new j(Math.floor((n.clientX-d)/R*160),Math.floor((n.clientY-o)/G*90)),S=(D=h.current)==null?void 0:D.get(z);S&&y(S.alive?"erase":"add")}function X(){y(void 0),x.current=void 0}function Y(n){const f=n.target,{x:d,y:o,width:R,height:G}=f.getBoundingClientRect();I(new j(Math.floor((n.clientX-d)/R*160),Math.floor((n.clientY-o)/G*90)))}function B(n){var f;if(P.current===-1)k(n);else if((n-P.current)/1e3>t){const o=c.current;if(!o)return;_(o.getGrid()),v.current&&o.step(),(f=r.current)==null||f.render(),k(n)}g.current=requestAnimationFrame(B)}function _(n){if(A.current===void 0||!c.current)return;(x.current?n.getPositionsInLine(x.current,E.current):[E.current]).forEach(o=>{n.get(o)&&n.set(o,new F(n,A.current==="add"))}),x.current=E.current}function L(){const n=c.current;if(!n)return;n.restart(),[[16,10],[17,10],[18,10],[18,9],[17,8]].forEach(d=>{var o;(o=h.current)==null||o.setAtPosition(new j(...d),new F(h.current,!0))})}return i.jsxs("div",{className:"route game-of-life",children:[i.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[i.jsx("button",{onClick:()=>W(n=>!n),children:v.current?i.jsxs(i.Fragment,{children:[i.jsx(Z,{}),"stop"]}):i.jsxs(i.Fragment,{children:[i.jsx($,{}),"start"]})}),i.jsxs("button",{onClick:()=>{var n;return(n=c.current)==null?void 0:n.step()},children:[i.jsx(tt,{}),"step"]}),i.jsxs("button",{onClick:()=>L(),children:[i.jsx(et,{}),"reset"]})]}),i.jsx(it,{ref:r,grid:h.current,onMouseDown:V,onMouseUp:X,onMouseMove:Y,onContextMenu:U})]})}export{ft as default};
