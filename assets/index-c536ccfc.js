import{r as F,R as Mt,a as Fe,c as Jt,g as Ho,j as Et,_ as Xt}from"./index-3290c650.js";import{u as $o,a as Yo}from"./react-spring_web.modern-20423c8f.js";const nr=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ge(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Kr(e){return"nodeType"in e}function At(e){var t,n;return e?Ge(e)?e:Kr(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Xr(e){const{Document:t}=At(e);return e instanceof t}function vn(e){return Ge(e)?!1:e instanceof At(e).HTMLElement}function Go(e){return e instanceof At(e).SVGElement}function Je(e){return e?Ge(e)?e.document:Kr(e)?Xr(e)?e:vn(e)?e.ownerDocument:document:document:document}const he=nr?F.useLayoutEffect:F.useEffect;function Zr(e){const t=F.useRef(e);return he(()=>{t.current=e}),F.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Jo(){const e=F.useRef(null),t=F.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=F.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function un(e,t){t===void 0&&(t=[e]);const n=F.useRef(e);return he(()=>{n.current!==e&&(n.current=e)},t),n}function _n(e,t){const n=F.useRef();return F.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function jn(e){const t=Zr(e),n=F.useRef(null),r=F.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function Mr(e){const t=F.useRef();return F.useEffect(()=>{t.current=e},[e]),t.current}let yr={};function rr(e,t){return F.useMemo(()=>{if(t)return t;const n=yr[e]==null?0:yr[e]+1;return yr[e]=n,e+"-"+n},[e,t])}function ds(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((o,a)=>{const l=Object.entries(a);for(const[u,g]of l){const b=o[u];b!=null&&(o[u]=b+e*g)}return o},{...t})}}const Be=ds(1),Pn=ds(-1);function Ko(e){return"clientX"in e&&"clientY"in e}function fs(e){if(!e)return!1;const{KeyboardEvent:t}=At(e.target);return t&&e instanceof t}function Xo(e){if(!e)return!1;const{TouchEvent:t}=At(e.target);return t&&e instanceof t}function Nr(e){if(Xo(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ko(e)?{x:e.clientX,y:e.clientY}:null}const xi="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Zo(e){return e.matches(xi)?e:e.querySelector(xi)}const Qo={display:"none"};function ta(e){let{id:t,value:n}=e;return Mt.createElement("div",{id:t,style:Qo},n)}const ea={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};function na(e){let{id:t,announcement:n}=e;return Mt.createElement("div",{id:t,style:ea,role:"status","aria-live":"assertive","aria-atomic":!0},n)}function ra(){const[e,t]=F.useState("");return{announce:F.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const gs=F.createContext(null);function ia(e){const t=F.useContext(gs);F.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function sa(){const[e]=F.useState(()=>new Set),t=F.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[F.useCallback(r=>{let{type:s,event:o}=r;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,o)})},[e]),t]}const oa={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},aa={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ca(e){let{announcements:t=aa,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=oa}=e;const{announce:o,announcement:a}=ra(),l=rr("DndLiveRegion"),[u,g]=F.useState(!1);if(F.useEffect(()=>{g(!0)},[]),ia(F.useMemo(()=>({onDragStart(h){let{active:f}=h;o(t.onDragStart({active:f}))},onDragMove(h){let{active:f,over:p}=h;t.onDragMove&&o(t.onDragMove({active:f,over:p}))},onDragOver(h){let{active:f,over:p}=h;o(t.onDragOver({active:f,over:p}))},onDragEnd(h){let{active:f,over:p}=h;o(t.onDragEnd({active:f,over:p}))},onDragCancel(h){let{active:f,over:p}=h;o(t.onDragCancel({active:f,over:p}))}}),[o,t])),!u)return null;const b=Mt.createElement(Mt.Fragment,null,Mt.createElement(ta,{id:r,value:s.draggable}),Mt.createElement(na,{id:l,announcement:a}));return n?Fe.createPortal(b,n):b}var ht;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ht||(ht={}));function Vn(){}const zt=Object.freeze({x:0,y:0});function la(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function ua(e,t){if(!e||e.length===0)return null;const[n]=e;return t?n[t]:n}function ha(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=s-r,l=o-n;if(r<s&&n<o){const u=t.width*t.height,g=e.width*e.height,b=a*l,h=b/(u+g-b);return Number(h.toFixed(4))}return 0}const da=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const o of r){const{id:a}=o,l=n.get(a);if(l){const u=ha(l,t);u>0&&s.push({id:a,data:{droppableContainer:o,value:u}})}}return s.sort(la)};function fa(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function ps(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:zt}function ga(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const pa=ga(1);function ya(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ba(e,t,n){const r=ya(t);if(!r)return e;const{scaleX:s,scaleY:o,x:a,y:l}=r,u=e.left-a-(1-s)*parseFloat(n),g=e.top-l-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),b=s?e.width/s:e.width,h=o?e.height/o:e.height;return{width:b,height:h,top:g,right:u+b,bottom:g+h,left:u}}const wa={ignoreTransform:!1};function Cn(e,t){t===void 0&&(t=wa);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:g,transformOrigin:b}=At(e).getComputedStyle(e);g&&(n=ba(n,g,b))}const{top:r,left:s,width:o,height:a,bottom:l,right:u}=n;return{top:r,left:s,width:o,height:a,bottom:l,right:u}}function Li(e){return Cn(e,{ignoreTransform:!0})}function ma(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function va(e,t){return t===void 0&&(t=At(e).getComputedStyle(e)),t.position==="fixed"}function _a(e,t){t===void 0&&(t=At(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?n.test(o):!1})}function Qr(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Xr(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!vn(s)||Go(s)||n.includes(s))return n;const o=At(e).getComputedStyle(s);return s!==e&&_a(s,o)&&n.push(s),va(s,o)?n:r(s.parentNode)}return e?r(e):n}function ys(e){const[t]=Qr(e,1);return t??null}function br(e){return!nr||!e?null:Ge(e)?e:Kr(e)?Xr(e)||e===Je(e).scrollingElement?window:vn(e)?e:null:null}function bs(e){return Ge(e)?e.scrollX:e.scrollLeft}function ws(e){return Ge(e)?e.scrollY:e.scrollTop}function Ur(e){return{x:bs(e),y:ws(e)}}var yt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(yt||(yt={}));function ms(e){return!nr||!e?!1:e===document.scrollingElement}function vs(e){const t={x:0,y:0},n=ms(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:s,isLeft:o,isBottom:a,isRight:l,maxScroll:r,minScroll:t}}const Ca={x:.2,y:.2};function Sa(e,t,n,r,s){let{top:o,left:a,right:l,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=Ca);const{isTop:g,isBottom:b,isLeft:h,isRight:f}=vs(e),p={x:0,y:0},y={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!g&&o<=t.top+v.height?(p.y=yt.Backward,y.y=r*Math.abs((t.top+v.height-o)/v.height)):!b&&u>=t.bottom-v.height&&(p.y=yt.Forward,y.y=r*Math.abs((t.bottom-v.height-u)/v.height)),!f&&l>=t.right-v.width?(p.x=yt.Forward,y.x=r*Math.abs((t.right-v.width-l)/v.width)):!h&&a<=t.left+v.width&&(p.x=yt.Backward,y.x=r*Math.abs((t.left+v.width-a)/v.width)),{direction:p,speed:y}}function Ea(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function _s(e){return e.reduce((t,n)=>Be(t,Ur(n)),zt)}function ka(e){return e.reduce((t,n)=>t+bs(n),0)}function Ra(e){return e.reduce((t,n)=>t+ws(n),0)}function Da(e,t){if(t===void 0&&(t=Cn),!e)return;const{top:n,left:r,bottom:s,right:o}=t(e);ys(e)&&(s<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Aa=[["x",["left","right"],ka],["y",["top","bottom"],Ra]];class ti{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Qr(n),s=_s(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,a,l]of Aa)for(const u of a)Object.defineProperty(this,u,{get:()=>{const g=l(r),b=s[o]-g;return this.rect[u]+b},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class sn{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Ta(e){const{EventTarget:t}=At(e);return e instanceof t?e:Je(e)}function wr(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var It;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(It||(It={}));function Oi(e){e.preventDefault()}function xa(e){e.stopPropagation()}var it;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter"})(it||(it={}));const Cs={start:[it.Space,it.Enter],cancel:[it.Esc],end:[it.Space,it.Enter]},La=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case it.Right:return{...n,x:n.x+25};case it.Left:return{...n,x:n.x-25};case it.Down:return{...n,y:n.y+25};case it.Up:return{...n,y:n.y-25}}};class Ss{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new sn(Je(n)),this.windowListeners=new sn(At(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(It.Resize,this.handleCancel),this.windowListeners.add(It.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(It.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Da(r),n(zt)}handleKeyDown(t){if(fs(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:o=Cs,coordinateGetter:a=La,scrollBehavior:l="smooth"}=s,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:g}=r.current,b=g?{x:g.left,y:g.top}:zt;this.referenceCoordinates||(this.referenceCoordinates=b);const h=a(t,{active:n,context:r.current,currentCoordinates:b});if(h){const f=Pn(h,b),p={x:0,y:0},{scrollableAncestors:y}=r.current;for(const v of y){const L=t.code,{isTop:T,isRight:I,isLeft:w,isBottom:_,maxScroll:C,minScroll:R}=vs(v),S=Ea(v),A={x:Math.min(L===it.Right?S.right-S.width/2:S.right,Math.max(L===it.Right?S.left:S.left+S.width/2,h.x)),y:Math.min(L===it.Down?S.bottom-S.height/2:S.bottom,Math.max(L===it.Down?S.top:S.top+S.height/2,h.y))},U=L===it.Right&&!I||L===it.Left&&!w,k=L===it.Down&&!_||L===it.Up&&!T;if(U&&A.x!==h.x){const D=v.scrollLeft+f.x,B=L===it.Right&&D<=C.x||L===it.Left&&D>=R.x;if(B&&!f.y){v.scrollTo({left:D,behavior:l});return}B?p.x=v.scrollLeft-D:p.x=L===it.Right?v.scrollLeft-C.x:v.scrollLeft-R.x,p.x&&v.scrollBy({left:-p.x,behavior:l});break}else if(k&&A.y!==h.y){const D=v.scrollTop+f.y,B=L===it.Down&&D<=C.y||L===it.Up&&D>=R.y;if(B&&!f.x){v.scrollTo({top:D,behavior:l});return}B?p.y=v.scrollTop-D:p.y=L===it.Down?v.scrollTop-C.y:v.scrollTop-R.y,p.y&&v.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Be(Pn(h,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ss.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Cs,onActivation:s}=t,{active:o}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const l=o.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function Ii(e){return!!(e&&"distance"in e)}function Mi(e){return!!(e&&"delay"in e)}class ei{constructor(t,n,r){var s;r===void 0&&(r=Ta(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:a}=o;this.props=t,this.events=n,this.document=Je(a),this.documentListeners=new sn(this.document),this.listeners=new sn(r),this.windowListeners=new sn(At(a)),this.initialCoordinates=(s=Nr(o))!=null?s:zt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),this.windowListeners.add(It.Resize,this.handleCancel),this.windowListeners.add(It.DragStart,Oi),this.windowListeners.add(It.VisibilityChange,this.handleCancel),this.windowListeners.add(It.ContextMenu,Oi),this.documentListeners.add(It.Keydown,this.handleKeydown),n){if(Ii(n))return;if(Mi(n)){this.timeoutId=setTimeout(this.handleStart,n.delay);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(It.Click,xa,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(It.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:o}=this,{onMove:a,options:{activationConstraint:l}}=o;if(!s)return;const u=(n=Nr(t))!=null?n:zt,g=Pn(s,u);if(!r&&l){if(Mi(l))return wr(g,l.tolerance)?this.handleCancel():void 0;if(Ii(l))return l.tolerance!=null&&wr(g,l.tolerance)?this.handleCancel():wr(g,l.distance)?this.handleStart():void 0}t.cancelable&&t.preventDefault(),a(u)}handleEnd(){const{onEnd:t}=this.props;this.detach(),t()}handleCancel(){const{onCancel:t}=this.props;this.detach(),t()}handleKeydown(t){t.code===it.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Oa={move:{name:"pointermove"},end:{name:"pointerup"}};class Es extends ei{constructor(t){const{event:n}=t,r=Je(n.target);super(t,Oa,r)}}Es.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Ia={move:{name:"mousemove"},end:{name:"mouseup"}};var Fr;(function(e){e[e.RightClick=2]="RightClick"})(Fr||(Fr={}));class Ma extends ei{constructor(t){super(t,Ia,Je(t.event.target))}}Ma.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Fr.RightClick?!1:(r==null||r({event:n}),!0)}}];const mr={move:{name:"touchmove"},end:{name:"touchend"}};class Na extends ei{constructor(t){super(t,mr)}static setup(){return window.addEventListener(mr.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(mr.move.name,t)};function t(){}}}Na.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var on;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(on||(on={}));var Wn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Wn||(Wn={}));function Ua(e){let{acceleration:t,activator:n=on.Pointer,canScroll:r,draggingRect:s,enabled:o,interval:a=5,order:l=Wn.TreeOrder,pointerCoordinates:u,scrollableAncestors:g,scrollableAncestorRects:b,delta:h,threshold:f}=e;const p=Ba({delta:h,disabled:!o}),[y,v]=Jo(),L=F.useRef({x:0,y:0}),T=F.useRef({x:0,y:0}),I=F.useMemo(()=>{switch(n){case on.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case on.DraggableRect:return s}},[n,s,u]),w=F.useRef(null),_=F.useCallback(()=>{const R=w.current;if(!R)return;const S=L.current.x*T.current.x,A=L.current.y*T.current.y;R.scrollBy(S,A)},[]),C=F.useMemo(()=>l===Wn.TreeOrder?[...g].reverse():g,[l,g]);F.useEffect(()=>{if(!o||!g.length||!I){v();return}for(const R of C){if((r==null?void 0:r(R))===!1)continue;const S=g.indexOf(R),A=b[S];if(!A)continue;const{direction:U,speed:k}=Sa(R,A,I,t,f);for(const D of["x","y"])p[D][U[D]]||(k[D]=0,U[D]=0);if(k.x>0||k.y>0){v(),w.current=R,y(_,a),L.current=k,T.current=U;return}}L.current={x:0,y:0},T.current={x:0,y:0},v()},[t,_,r,v,o,a,JSON.stringify(I),JSON.stringify(p),y,g,C,b,JSON.stringify(f)])}const Fa={x:{[yt.Backward]:!1,[yt.Forward]:!1},y:{[yt.Backward]:!1,[yt.Forward]:!1}};function Ba(e){let{delta:t,disabled:n}=e;const r=Mr(t);return _n(s=>{if(n||!r||!s)return Fa;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[yt.Backward]:s.x[yt.Backward]||o.x===-1,[yt.Forward]:s.x[yt.Forward]||o.x===1},y:{[yt.Backward]:s.y[yt.Backward]||o.y===-1,[yt.Forward]:s.y[yt.Forward]||o.y===1}}},[n,t,r])}function ja(e,t){const n=t!==null?e.get(t):void 0,r=n?n.node.current:null;return _n(s=>{var o;return t===null?null:(o=r??s)!=null?o:null},[r,t])}function Pa(e,t){return F.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,o=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...o]},[]),[e,t])}var hn;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(hn||(hn={}));var Br;(function(e){e.Optimized="optimized"})(Br||(Br={}));const Ni=new Map;function Va(e,t){let{dragging:n,dependencies:r,config:s}=t;const[o,a]=F.useState(null),{frequency:l,measure:u,strategy:g}=s,b=F.useRef(e),h=L(),f=un(h),p=F.useCallback(function(T){T===void 0&&(T=[]),!f.current&&a(I=>I===null?T:I.concat(T.filter(w=>!I.includes(w))))},[f]),y=F.useRef(null),v=_n(T=>{if(h&&!n)return Ni;if(!T||T===Ni||b.current!==e||o!=null){const I=new Map;for(let w of e){if(!w)continue;if(o&&o.length>0&&!o.includes(w.id)&&w.rect.current){I.set(w.id,w.rect.current);continue}const _=w.node.current,C=_?new ti(u(_),_):null;w.rect.current=C,C&&I.set(w.id,C)}return I}return T},[e,o,n,h,u]);return F.useEffect(()=>{b.current=e},[e]),F.useEffect(()=>{h||p()},[n,h]),F.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),F.useEffect(()=>{h||typeof l!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},l))},[l,h,p,...r]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:o!=null};function L(){switch(g){case hn.Always:return!1;case hn.BeforeDragging:return n;default:return!n}}}function ks(e,t){return _n(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Wa(e,t){return ks(e,t)}function qa(e){let{callback:t,disabled:n}=e;const r=Zr(t),s=F.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return F.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function ir(e){let{callback:t,disabled:n}=e;const r=Zr(t),s=F.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return F.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function za(e){return new ti(Cn(e),e)}function Ui(e,t,n){t===void 0&&(t=za);const[r,s]=F.useReducer(l,null),o=qa({callback(u){if(e)for(const g of u){const{type:b,target:h}=g;if(b==="childList"&&h instanceof HTMLElement&&h.contains(e)){s();break}}}}),a=ir({callback:s});return he(()=>{s(),e?(a==null||a.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),o==null||o.disconnect())},[e]),r;function l(u){if(!e)return null;if(e.isConnected===!1){var g;return(g=u??n)!=null?g:null}const b=t(e);return JSON.stringify(u)===JSON.stringify(b)?u:b}}function Ha(e){const t=ks(e);return ps(e,t)}const Fi=[];function $a(e){const t=F.useRef(e),n=_n(r=>e?r&&r!==Fi&&e&&t.current&&e.parentNode===t.current.parentNode?r:Qr(e):Fi,[e]);return F.useEffect(()=>{t.current=e},[e]),n}function Ya(e){const[t,n]=F.useState(null),r=F.useRef(e),s=F.useCallback(o=>{const a=br(o.target);a&&n(l=>l?(l.set(a,Ur(a)),new Map(l)):null)},[]);return F.useEffect(()=>{const o=r.current;if(e!==o){a(o);const l=e.map(u=>{const g=br(u);return g?(g.addEventListener("scroll",s,{passive:!0}),[g,Ur(g)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),r.current=e}return()=>{a(e),a(o)};function a(l){l.forEach(u=>{const g=br(u);g==null||g.removeEventListener("scroll",s)})}},[s,e]),F.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,a)=>Be(o,a),zt):_s(e):zt,[e,t])}function Bi(e,t){t===void 0&&(t=[]);const n=F.useRef(null);return F.useEffect(()=>{n.current=null},t),F.useEffect(()=>{const r=e!==zt;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Pn(e,n.current):zt}function Ga(e){F.useEffect(()=>{if(!nr)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ja(e,t){return F.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:o}=r;return n[s]=a=>{o(a,t)},n},{}),[e,t])}function Rs(e){return F.useMemo(()=>e?ma(e):null,[e])}const vr=[];function Ka(e,t){t===void 0&&(t=Cn);const[n]=e,r=Rs(n?At(n):null),[s,o]=F.useReducer(l,vr),a=ir({callback:o});return e.length>0&&s===vr&&o(),he(()=>{e.length?e.forEach(u=>a==null?void 0:a.observe(u)):(a==null||a.disconnect(),o())},[e]),s;function l(){return e.length?e.map(u=>ms(u)?r:new ti(t(u),u)):vr}}function Xa(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return vn(t)?t:e}function Za(e){let{measure:t}=e;const[n,r]=F.useState(null),s=F.useCallback(g=>{for(const{target:b}of g)if(vn(b)){r(h=>{const f=t(b);return h?{...h,width:f.width,height:f.height}:f});break}},[t]),o=ir({callback:s}),a=F.useCallback(g=>{const b=Xa(g);o==null||o.disconnect(),b&&(o==null||o.observe(b)),r(b?t(b):null)},[t,o]),[l,u]=jn(a);return F.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const Qa=[{sensor:Es,options:{}},{sensor:Ss,options:{}}],tc={current:{}},Mn={draggable:{measure:Li},droppable:{measure:Li,strategy:hn.WhileDragging,frequency:Br.Optimized},dragOverlay:{measure:Cn}};class an extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const ec={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new an,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Vn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Mn,measureDroppableContainers:Vn,windowRect:null,measuringScheduled:!1},nc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Vn,draggableNodes:new Map,over:null,measureDroppableContainers:Vn},sr=F.createContext(nc),rc=F.createContext(ec);function ic(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new an}}}function sc(e,t){switch(t.type){case ht.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ht.DragMove:return e.draggable.active?{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}}:e;case ht.DragEnd:case ht.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ht.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new an(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case ht.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const a=new an(e.droppable.containers);return a.set(n,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case ht.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new an(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function oc(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=F.useContext(sr),o=Mr(r),a=Mr(n==null?void 0:n.id);return F.useEffect(()=>{if(!t&&!r&&o&&a!=null){if(!fs(o)||document.activeElement===o.target)return;const l=s.get(a);if(!l)return;const{activatorNode:u,node:g}=l;if(!u.current&&!g.current)return;requestAnimationFrame(()=>{for(const b of[u.current,g.current]){if(!b)continue;const h=Zo(b);if(h){h.focus();break}}})}},[r,t,s,a,o]),null}function ac(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...r}),n):n}function cc(e){return F.useMemo(()=>({draggable:{...Mn.draggable,...e==null?void 0:e.draggable},droppable:{...Mn.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Mn.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function lc(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const o=F.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;he(()=>{if(!a&&!l||!t){o.current=!1;return}if(o.current||!r)return;const g=t==null?void 0:t.node.current;if(!g||g.isConnected===!1)return;const b=n(g),h=ps(b,r);if(a||(h.x=0),l||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const f=ys(g);f&&f.scrollBy({top:h.y,left:h.x})}},[t,a,l,r,n])}const Ds=F.createContext({...zt,scaleX:1,scaleY:1});var me;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(me||(me={}));const uc=F.memo(function(t){var n,r,s,o;let{id:a,accessibility:l,autoScroll:u=!0,children:g,sensors:b=Qa,collisionDetection:h=da,measuring:f,modifiers:p,...y}=t;const v=F.useReducer(sc,void 0,ic),[L,T]=v,[I,w]=sa(),[_,C]=F.useState(me.Uninitialized),R=_===me.Initialized,{draggable:{active:S,nodes:A,translate:U},droppable:{containers:k}}=L,D=S?A.get(S):null,B=F.useRef({initial:null,translated:null}),P=F.useMemo(()=>{var vt;return S!=null?{id:S,data:(vt=D==null?void 0:D.data)!=null?vt:tc,rect:B}:null},[S,D]),z=F.useRef(null),[G,X]=F.useState(null),[et,mt]=F.useState(null),H=un(y,Object.values(y)),Ht=rr("DndDescribedBy",a),kt=F.useMemo(()=>k.getEnabled(),[k]),Ct=cc(f),{droppableRects:nt,measureDroppableContainers:Q,measuringScheduled:Rt}=Va(kt,{dragging:R,dependencies:[U.x,U.y],config:Ct.droppable}),ct=ja(A,S),jt=F.useMemo(()=>et?Nr(et):null,[et]),pe=zo(),$t=Wa(ct,Ct.draggable.measure);lc({activeNode:S?A.get(S):null,config:pe.layoutShiftCompensation,initialRect:$t,measure:Ct.draggable.measure});const lt=Ui(ct,Ct.draggable.measure,$t),oe=Ui(ct?ct.parentElement:null),St=F.useRef({activatorEvent:null,active:null,activeNode:ct,collisionRect:null,collisions:null,droppableRects:nt,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Dt=k.getNodeFor((n=St.current.over)==null?void 0:n.id),ut=Za({measure:Ct.dragOverlay.measure}),O=(r=ut.nodeRef.current)!=null?r:ct,M=R?(s=ut.rect)!=null?s:lt:null,j=!!(ut.nodeRef.current&&ut.rect),W=Ha(j?null:lt),m=Rs(O?At(O):null),i=$a(R?Dt??ct:null),c=Ka(i),d=ac(p,{transform:{x:U.x-W.x,y:U.y-W.y,scaleX:1,scaleY:1},activatorEvent:et,active:P,activeNodeRect:lt,containerNodeRect:oe,draggingNodeRect:M,over:St.current.over,overlayNodeRect:ut.rect,scrollableAncestors:i,scrollableAncestorRects:c,windowRect:m}),E=jt?Be(jt,U):null,x=Ya(i),N=Bi(x),V=Bi(x,[lt]),$=Be(d,N),tt=M?pa(M,d):null,J=P&&tt?h({active:P,collisionRect:tt,droppableRects:nt,droppableContainers:kt,pointerCoordinates:E}):null,K=ua(J,"id"),[rt,Yt]=F.useState(null),ye=j?d:Be(d,V),ke=fa(ye,(o=rt==null?void 0:rt.rect)!=null?o:null,lt),ae=F.useCallback((vt,Tt)=>{let{sensor:xt,options:we}=Tt;if(z.current==null)return;const Ot=A.get(z.current);if(!Ot)return;const Pt=vt.nativeEvent,Gt=new xt({active:z.current,activeNode:Ot,event:Pt,options:we,context:St,onStart(Vt){const Qe=z.current;if(Qe==null)return;const tn=A.get(Qe);if(!tn)return;const{onDragStart:An}=H.current,Tn={active:{id:Qe,data:tn.data,rect:B}};Fe.unstable_batchedUpdates(()=>{An==null||An(Tn),C(me.Initializing),T({type:ht.DragStart,initialCoordinates:Vt,active:Qe}),I({type:"onDragStart",event:Tn})})},onMove(Vt){T({type:ht.DragMove,coordinates:Vt})},onEnd:Ue(ht.DragEnd),onCancel:Ue(ht.DragCancel)});Fe.unstable_batchedUpdates(()=>{X(Gt),mt(vt.nativeEvent)});function Ue(Vt){return async function(){const{active:tn,collisions:An,over:Tn,scrollAdjustedTranslate:Ti}=St.current;let en=null;if(tn&&Ti){const{cancelDrop:nn}=H.current;en={activatorEvent:Pt,active:tn,collisions:An,delta:Ti,over:Tn},Vt===ht.DragEnd&&typeof nn=="function"&&await Promise.resolve(nn(en))&&(Vt=ht.DragCancel)}z.current=null,Fe.unstable_batchedUpdates(()=>{T({type:Vt}),C(me.Uninitialized),Yt(null),X(null),mt(null);const nn=Vt===ht.DragEnd?"onDragEnd":"onDragCancel";if(en){const pr=H.current[nn];pr==null||pr(en),I({type:nn,event:en})}})}}},[A]),be=F.useCallback((vt,Tt)=>(xt,we)=>{const Ot=xt.nativeEvent,Pt=A.get(we);if(z.current!==null||!Pt||Ot.dndKit||Ot.defaultPrevented)return;const Gt={active:Pt};vt(xt,Tt.options,Gt)===!0&&(Ot.dndKit={capturedBy:Tt.sensor},z.current=we,ae(xt,Tt))},[A,ae]),Ai=Pa(b,be);Ga(b),he(()=>{lt&&_===me.Initializing&&C(me.Initialized)},[lt,_]),F.useEffect(()=>{const{onDragMove:vt}=H.current,{active:Tt,activatorEvent:xt,collisions:we,over:Ot}=St.current;if(!Tt||!xt)return;const Pt={active:Tt,activatorEvent:xt,collisions:we,delta:{x:$.x,y:$.y},over:Ot};Fe.unstable_batchedUpdates(()=>{vt==null||vt(Pt),I({type:"onDragMove",event:Pt})})},[$.x,$.y]),F.useEffect(()=>{const{active:vt,activatorEvent:Tt,collisions:xt,droppableContainers:we,scrollAdjustedTranslate:Ot}=St.current;if(!vt||z.current==null||!Tt||!Ot)return;const{onDragOver:Pt}=H.current,Gt=we.get(K),Ue=Gt&&Gt.rect.current?{id:Gt.id,rect:Gt.rect.current,data:Gt.data,disabled:Gt.disabled}:null,Vt={active:vt,activatorEvent:Tt,collisions:xt,delta:{x:Ot.x,y:Ot.y},over:Ue};Fe.unstable_batchedUpdates(()=>{Yt(Ue),Pt==null||Pt(Vt),I({type:"onDragOver",event:Vt})})},[K]),he(()=>{St.current={activatorEvent:et,active:P,activeNode:ct,collisionRect:tt,collisions:J,droppableRects:nt,draggableNodes:A,draggingNode:O,draggingNodeRect:M,droppableContainers:k,over:rt,scrollableAncestors:i,scrollAdjustedTranslate:$},B.current={initial:M,translated:tt}},[P,ct,J,tt,A,O,M,nt,k,rt,i,$]),Ua({...pe,delta:U,draggingRect:tt,pointerCoordinates:E,scrollableAncestors:i,scrollableAncestorRects:c});const Wo=F.useMemo(()=>({active:P,activeNode:ct,activeNodeRect:lt,activatorEvent:et,collisions:J,containerNodeRect:oe,dragOverlay:ut,draggableNodes:A,droppableContainers:k,droppableRects:nt,over:rt,measureDroppableContainers:Q,scrollableAncestors:i,scrollableAncestorRects:c,measuringConfiguration:Ct,measuringScheduled:Rt,windowRect:m}),[P,ct,lt,et,J,oe,ut,A,k,nt,rt,Q,i,c,Ct,Rt,m]),qo=F.useMemo(()=>({activatorEvent:et,activators:Ai,active:P,activeNodeRect:lt,ariaDescribedById:{draggable:Ht},dispatch:T,draggableNodes:A,over:rt,measureDroppableContainers:Q}),[et,Ai,P,lt,T,Ht,A,rt,Q]);return Mt.createElement(gs.Provider,{value:w},Mt.createElement(sr.Provider,{value:qo},Mt.createElement(rc.Provider,{value:Wo},Mt.createElement(Ds.Provider,{value:ke},g)),Mt.createElement(oc,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Mt.createElement(ca,{...l,hiddenTextDescribedById:Ht}));function zo(){const vt=(G==null?void 0:G.autoScrollEnabled)===!1,Tt=typeof u=="object"?u.enabled===!1:u===!1,xt=R&&!vt&&!Tt;return typeof u=="object"?{...u,enabled:xt}:{enabled:xt}}}),hc=F.createContext(null),ji="button",dc="Droppable";function fc(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const o=rr(dc),{activators:a,activatorEvent:l,active:u,activeNodeRect:g,ariaDescribedById:b,draggableNodes:h,over:f}=F.useContext(sr),{role:p=ji,roleDescription:y="draggable",tabIndex:v=0}=s??{},L=(u==null?void 0:u.id)===t,T=F.useContext(L?Ds:hc),[I,w]=jn(),[_,C]=jn(),R=Ja(a,t),S=un(n);he(()=>(h.set(t,{id:t,key:o,node:I,activatorNode:_,data:S}),()=>{const U=h.get(t);U&&U.key===o&&h.delete(t)}),[h,t]);const A=F.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":r,"aria-pressed":L&&p===ji?!0:void 0,"aria-roledescription":y,"aria-describedby":b.draggable}),[r,p,v,L,y,b.draggable]);return{active:u,activatorEvent:l,activeNodeRect:g,attributes:A,isDragging:L,listeners:r?void 0:R,node:I,over:f,setNodeRef:w,setActivatorNodeRef:C,transform:T}}const gc="Droppable",pc={timeout:25};function yc(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const o=rr(gc),{active:a,dispatch:l,over:u,measureDroppableContainers:g}=F.useContext(sr),b=F.useRef({disabled:n}),h=F.useRef(!1),f=F.useRef(null),p=F.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:L}={...pc,...s},T=un(v??r),I=F.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{g(Array.isArray(T.current)?T.current:[T.current]),p.current=null},L)},[L]),w=ir({callback:I,disabled:y||!a}),_=F.useCallback((A,U)=>{w&&(U&&(w.unobserve(U),h.current=!1),A&&w.observe(A))},[w]),[C,R]=jn(_),S=un(t);return F.useEffect(()=>{!w||!C.current||(w.disconnect(),h.current=!1,w.observe(C.current))},[C,w]),he(()=>(l({type:ht.RegisterDroppable,element:{id:r,key:o,disabled:n,node:C,rect:f,data:S}}),()=>l({type:ht.UnregisterDroppable,key:o,id:r})),[r]),F.useEffect(()=>{n!==b.current.disabled&&(l({type:ht.SetDroppableDisabled,id:r,key:o,disabled:n}),b.current.disabled=n)},[r,o,n,l]),{active:a,rect:f,isOver:(u==null?void 0:u.id)===r,node:C,over:u,setNodeRef:R}}const qt=()=>new Map,jr=e=>{const t=qt();return e.forEach((n,r)=>{t.set(r,n)}),t},Bt=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},bc=(e,t)=>{const n=[];for(const[r,s]of e)n.push(t(s,r));return n},wc=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},Ae=()=>new Set,_r=e=>e[e.length-1],mc=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Se=Array.from,vc=Array.isArray;class or{constructor(){this._observers=qt()}on(t,n){Bt(this._observers,t,Ae).add(n)}once(t,n){const r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Se((this._observers.get(t)||qt()).values()).forEach(r=>r(...n))}destroy(){this._observers=qt()}}const te=Math.floor,Nn=Math.abs,_c=Math.log10,ni=(e,t)=>e<t?e:t,Me=(e,t)=>e>t?e:t,As=e=>e!==0?e<0:1/e<0,Pi=1,Vi=2,Cr=4,Sr=8,dn=32,le=64,Lt=128,ar=31,Pr=63,Re=127,Cc=2147483647,Ts=Number.MAX_SAFE_INTEGER,Sc=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&te(e)===e),Ec=String.fromCharCode,kc=e=>e.toLowerCase(),Rc=/^\s*/g,Dc=e=>e.replace(Rc,""),Ac=/([A-Z])/g,Wi=(e,t)=>Dc(e.replace(Ac,n=>`${t}${kc(n)}`)),Tc=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},fn=typeof TextEncoder<"u"?new TextEncoder:null,xc=e=>fn.encode(e),Vr=fn?xc:Tc;let cn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});cn&&cn.decode(new Uint8Array).length===1&&(cn=null);class Sn{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const bt=()=>new Sn,Lc=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},ot=e=>{const t=new Uint8Array(Lc(e));let n=0;for(let r=0;r<e.bufs.length;r++){const s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},Oc=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(Me(n,t)*2),e.cpos=0)},gt=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},gn=gt,q=(e,t)=>{for(;t>Re;)gt(e,Lt|Re&t),t=te(t/128);gt(e,Re&t)},ri=(e,t)=>{const n=As(t);for(n&&(t=-t),gt(e,(t>Pr?Lt:0)|(n?le:0)|Pr&t),t=te(t/64);t>0;)gt(e,(t>Re?Lt:0)|Re&t),t=te(t/128)},Wr=new Uint8Array(3e4),Ic=Wr.length/3,Mc=(e,t)=>{if(t.length<Ic){const n=fn.encodeInto(t,Wr).written||0;q(e,n);for(let r=0;r<n;r++)gt(e,Wr[r])}else at(e,Vr(t))},Nc=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;q(e,r);for(let s=0;s<r;s++)gt(e,n.codePointAt(s))},Zt=fn&&fn.encodeInto?Mc:Nc,cr=(e,t)=>{const n=e.cbuf.length,r=e.cpos,s=ni(n-r,t.length),o=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(Me(n*2,o)),e.cbuf.set(t.subarray(s)),e.cpos=o)},at=(e,t)=>{q(e,t.byteLength),cr(e,t)},ii=(e,t)=>{Oc(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},Uc=(e,t)=>ii(e,4).setFloat32(0,t,!1),Fc=(e,t)=>ii(e,8).setFloat64(0,t,!1),Bc=(e,t)=>ii(e,8).setBigInt64(0,t,!1),qi=new DataView(new ArrayBuffer(4)),jc=e=>(qi.setFloat32(0,e),qi.getFloat32(0)===e),We=(e,t)=>{switch(typeof t){case"string":gt(e,119),Zt(e,t);break;case"number":Sc(t)&&Nn(t)<=Cc?(gt(e,125),ri(e,t)):jc(t)?(gt(e,124),Uc(e,t)):(gt(e,123),Fc(e,t));break;case"bigint":gt(e,122),Bc(e,t);break;case"object":if(t===null)gt(e,126);else if(vc(t)){gt(e,117),q(e,t.length);for(let n=0;n<t.length;n++)We(e,t[n])}else if(t instanceof Uint8Array)gt(e,116),at(e,t);else{gt(e,118);const n=Object.keys(t);q(e,n.length);for(let r=0;r<n.length;r++){const s=n[r];Zt(e,s),We(e,t[s])}}break;case"boolean":gt(e,t?120:121);break;default:gt(e,127)}};class zi extends Sn{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&q(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Hi=e=>{e.count>0&&(ri(e.encoder,e.count===1?e.s:-e.s),e.count>1&&q(e.encoder,e.count-2))};class Un{constructor(){this.encoder=new Sn,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Hi(this),this.count=1,this.s=t)}toUint8Array(){return Hi(this),ot(this.encoder)}}const $i=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);ri(e.encoder,t),e.count>1&&q(e.encoder,e.count-2)}};class Er{constructor(){this.encoder=new Sn,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):($i(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return $i(this),ot(this.encoder)}}class Pc{constructor(){this.sarr=[],this.s="",this.lensE=new Un}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Sn;return this.sarr.push(this.s),this.s="",Zt(t,this.sarr.join("")),cr(t,this.lensE.toUint8Array()),ot(t)}}const ee=e=>new Error(e),Qt=()=>{throw ee("Method unimplemented")},ne=()=>{throw ee("Unexpected case")},xs=ee("Unexpected end of array"),Ls=ee("Integer out of Range");class lr{constructor(t){this.arr=t,this.pos=0}}const se=e=>new lr(e),Vc=e=>e.pos!==e.arr.length,Wc=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},pt=e=>Wc(e,Y(e)),Te=e=>e.arr[e.pos++],Y=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const s=e.arr[e.pos++];if(t=t+(s&Re)*n,n*=128,s<Lt)return t;if(t>Ts)throw Ls}throw xs},si=e=>{let t=e.arr[e.pos++],n=t&Pr,r=64;const s=(t&le)>0?-1:1;if(!(t&Lt))return s*n;const o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],n=n+(t&Re)*r,r*=128,t<Lt)return s*n;if(n>Ts)throw Ls}throw xs},qc=e=>{let t=Y(e);if(t===0)return"";{let n=String.fromCodePoint(Te(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Te(e));else for(;t>0;){const r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},zc=e=>cn.decode(pt(e)),ue=cn?zc:qc,oi=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Hc=e=>oi(e,4).getFloat32(0,!1),$c=e=>oi(e,8).getFloat64(0,!1),Yc=e=>oi(e,8).getBigInt64(0,!1),Gc=[e=>{},e=>null,si,Hc,$c,Yc,e=>!1,e=>!0,ue,e=>{const t=Y(e),n={};for(let r=0;r<t;r++){const s=ue(e);n[s]=qe(e)}return n},e=>{const t=Y(e),n=[];for(let r=0;r<t;r++)n.push(qe(e));return n},pt],qe=e=>Gc[127-Te(e)](e);class Yi extends lr{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Vc(this)?this.count=Y(this)+1:this.count=-1),this.count--,this.s}}class Fn extends lr{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=si(this);const t=As(this.s);this.count=1,t&&(this.s=-this.s,this.count=Y(this)+2)}return this.count--,this.s}}class kr extends lr{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=si(this),n=t&1;this.diff=te(t/2),this.count=1,n&&(this.count=Y(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Jc{constructor(t){this.decoder=new Fn(t),this.str=ue(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const Kc=crypto.getRandomValues.bind(crypto),Xc=Math.random,Os=()=>Kc(new Uint32Array(1))[0],Zc=[1e7]+-1e3+-4e3+-8e3+-1e11,Is=()=>Zc.replace(/[018]/g,e=>(e^Os()&15>>e/4).toString(16)),de=Date.now,Gi=e=>new Promise(e);Promise.all.bind(Promise);const Qc=e=>Promise.reject(e),ai=e=>Promise.resolve(e),Ji=e=>e===void 0?null:e;class tl{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let Ms=new tl,ci=!0;try{typeof localStorage<"u"&&localStorage&&(Ms=localStorage,ci=!1)}catch{}const Ns=Ms,el=e=>ci||addEventListener("storage",e),nl=e=>ci||removeEventListener("storage",e),rl=Object.assign,il=Object.keys,sl=(e,t)=>{for(const n in e)t(e[n],n)},qn=e=>il(e).length,ol=e=>{for(const t in e)return!1;return!0},al=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Us=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),cl=(e,t)=>e===t||qn(e)===qn(t)&&al(e,(n,r)=>(n!==void 0||Us(t,r))&&t[r]===n),li=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&li(e,t,n+1)}},ll=()=>{},ul=e=>e,hl=(e,t)=>e===t,ln=(e,t)=>{if(e==null||t==null)return hl(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!ln(e.get(n),t.get(n)))return!1;break}case Object:if(qn(e)!==qn(t))return!1;for(const n in e)if(!Us(e,n)||!ln(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ln(e[n],t[n]))return!1;break;default:return!1}return!0},dl=(e,t)=>t.includes(e),ze=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Fs=typeof window<"u"&&typeof document<"u"&&!ze;let Kt;const fl=()=>{if(Kt===void 0)if(ze){Kt=qt();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&Kt.set(t,""),t=r):t!==null&&(Kt.set(t,r),t=null)}t!==null&&Kt.set(t,"")}else typeof location=="object"?(Kt=qt(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Kt.set(`--${Wi(t,"-")}`,n),Kt.set(`-${Wi(t,"-")}`,n)}})):Kt=qt();return Kt},qr=e=>fl().has(e),zn=e=>Ji(ze?process.env[e.toUpperCase()]:Ns.getItem(e)),gl=e=>qr("--"+e)||zn(e)!==null;gl("production");const Ki=ze&&dl({}.FORCE_COLOR,["true","1","2"]),pl=!qr("no-colors")&&(!ze||process.stdout.isTTY||Ki)&&(!ze||qr("color")||Ki||zn("COLORTERM")!==null||(zn("TERM")||"").includes("color")),Bs=e=>new Uint8Array(e),yl=(e,t,n)=>new Uint8Array(e,t,n),bl=e=>new Uint8Array(e),wl=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Ec(e[n]);return btoa(t)},ml=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),vl=e=>{const t=atob(e),n=Bs(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},_l=e=>{const t=Buffer.from(e,"base64");return yl(t.buffer,t.byteOffset,t.byteLength)},js=Fs?wl:ml,Ps=Fs?vl:_l,Cl=e=>{const t=Bs(e.byteLength);return t.set(e),t};class Sl{constructor(t,n){this.left=t,this.right=n}}const ce=(e,t)=>new Sl(e,t);typeof DOMParser<"u"&&new DOMParser;const El=e=>bc(e,(t,n)=>`${n}:${t};`).join(""),fe=Symbol,Ft=fe(),xe=fe(),Vs=fe(),ui=fe(),Ws=fe(),qs=fe(),zs=fe(),hi=fe(),ur=fe(),kl=e=>{const t=[];let n=0;for(;n<e.length;n++){const r=e[n];r.constructor===String||r.constructor===Number||r.constructor===Object&&t.push(JSON.stringify(r))}return t},Xi=[Ws,zs,hi,Vs];let Rr=0,Zi=de();const Rl=(e,t)=>{const n=Xi[Rr],r=zn("log"),s=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return Rr=(Rr+1)%Xi.length,t+=": ",s?(...o)=>{const a=de(),l=a-Zi;Zi=a,e(n,t,ur,...o.map(u=>typeof u=="string"||typeof u=="symbol"?u:JSON.stringify(u)),n," +"+l+"ms")}:ll},Dl={[Ft]:ce("font-weight","bold"),[xe]:ce("font-weight","normal"),[Vs]:ce("color","blue"),[Ws]:ce("color","green"),[ui]:ce("color","grey"),[qs]:ce("color","red"),[zs]:ce("color","purple"),[hi]:ce("color","orange"),[ur]:ce("color","black")},Al=e=>{const t=[],n=[],r=qt();let s=[],o=0;for(;o<e.length;o++){const a=e[o],l=Dl[a];if(l!==void 0)r.set(l.left,l.right);else if(a.constructor===String||a.constructor===Number){const u=El(r);o>0||u.length>0?(t.push("%c"+a),n.push(u)):t.push(a)}else break}for(o>0&&(s=n,s.unshift(t.join("")));o<e.length;o++){const a=e[o];a instanceof Symbol||s.push(a)}return s},Tl=pl?Al:kl,Hs=(...e)=>{console.log(...Tl(e)),xl.forEach(t=>t.print(e))},xl=Ae(),Ll=e=>Rl(Hs,e),$s=e=>({[Symbol.iterator](){return this},next:e}),Ol=(e,t)=>$s(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),Dr=(e,t)=>$s(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class di{constructor(t,n){this.clock=t,this.len=n}}class En{constructor(){this.clients=new Map}}const Ys=(e,t,n)=>t.clients.forEach((r,s)=>{const o=e.doc.store.clients.get(s);for(let a=0;a<r.length;a++){const l=r[a];oo(e,o,l.clock,l.len,n)}}),Il=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const s=te((n+r)/2),o=e[s],a=o.clock;if(a<=t){if(t<a+o.len)return s;n=s+1}else r=s-1}return null},Gs=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&Il(n,t.clock)!==null},fi=e=>{e.clients.forEach(t=>{t.sort((s,o)=>s.clock-o.clock);let n,r;for(n=1,r=1;n<t.length;n++){const s=t[r-1],o=t[n];s.clock+s.len>=o.clock?s.len=Me(s.len,o.clock+o.len-s.clock):(r<n&&(t[r]=o),r++)}t.length=r})},Ml=e=>{const t=new En;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,s)=>{if(!t.clients.has(s)){const o=r.slice();for(let a=n+1;a<e.length;a++)mc(o,e[a].clients.get(s)||[]);t.clients.set(s,o)}});return fi(t),t},Hn=(e,t,n,r)=>{Bt(e.clients,t,()=>[]).push(new di(n,r))},Nl=()=>new En,Ul=e=>{const t=Nl();return e.clients.forEach((n,r)=>{const s=[];for(let o=0;o<n.length;o++){const a=n[o];if(a.deleted){const l=a.id.clock;let u=a.length;if(o+1<n.length)for(let g=n[o+1];o+1<n.length&&g.deleted;g=n[++o+1])u+=g.length;s.push(new di(l,u))}}s.length>0&&t.clients.set(r,s)}),t},Ke=(e,t)=>{q(e.restEncoder,t.clients.size),Se(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),q(e.restEncoder,n);const s=r.length;q(e.restEncoder,s);for(let o=0;o<s;o++){const a=r[o];e.writeDsClock(a.clock),e.writeDsLen(a.len)}})},gi=e=>{const t=new En,n=Y(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const s=Y(e.restDecoder),o=Y(e.restDecoder);if(o>0){const a=Bt(t.clients,s,()=>[]);for(let l=0;l<o;l++)a.push(new di(e.readDsClock(),e.readDsLen()))}}return t},Qi=(e,t,n)=>{const r=new En,s=Y(e.restDecoder);for(let o=0;o<s;o++){e.resetDsCurVal();const a=Y(e.restDecoder),l=Y(e.restDecoder),u=n.clients.get(a)||[],g=wt(n,a);for(let b=0;b<l;b++){const h=e.readDsClock(),f=h+e.readDsLen();if(h<g){g<f&&Hn(r,a,g,f-g);let p=re(u,h),y=u[p];for(!y.deleted&&y.id.clock<h&&(u.splice(p+1,0,Zn(t,y,h-y.id.clock)),p++);p<u.length&&(y=u[p++],y.id.clock<f);)y.deleted||(f<y.id.clock+y.length&&u.splice(p,0,Zn(t,y,f-y.id.clock)),y.delete(t))}else Hn(r,a,h,f-h)}}if(r.clients.size>0){const o=new Le;return q(o.restEncoder,0),Ke(o,r),o.toUint8Array()}return null},Js=Os;class Xe extends or{constructor({guid:t=Is(),collectionid:n=null,gc:r=!0,gcFilter:s=()=>!0,meta:o=null,autoLoad:a=!1,shouldLoad:l=!0}={}){super(),this.gc=r,this.gcFilter=s,this.clientID=Js(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new io,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=a,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=Gi(g=>{this.on("load",()=>{this.isLoaded=!0,g(this)})});const u=()=>Gi(g=>{const b=h=>{(h===void 0||h===!0)&&(this.off("sync",b),g())};this.on("sync",b)});this.on("sync",g=>{g===!1&&this.isSynced&&(this.whenSynced=u()),this.isSynced=g===void 0||g===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=u()}load(){const t=this._item;t!==null&&!this.shouldLoad&&st(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Se(this.subdocs).map(t=>t.guid))}transact(t,n=null){return st(this,t,n)}get(t,n=_t){const r=Bt(this.share,t,()=>{const o=new n;return o._integrate(this,null),o}),s=r.constructor;if(n!==_t&&s!==n)if(s===_t){const o=new n;o._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=o}),o._start=r._start;for(let a=o._start;a!==null;a=a.right)a.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,Pe)}getText(t=""){return this.get(t,Ye)}getMap(t=""){return this.get(t,$e)}getXmlFragment(t=""){return this.get(t,Oe)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Se(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new Xe({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,st(t.parent.doc,r=>{const s=n.doc;t.deleted||r.subdocsAdded.add(s),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,n){super.on(t,n)}off(t,n){super.off(t,n)}}class Ks{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return Y(this.restDecoder)}readDsLen(){return Y(this.restDecoder)}}class Xs extends Ks{readLeftID(){return Z(Y(this.restDecoder),Y(this.restDecoder))}readRightID(){return Z(Y(this.restDecoder),Y(this.restDecoder))}readClient(){return Y(this.restDecoder)}readInfo(){return Te(this.restDecoder)}readString(){return ue(this.restDecoder)}readParentInfo(){return Y(this.restDecoder)===1}readTypeRef(){return Y(this.restDecoder)}readLen(){return Y(this.restDecoder)}readAny(){return qe(this.restDecoder)}readBuf(){return Cl(pt(this.restDecoder))}readJSON(){return JSON.parse(ue(this.restDecoder))}readKey(){return ue(this.restDecoder)}}class Fl{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Y(this.restDecoder),this.dsCurrVal}readDsLen(){const t=Y(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class He extends Fl{constructor(t){super(t),this.keys=[],Y(t),this.keyClockDecoder=new kr(pt(t)),this.clientDecoder=new Fn(pt(t)),this.leftClockDecoder=new kr(pt(t)),this.rightClockDecoder=new kr(pt(t)),this.infoDecoder=new Yi(pt(t),Te),this.stringDecoder=new Jc(pt(t)),this.parentInfoDecoder=new Yi(pt(t),Te),this.typeRefDecoder=new Fn(pt(t)),this.lenDecoder=new Fn(pt(t))}readLeftID(){return new je(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new je(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return qe(this.restDecoder)}readBuf(){return pt(this.restDecoder)}readJSON(){return qe(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Zs{constructor(){this.restEncoder=bt()}toUint8Array(){return ot(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){q(this.restEncoder,t)}writeDsLen(t){q(this.restEncoder,t)}}class kn extends Zs{writeLeftID(t){q(this.restEncoder,t.client),q(this.restEncoder,t.clock)}writeRightID(t){q(this.restEncoder,t.client),q(this.restEncoder,t.clock)}writeClient(t){q(this.restEncoder,t)}writeInfo(t){gn(this.restEncoder,t)}writeString(t){Zt(this.restEncoder,t)}writeParentInfo(t){q(this.restEncoder,t?1:0)}writeTypeRef(t){q(this.restEncoder,t)}writeLen(t){q(this.restEncoder,t)}writeAny(t){We(this.restEncoder,t)}writeBuf(t){at(this.restEncoder,t)}writeJSON(t){Zt(this.restEncoder,JSON.stringify(t))}writeKey(t){Zt(this.restEncoder,t)}}class Qs{constructor(){this.restEncoder=bt(),this.dsCurrVal=0}toUint8Array(){return ot(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,q(this.restEncoder,n)}writeDsLen(t){t===0&&ne(),q(this.restEncoder,t-1),this.dsCurrVal+=t}}class Le extends Qs{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Er,this.clientEncoder=new Un,this.leftClockEncoder=new Er,this.rightClockEncoder=new Er,this.infoEncoder=new zi(gn),this.stringEncoder=new Pc,this.parentInfoEncoder=new zi(gn),this.typeRefEncoder=new Un,this.lenEncoder=new Un}toUint8Array(){const t=bt();return q(t,0),at(t,this.keyClockEncoder.toUint8Array()),at(t,this.clientEncoder.toUint8Array()),at(t,this.leftClockEncoder.toUint8Array()),at(t,this.rightClockEncoder.toUint8Array()),at(t,ot(this.infoEncoder)),at(t,this.stringEncoder.toUint8Array()),at(t,ot(this.parentInfoEncoder)),at(t,this.typeRefEncoder.toUint8Array()),at(t,this.lenEncoder.toUint8Array()),cr(t,ot(this.restEncoder)),ot(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){We(this.restEncoder,t)}writeBuf(t){at(this.restEncoder,t)}writeJSON(t){We(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const Bl=(e,t,n,r)=>{r=Me(r,t[0].id.clock);const s=re(t,r);q(e.restEncoder,t.length-s),e.writeClient(n),q(e.restEncoder,r);const o=t[s];o.write(e,r-o.id.clock);for(let a=s+1;a<t.length;a++)t[a].write(e,0)},pi=(e,t,n)=>{const r=new Map;n.forEach((s,o)=>{wt(t,o)>s&&r.set(o,s)}),hr(t).forEach((s,o)=>{n.has(o)||r.set(o,0)}),q(e.restEncoder,r.size),Se(r.entries()).sort((s,o)=>o[0]-s[0]).forEach(([s,o])=>{Bl(e,t.clients.get(s),s,o)})},jl=(e,t)=>{const n=qt(),r=Y(e.restDecoder);for(let s=0;s<r;s++){const o=Y(e.restDecoder),a=new Array(o),l=e.readClient();let u=Y(e.restDecoder);n.set(l,{i:0,refs:a});for(let g=0;g<o;g++){const b=e.readInfo();switch(ar&b){case 0:{const h=e.readLen();a[g]=new Nt(Z(l,u),h),u+=h;break}case 10:{const h=Y(e.restDecoder);a[g]=new Ut(Z(l,u),h),u+=h;break}default:{const h=(b&(le|Lt))===0,f=new dt(Z(l,u),null,(b&Lt)===Lt?e.readLeftID():null,null,(b&le)===le?e.readRightID():null,h?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,h&&(b&dn)===dn?e.readString():null,Ro(e,b));a[g]=f,u+=f.length}}}}return n},Pl=(e,t,n)=>{const r=[];let s=Se(n.keys()).sort((p,y)=>p-y);if(s.length===0)return null;const o=()=>{if(s.length===0)return null;let p=n.get(s[s.length-1]);for(;p.refs.length===p.i;)if(s.pop(),s.length>0)p=n.get(s[s.length-1]);else return null;return p};let a=o();if(a===null&&r.length===0)return null;const l=new io,u=new Map,g=(p,y)=>{const v=u.get(p);(v==null||v>y)&&u.set(p,y)};let b=a.refs[a.i++];const h=new Map,f=()=>{for(const p of r){const y=p.id.client,v=n.get(y);v?(v.i--,l.clients.set(y,v.refs.slice(v.i)),n.delete(y),v.i=0,v.refs=[]):l.clients.set(y,[p]),s=s.filter(L=>L!==y)}r.length=0};for(;;){if(b.constructor!==Ut){const y=Bt(h,b.id.client,()=>wt(t,b.id.client))-b.id.clock;if(y<0)r.push(b),g(b.id.client,b.id.clock-1),f();else{const v=b.getMissing(e,t);if(v!==null){r.push(b);const L=n.get(v)||{refs:[],i:0};if(L.refs.length===L.i)g(v,wt(t,v)),f();else{b=L.refs[L.i++];continue}}else(y===0||y<b.length)&&(b.integrate(e,y),h.set(b.id.client,b.id.clock+b.length))}}if(r.length>0)b=r.pop();else if(a!==null&&a.i<a.refs.length)b=a.refs[a.i++];else{if(a=o(),a===null)break;b=a.refs[a.i++]}}if(l.clients.size>0){const p=new Le;return pi(p,l,new Map),q(p.restEncoder,0),{missing:u,update:p.toUint8Array()}}return null},Vl=(e,t)=>pi(e,t.doc.store,t.beforeState),Wl=(e,t,n,r=new He(e))=>st(t,s=>{s.local=!1;let o=!1;const a=s.doc,l=a.store,u=jl(r,a),g=Pl(s,l,u),b=l.pendingStructs;if(b){for(const[f,p]of b.missing)if(p<wt(l,f)){o=!0;break}if(g){for(const[f,p]of g.missing){const y=b.missing.get(f);(y==null||y>p)&&b.missing.set(f,p)}b.update=$n([b.update,g.update])}}else l.pendingStructs=g;const h=Qi(r,s,l);if(l.pendingDs){const f=new He(se(l.pendingDs));Y(f.restDecoder);const p=Qi(f,s,l);h&&p?l.pendingDs=$n([h,p]):l.pendingDs=h||p}else l.pendingDs=h;if(o){const f=l.pendingStructs.update;l.pendingStructs=null,to(s.doc,f)}},n,!1),to=(e,t,n,r=He)=>{const s=se(t);Wl(s,e,n,new r(s))},ql=(e,t,n)=>to(e,t,n,Xs),zl=(e,t,n=new Map)=>{pi(e,t.store,n),Ke(e,Ul(t.store))},Hl=(e,t=new Uint8Array([0]),n=new Le)=>{const r=eo(t);zl(n,e,r);const s=[n.toUint8Array()];if(e.store.pendingDs&&s.push(e.store.pendingDs),e.store.pendingStructs&&s.push(au(e.store.pendingStructs.update,t)),s.length>1){if(n.constructor===kn)return su(s.map((o,a)=>a===0?o:lu(o)));if(n.constructor===Le)return $n(s)}return s[0]},$l=(e,t)=>Hl(e,t,new kn),Yl=e=>{const t=new Map,n=Y(e.restDecoder);for(let r=0;r<n;r++){const s=Y(e.restDecoder),o=Y(e.restDecoder);t.set(s,o)}return t},eo=e=>Yl(new Ks(se(e))),no=(e,t)=>(q(e.restEncoder,t.size),Se(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{q(e.restEncoder,n),q(e.restEncoder,r)}),e),Gl=(e,t)=>no(e,hr(t.store)),Jl=(e,t=new Qs)=>(e instanceof Map?no(t,e):Gl(t,e),t.toUint8Array()),Kl=e=>Jl(e,new Zs);class Xl{constructor(){this.l=[]}}const ts=()=>new Xl,es=(e,t)=>e.l.push(t),ns=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(s=>t!==s),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ro=(e,t,n)=>li(e.l,[t,n]);class je{constructor(t,n){this.client=t,this.clock=n}}const xn=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,Z=(e,t)=>new je(e,t),Zl=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw ne()},rn=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Gs(t.ds,e.id),zr=(e,t)=>{const n=Bt(e.meta,zr,Ae),r=e.doc.store;n.has(t)||(t.sv.forEach((s,o)=>{s<wt(r,o)&&Ee(e,Z(o,s))}),Ys(e,t.ds,s=>{}),n.add(t))};class io{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const hr=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const s=n[n.length-1];t.set(r,s.id.clock+s.length)}),t},wt=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},so=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw ne()}n.push(t)},re=(e,t)=>{let n=0,r=e.length-1,s=e[r],o=s.id.clock;if(o===t)return r;let a=te(t/(o+s.length-1)*r);for(;n<=r;){if(s=e[a],o=s.id.clock,o<=t){if(t<o+s.length)return a;n=a+1}else r=a-1;a=te((n+r)/2)}throw ne()},Ql=(e,t)=>{const n=e.clients.get(t.client);return n[re(n,t.clock)]},Ar=Ql,Hr=(e,t,n)=>{const r=re(t,n),s=t[r];return s.id.clock<n&&s instanceof dt?(t.splice(r+1,0,Zn(e,s,n-s.id.clock)),r+1):r},Ee=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Hr(e,n,t.clock)]},rs=(e,t,n)=>{const r=t.clients.get(n.client),s=re(r,n.clock),o=r[s];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Nt&&r.splice(s+1,0,Zn(e,o,n.clock-o.id.clock+1)),o},tu=(e,t,n)=>{const r=e.clients.get(t.id.client);r[re(r,t.id.clock)]=n},oo=(e,t,n,r,s)=>{if(r===0)return;const o=n+r;let a=Hr(e,t,n),l;do l=t[a++],o<l.id.clock+l.length&&Hr(e,t,o),s(l);while(a<t.length&&t[a].id.clock<o)};class eu{constructor(t,n,r){this.doc=t,this.deleteSet=new En,this.beforeState=hr(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const is=(e,t)=>t.deleteSet.clients.size===0&&!wc(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(fi(t.deleteSet),Vl(e,t),Ke(e,t.deleteSet),!0),ss=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&Bt(e.changed,t,Ae).add(n)},Bn=(e,t)=>{let n=e[t],r=e[t-1],s=t;for(;s>0;n=r,r=e[--s-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof dt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const o=t-s;return o&&e.splice(t+1-o,o),o},nu=(e,t,n)=>{for(const[r,s]of e.clients.entries()){const o=t.clients.get(r);for(let a=s.length-1;a>=0;a--){const l=s[a],u=l.clock+l.len;for(let g=re(o,l.clock),b=o[g];g<o.length&&b.id.clock<u;b=o[++g]){const h=o[g];if(l.clock+l.len<=h.id.clock)break;h instanceof dt&&h.deleted&&!h.keep&&n(h)&&h.gc(t,!1)}}}},ru=(e,t)=>{e.clients.forEach((n,r)=>{const s=t.clients.get(r);for(let o=n.length-1;o>=0;o--){const a=n[o],l=ni(s.length-1,1+re(s,a.clock+a.len-1));for(let u=l,g=s[u];u>0&&g.id.clock>=a.clock;g=s[u])u-=1+Bn(s,u)}})},ao=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,s=r.store,o=n.deleteSet,a=n._mergeStructs;try{fi(o),n.afterState=hr(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const l=[];n.changed.forEach((u,g)=>l.push(()=>{(g._item===null||!g._item.deleted)&&g._callObserver(n,u)})),l.push(()=>{n.changedParentTypes.forEach((u,g)=>{g._dEH.l.length>0&&(g._item===null||!g._item.deleted)&&(u=u.filter(b=>b.target._item===null||!b.target._item.deleted),u.forEach(b=>{b.currentTarget=g,b._path=null}),u.sort((b,h)=>b.path.length-h.path.length),ro(g._dEH,u,n))})}),l.push(()=>r.emit("afterTransaction",[n,r])),li(l,[]),n._needFormattingCleanup&&Cu(n)}finally{r.gc&&nu(o,s,r.gcFilter),ru(o,s),n.afterState.forEach((b,h)=>{const f=n.beforeState.get(h)||0;if(f!==b){const p=s.clients.get(h),y=Me(re(p,f),1);for(let v=p.length-1;v>=y;)v-=1+Bn(p,v)}});for(let b=a.length-1;b>=0;b--){const{client:h,clock:f}=a[b].id,p=s.clients.get(h),y=re(p,f);y+1<p.length&&Bn(p,y+1)>1||y>0&&Bn(p,y)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(Hs(hi,Ft,"[yjs] ",xe,qs,"Changed the client-id because another client seems to be using it."),r.clientID=Js()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const b=new kn;is(b,n)&&r.emit("update",[b.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const b=new Le;is(b,n)&&r.emit("updateV2",[b.toUint8Array(),n.origin,r,n])}const{subdocsAdded:l,subdocsLoaded:u,subdocsRemoved:g}=n;(l.size>0||g.size>0||u.size>0)&&(l.forEach(b=>{b.clientID=r.clientID,b.collectionid==null&&(b.collectionid=r.collectionid),r.subdocs.add(b)}),g.forEach(b=>r.subdocs.delete(b)),r.emit("subdocs",[{loaded:u,added:l,removed:g},r,n]),g.forEach(b=>b.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):ao(e,t+1)}}},st=(e,t,n=null,r=!0)=>{const s=e._transactionCleanups;let o=!1,a=null;e._transaction===null&&(o=!0,e._transaction=new eu(e,n,r),s.push(e._transaction),s.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){const l=e._transaction===s[0];e._transaction=null,l&&ao(s,0)}}return a};function*iu(e){const t=Y(e.restDecoder);for(let n=0;n<t;n++){const r=Y(e.restDecoder),s=e.readClient();let o=Y(e.restDecoder);for(let a=0;a<r;a++){const l=e.readInfo();if(l===10){const u=Y(e.restDecoder);yield new Ut(Z(s,o),u),o+=u}else if(ar&l){const u=(l&(le|Lt))===0,g=new dt(Z(s,o),null,(l&Lt)===Lt?e.readLeftID():null,null,(l&le)===le?e.readRightID():null,u?e.readParentInfo()?e.readString():e.readLeftID():null,u&&(l&dn)===dn?e.readString():null,Ro(e,l));yield g,o+=g.length}else{const u=e.readLen();yield new Nt(Z(s,o),u),o+=u}}}}class yi{constructor(t,n){this.gen=iu(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ut);return this.curr}}class bi{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const su=e=>$n(e,Xs,kn),ou=(e,t)=>{if(e.constructor===Nt){const{client:n,clock:r}=e.id;return new Nt(Z(n,r+t),e.length-t)}else if(e.constructor===Ut){const{client:n,clock:r}=e.id;return new Ut(Z(n,r+t),e.length-t)}else{const n=e,{client:r,clock:s}=n.id;return new dt(Z(r,s+t),null,Z(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},$n=(e,t=He,n=Le)=>{if(e.length===1)return e[0];const r=e.map(b=>new t(se(b)));let s=r.map(b=>new yi(b,!0)),o=null;const a=new n,l=new bi(a);for(;s=s.filter(f=>f.curr!==null),s.sort((f,p)=>{if(f.curr.id.client===p.curr.id.client){const y=f.curr.id.clock-p.curr.id.clock;return y===0?f.curr.constructor===p.curr.constructor?0:f.curr.constructor===Ut?1:-1:y}else return p.curr.id.client-f.curr.id.client}),s.length!==0;){const b=s[0],h=b.curr.id.client;if(o!==null){let f=b.curr,p=!1;for(;f!==null&&f.id.clock+f.length<=o.struct.id.clock+o.struct.length&&f.id.client>=o.struct.id.client;)f=b.next(),p=!0;if(f===null||f.id.client!==h||p&&f.id.clock>o.struct.id.clock+o.struct.length)continue;if(h!==o.struct.id.client)_e(l,o.struct,o.offset),o={struct:f,offset:0},b.next();else if(o.struct.id.clock+o.struct.length<f.id.clock)if(o.struct.constructor===Ut)o.struct.length=f.id.clock+f.length-o.struct.id.clock;else{_e(l,o.struct,o.offset);const y=f.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Ut(Z(h,o.struct.id.clock+o.struct.length),y),offset:0}}else{const y=o.struct.id.clock+o.struct.length-f.id.clock;y>0&&(o.struct.constructor===Ut?o.struct.length-=y:f=ou(f,y)),o.struct.mergeWith(f)||(_e(l,o.struct,o.offset),o={struct:f,offset:0},b.next())}}else o={struct:b.curr,offset:0},b.next();for(let f=b.curr;f!==null&&f.id.client===h&&f.id.clock===o.struct.id.clock+o.struct.length&&f.constructor!==Ut;f=b.next())_e(l,o.struct,o.offset),o={struct:f,offset:0}}o!==null&&(_e(l,o.struct,o.offset),o=null),wi(l);const u=r.map(b=>gi(b)),g=Ml(u);return Ke(a,g),a.toUint8Array()},au=(e,t,n=He,r=Le)=>{const s=eo(t),o=new r,a=new bi(o),l=new n(se(e)),u=new yi(l,!1);for(;u.curr;){const b=u.curr,h=b.id.client,f=s.get(h)||0;if(u.curr.constructor===Ut){u.next();continue}if(b.id.clock+b.length>f)for(_e(a,b,Me(f-b.id.clock,0)),u.next();u.curr&&u.curr.id.client===h;)_e(a,u.curr,0),u.next();else for(;u.curr&&u.curr.id.client===h&&u.curr.id.clock+u.curr.length<=f;)u.next()}wi(a);const g=gi(l);return Ke(o,g),o.toUint8Array()},co=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:ot(e.encoder.restEncoder)}),e.encoder.restEncoder=bt(),e.written=0)},_e=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&co(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),q(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},wi=e=>{co(e);const t=e.encoder.restEncoder;q(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];q(t,r.written),cr(t,r.restEncoder)}},cu=(e,t,n,r)=>{const s=new n(se(e)),o=new yi(s,!1),a=new r,l=new bi(a);for(let g=o.curr;g!==null;g=o.next())_e(l,t(g),0);wi(l);const u=gi(s);return Ke(a,u),a.toUint8Array()},lu=e=>cu(e,ul,He,kn),os="You must not compute changes after the event-handler fired.";class dr{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=uu(this.currentTarget,this.target))}deletes(t){return Gs(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw ee(os);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(s=>{if(s!==null){const o=n._map.get(s);let a,l;if(this.adds(o)){let u=o.left;for(;u!==null&&this.adds(u);)u=u.left;if(this.deletes(o))if(u!==null&&this.deletes(u))a="delete",l=_r(u.content.getContent());else return;else u!==null&&this.deletes(u)?(a="update",l=_r(u.content.getContent())):(a="add",l=void 0)}else if(this.deletes(o))a="delete",l=_r(o.content.getContent());else return;t.set(s,{action:a,oldValue:l})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw ee(os);const n=this.target,r=Ae(),s=Ae(),o=[];if(t={added:r,deleted:s,delta:o,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const u=()=>{l&&o.push(l)};for(let g=n._start;g!==null;g=g.right)g.deleted?this.deletes(g)&&!this.adds(g)&&((l===null||l.delete===void 0)&&(u(),l={delete:0}),l.delete+=g.length,s.add(g)):this.adds(g)?((l===null||l.insert===void 0)&&(u(),l={insert:[]}),l.insert=l.insert.concat(g.content.getContent()),r.add(g)):((l===null||l.retain===void 0)&&(u(),l={retain:0}),l.retain+=g.length);l!==null&&l.retain===void 0&&u()}this._changes=t}return t}}const uu=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,s=t._item.parent._start;for(;s!==t._item&&s!==null;)s.deleted||r++,s=s.right;n.unshift(r)}t=t._item.parent}return n},lo=80;let mi=0;class hu{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=mi++}}const du=e=>{e.timestamp=mi++},uo=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=mi++},fu=(e,t,n)=>{if(e.length>=lo){const r=e.reduce((s,o)=>s.timestamp<o.timestamp?s:o);return uo(r,t,n),r}else{const r=new hu(t,n);return e.push(r),r}},fr=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((o,a)=>Nn(t-o.index)<Nn(t-a.index)?o:a);let r=e._start,s=0;for(n!==null&&(r=n.p,s=n.index,du(n));r.right!==null&&s<t;){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}for(;r.left!==null&&s>t;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return n!==null&&Nn(n.index-s)<r.parent.length/lo?(uo(n,r,s),n):fu(e._searchMarker,r,s)},pn=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const s=e[r];if(n>0){let o=s.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(s.index-=o.length);if(o===null||o.marker===!0){e.splice(r,1);continue}s.p=o,o.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=Me(t,s.index+n))}},gr=(e,t,n)=>{const r=e,s=t.changedParentTypes;for(;Bt(s,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;ro(r._eH,n,t)};class _t{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=ts(),this._dEH=ts(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Qt()}clone(){throw Qt()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){es(this._eH,t)}observeDeep(t){es(this._dEH,t)}unobserve(t){ns(this._eH,t)}unobserveDeep(t){ns(this._dEH,t)}toJSON(){}}const ho=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let o=e._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const a=o.content.getContent();if(a.length<=t)t-=a.length;else{for(let l=t;l<a.length&&r>0;l++)s.push(a[l]),r--;t=0}}o=o.right}return s},fo=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let s=0;s<r.length;s++)t.push(r[s])}n=n.right}return t},yn=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let o=0;o<s.length;o++)t(s[o],n++,e)}r=r.right}},go=(e,t)=>{const n=[];return yn(e,(r,s)=>{n.push(t(r,s,e))}),n},gu=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const s=n[r++];return n.length<=r&&(n=null),{done:!1,value:s}}}},po=(e,t)=>{const n=fr(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Yn=(e,t,n,r)=>{let s=n;const o=e.doc,a=o.clientID,l=o.store,u=n===null?t._start:n.right;let g=[];const b=()=>{g.length>0&&(s=new dt(Z(a,wt(l,a)),s,s&&s.lastId,u,u&&u.id,t,null,new Ie(g)),s.integrate(e,0),g=[])};r.forEach(h=>{if(h===null)g.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:g.push(h);break;default:switch(b(),h.constructor){case Uint8Array:case ArrayBuffer:s=new dt(Z(a,wt(l,a)),s,s&&s.lastId,u,u&&u.id,t,null,new Rn(new Uint8Array(h))),s.integrate(e,0);break;case Xe:s=new dt(Z(a,wt(l,a)),s,s&&s.lastId,u,u&&u.id,t,null,new Dn(h)),s.integrate(e,0);break;default:if(h instanceof _t)s=new dt(Z(a,wt(l,a)),s,s&&s.lastId,u,u&&u.id,t,null,new ge(h)),s.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),b()},yo=()=>ee("Length exceeded!"),bo=(e,t,n,r)=>{if(n>t._length)throw yo();if(n===0)return t._searchMarker&&pn(t._searchMarker,n,r.length),Yn(e,t,null,r);const s=n,o=fr(t,n);let a=t._start;for(o!==null&&(a=o.p,n-=o.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&Ee(e,Z(a.id.client,a.id.clock+n));break}n-=a.length}return t._searchMarker&&pn(t._searchMarker,s,r.length),Yn(e,t,a,r)},pu=(e,t,n)=>{let s=(t._searchMarker||[]).reduce((o,a)=>a.index>o.index?a:o,{index:0,p:t._start}).p;if(s)for(;s.right;)s=s.right;return Yn(e,t,s,n)},wo=(e,t,n,r)=>{if(r===0)return;const s=n,o=r,a=fr(t,n);let l=t._start;for(a!==null&&(l=a.p,n-=a.index);l!==null&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&Ee(e,Z(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&l!==null;)l.deleted||(r<l.length&&Ee(e,Z(l.id.client,l.id.clock+r)),l.delete(e),r-=l.length),l=l.right;if(r>0)throw yo();t._searchMarker&&pn(t._searchMarker,s,-o+r)},Gn=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},vi=(e,t,n,r)=>{const s=t._map.get(n)||null,o=e.doc,a=o.clientID;let l;if(r==null)l=new Ie([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:l=new Ie([r]);break;case Uint8Array:l=new Rn(r);break;case Xe:l=new Dn(r);break;default:if(r instanceof _t)l=new ge(r);else throw new Error("Unexpected content type")}new dt(Z(a,wt(o.store,a)),s,s&&s.lastId,null,null,t,n,l).integrate(e,0)},_i=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},mo=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},vo=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},Ln=e=>Ol(e.entries(),t=>!t[1].deleted);class yu extends dr{constructor(t,n){super(t,n),this._transaction=n}}class Pe extends _t{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new Pe;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Pe}clone(){const t=new Pe;return t.insert(0,this.toArray().map(n=>n instanceof _t?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),gr(this,t,new yu(this,t))}insert(t,n){this.doc!==null?st(this.doc,r=>{bo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?st(this.doc,n=>{pu(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?st(this.doc,r=>{wo(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return po(this,t)}toArray(){return fo(this)}slice(t=0,n=this.length){return ho(this,t,n)}toJSON(){return this.map(t=>t instanceof _t?t.toJSON():t)}map(t){return go(this,t)}forEach(t){yn(this,t)}[Symbol.iterator](){return gu(this)}_write(t){t.writeTypeRef(Pu)}}const bu=e=>new Pe;class wu extends dr{constructor(t,n,r){super(t,n),this.keysChanged=r}}class $e extends _t{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,s)=>{this.set(s,r)}),this._prelimContent=null}_copy(){return new $e}clone(){const t=new $e;return this.forEach((n,r)=>{t.set(r,n instanceof _t?n.clone():n)}),t}_callObserver(t,n){gr(this,t,new wu(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const s=n.content.getContent()[n.length-1];t[r]=s instanceof _t?s.toJSON():s}}),t}get size(){return[...Ln(this._map)].length}keys(){return Dr(Ln(this._map),t=>t[0])}values(){return Dr(Ln(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Dr(Ln(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?st(this.doc,n=>{Gn(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?st(this.doc,r=>{vi(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return _i(this,t)}has(t){return vo(this,t)}clear(){this.doc!==null?st(this.doc,t=>{this.forEach(function(n,r,s){Gn(t,s,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Vu)}}const mu=e=>new $e,Ce=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&cl(e,t);class $r{constructor(t,n,r,s){this.left=t,this.right=n,this.index=r,this.currentAttributes=s}forward(){switch(this.right===null&&ne(),this.right.content.constructor){case ft:this.right.deleted||Ze(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const as=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case ft:t.right.deleted||Ze(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&Ee(e,Z(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},On=(e,t,n)=>{const r=new Map,s=fr(t,n);if(s){const o=new $r(s.p.left,s.p,s.index,r);return as(e,o,n-s.index)}else{const o=new $r(null,t._start,0,r);return as(e,o,n)}},_o=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ft&&Ce(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const s=e.doc,o=s.clientID;r.forEach((a,l)=>{const u=n.left,g=n.right,b=new dt(Z(o,wt(s.store,o)),u,u&&u.lastId,g,g&&g.id,t,null,new ft(l,a));b.integrate(e,0),n.right=b,n.forward()})},Ze=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},Co=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===ft&&Ce(t[e.right.content.key]||null,e.right.content.value)))break;e.forward()}},So=(e,t,n,r)=>{const s=e.doc,o=s.clientID,a=new Map;for(const l in r){const u=r[l],g=n.currentAttributes.get(l)||null;if(!Ce(g,u)){a.set(l,g);const{left:b,right:h}=n;n.right=new dt(Z(o,wt(s.store,o)),b,b&&b.lastId,h,h&&h.id,t,null,new ft(l,u)),n.right.integrate(e,0),n.forward()}}return a},Tr=(e,t,n,r,s)=>{n.currentAttributes.forEach((f,p)=>{s[p]===void 0&&(s[p]=null)});const o=e.doc,a=o.clientID;Co(n,s);const l=So(e,t,n,s),u=r.constructor===String?new ie(r):r instanceof _t?new ge(r):new Ne(r);let{left:g,right:b,index:h}=n;t._searchMarker&&pn(t._searchMarker,n.index,u.getLength()),b=new dt(Z(a,wt(o.store,a)),g,g&&g.lastId,b,b&&b.id,t,null,u),b.integrate(e,0),n.right=b,n.index=h,n.forward(),_o(e,t,n,l)},cs=(e,t,n,r,s)=>{const o=e.doc,a=o.clientID;Co(n,s);const l=So(e,t,n,s);t:for(;n.right!==null&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===ft));){if(!n.right.deleted)switch(n.right.content.constructor){case ft:{const{key:u,value:g}=n.right.content,b=s[u];if(b!==void 0){if(Ce(b,g))l.delete(u);else{if(r===0)break t;l.set(u,g)}n.right.delete(e)}else n.currentAttributes.set(u,g);break}default:r<n.right.length&&Ee(e,Z(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let u="";for(;r>0;r--)u+=`
`;n.right=new dt(Z(a,wt(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new ie(u)),n.right.integrate(e,0),n.forward()}_o(e,t,n,l)},Eo=(e,t,n,r,s)=>{let o=t;const a=qt();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===ft){const g=o.content;a.set(g.key,g)}o=o.right}let l=0,u=!1;for(;t!==o;){if(n===t&&(u=!0),!t.deleted){const g=t.content;switch(g.constructor){case ft:{const{key:b,value:h}=g,f=r.get(b)||null;(a.get(b)!==g||f===h)&&(t.delete(e),l++,!u&&(s.get(b)||null)===h&&f!==h&&(f===null?s.delete(b):s.set(b,f))),!u&&!t.deleted&&Ze(s,g);break}}}t=t.right}return l},vu=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ft){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},_u=e=>{let t=0;return st(e.doc,n=>{let r=e._start,s=e._start,o=qt();const a=jr(o);for(;s;){if(s.deleted===!1)switch(s.content.constructor){case ft:Ze(a,s.content);break;default:t+=Eo(n,r,s,o,a),o=jr(a),r=s;break}s=s.right}}),t},Cu=e=>{const t=new Set,n=e.doc;for(const[r,s]of e.afterState.entries()){const o=e.beforeState.get(r)||0;s!==o&&oo(e,n.store.clients.get(r),o,s,a=>{!a.deleted&&a.content.constructor===ft&&a.constructor!==Nt&&t.add(a.parent)})}st(n,r=>{Ys(e,e.deleteSet,s=>{if(s instanceof Nt||!s.parent._hasFormatting||t.has(s.parent))return;const o=s.parent;s.content.constructor===ft?t.add(o):vu(r,s)});for(const s of t)_u(s)})},ls=(e,t,n)=>{const r=n,s=jr(t.currentAttributes),o=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case ge:case Ne:case ie:n<t.right.length&&Ee(e,Z(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}o&&Eo(e,o,t.right,s,t.currentAttributes);const a=(t.left||t.right).parent;return a._searchMarker&&pn(a._searchMarker,t.index,-r+n),t};class Su extends dr{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];st(t,r=>{const s=new Map,o=new Map;let a=this.target._start,l=null;const u={};let g="",b=0,h=0;const f=()=>{if(l!==null){let p=null;switch(l){case"delete":h>0&&(p={delete:h}),h=0;break;case"insert":(typeof g=="object"||g.length>0)&&(p={insert:g},s.size>0&&(p.attributes={},s.forEach((y,v)=>{y!==null&&(p.attributes[v]=y)}))),g="";break;case"retain":b>0&&(p={retain:b},ol(u)||(p.attributes=rl({},u))),b=0;break}p&&n.push(p),l=null}};for(;a!==null;){switch(a.content.constructor){case ge:case Ne:this.adds(a)?this.deletes(a)||(f(),l="insert",g=a.content.getContent()[0],f()):this.deletes(a)?(l!=="delete"&&(f(),l="delete"),h+=1):a.deleted||(l!=="retain"&&(f(),l="retain"),b+=1);break;case ie:this.adds(a)?this.deletes(a)||(l!=="insert"&&(f(),l="insert"),g+=a.content.str):this.deletes(a)?(l!=="delete"&&(f(),l="delete"),h+=a.length):a.deleted||(l!=="retain"&&(f(),l="retain"),b+=a.length);break;case ft:{const{key:p,value:y}=a.content;if(this.adds(a)){if(!this.deletes(a)){const v=s.get(p)||null;Ce(v,y)?y!==null&&a.delete(r):(l==="retain"&&f(),Ce(y,o.get(p)||null)?delete u[p]:u[p]=y)}}else if(this.deletes(a)){o.set(p,y);const v=s.get(p)||null;Ce(v,y)||(l==="retain"&&f(),u[p]=v)}else if(!a.deleted){o.set(p,y);const v=u[p];v!==void 0&&(Ce(v,y)?v!==null&&a.delete(r):(l==="retain"&&f(),y===null?delete u[p]:u[p]=y))}a.deleted||(l==="insert"&&f(),Ze(s,a.content));break}}a=a.right}for(f();n.length>0;){const p=n[n.length-1];if(p.retain!==void 0&&p.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class Ye extends _t{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Ye}clone(){const t=new Ye;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new Su(this,t,n);gr(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===ie&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?st(this.doc,r=>{const s=new $r(null,this._start,0,new Map);for(let o=0;o<t.length;o++){const a=t[o];if(a.insert!==void 0){const l=!n&&typeof a.insert=="string"&&o===t.length-1&&s.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof l!="string"||l.length>0)&&Tr(r,this,s,l,a.attributes||{})}else a.retain!==void 0?cs(r,this,s,a.retain,a.attributes||{}):a.delete!==void 0&&ls(r,s,a.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const s=[],o=new Map,a=this.doc;let l="",u=this._start;function g(){if(l.length>0){const h={};let f=!1;o.forEach((y,v)=>{f=!0,h[v]=y});const p={insert:l};f&&(p.attributes=h),s.push(p),l=""}}const b=()=>{for(;u!==null;){if(rn(u,t)||n!==void 0&&rn(u,n))switch(u.content.constructor){case ie:{const h=o.get("ychange");t!==void 0&&!rn(u,t)?(h===void 0||h.user!==u.id.client||h.type!=="removed")&&(g(),o.set("ychange",r?r("removed",u.id):{type:"removed"})):n!==void 0&&!rn(u,n)?(h===void 0||h.user!==u.id.client||h.type!=="added")&&(g(),o.set("ychange",r?r("added",u.id):{type:"added"})):h!==void 0&&(g(),o.delete("ychange")),l+=u.content.str;break}case ge:case Ne:{g();const h={insert:u.content.getContent()[0]};if(o.size>0){const f={};h.attributes=f,o.forEach((p,y)=>{f[y]=p})}s.push(h);break}case ft:rn(u,t)&&(g(),Ze(o,u.content));break}u=u.right}g()};return t||n?st(a,h=>{t&&zr(h,t),n&&zr(h,n),b()},"cleanup"):b(),s}insert(t,n,r){if(n.length<=0)return;const s=this.doc;s!==null?st(s,o=>{const a=On(o,this,t);r||(r={},a.currentAttributes.forEach((l,u)=>{r[u]=l})),Tr(o,this,a,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r={}){const s=this.doc;s!==null?st(s,o=>{const a=On(o,this,t);Tr(o,this,a,n,r)}):this._pending.push(()=>this.insertEmbed(t,n,r))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?st(r,s=>{ls(s,On(s,this,t),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const s=this.doc;s!==null?st(s,o=>{const a=On(o,this,t);a.right!==null&&cs(o,this,a,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?st(this.doc,n=>{Gn(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?st(this.doc,r=>{vi(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return _i(this,t)}getAttributes(){return mo(this)}_write(t){t.writeTypeRef(Wu)}}const Eu=e=>new Ye;class xr{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===bn||n.constructor===Oe)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Oe extends _t{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Oe}clone(){const t=new Oe;return t.insert(0,this.toArray().map(n=>n instanceof _t?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new xr(this,t)}querySelector(t){t=t.toUpperCase();const r=new xr(this,s=>s.nodeName&&s.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Se(new xr(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){gr(this,t,new Du(this,n,t))}toString(){return go(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const s=t.createDocumentFragment();return r!==void 0&&r._createAssociation(s,this),yn(this,o=>{s.insertBefore(o.toDOM(t,n,r),null)}),s}insert(t,n){this.doc!==null?st(this.doc,r=>{bo(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)st(this.doc,r=>{const s=t&&t instanceof _t?t._item:t;Yn(r,this,s,n)});else{const r=this._prelimContent,s=t===null?0:r.findIndex(o=>o===t)+1;if(s===0&&t!==null)throw ee("Reference item not found");r.splice(s,0,...n)}}delete(t,n=1){this.doc!==null?st(this.doc,r=>{wo(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return fo(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return po(this,t)}slice(t=0,n=this.length){return ho(this,t,n)}forEach(t){yn(this,t)}_write(t){t.writeTypeRef(zu)}}const ku=e=>new Oe;class bn extends Oe{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,s)=>{this.setAttribute(s,r)}),this._prelimAttrs=null}_copy(){return new bn(this.nodeName)}clone(){const t=new bn(this.nodeName),n=this.getAttributes();return sl(n,(r,s)=>{typeof r=="string"&&t.setAttribute(s,r)}),t.insert(0,this.toArray().map(r=>r instanceof _t?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const l in t)r.push(l);r.sort();const s=r.length;for(let l=0;l<s;l++){const u=r[l];n.push(u+'="'+t[u]+'"')}const o=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${o}${a}>${super.toString()}</${o}>`}removeAttribute(t){this.doc!==null?st(this.doc,n=>{Gn(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?st(this.doc,r=>{vi(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return _i(this,t)}hasAttribute(t){return vo(this,t)}getAttributes(){return mo(this)}toDOM(t=document,n={},r){const s=t.createElement(this.nodeName),o=this.getAttributes();for(const a in o){const l=o[a];typeof l=="string"&&s.setAttribute(a,l)}return yn(this,a=>{s.appendChild(a.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(qu),t.writeKey(this.nodeName)}}const Ru=e=>new bn(e.readKey());class Du extends dr{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class Jn extends $e{constructor(t){super(),this.hookName=t}_copy(){return new Jn(this.hookName)}clone(){const t=new Jn(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const s=n[this.hookName];let o;return s!==void 0?o=s.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(t){t.writeTypeRef(Hu),t.writeKey(this.hookName)}}const Au=e=>new Jn(e.readKey());class Kn extends Ye{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Kn}clone(){const t=new Kn;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const s=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(s,this),s}toString(){return this.toDelta().map(t=>{const n=[];for(const s in t.attributes){const o=[];for(const a in t.attributes[s])o.push({key:a,value:t.attributes[s][a]});o.sort((a,l)=>a.key<l.key?-1:1),n.push({nodeName:s,attrs:o})}n.sort((s,o)=>s.nodeName<o.nodeName?-1:1);let r="";for(let s=0;s<n.length;s++){const o=n[s];r+=`<${o.nodeName}`;for(let a=0;a<o.attrs.length;a++){const l=o.attrs[a];r+=` ${l.key}="${l.value}"`}r+=">"}r+=t.insert;for(let s=n.length-1;s>=0;s--)r+=`</${n[s].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef($u)}}const Tu=e=>new Kn;class Ci{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Qt()}mergeWith(t){return!1}write(t,n,r){throw Qt()}integrate(t,n){throw Qt()}}const xu=0;class Nt extends Ci{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),so(t.doc.store,this)}write(t,n){t.writeInfo(xu),t.writeLen(this.length-n)}getMissing(t,n){return null}}class Rn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Rn(this.content)}splice(t){throw Qt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const Lu=e=>new Rn(e.readBuf());class wn{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new wn(this.len)}splice(t){const n=new wn(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){Hn(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const Ou=e=>new wn(e.readLen()),ko=(e,t)=>new Xe({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Dn{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Dn(ko(this.doc.guid,this.opts))}splice(t){throw Qt()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const Iu=e=>new Dn(ko(e.readString(),e.readAny()));class Ne{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ne(this.embed)}splice(t){throw Qt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const Mu=e=>new Ne(e.readJSON());class ft{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ft(this.key,this.value)}splice(t){throw Qt()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const Nu=e=>new ft(e.readKey(),e.readJSON());class Xn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Xn(this.arr)}splice(t){const n=new Xn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const o=this.arr[s];t.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const Uu=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const s=e.readString();s==="undefined"?n.push(void 0):n.push(JSON.parse(s))}return new Xn(n)};class Ie{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ie(this.arr)}splice(t){const n=new Ie(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const o=this.arr[s];t.writeAny(o)}}getRef(){return 8}}const Fu=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Ie(n)};class ie{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ie(this.str)}splice(t){const n=new ie(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const Bu=e=>new ie(e.readString()),ju=[bu,mu,Eu,Ru,ku,Au,Tu],Pu=0,Vu=1,Wu=2,qu=3,zu=4,Hu=5,$u=6;class ge{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ge(this.type._copy())}splice(t){throw Qt()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const Yu=e=>new ge(ju[e.readTypeRef()](e)),Zn=(e,t,n)=>{const{client:r,clock:s}=t.id,o=new dt(Z(r,s+n),t,Z(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),t.redone!==null&&(o.redone=Z(t.redone.client,t.redone.clock+n)),t.right=o,o.right!==null&&(o.right.left=o),e._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),t.length=n,o};class dt extends Ci{constructor(t,n,r,s,o,a,l,u){super(t,u.getLength()),this.origin=r,this.left=n,this.right=s,this.rightOrigin=o,this.parent=a,this.parentSub=l,this.redone=null,this.content=u,this.info=this.content.isCountable()?Vi:0}set marker(t){(this.info&Sr)>0!==t&&(this.info^=Sr)}get marker(){return(this.info&Sr)>0}get keep(){return(this.info&Pi)>0}set keep(t){this.keep!==t&&(this.info^=Pi)}get countable(){return(this.info&Vi)>0}get deleted(){return(this.info&Cr)>0}set deleted(t){this.deleted!==t&&(this.info^=Cr)}markDeleted(){this.info|=Cr}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=wt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=wt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===je&&this.id.client!==this.parent.client&&this.parent.clock>=wt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=rs(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ee(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Nt||this.right&&this.right.constructor===Nt)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===dt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===dt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===je){const r=Ar(n,this.parent);r.constructor===Nt?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=rs(t,t.doc.store,Z(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,s;if(r!==null)s=r.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const o=new Set,a=new Set;for(;s!==null&&s!==this.right;){if(a.add(s),o.add(s),xn(this.origin,s.origin)){if(s.id.client<this.id.client)r=s,o.clear();else if(xn(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&a.has(Ar(t.doc.store,s.origin)))o.has(Ar(t.doc.store,s.origin))||(r=s,o.clear());else break;s=s.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),so(t.doc.store,this),this.content.integrate(t,this),ss(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new Nt(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:Z(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&xn(t.origin,this.lastId)&&this.right===t&&xn(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),Hn(t.deleteSet,this.id.client,this.id.clock,this.length),ss(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw ne();this.content.gc(t),n?tu(t,this,new Nt(this.id,this.length)):this.content=new wn(this.length)}write(t,n){const r=n>0?Z(this.id.client,this.id.clock+n-1):this.origin,s=this.rightOrigin,o=this.parentSub,a=this.content.getRef()&ar|(r===null?0:Lt)|(s===null?0:le)|(o===null?0:dn);if(t.writeInfo(a),r!==null&&t.writeLeftID(r),s!==null&&t.writeRightID(s),r===null&&s===null){const l=this.parent;if(l._item!==void 0){const u=l._item;if(u===null){const g=Zl(l);t.writeParentInfo(!0),t.writeString(g)}else t.writeParentInfo(!1),t.writeLeftID(u.id)}else l.constructor===String?(t.writeParentInfo(!0),t.writeString(l)):l.constructor===je?(t.writeParentInfo(!1),t.writeLeftID(l)):ne();o!==null&&t.writeString(o)}this.content.write(t,n)}}const Ro=(e,t)=>Gu[t&ar](e),Gu=[()=>{ne()},Ou,Uu,Lu,Bu,Mu,Nu,Yu,Fu,Iu,()=>{ne()}],Ju=10;class Ut extends Ci{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){ne()}write(t,n){t.writeInfo(Ju),q(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const Do=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Ao="__ $YJS$ __";Do[Ao]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Do[Ao]=!0;const Ku=1200,Xu=2500,Qn=3e4,Yr=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=a=>{e.lastMessageReceived=de();const l=a.data,u=typeof l=="string"?JSON.parse(l):l;u&&u.type==="pong"&&(clearTimeout(r),r=setTimeout(o,Qn/2)),e.emit("message",[u,e])};const s=a=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:a},e])):e.unsuccessfulReconnects++,setTimeout(Yr,ni(_c(e.unsuccessfulReconnects+1)*Ku,Xu),e)),clearTimeout(r)},o=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>s(null),t.onerror=a=>s(a),t.onopen=()=>{e.lastMessageReceived=de(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(o,Qn/2)}}};class Zu extends or{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Qn<de()-this.lastMessageReceived&&this.ws.close()},Qn/2),Yr(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Yr(this)}}const To=new Map;class Qu{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:Ps(n.newValue||"")}),el(this._onChange)}postMessage(t){Ns.setItem(this.room,js(bl(t)))}close(){nl(this._onChange)}}const th=typeof BroadcastChannel>"u"?Qu:BroadcastChannel,Si=e=>Bt(To,e,()=>{const t=Ae(),n=new th(e);return n.onmessage=r=>t.forEach(s=>s(r.data,"broadcastchannel")),{bc:n,subs:t}}),eh=(e,t)=>(Si(e).subs.add(t),t),nh=(e,t)=>{const n=Si(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),To.delete(e)),r},rh=(e,t,n=null)=>{const r=Si(e);r.bc.postMessage(t),r.subs.forEach(s=>s(t,n))},ih=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};function In(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xo={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,r=Math.abs,s=Math.pow;return function(){function o(a,l,u){function g(f,p){if(!l[f]){if(!a[f]){var y=typeof In=="function"&&In;if(!p&&y)return y(f,!0);if(b)return b(f,!0);var v=new Error("Cannot find module '"+f+"'");throw v.code="MODULE_NOT_FOUND",v}var L=l[f]={exports:{}};a[f][0].call(L.exports,function(T){var I=a[f][1][T];return g(I||T)},L,L.exports,o,a,l,u)}return l[f].exports}for(var b=typeof In=="function"&&In,h=0;h<u.length;h++)g(u[h]);return g}return o}()({1:[function(o,a,l){function u(_){var C=_.length;if(0<C%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=_.indexOf("=");R===-1&&(R=C);var S=R===C?0:4-R%4;return[R,S]}function g(_,C,R){return 3*(C+R)/4-R}function b(_){var C,R,S=u(_),A=S[0],U=S[1],k=new L(g(_,A,U)),D=0,B=0<U?A-4:A;for(R=0;R<B;R+=4)C=v[_.charCodeAt(R)]<<18|v[_.charCodeAt(R+1)]<<12|v[_.charCodeAt(R+2)]<<6|v[_.charCodeAt(R+3)],k[D++]=255&C>>16,k[D++]=255&C>>8,k[D++]=255&C;return U===2&&(C=v[_.charCodeAt(R)]<<2|v[_.charCodeAt(R+1)]>>4,k[D++]=255&C),U===1&&(C=v[_.charCodeAt(R)]<<10|v[_.charCodeAt(R+1)]<<4|v[_.charCodeAt(R+2)]>>2,k[D++]=255&C>>8,k[D++]=255&C),k}function h(_){return y[63&_>>18]+y[63&_>>12]+y[63&_>>6]+y[63&_]}function f(_,C,R){for(var S,A=[],U=C;U<R;U+=3)S=(16711680&_[U]<<16)+(65280&_[U+1]<<8)+(255&_[U+2]),A.push(h(S));return A.join("")}function p(_){for(var C,R=_.length,S=R%3,A=[],U=16383,k=0,D=R-S;k<D;k+=U)A.push(f(_,k,k+U>D?D:k+U));return S===1?(C=_[R-1],A.push(y[C>>2]+y[63&C<<4]+"==")):S===2&&(C=(_[R-2]<<8)+_[R-1],A.push(y[C>>10]+y[63&C>>4]+y[63&C<<2]+"=")),A.join("")}l.byteLength=function(_){var C=u(_),R=C[0],S=C[1];return 3*(R+S)/4-S},l.toByteArray=b,l.fromByteArray=p;for(var y=[],v=[],L=typeof Uint8Array>"u"?Array:Uint8Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=0,w=T.length;I<w;++I)y[I]=T[I],v[T.charCodeAt(I)]=I;v[45]=62,v[95]=63},{}],2:[function(){},{}],3:[function(o,a,l){(function(){(function(){var u=String.fromCharCode,g=Math.min;function b(i){if(2147483647<i)throw new RangeError('The value "'+i+'" is invalid for option "size"');var c=new Uint8Array(i);return c.__proto__=h.prototype,c}function h(i,c,d){if(typeof i=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(i)}return f(i,c,d)}function f(i,c,d){if(typeof i=="string")return L(i,c);if(ArrayBuffer.isView(i))return T(i);if(i==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(O(i,ArrayBuffer)||i&&O(i.buffer,ArrayBuffer))return I(i,c,d);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var E=i.valueOf&&i.valueOf();if(E!=null&&E!==i)return h.from(E,c,d);var x=w(i);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return h.from(i[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}function p(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(0>i)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function y(i,c,d){return p(i),0>=i||c===void 0?b(i):typeof d=="string"?b(i).fill(c,d):b(i).fill(c)}function v(i){return p(i),b(0>i?0:0|_(i))}function L(i,c){if((typeof c!="string"||c==="")&&(c="utf8"),!h.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var d=0|C(i,c),E=b(d),x=E.write(i,c);return x!==d&&(E=E.slice(0,x)),E}function T(i){for(var c=0>i.length?0:0|_(i.length),d=b(c),E=0;E<c;E+=1)d[E]=255&i[E];return d}function I(i,c,d){if(0>c||i.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<c+(d||0))throw new RangeError('"length" is outside of buffer bounds');var E;return E=c===void 0&&d===void 0?new Uint8Array(i):d===void 0?new Uint8Array(i,c):new Uint8Array(i,c,d),E.__proto__=h.prototype,E}function w(i){if(h.isBuffer(i)){var c=0|_(i.length),d=b(c);return d.length===0||i.copy(d,0,0,c),d}return i.length===void 0?i.type==="Buffer"&&Array.isArray(i.data)?T(i.data):void 0:typeof i.length!="number"||M(i.length)?b(0):T(i)}function _(i){if(i>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|i}function C(i,c){if(h.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||O(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);var d=i.length,E=2<arguments.length&&arguments[2]===!0;if(!E&&d===0)return 0;for(var x=!1;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return lt(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return Dt(i).length;default:if(x)return E?-1:lt(i).length;c=(""+c).toLowerCase(),x=!0}}function R(i,c,d){var E=!1;if((c===void 0||0>c)&&(c=0),c>this.length||((d===void 0||d>this.length)&&(d=this.length),0>=d)||(d>>>=0,c>>>=0,d<=c))return"";for(i||(i="utf8");;)switch(i){case"hex":return kt(this,c,d);case"utf8":case"utf-8":return et(this,c,d);case"ascii":return H(this,c,d);case"latin1":case"binary":return Ht(this,c,d);case"base64":return X(this,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ct(this,c,d);default:if(E)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),E=!0}}function S(i,c,d){var E=i[c];i[c]=i[d],i[d]=E}function A(i,c,d,E,x){if(i.length===0)return-1;if(typeof d=="string"?(E=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648),d=+d,M(d)&&(d=x?0:i.length-1),0>d&&(d=i.length+d),d>=i.length){if(x)return-1;d=i.length-1}else if(0>d)if(x)d=0;else return-1;if(typeof c=="string"&&(c=h.from(c,E)),h.isBuffer(c))return c.length===0?-1:U(i,c,d,E,x);if(typeof c=="number")return c&=255,typeof Uint8Array.prototype.indexOf=="function"?x?Uint8Array.prototype.indexOf.call(i,c,d):Uint8Array.prototype.lastIndexOf.call(i,c,d):U(i,[c],d,E,x);throw new TypeError("val must be string, number or Buffer")}function U(i,c,d,E,x){function N(ye,ke){return V===1?ye[ke]:ye.readUInt16BE(ke*V)}var V=1,$=i.length,tt=c.length;if(E!==void 0&&(E=(E+"").toLowerCase(),E==="ucs2"||E==="ucs-2"||E==="utf16le"||E==="utf-16le")){if(2>i.length||2>c.length)return-1;V=2,$/=2,tt/=2,d/=2}var J;if(x){var K=-1;for(J=d;J<$;J++)if(N(i,J)!==N(c,K===-1?0:J-K))K!==-1&&(J-=J-K),K=-1;else if(K===-1&&(K=J),J-K+1===tt)return K*V}else for(d+tt>$&&(d=$-tt),J=d;0<=J;J--){for(var rt=!0,Yt=0;Yt<tt;Yt++)if(N(i,J+Yt)!==N(c,Yt)){rt=!1;break}if(rt)return J}return-1}function k(i,c,d,E){d=+d||0;var x=i.length-d;E?(E=+E,E>x&&(E=x)):E=x;var N=c.length;E>N/2&&(E=N/2);for(var V,$=0;$<E;++$){if(V=parseInt(c.substr(2*$,2),16),M(V))return $;i[d+$]=V}return $}function D(i,c,d,E){return ut(lt(c,i.length-d),i,d,E)}function B(i,c,d,E){return ut(oe(c),i,d,E)}function P(i,c,d,E){return B(i,c,d,E)}function z(i,c,d,E){return ut(Dt(c),i,d,E)}function G(i,c,d,E){return ut(St(c,i.length-d),i,d,E)}function X(i,c,d){return c===0&&d===i.length?j.fromByteArray(i):j.fromByteArray(i.slice(c,d))}function et(i,c,d){d=g(i.length,d);for(var E=[],x=c;x<d;){var N=i[x],V=null,$=239<N?4:223<N?3:191<N?2:1;if(x+$<=d){var tt,J,K,rt;$===1?128>N&&(V=N):$===2?(tt=i[x+1],(192&tt)==128&&(rt=(31&N)<<6|63&tt,127<rt&&(V=rt))):$===3?(tt=i[x+1],J=i[x+2],(192&tt)==128&&(192&J)==128&&(rt=(15&N)<<12|(63&tt)<<6|63&J,2047<rt&&(55296>rt||57343<rt)&&(V=rt))):$===4&&(tt=i[x+1],J=i[x+2],K=i[x+3],(192&tt)==128&&(192&J)==128&&(192&K)==128&&(rt=(15&N)<<18|(63&tt)<<12|(63&J)<<6|63&K,65535<rt&&1114112>rt&&(V=rt)))}V===null?(V=65533,$=1):65535<V&&(V-=65536,E.push(55296|1023&V>>>10),V=56320|1023&V),E.push(V),x+=$}return mt(E)}function mt(i){var c=i.length;if(c<=4096)return u.apply(String,i);for(var d="",E=0;E<c;)d+=u.apply(String,i.slice(E,E+=4096));return d}function H(i,c,d){var E="";d=g(i.length,d);for(var x=c;x<d;++x)E+=u(127&i[x]);return E}function Ht(i,c,d){var E="";d=g(i.length,d);for(var x=c;x<d;++x)E+=u(i[x]);return E}function kt(i,c,d){var E=i.length;(!c||0>c)&&(c=0),(!d||0>d||d>E)&&(d=E);for(var x="",N=c;N<d;++N)x+=$t(i[N]);return x}function Ct(i,c,d){for(var E=i.slice(c,d),x="",N=0;N<E.length;N+=2)x+=u(E[N]+256*E[N+1]);return x}function nt(i,c,d){if(i%1!=0||0>i)throw new RangeError("offset is not uint");if(i+c>d)throw new RangeError("Trying to access beyond buffer length")}function Q(i,c,d,E,x,N){if(!h.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>x||c<N)throw new RangeError('"value" argument is out of bounds');if(d+E>i.length)throw new RangeError("Index out of range")}function Rt(i,c,d,E){if(d+E>i.length)throw new RangeError("Index out of range");if(0>d)throw new RangeError("Index out of range")}function ct(i,c,d,E,x){return c=+c,d>>>=0,x||Rt(i,c,d,4),W.write(i,c,d,E,23,4),d+4}function jt(i,c,d,E,x){return c=+c,d>>>=0,x||Rt(i,c,d,8),W.write(i,c,d,E,52,8),d+8}function pe(i){if(i=i.split("=")[0],i=i.trim().replace(m,""),2>i.length)return"";for(;i.length%4!=0;)i+="=";return i}function $t(i){return 16>i?"0"+i.toString(16):i.toString(16)}function lt(i,c){c=c||1/0;for(var d,E=i.length,x=null,N=[],V=0;V<E;++V){if(d=i.charCodeAt(V),55295<d&&57344>d){if(!x){if(56319<d){-1<(c-=3)&&N.push(239,191,189);continue}else if(V+1===E){-1<(c-=3)&&N.push(239,191,189);continue}x=d;continue}if(56320>d){-1<(c-=3)&&N.push(239,191,189),x=d;continue}d=(x-55296<<10|d-56320)+65536}else x&&-1<(c-=3)&&N.push(239,191,189);if(x=null,128>d){if(0>(c-=1))break;N.push(d)}else if(2048>d){if(0>(c-=2))break;N.push(192|d>>6,128|63&d)}else if(65536>d){if(0>(c-=3))break;N.push(224|d>>12,128|63&d>>6,128|63&d)}else if(1114112>d){if(0>(c-=4))break;N.push(240|d>>18,128|63&d>>12,128|63&d>>6,128|63&d)}else throw new Error("Invalid code point")}return N}function oe(i){for(var c=[],d=0;d<i.length;++d)c.push(255&i.charCodeAt(d));return c}function St(i,c){for(var d,E,x,N=[],V=0;V<i.length&&!(0>(c-=2));++V)d=i.charCodeAt(V),E=d>>8,x=d%256,N.push(x),N.push(E);return N}function Dt(i){return j.toByteArray(pe(i))}function ut(i,c,d,E){for(var x=0;x<E&&!(x+d>=c.length||x>=i.length);++x)c[x+d]=i[x];return x}function O(i,c){return i instanceof c||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===c.name}function M(i){return i!==i}var j=o("base64-js"),W=o("ieee754");l.Buffer=h,l.SlowBuffer=function(i){return+i!=i&&(i=0),h.alloc(+i)},l.INSPECT_MAX_BYTES=50,l.kMaxLength=2147483647,h.TYPED_ARRAY_SUPPORT=function(){try{var i=new Uint8Array(1);return i.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},i.foo()===42}catch{return!1}}(),h.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){return h.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){return h.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=function(i,c,d){return f(i,c,d)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(i,c,d){return y(i,c,d)},h.allocUnsafe=function(i){return v(i)},h.allocUnsafeSlow=function(i){return v(i)},h.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==h.prototype},h.compare=function(i,c){if(O(i,Uint8Array)&&(i=h.from(i,i.offset,i.byteLength)),O(c,Uint8Array)&&(c=h.from(c,c.offset,c.byteLength)),!h.isBuffer(i)||!h.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===c)return 0;for(var d=i.length,E=c.length,x=0,N=g(d,E);x<N;++x)if(i[x]!==c[x]){d=i[x],E=c[x];break}return d<E?-1:E<d?1:0},h.isEncoding=function(i){switch((i+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(i,c){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return h.alloc(0);var d;if(c===void 0)for(c=0,d=0;d<i.length;++d)c+=i[d].length;var E=h.allocUnsafe(c),x=0;for(d=0;d<i.length;++d){var N=i[d];if(O(N,Uint8Array)&&(N=h.from(N)),!h.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(E,x),x+=N.length}return E},h.byteLength=C,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var i=this.length;if(i%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<i;c+=2)S(this,c,c+1);return this},h.prototype.swap32=function(){var i=this.length;if(i%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<i;c+=4)S(this,c,c+3),S(this,c+1,c+2);return this},h.prototype.swap64=function(){var i=this.length;if(i%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<i;c+=8)S(this,c,c+7),S(this,c+1,c+6),S(this,c+2,c+5),S(this,c+3,c+4);return this},h.prototype.toString=function(){var i=this.length;return i===0?"":arguments.length===0?et(this,0,i):R.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(i){if(!h.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i||h.compare(this,i)===0},h.prototype.inspect=function(){var i="",c=l.INSPECT_MAX_BYTES;return i=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(i+=" ... "),"<Buffer "+i+">"},h.prototype.compare=function(i,c,d,E,x){if(O(i,Uint8Array)&&(i=h.from(i,i.offset,i.byteLength)),!h.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(c===void 0&&(c=0),d===void 0&&(d=i?i.length:0),E===void 0&&(E=0),x===void 0&&(x=this.length),0>c||d>i.length||0>E||x>this.length)throw new RangeError("out of range index");if(E>=x&&c>=d)return 0;if(E>=x)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,E>>>=0,x>>>=0,this===i)return 0;for(var N=x-E,V=d-c,$=g(N,V),tt=this.slice(E,x),J=i.slice(c,d),K=0;K<$;++K)if(tt[K]!==J[K]){N=tt[K],V=J[K];break}return N<V?-1:V<N?1:0},h.prototype.includes=function(i,c,d){return this.indexOf(i,c,d)!==-1},h.prototype.indexOf=function(i,c,d){return A(this,i,c,d,!0)},h.prototype.lastIndexOf=function(i,c,d){return A(this,i,c,d,!1)},h.prototype.write=function(i,c,d,E){if(c===void 0)E="utf8",d=this.length,c=0;else if(d===void 0&&typeof c=="string")E=c,d=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(d)?(d>>>=0,E===void 0&&(E="utf8")):(E=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var x=this.length-c;if((d===void 0||d>x)&&(d=x),0<i.length&&(0>d||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");for(var N=!1;;)switch(E){case"hex":return k(this,i,c,d);case"utf8":case"utf-8":return D(this,i,c,d);case"ascii":return B(this,i,c,d);case"latin1":case"binary":return P(this,i,c,d);case"base64":return z(this,i,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,i,c,d);default:if(N)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),N=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(i,c){var d=this.length;i=~~i,c=c===void 0?d:~~c,0>i?(i+=d,0>i&&(i=0)):i>d&&(i=d),0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d),c<i&&(c=i);var E=this.subarray(i,c);return E.__proto__=h.prototype,E},h.prototype.readUIntLE=function(i,c,d){i>>>=0,c>>>=0,d||nt(i,c,this.length);for(var E=this[i],x=1,N=0;++N<c&&(x*=256);)E+=this[i+N]*x;return E},h.prototype.readUIntBE=function(i,c,d){i>>>=0,c>>>=0,d||nt(i,c,this.length);for(var E=this[i+--c],x=1;0<c&&(x*=256);)E+=this[i+--c]*x;return E},h.prototype.readUInt8=function(i,c){return i>>>=0,c||nt(i,1,this.length),this[i]},h.prototype.readUInt16LE=function(i,c){return i>>>=0,c||nt(i,2,this.length),this[i]|this[i+1]<<8},h.prototype.readUInt16BE=function(i,c){return i>>>=0,c||nt(i,2,this.length),this[i]<<8|this[i+1]},h.prototype.readUInt32LE=function(i,c){return i>>>=0,c||nt(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+16777216*this[i+3]},h.prototype.readUInt32BE=function(i,c){return i>>>=0,c||nt(i,4,this.length),16777216*this[i]+(this[i+1]<<16|this[i+2]<<8|this[i+3])},h.prototype.readIntLE=function(i,c,d){i>>>=0,c>>>=0,d||nt(i,c,this.length);for(var E=this[i],x=1,N=0;++N<c&&(x*=256);)E+=this[i+N]*x;return x*=128,E>=x&&(E-=s(2,8*c)),E},h.prototype.readIntBE=function(i,c,d){i>>>=0,c>>>=0,d||nt(i,c,this.length);for(var E=c,x=1,N=this[i+--E];0<E&&(x*=256);)N+=this[i+--E]*x;return x*=128,N>=x&&(N-=s(2,8*c)),N},h.prototype.readInt8=function(i,c){return i>>>=0,c||nt(i,1,this.length),128&this[i]?-1*(255-this[i]+1):this[i]},h.prototype.readInt16LE=function(i,c){i>>>=0,c||nt(i,2,this.length);var d=this[i]|this[i+1]<<8;return 32768&d?4294901760|d:d},h.prototype.readInt16BE=function(i,c){i>>>=0,c||nt(i,2,this.length);var d=this[i+1]|this[i]<<8;return 32768&d?4294901760|d:d},h.prototype.readInt32LE=function(i,c){return i>>>=0,c||nt(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},h.prototype.readInt32BE=function(i,c){return i>>>=0,c||nt(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},h.prototype.readFloatLE=function(i,c){return i>>>=0,c||nt(i,4,this.length),W.read(this,i,!0,23,4)},h.prototype.readFloatBE=function(i,c){return i>>>=0,c||nt(i,4,this.length),W.read(this,i,!1,23,4)},h.prototype.readDoubleLE=function(i,c){return i>>>=0,c||nt(i,8,this.length),W.read(this,i,!0,52,8)},h.prototype.readDoubleBE=function(i,c){return i>>>=0,c||nt(i,8,this.length),W.read(this,i,!1,52,8)},h.prototype.writeUIntLE=function(i,c,d,E){if(i=+i,c>>>=0,d>>>=0,!E){var x=s(2,8*d)-1;Q(this,i,c,d,x,0)}var N=1,V=0;for(this[c]=255&i;++V<d&&(N*=256);)this[c+V]=255&i/N;return c+d},h.prototype.writeUIntBE=function(i,c,d,E){if(i=+i,c>>>=0,d>>>=0,!E){var x=s(2,8*d)-1;Q(this,i,c,d,x,0)}var N=d-1,V=1;for(this[c+N]=255&i;0<=--N&&(V*=256);)this[c+N]=255&i/V;return c+d},h.prototype.writeUInt8=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,1,255,0),this[c]=255&i,c+1},h.prototype.writeUInt16LE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,2,65535,0),this[c]=255&i,this[c+1]=i>>>8,c+2},h.prototype.writeUInt16BE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,2,65535,0),this[c]=i>>>8,this[c+1]=255&i,c+2},h.prototype.writeUInt32LE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,4,4294967295,0),this[c+3]=i>>>24,this[c+2]=i>>>16,this[c+1]=i>>>8,this[c]=255&i,c+4},h.prototype.writeUInt32BE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,4,4294967295,0),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},h.prototype.writeIntLE=function(i,c,d,E){if(i=+i,c>>>=0,!E){var x=s(2,8*d-1);Q(this,i,c,d,x-1,-x)}var N=0,V=1,$=0;for(this[c]=255&i;++N<d&&(V*=256);)0>i&&$===0&&this[c+N-1]!==0&&($=1),this[c+N]=255&(i/V>>0)-$;return c+d},h.prototype.writeIntBE=function(i,c,d,E){if(i=+i,c>>>=0,!E){var x=s(2,8*d-1);Q(this,i,c,d,x-1,-x)}var N=d-1,V=1,$=0;for(this[c+N]=255&i;0<=--N&&(V*=256);)0>i&&$===0&&this[c+N+1]!==0&&($=1),this[c+N]=255&(i/V>>0)-$;return c+d},h.prototype.writeInt8=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,1,127,-128),0>i&&(i=255+i+1),this[c]=255&i,c+1},h.prototype.writeInt16LE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,2,32767,-32768),this[c]=255&i,this[c+1]=i>>>8,c+2},h.prototype.writeInt16BE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,2,32767,-32768),this[c]=i>>>8,this[c+1]=255&i,c+2},h.prototype.writeInt32LE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,4,2147483647,-2147483648),this[c]=255&i,this[c+1]=i>>>8,this[c+2]=i>>>16,this[c+3]=i>>>24,c+4},h.prototype.writeInt32BE=function(i,c,d){return i=+i,c>>>=0,d||Q(this,i,c,4,2147483647,-2147483648),0>i&&(i=4294967295+i+1),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},h.prototype.writeFloatLE=function(i,c,d){return ct(this,i,c,!0,d)},h.prototype.writeFloatBE=function(i,c,d){return ct(this,i,c,!1,d)},h.prototype.writeDoubleLE=function(i,c,d){return jt(this,i,c,!0,d)},h.prototype.writeDoubleBE=function(i,c,d){return jt(this,i,c,!1,d)},h.prototype.copy=function(i,c,d,E){if(!h.isBuffer(i))throw new TypeError("argument should be a Buffer");if(d||(d=0),E||E===0||(E=this.length),c>=i.length&&(c=i.length),c||(c=0),0<E&&E<d&&(E=d),E===d||i.length===0||this.length===0)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("Index out of range");if(0>E)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),i.length-c<E-d&&(E=i.length-c+d);var x=E-d;if(this===i&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(c,d,E);else if(this===i&&d<c&&c<E)for(var N=x-1;0<=N;--N)i[N+c]=this[N+d];else Uint8Array.prototype.set.call(i,this.subarray(d,E),c);return x},h.prototype.fill=function(i,c,d,E){if(typeof i=="string"){if(typeof c=="string"?(E=c,c=0,d=this.length):typeof d=="string"&&(E=d,d=this.length),E!==void 0&&typeof E!="string")throw new TypeError("encoding must be a string");if(typeof E=="string"&&!h.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(i.length===1){var x=i.charCodeAt(0);(E==="utf8"&&128>x||E==="latin1")&&(i=x)}}else typeof i=="number"&&(i&=255);if(0>c||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c>>>=0,d=d===void 0?this.length:d>>>0,i||(i=0);var N;if(typeof i=="number")for(N=c;N<d;++N)this[N]=i;else{var V=h.isBuffer(i)?i:h.from(i,E),$=V.length;if($===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(N=0;N<d-c;++N)this[N+c]=V[N%$]}return this};var m=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,o("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(o,a,l){(function(u){(function(){function g(){let h;try{h=l.storage.getItem("debug")}catch{}return!h&&typeof u<"u"&&"env"in u&&(h=u.env.DEBUG),h}l.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;h.splice(1,0,f,"color: inherit");let p=0,y=0;h[0].replace(/%[a-zA-Z%]/g,v=>{v==="%%"||(p++,v==="%c"&&(y=p))}),h.splice(y,0,f)},l.save=function(h){try{h?l.storage.setItem("debug",h):l.storage.removeItem("debug")}catch{}},l.load=g,l.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},l.storage=function(){try{return localStorage}catch{}}(),l.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),l.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],l.log=console.debug||console.log||(()=>{}),a.exports=o("./common")(l);const{formatters:b}=a.exports;b.j=function(h){try{return JSON.stringify(h)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}).call(this)}).call(this,o("_process"))},{"./common":5,_process:12}],5:[function(o,a){a.exports=function(l){function u(h){function f(...v){if(!f.enabled)return;const L=f,T=+new Date,I=T-(p||T);L.diff=I,L.prev=p,L.curr=T,p=T,v[0]=u.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let w=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(C,R)=>{if(C==="%%")return"%";w++;const S=u.formatters[R];if(typeof S=="function"){const A=v[w];C=S.call(L,A),v.splice(w,1),w--}return C}),u.formatArgs.call(L,v),(L.log||u.log).apply(L,v)}let p,y=null;return f.namespace=h,f.useColors=u.useColors(),f.color=u.selectColor(h),f.extend=g,f.destroy=u.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>y===null?u.enabled(h):y,set:v=>{y=v}}),typeof u.init=="function"&&u.init(f),f}function g(h,f){const p=u(this.namespace+(typeof f>"u"?":":f)+h);return p.log=this.log,p}function b(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return u.debug=u,u.default=u,u.coerce=function(h){return h instanceof Error?h.stack||h.message:h},u.disable=function(){const h=[...u.names.map(b),...u.skips.map(b).map(f=>"-"+f)].join(",");return u.enable(""),h},u.enable=function(h){u.save(h),u.names=[],u.skips=[];let f;const p=(typeof h=="string"?h:"").split(/[\s,]+/),y=p.length;for(f=0;f<y;f++)p[f]&&(h=p[f].replace(/\*/g,".*?"),h[0]==="-"?u.skips.push(new RegExp("^"+h.substr(1)+"$")):u.names.push(new RegExp("^"+h+"$")))},u.enabled=function(h){if(h[h.length-1]==="*")return!0;let f,p;for(f=0,p=u.skips.length;f<p;f++)if(u.skips[f].test(h))return!1;for(f=0,p=u.names.length;f<p;f++)if(u.names[f].test(h))return!0;return!1},u.humanize=o("ms"),u.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(l).forEach(h=>{u[h]=l[h]}),u.names=[],u.skips=[],u.formatters={},u.selectColor=function(h){let f=0;for(let p=0;p<h.length;p++)f=(f<<5)-f+h.charCodeAt(p),f|=0;return u.colors[r(f)%u.colors.length]},u.enable(u.load()),u}},{ms:11}],6:[function(o,a){function l(u,g){for(const b in g)Object.defineProperty(u,b,{value:g[b],enumerable:!0,configurable:!0});return u}a.exports=function(u,g,b){if(!u||typeof u=="string")throw new TypeError("Please pass an Error to err-code");b||(b={}),typeof g=="object"&&(b=g,g=""),g&&(b.code=g);try{return l(u,b)}catch{b.message=u.message,b.stack=u.stack;const f=function(){};return f.prototype=Object.create(Object.getPrototypeOf(u)),l(new f,b)}}},{}],7:[function(o,a){function l(k){console&&console.warn&&console.warn(k)}function u(){u.init.call(this)}function g(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}function b(k){return k._maxListeners===void 0?u.defaultMaxListeners:k._maxListeners}function h(k,D,B,P){var z,G,X;if(g(B),G=k._events,G===void 0?(G=k._events=Object.create(null),k._eventsCount=0):(G.newListener!==void 0&&(k.emit("newListener",D,B.listener?B.listener:B),G=k._events),X=G[D]),X===void 0)X=G[D]=B,++k._eventsCount;else if(typeof X=="function"?X=G[D]=P?[B,X]:[X,B]:P?X.unshift(B):X.push(B),z=b(k),0<z&&X.length>z&&!X.warned){X.warned=!0;var et=new Error("Possible EventEmitter memory leak detected. "+X.length+" "+(D+" listeners added. Use emitter.setMaxListeners() to increase limit"));et.name="MaxListenersExceededWarning",et.emitter=k,et.type=D,et.count=X.length,l(et)}return k}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(k,D,B){var P={fired:!1,wrapFn:void 0,target:k,type:D,listener:B},z=f.bind(P);return z.listener=B,P.wrapFn=z,z}function y(k,D,B){var P=k._events;if(P===void 0)return[];var z=P[D];return z===void 0?[]:typeof z=="function"?B?[z.listener||z]:[z]:B?I(z):L(z,z.length)}function v(k){var D=this._events;if(D!==void 0){var B=D[k];if(typeof B=="function")return 1;if(B!==void 0)return B.length}return 0}function L(k,D){for(var B=Array(D),P=0;P<D;++P)B[P]=k[P];return B}function T(k,D){for(;D+1<k.length;D++)k[D]=k[D+1];k.pop()}function I(k){for(var D=Array(k.length),B=0;B<D.length;++B)D[B]=k[B].listener||k[B];return D}function w(k,D,B){typeof k.on=="function"&&_(k,"error",D,B)}function _(k,D,B,P){if(typeof k.on=="function")P.once?k.once(D,B):k.on(D,B);else if(typeof k.addEventListener=="function")k.addEventListener(D,function z(G){P.once&&k.removeEventListener(D,z),B(G)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}var C,R=typeof Reflect=="object"?Reflect:null,S=R&&typeof R.apply=="function"?R.apply:function(k,D,B){return Function.prototype.apply.call(k,D,B)};C=R&&typeof R.ownKeys=="function"?R.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var A=Number.isNaN||function(k){return k!==k};a.exports=u,a.exports.once=function(k,D){return new Promise(function(B,P){function z(X){k.removeListener(D,G),P(X)}function G(){typeof k.removeListener=="function"&&k.removeListener("error",z),B([].slice.call(arguments))}_(k,D,G,{once:!0}),D!=="error"&&w(k,z,{once:!0})})},u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var U=10;Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(k){if(typeof k!="number"||0>k||A(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");U=k}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(k){if(typeof k!="number"||0>k||A(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},u.prototype.getMaxListeners=function(){return b(this)},u.prototype.emit=function(k){for(var D=[],B=1;B<arguments.length;B++)D.push(arguments[B]);var P=k==="error",z=this._events;if(z!==void 0)P=P&&z.error===void 0;else if(!P)return!1;if(P){var G;if(0<D.length&&(G=D[0]),G instanceof Error)throw G;var X=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw X.context=G,X}var et=z[k];if(et===void 0)return!1;if(typeof et=="function")S(et,this,D);else for(var mt=et.length,H=L(et,mt),B=0;B<mt;++B)S(H[B],this,D);return!0},u.prototype.addListener=function(k,D){return h(this,k,D,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(k,D){return h(this,k,D,!0)},u.prototype.once=function(k,D){return g(D),this.on(k,p(this,k,D)),this},u.prototype.prependOnceListener=function(k,D){return g(D),this.prependListener(k,p(this,k,D)),this},u.prototype.removeListener=function(k,D){var B,P,z,G,X;if(g(D),P=this._events,P===void 0)return this;if(B=P[k],B===void 0)return this;if(B===D||B.listener===D)--this._eventsCount==0?this._events=Object.create(null):(delete P[k],P.removeListener&&this.emit("removeListener",k,B.listener||D));else if(typeof B!="function"){for(z=-1,G=B.length-1;0<=G;G--)if(B[G]===D||B[G].listener===D){X=B[G].listener,z=G;break}if(0>z)return this;z===0?B.shift():T(B,z),B.length===1&&(P[k]=B[0]),P.removeListener!==void 0&&this.emit("removeListener",k,X||D)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(k){var D,B,P;if(B=this._events,B===void 0)return this;if(B.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):B[k]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete B[k]),this;if(arguments.length===0){var z,G=Object.keys(B);for(P=0;P<G.length;++P)z=G[P],z!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(D=B[k],typeof D=="function")this.removeListener(k,D);else if(D!==void 0)for(P=D.length-1;0<=P;P--)this.removeListener(k,D[P]);return this},u.prototype.listeners=function(k){return y(this,k,!0)},u.prototype.rawListeners=function(k){return y(this,k,!1)},u.listenerCount=function(k,D){return typeof k.listenerCount=="function"?k.listenerCount(D):v.call(k,D)},u.prototype.listenerCount=v,u.prototype.eventNames=function(){return 0<this._eventsCount?C(this._events):[]}},{}],8:[function(o,a){a.exports=function(){if(typeof globalThis>"u")return null;var l={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return l.RTCPeerConnection?l:null}},{}],9:[function(o,a,l){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */l.read=function(u,g,b,h,f){var p,y,v=8*f-h-1,L=(1<<v)-1,T=L>>1,I=-7,w=b?f-1:0,_=b?-1:1,C=u[g+w];for(w+=_,p=C&(1<<-I)-1,C>>=-I,I+=v;0<I;p=256*p+u[g+w],w+=_,I-=8);for(y=p&(1<<-I)-1,p>>=-I,I+=h;0<I;y=256*y+u[g+w],w+=_,I-=8);if(p===0)p=1-T;else{if(p===L)return y?NaN:(C?-1:1)*(1/0);y+=s(2,h),p-=T}return(C?-1:1)*y*s(2,p-h)},l.write=function(u,g,b,h,f,p){var y,v,L,T=Math.LN2,I=Math.log,w=8*p-f-1,_=(1<<w)-1,C=_>>1,R=f===23?s(2,-24)-s(2,-77):0,S=h?0:p-1,A=h?1:-1,U=0>g||g===0&&0>1/g?1:0;for(g=r(g),isNaN(g)||g===1/0?(v=isNaN(g)?1:0,y=_):(y=n(I(g)/T),1>g*(L=s(2,-y))&&(y--,L*=2),g+=1<=y+C?R/L:R*s(2,1-C),2<=g*L&&(y++,L/=2),y+C>=_?(v=0,y=_):1<=y+C?(v=(g*L-1)*s(2,f),y+=C):(v=g*s(2,C-1)*s(2,f),y=0));8<=f;u[b+S]=255&v,S+=A,v/=256,f-=8);for(y=y<<f|v,w+=f;0<w;u[b+S]=255&y,S+=A,y/=256,w-=8);u[b+S-A]|=128*U}},{}],10:[function(o,a){a.exports=typeof Object.create=="function"?function(l,u){u&&(l.super_=u,l.prototype=Object.create(u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}))}:function(l,u){if(u){l.super_=u;var g=function(){};g.prototype=u.prototype,l.prototype=new g,l.prototype.constructor=l}}},{}],11:[function(o,a){var l=Math.round;function u(f){if(f+="",!(100<f.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(p){var y=parseFloat(p[1]),v=(p[2]||"ms").toLowerCase();return v==="years"||v==="year"||v==="yrs"||v==="yr"||v==="y"?315576e5*y:v==="weeks"||v==="week"||v==="w"?6048e5*y:v==="days"||v==="day"||v==="d"?864e5*y:v==="hours"||v==="hour"||v==="hrs"||v==="hr"||v==="h"?36e5*y:v==="minutes"||v==="minute"||v==="mins"||v==="min"||v==="m"?6e4*y:v==="seconds"||v==="second"||v==="secs"||v==="sec"||v==="s"?1e3*y:v==="milliseconds"||v==="millisecond"||v==="msecs"||v==="msec"||v==="ms"?y:void 0}}}function g(f){var p=r(f);return 864e5<=p?l(f/864e5)+"d":36e5<=p?l(f/36e5)+"h":6e4<=p?l(f/6e4)+"m":1e3<=p?l(f/1e3)+"s":f+"ms"}function b(f){var p=r(f);return 864e5<=p?h(f,p,864e5,"day"):36e5<=p?h(f,p,36e5,"hour"):6e4<=p?h(f,p,6e4,"minute"):1e3<=p?h(f,p,1e3,"second"):f+" ms"}function h(f,p,y,v){return l(f/y)+" "+v+(p>=1.5*y?"s":"")}a.exports=function(f,p){p=p||{};var y=typeof f;if(y=="string"&&0<f.length)return u(f);if(y==="number"&&isFinite(f))return p.long?b(f):g(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],12:[function(o,a){function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function g(R){if(v===setTimeout)return setTimeout(R,0);if((v===l||!v)&&setTimeout)return v=setTimeout,setTimeout(R,0);try{return v(R,0)}catch{try{return v.call(null,R,0)}catch{return v.call(this,R,0)}}}function b(R){if(L===clearTimeout)return clearTimeout(R);if((L===u||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(R);try{return L(R)}catch{try{return L.call(null,R)}catch{return L.call(this,R)}}}function h(){_&&I&&(_=!1,I.length?w=I.concat(w):C=-1,w.length&&f())}function f(){if(!_){var R=g(h);_=!0;for(var S=w.length;S;){for(I=w,w=[];++C<S;)I&&I[C].run();C=-1,S=w.length}I=null,_=!1,b(R)}}function p(R,S){this.fun=R,this.array=S}function y(){}var v,L,T=a.exports={};(function(){try{v=typeof setTimeout=="function"?setTimeout:l}catch{v=l}try{L=typeof clearTimeout=="function"?clearTimeout:u}catch{L=u}})();var I,w=[],_=!1,C=-1;T.nextTick=function(R){var S=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)S[A-1]=arguments[A];w.push(new p(R,S)),w.length!==1||_||g(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=y,T.addListener=y,T.once=y,T.off=y,T.removeListener=y,T.removeAllListeners=y,T.emit=y,T.prependListener=y,T.prependOnceListener=y,T.listeners=function(){return[]},T.binding=function(){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(){throw new Error("process.chdir is not supported")},T.umask=function(){return 0}},{}],13:[function(o,a){(function(l){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let u;a.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?l:window):g=>(u||(u=Promise.resolve())).then(g).catch(b=>setTimeout(()=>{throw b},0))}).call(this)}).call(this,typeof Jt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Jt)},{}],14:[function(o,a){(function(l,u){(function(){var g=o("safe-buffer").Buffer,b=u.crypto||u.msCrypto;a.exports=b&&b.getRandomValues?function(h,f){if(h>4294967295)throw new RangeError("requested too many random bytes");var p=g.allocUnsafe(h);if(0<h)if(65536<h)for(var y=0;y<h;y+=65536)b.getRandomValues(p.slice(y,y+65536));else b.getRandomValues(p);return typeof f=="function"?l.nextTick(function(){f(null,p)}):p}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,o("_process"),typeof Jt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Jt)},{_process:12,"safe-buffer":30}],15:[function(o,a){function l(y,v){y.prototype=Object.create(v.prototype),y.prototype.constructor=y,y.__proto__=v}function u(y,v,L){function T(w,_,C){return typeof v=="string"?v:v(w,_,C)}L||(L=Error);var I=function(w){function _(C,R,S){return w.call(this,T(C,R,S))||this}return l(_,w),_}(L);I.prototype.name=L.name,I.prototype.code=y,p[y]=I}function g(y,v){if(Array.isArray(y)){var L=y.length;return y=y.map(function(T){return T+""}),2<L?"one of ".concat(v," ").concat(y.slice(0,L-1).join(", "),", or ")+y[L-1]:L===2?"one of ".concat(v," ").concat(y[0]," or ").concat(y[1]):"of ".concat(v," ").concat(y[0])}return"of ".concat(v," ").concat(y+"")}function b(y,v,L){return y.substr(!L||0>L?0:+L,v.length)===v}function h(y,v,L){return(L===void 0||L>y.length)&&(L=y.length),y.substring(L-v.length,L)===v}function f(y,v,L){return typeof L!="number"&&(L=0),!(L+v.length>y.length)&&y.indexOf(v,L)!==-1}var p={};u("ERR_INVALID_OPT_VALUE",function(y,v){return'The value "'+v+'" is invalid for option "'+y+'"'},TypeError),u("ERR_INVALID_ARG_TYPE",function(y,v,L){var T;typeof v=="string"&&b(v,"not ")?(T="must not be",v=v.replace(/^not /,"")):T="must be";var I;if(h(y," argument"))I="The ".concat(y," ").concat(T," ").concat(g(v,"type"));else{var w=f(y,".")?"property":"argument";I='The "'.concat(y,'" ').concat(w," ").concat(T," ").concat(g(v,"type"))}return I+=". Received type ".concat(typeof L),I},TypeError),u("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),u("ERR_METHOD_NOT_IMPLEMENTED",function(y){return"The "+y+" method is not implemented"}),u("ERR_STREAM_PREMATURE_CLOSE","Premature close"),u("ERR_STREAM_DESTROYED",function(y){return"Cannot call "+y+" after a stream was destroyed"}),u("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),u("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),u("ERR_STREAM_WRITE_AFTER_END","write after end"),u("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),u("ERR_UNKNOWN_ENCODING",function(y){return"Unknown encoding: "+y},TypeError),u("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=p},{}],16:[function(o,a){(function(l){(function(){function u(T){return this instanceof u?(f.call(this,T),p.call(this,T),this.allowHalfOpen=!0,void(T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",g))))):new u(T)}function g(){this._writableState.ended||l.nextTick(b,this)}function b(T){T.end()}var h=Object.keys||function(T){var I=[];for(var w in T)I.push(w);return I};a.exports=u;var f=o("./_stream_readable"),p=o("./_stream_writable");o("inherits")(u,f);for(var y,v=h(p.prototype),L=0;L<v.length;L++)y=v[L],u.prototype[y]||(u.prototype[y]=p.prototype[y]);Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(T){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=T,this._writableState.destroyed=T)}})}).call(this)}).call(this,o("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(o,a){function l(g){return this instanceof l?void u.call(this,g):new l(g)}a.exports=l;var u=o("./_stream_transform");o("inherits")(l,u),l.prototype._transform=function(g,b,h){h(null,g)}},{"./_stream_transform":19,inherits:10}],18:[function(o,a){(function(l,u){(function(){function g(m){return Ct.from(m)}function b(m){return Ct.isBuffer(m)||m instanceof nt}function h(m,i,c){return typeof m.prependListener=="function"?m.prependListener(i,c):void(m._events&&m._events[i]?Array.isArray(m._events[i])?m._events[i].unshift(c):m._events[i]=[c,m._events[i]]:m.on(i,c))}function f(m,i,c){mt=mt||o("./_stream_duplex"),m=m||{},typeof c!="boolean"&&(c=i instanceof mt),this.objectMode=!!m.objectMode,c&&(this.objectMode=this.objectMode||!!m.readableObjectMode),this.highWaterMark=oe(this,m,"readableHighWaterMark",c),this.buffer=new pe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=m.emitClose!==!1,this.autoDestroy=!!m.autoDestroy,this.destroyed=!1,this.defaultEncoding=m.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,m.encoding&&(!Rt&&(Rt=o("string_decoder/").StringDecoder),this.decoder=new Rt(m.encoding),this.encoding=m.encoding)}function p(m){if(mt=mt||o("./_stream_duplex"),!(this instanceof p))return new p(m);var i=this instanceof mt;this._readableState=new f(m,this,i),this.readable=!0,m&&(typeof m.read=="function"&&(this._read=m.read),typeof m.destroy=="function"&&(this._destroy=m.destroy)),kt.call(this)}function y(m,i,c,d,E){H("readableAddChunk",i);var x=m._readableState;if(i===null)x.reading=!1,w(m,x);else{var N;if(E||(N=L(x,i)),N)j(m,N);else if(!(x.objectMode||i&&0<i.length))d||(x.reading=!1,R(m,x));else if(typeof i=="string"||x.objectMode||Object.getPrototypeOf(i)===Ct.prototype||(i=g(i)),d)x.endEmitted?j(m,new M):v(m,x,i,!0);else if(x.ended)j(m,new ut);else{if(x.destroyed)return!1;x.reading=!1,x.decoder&&!c?(i=x.decoder.write(i),x.objectMode||i.length!==0?v(m,x,i,!1):R(m,x)):v(m,x,i,!1)}}return!x.ended&&(x.length<x.highWaterMark||x.length===0)}function v(m,i,c,d){i.flowing&&i.length===0&&!i.sync?(i.awaitDrain=0,m.emit("data",c)):(i.length+=i.objectMode?1:c.length,d?i.buffer.unshift(c):i.buffer.push(c),i.needReadable&&_(m)),R(m,i)}function L(m,i){var c;return b(i)||typeof i=="string"||i===void 0||m.objectMode||(c=new Dt("chunk",["string","Buffer","Uint8Array"],i)),c}function T(m){return 1073741824<=m?m=1073741824:(m--,m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,m|=m>>>16,m++),m}function I(m,i){return 0>=m||i.length===0&&i.ended?0:i.objectMode?1:m===m?(m>i.highWaterMark&&(i.highWaterMark=T(m)),m<=i.length?m:i.ended?i.length:(i.needReadable=!0,0)):i.flowing&&i.length?i.buffer.head.data.length:i.length}function w(m,i){if(H("onEofChunk"),!i.ended){if(i.decoder){var c=i.decoder.end();c&&c.length&&(i.buffer.push(c),i.length+=i.objectMode?1:c.length)}i.ended=!0,i.sync?_(m):(i.needReadable=!1,!i.emittedReadable&&(i.emittedReadable=!0,C(m)))}}function _(m){var i=m._readableState;H("emitReadable",i.needReadable,i.emittedReadable),i.needReadable=!1,i.emittedReadable||(H("emitReadable",i.flowing),i.emittedReadable=!0,l.nextTick(C,m))}function C(m){var i=m._readableState;H("emitReadable_",i.destroyed,i.length,i.ended),!i.destroyed&&(i.length||i.ended)&&(m.emit("readable"),i.emittedReadable=!1),i.needReadable=!i.flowing&&!i.ended&&i.length<=i.highWaterMark,P(m)}function R(m,i){i.readingMore||(i.readingMore=!0,l.nextTick(S,m,i))}function S(m,i){for(;!i.reading&&!i.ended&&(i.length<i.highWaterMark||i.flowing&&i.length===0);){var c=i.length;if(H("maybeReadMore read 0"),m.read(0),c===i.length)break}i.readingMore=!1}function A(m){return function(){var i=m._readableState;H("pipeOnDrain",i.awaitDrain),i.awaitDrain&&i.awaitDrain--,i.awaitDrain===0&&Ht(m,"data")&&(i.flowing=!0,P(m))}}function U(m){var i=m._readableState;i.readableListening=0<m.listenerCount("readable"),i.resumeScheduled&&!i.paused?i.flowing=!0:0<m.listenerCount("data")&&m.resume()}function k(m){H("readable nexttick read 0"),m.read(0)}function D(m,i){i.resumeScheduled||(i.resumeScheduled=!0,l.nextTick(B,m,i))}function B(m,i){H("resume",i.reading),i.reading||m.read(0),i.resumeScheduled=!1,m.emit("resume"),P(m),i.flowing&&!i.reading&&m.read(0)}function P(m){var i=m._readableState;for(H("flow",i.flowing);i.flowing&&m.read()!==null;);}function z(m,i){if(i.length===0)return null;var c;return i.objectMode?c=i.buffer.shift():!m||m>=i.length?(c=i.decoder?i.buffer.join(""):i.buffer.length===1?i.buffer.first():i.buffer.concat(i.length),i.buffer.clear()):c=i.buffer.consume(m,i.decoder),c}function G(m){var i=m._readableState;H("endReadable",i.endEmitted),i.endEmitted||(i.ended=!0,l.nextTick(X,i,m))}function X(m,i){if(H("endReadableNT",m.endEmitted,m.length),!m.endEmitted&&m.length===0&&(m.endEmitted=!0,i.readable=!1,i.emit("end"),m.autoDestroy)){var c=i._writableState;(!c||c.autoDestroy&&c.finished)&&i.destroy()}}function et(m,i){for(var c=0,d=m.length;c<d;c++)if(m[c]===i)return c;return-1}a.exports=p;var mt;p.ReadableState=f;var H;o("events").EventEmitter;var Ht=function(m,i){return m.listeners(i).length},kt=o("./internal/streams/stream"),Ct=o("buffer").Buffer,nt=u.Uint8Array||function(){},Q=o("util");H=Q&&Q.debuglog?Q.debuglog("stream"):function(){};var Rt,ct,jt,pe=o("./internal/streams/buffer_list"),$t=o("./internal/streams/destroy"),lt=o("./internal/streams/state"),oe=lt.getHighWaterMark,St=o("../errors").codes,Dt=St.ERR_INVALID_ARG_TYPE,ut=St.ERR_STREAM_PUSH_AFTER_EOF,O=St.ERR_METHOD_NOT_IMPLEMENTED,M=St.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("inherits")(p,kt);var j=$t.errorOrDestroy,W=["error","close","destroy","pause","resume"];Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(m){this._readableState&&(this._readableState.destroyed=m)}}),p.prototype.destroy=$t.destroy,p.prototype._undestroy=$t.undestroy,p.prototype._destroy=function(m,i){i(m)},p.prototype.push=function(m,i){var c,d=this._readableState;return d.objectMode?c=!0:typeof m=="string"&&(i=i||d.defaultEncoding,i!==d.encoding&&(m=Ct.from(m,i),i=""),c=!0),y(this,m,i,!1,c)},p.prototype.unshift=function(m){return y(this,m,null,!0,!1)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(m){Rt||(Rt=o("string_decoder/").StringDecoder);var i=new Rt(m);this._readableState.decoder=i,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,d="";c!==null;)d+=i.write(c.data),c=c.next;return this._readableState.buffer.clear(),d!==""&&this._readableState.buffer.push(d),this._readableState.length=d.length,this},p.prototype.read=function(m){H("read",m),m=parseInt(m,10);var i=this._readableState,c=m;if(m!==0&&(i.emittedReadable=!1),m===0&&i.needReadable&&((i.highWaterMark===0?0<i.length:i.length>=i.highWaterMark)||i.ended))return H("read: emitReadable",i.length,i.ended),i.length===0&&i.ended?G(this):_(this),null;if(m=I(m,i),m===0&&i.ended)return i.length===0&&G(this),null;var d=i.needReadable;H("need readable",d),(i.length===0||i.length-m<i.highWaterMark)&&(d=!0,H("length less than watermark",d)),i.ended||i.reading?(d=!1,H("reading or ended",d)):d&&(H("do read"),i.reading=!0,i.sync=!0,i.length===0&&(i.needReadable=!0),this._read(i.highWaterMark),i.sync=!1,!i.reading&&(m=I(c,i)));var E;return E=0<m?z(m,i):null,E===null?(i.needReadable=i.length<=i.highWaterMark,m=0):(i.length-=m,i.awaitDrain=0),i.length===0&&(!i.ended&&(i.needReadable=!0),c!==m&&i.ended&&G(this)),E!==null&&this.emit("data",E),E},p.prototype._read=function(){j(this,new O("_read()"))},p.prototype.pipe=function(m,i){function c(ae,be){H("onunpipe"),ae===J&&be&&be.hasUnpiped===!1&&(be.hasUnpiped=!0,E())}function d(){H("onend"),m.end()}function E(){H("cleanup"),m.removeListener("close",V),m.removeListener("finish",$),m.removeListener("drain",ye),m.removeListener("error",N),m.removeListener("unpipe",c),J.removeListener("end",d),J.removeListener("end",tt),J.removeListener("data",x),ke=!0,K.awaitDrain&&(!m._writableState||m._writableState.needDrain)&&ye()}function x(ae){H("ondata");var be=m.write(ae);H("dest.write",be),be===!1&&((K.pipesCount===1&&K.pipes===m||1<K.pipesCount&&et(K.pipes,m)!==-1)&&!ke&&(H("false write response, pause",K.awaitDrain),K.awaitDrain++),J.pause())}function N(ae){H("onerror",ae),tt(),m.removeListener("error",N),Ht(m,"error")===0&&j(m,ae)}function V(){m.removeListener("finish",$),tt()}function $(){H("onfinish"),m.removeListener("close",V),tt()}function tt(){H("unpipe"),J.unpipe(m)}var J=this,K=this._readableState;switch(K.pipesCount){case 0:K.pipes=m;break;case 1:K.pipes=[K.pipes,m];break;default:K.pipes.push(m)}K.pipesCount+=1,H("pipe count=%d opts=%j",K.pipesCount,i);var rt=(!i||i.end!==!1)&&m!==l.stdout&&m!==l.stderr,Yt=rt?d:tt;K.endEmitted?l.nextTick(Yt):J.once("end",Yt),m.on("unpipe",c);var ye=A(J);m.on("drain",ye);var ke=!1;return J.on("data",x),h(m,"error",N),m.once("close",V),m.once("finish",$),m.emit("pipe",J),K.flowing||(H("pipe resume"),J.resume()),m},p.prototype.unpipe=function(m){var i=this._readableState,c={hasUnpiped:!1};if(i.pipesCount===0)return this;if(i.pipesCount===1)return m&&m!==i.pipes?this:(m||(m=i.pipes),i.pipes=null,i.pipesCount=0,i.flowing=!1,m&&m.emit("unpipe",this,c),this);if(!m){var d=i.pipes,E=i.pipesCount;i.pipes=null,i.pipesCount=0,i.flowing=!1;for(var x=0;x<E;x++)d[x].emit("unpipe",this,{hasUnpiped:!1});return this}var N=et(i.pipes,m);return N===-1?this:(i.pipes.splice(N,1),i.pipesCount-=1,i.pipesCount===1&&(i.pipes=i.pipes[0]),m.emit("unpipe",this,c),this)},p.prototype.on=function(m,i){var c=kt.prototype.on.call(this,m,i),d=this._readableState;return m==="data"?(d.readableListening=0<this.listenerCount("readable"),d.flowing!==!1&&this.resume()):m=="readable"&&!d.endEmitted&&!d.readableListening&&(d.readableListening=d.needReadable=!0,d.flowing=!1,d.emittedReadable=!1,H("on readable",d.length,d.reading),d.length?_(this):!d.reading&&l.nextTick(k,this)),c},p.prototype.addListener=p.prototype.on,p.prototype.removeListener=function(m,i){var c=kt.prototype.removeListener.call(this,m,i);return m==="readable"&&l.nextTick(U,this),c},p.prototype.removeAllListeners=function(m){var i=kt.prototype.removeAllListeners.apply(this,arguments);return(m==="readable"||m===void 0)&&l.nextTick(U,this),i},p.prototype.resume=function(){var m=this._readableState;return m.flowing||(H("resume"),m.flowing=!m.readableListening,D(this,m)),m.paused=!1,this},p.prototype.pause=function(){return H("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(H("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},p.prototype.wrap=function(m){var i=this,c=this._readableState,d=!1;for(var E in m.on("end",function(){if(H("wrapped end"),c.decoder&&!c.ended){var N=c.decoder.end();N&&N.length&&i.push(N)}i.push(null)}),m.on("data",function(N){if(H("wrapped data"),c.decoder&&(N=c.decoder.write(N)),!(c.objectMode&&N==null)&&(c.objectMode||N&&N.length)){var V=i.push(N);V||(d=!0,m.pause())}}),m)this[E]===void 0&&typeof m[E]=="function"&&(this[E]=function(N){return function(){return m[N].apply(m,arguments)}}(E));for(var x=0;x<W.length;x++)m.on(W[x],this.emit.bind(this,W[x]));return this._read=function(N){H("wrapped _read",N),d&&(d=!1,m.resume())},this},typeof Symbol=="function"&&(p.prototype[Symbol.asyncIterator]=function(){return ct===void 0&&(ct=o("./internal/streams/async_iterator")),ct(this)}),Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(p.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(p.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(m){this._readableState&&(this._readableState.flowing=m)}}),p._fromList=z,Object.defineProperty(p.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(p.from=function(m,i){return jt===void 0&&(jt=o("./internal/streams/from")),jt(p,m,i)})}).call(this)}).call(this,o("_process"),typeof Jt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Jt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(o,a){function l(T,I){var w=this._transformState;w.transforming=!1;var _=w.writecb;if(_===null)return this.emit("error",new p);w.writechunk=null,w.writecb=null,I!=null&&this.push(I),_(T);var C=this._readableState;C.reading=!1,(C.needReadable||C.length<C.highWaterMark)&&this._read(C.highWaterMark)}function u(T){return this instanceof u?(L.call(this,T),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,T&&(typeof T.transform=="function"&&(this._transform=T.transform),typeof T.flush=="function"&&(this._flush=T.flush)),void this.on("prefinish",g)):new u(T)}function g(){var T=this;typeof this._flush!="function"||this._readableState.destroyed?b(this,null,null):this._flush(function(I,w){b(T,I,w)})}function b(T,I,w){if(I)return T.emit("error",I);if(w!=null&&T.push(w),T._writableState.length)throw new v;if(T._transformState.transforming)throw new y;return T.push(null)}a.exports=u;var h=o("../errors").codes,f=h.ERR_METHOD_NOT_IMPLEMENTED,p=h.ERR_MULTIPLE_CALLBACK,y=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,v=h.ERR_TRANSFORM_WITH_LENGTH_0,L=o("./_stream_duplex");o("inherits")(u,L),u.prototype.push=function(T,I){return this._transformState.needTransform=!1,L.prototype.push.call(this,T,I)},u.prototype._transform=function(T,I,w){w(new f("_transform()"))},u.prototype._write=function(T,I,w){var _=this._transformState;if(_.writecb=w,_.writechunk=T,_.writeencoding=I,!_.transforming){var C=this._readableState;(_.needTransform||C.needReadable||C.length<C.highWaterMark)&&this._read(C.highWaterMark)}},u.prototype._read=function(){var T=this._transformState;T.writechunk===null||T.transforming?T.needTransform=!0:(T.transforming=!0,this._transform(T.writechunk,T.writeencoding,T.afterTransform))},u.prototype._destroy=function(T,I){L.prototype._destroy.call(this,T,function(w){I(w)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(o,a){(function(l,u){(function(){function g(O){var M=this;this.next=null,this.entry=null,this.finish=function(){G(M,O)}}function b(O){return H.from(O)}function h(O){return H.isBuffer(O)||O instanceof Ht}function f(){}function p(O,M,j){X=X||o("./_stream_duplex"),O=O||{},typeof j!="boolean"&&(j=M instanceof X),this.objectMode=!!O.objectMode,j&&(this.objectMode=this.objectMode||!!O.writableObjectMode),this.highWaterMark=nt(this,O,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var W=O.decodeStrings===!1;this.decodeStrings=!W,this.defaultEncoding=O.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(m){R(M,m)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function y(O){X=X||o("./_stream_duplex");var M=this instanceof X;return M||ut.call(y,this)?(this._writableState=new p(O,this,M),this.writable=!0,O&&(typeof O.write=="function"&&(this._write=O.write),typeof O.writev=="function"&&(this._writev=O.writev),typeof O.destroy=="function"&&(this._destroy=O.destroy),typeof O.final=="function"&&(this._final=O.final)),void mt.call(this)):new y(O)}function v(O,M){var j=new oe;Dt(O,j),l.nextTick(M,j)}function L(O,M,j,W){var m;return j===null?m=new lt:typeof j!="string"&&!M.objectMode&&(m=new Rt("chunk",["string","Buffer"],j)),!m||(Dt(O,m),l.nextTick(W,m),!1)}function T(O,M,j){return O.objectMode||O.decodeStrings===!1||typeof M!="string"||(M=H.from(M,j)),M}function I(O,M,j,W,m,i){if(!j){var c=T(M,W,m);W!==c&&(j=!0,m="buffer",W=c)}var d=M.objectMode?1:W.length;M.length+=d;var E=M.length<M.highWaterMark;if(E||(M.needDrain=!0),M.writing||M.corked){var x=M.lastBufferedRequest;M.lastBufferedRequest={chunk:W,encoding:m,isBuf:j,callback:i,next:null},x?x.next=M.lastBufferedRequest:M.bufferedRequest=M.lastBufferedRequest,M.bufferedRequestCount+=1}else w(O,M,!1,d,W,m,i);return E}function w(O,M,j,W,m,i,c){M.writelen=W,M.writecb=c,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new $t("write")):j?O._writev(m,M.onwrite):O._write(m,i,M.onwrite),M.sync=!1}function _(O,M,j,W,m){--M.pendingcb,j?(l.nextTick(m,W),l.nextTick(P,O,M),O._writableState.errorEmitted=!0,Dt(O,W)):(m(W),O._writableState.errorEmitted=!0,Dt(O,W),P(O,M))}function C(O){O.writing=!1,O.writecb=null,O.length-=O.writelen,O.writelen=0}function R(O,M){var j=O._writableState,W=j.sync,m=j.writecb;if(typeof m!="function")throw new jt;if(C(j),M)_(O,j,W,M,m);else{var i=k(j)||O.destroyed;i||j.corked||j.bufferProcessing||!j.bufferedRequest||U(O,j),W?l.nextTick(S,O,j,i,m):S(O,j,i,m)}}function S(O,M,j,W){j||A(O,M),M.pendingcb--,W(),P(O,M)}function A(O,M){M.length===0&&M.needDrain&&(M.needDrain=!1,O.emit("drain"))}function U(O,M){M.bufferProcessing=!0;var j=M.bufferedRequest;if(O._writev&&j&&j.next){var W=M.bufferedRequestCount,m=Array(W),i=M.corkedRequestsFree;i.entry=j;for(var c=0,d=!0;j;)m[c]=j,j.isBuf||(d=!1),j=j.next,c+=1;m.allBuffers=d,w(O,M,!0,M.length,m,"",i.finish),M.pendingcb++,M.lastBufferedRequest=null,i.next?(M.corkedRequestsFree=i.next,i.next=null):M.corkedRequestsFree=new g(M),M.bufferedRequestCount=0}else{for(;j;){var E=j.chunk,x=j.encoding,N=j.callback,V=M.objectMode?1:E.length;if(w(O,M,!1,V,E,x,N),j=j.next,M.bufferedRequestCount--,M.writing)break}j===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=j,M.bufferProcessing=!1}function k(O){return O.ending&&O.length===0&&O.bufferedRequest===null&&!O.finished&&!O.writing}function D(O,M){O._final(function(j){M.pendingcb--,j&&Dt(O,j),M.prefinished=!0,O.emit("prefinish"),P(O,M)})}function B(O,M){M.prefinished||M.finalCalled||(typeof O._final!="function"||M.destroyed?(M.prefinished=!0,O.emit("prefinish")):(M.pendingcb++,M.finalCalled=!0,l.nextTick(D,O,M)))}function P(O,M){var j=k(M);if(j&&(B(O,M),M.pendingcb===0&&(M.finished=!0,O.emit("finish"),M.autoDestroy))){var W=O._readableState;(!W||W.autoDestroy&&W.endEmitted)&&O.destroy()}return j}function z(O,M,j){M.ending=!0,P(O,M),j&&(M.finished?l.nextTick(j):O.once("finish",j)),M.ended=!0,O.writable=!1}function G(O,M,j){var W=O.entry;for(O.entry=null;W;){var m=W.callback;M.pendingcb--,m(j),W=W.next}M.corkedRequestsFree.next=O}a.exports=y;var X;y.WritableState=p;var et={deprecate:o("util-deprecate")},mt=o("./internal/streams/stream"),H=o("buffer").Buffer,Ht=u.Uint8Array||function(){},kt=o("./internal/streams/destroy"),Ct=o("./internal/streams/state"),nt=Ct.getHighWaterMark,Q=o("../errors").codes,Rt=Q.ERR_INVALID_ARG_TYPE,ct=Q.ERR_METHOD_NOT_IMPLEMENTED,jt=Q.ERR_MULTIPLE_CALLBACK,pe=Q.ERR_STREAM_CANNOT_PIPE,$t=Q.ERR_STREAM_DESTROYED,lt=Q.ERR_STREAM_NULL_VALUES,oe=Q.ERR_STREAM_WRITE_AFTER_END,St=Q.ERR_UNKNOWN_ENCODING,Dt=kt.errorOrDestroy;o("inherits")(y,mt),p.prototype.getBuffer=function(){for(var O=this.bufferedRequest,M=[];O;)M.push(O),O=O.next;return M},function(){try{Object.defineProperty(p.prototype,"buffer",{get:et.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var ut;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ut=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(O){return!!ut.call(this,O)||this===y&&O&&O._writableState instanceof p}})):ut=function(O){return O instanceof this},y.prototype.pipe=function(){Dt(this,new pe)},y.prototype.write=function(O,M,j){var W=this._writableState,m=!1,i=!W.objectMode&&h(O);return i&&!H.isBuffer(O)&&(O=b(O)),typeof M=="function"&&(j=M,M=null),i?M="buffer":!M&&(M=W.defaultEncoding),typeof j!="function"&&(j=f),W.ending?v(this,j):(i||L(this,W,O,j))&&(W.pendingcb++,m=I(this,W,i,O,M,j)),m},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var O=this._writableState;O.corked&&(O.corked--,!O.writing&&!O.corked&&!O.bufferProcessing&&O.bufferedRequest&&U(this,O))},y.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())))throw new St(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(y.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(O,M,j){j(new ct("_write()"))},y.prototype._writev=null,y.prototype.end=function(O,M,j){var W=this._writableState;return typeof O=="function"?(j=O,O=null,M=null):typeof M=="function"&&(j=M,M=null),O!=null&&this.write(O,M),W.corked&&(W.corked=1,this.uncork()),W.ending||z(this,W,j),this},Object.defineProperty(y.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(y.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),y.prototype.destroy=kt.destroy,y.prototype._undestroy=kt.undestroy,y.prototype._destroy=function(O,M){M(O)}}).call(this)}).call(this,o("_process"),typeof Jt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Jt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(o,a){(function(l){(function(){function u(A,U,k){return U in A?Object.defineProperty(A,U,{value:k,enumerable:!0,configurable:!0,writable:!0}):A[U]=k,A}function g(A,U){return{value:A,done:U}}function b(A){var U=A[v];if(U!==null){var k=A[C].read();k!==null&&(A[w]=null,A[v]=null,A[L]=null,U(g(k,!1)))}}function h(A){l.nextTick(b,A)}function f(A,U){return function(k,D){A.then(function(){return U[I]?void k(g(void 0,!0)):void U[_](k,D)},D)}}var p,y=o("./end-of-stream"),v=Symbol("lastResolve"),L=Symbol("lastReject"),T=Symbol("error"),I=Symbol("ended"),w=Symbol("lastPromise"),_=Symbol("handlePromise"),C=Symbol("stream"),R=Object.getPrototypeOf(function(){}),S=Object.setPrototypeOf((p={get stream(){return this[C]},next:function(){var A=this,U=this[T];if(U!==null)return Promise.reject(U);if(this[I])return Promise.resolve(g(void 0,!0));if(this[C].destroyed)return new Promise(function(P,z){l.nextTick(function(){A[T]?z(A[T]):P(g(void 0,!0))})});var k,D=this[w];if(D)k=new Promise(f(D,this));else{var B=this[C].read();if(B!==null)return Promise.resolve(g(B,!1));k=new Promise(this[_])}return this[w]=k,k}},u(p,Symbol.asyncIterator,function(){return this}),u(p,"return",function(){var A=this;return new Promise(function(U,k){A[C].destroy(null,function(D){return D?void k(D):void U(g(void 0,!0))})})}),p),R);a.exports=function(A){var U,k=Object.create(S,(U={},u(U,C,{value:A,writable:!0}),u(U,v,{value:null,writable:!0}),u(U,L,{value:null,writable:!0}),u(U,T,{value:null,writable:!0}),u(U,I,{value:A._readableState.endEmitted,writable:!0}),u(U,_,{value:function(D,B){var P=k[C].read();P?(k[w]=null,k[v]=null,k[L]=null,D(g(P,!1))):(k[v]=D,k[L]=B)},writable:!0}),U));return k[w]=null,y(A,function(D){if(D&&D.code!=="ERR_STREAM_PREMATURE_CLOSE"){var B=k[L];return B!==null&&(k[w]=null,k[v]=null,k[L]=null,B(D)),void(k[T]=D)}var P=k[v];P!==null&&(k[w]=null,k[v]=null,k[L]=null,P(g(void 0,!0))),k[I]=!0}),A.on("readable",h.bind(null,k)),k}}).call(this)}).call(this,o("_process"))},{"./end-of-stream":24,_process:12}],22:[function(o,a){function l(w,_){var C=Object.keys(w);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(w);_&&(R=R.filter(function(S){return Object.getOwnPropertyDescriptor(w,S).enumerable})),C.push.apply(C,R)}return C}function u(w){for(var _,C=1;C<arguments.length;C++)_=arguments[C]==null?{}:arguments[C],C%2?l(Object(_),!0).forEach(function(R){g(w,R,_[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(_)):l(Object(_)).forEach(function(R){Object.defineProperty(w,R,Object.getOwnPropertyDescriptor(_,R))});return w}function g(w,_,C){return _ in w?Object.defineProperty(w,_,{value:C,enumerable:!0,configurable:!0,writable:!0}):w[_]=C,w}function b(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}function h(w,_){for(var C,R=0;R<_.length;R++)C=_[R],C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(w,C.key,C)}function f(w,_,C){return _&&h(w.prototype,_),C&&h(w,C),w}function p(w,_,C){v.prototype.copy.call(w,_,C)}var y=o("buffer"),v=y.Buffer,L=o("util"),T=L.inspect,I=T&&T.custom||"inspect";a.exports=function(){function w(){b(this,w),this.head=null,this.tail=null,this.length=0}return f(w,[{key:"push",value:function(_){var C={data:_,next:null};0<this.length?this.tail.next=C:this.head=C,this.tail=C,++this.length}},{key:"unshift",value:function(_){var C={data:_,next:this.head};this.length===0&&(this.tail=C),this.head=C,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var C=this.head,R=""+C.data;C=C.next;)R+=_+C.data;return R}},{key:"concat",value:function(_){if(this.length===0)return v.alloc(0);for(var C=v.allocUnsafe(_>>>0),R=this.head,S=0;R;)p(R.data,C,S),S+=R.data.length,R=R.next;return C}},{key:"consume",value:function(_,C){var R;return _<this.head.data.length?(R=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?R=this.shift():R=C?this._getString(_):this._getBuffer(_),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var C=this.head,R=1,S=C.data;for(_-=S.length;C=C.next;){var A=C.data,U=_>A.length?A.length:_;if(S+=U===A.length?A:A.slice(0,_),_-=U,_===0){U===A.length?(++R,this.head=C.next?C.next:this.tail=null):(this.head=C,C.data=A.slice(U));break}++R}return this.length-=R,S}},{key:"_getBuffer",value:function(_){var C=v.allocUnsafe(_),R=this.head,S=1;for(R.data.copy(C),_-=R.data.length;R=R.next;){var A=R.data,U=_>A.length?A.length:_;if(A.copy(C,C.length-_,0,U),_-=U,_===0){U===A.length?(++S,this.head=R.next?R.next:this.tail=null):(this.head=R,R.data=A.slice(U));break}++S}return this.length-=S,C}},{key:I,value:function(_,C){return T(this,u({},C,{depth:0,customInspect:!1}))}}]),w}()},{buffer:3,util:2}],23:[function(o,a){(function(l){(function(){function u(h,f){b(h,f),g(h)}function g(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function b(h,f){h.emit("error",f)}a.exports={destroy:function(h,f){var p=this,y=this._readableState&&this._readableState.destroyed,v=this._writableState&&this._writableState.destroyed;return y||v?(f?f(h):h&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,l.nextTick(b,this,h)):l.nextTick(b,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(L){!f&&L?p._writableState?p._writableState.errorEmitted?l.nextTick(g,p):(p._writableState.errorEmitted=!0,l.nextTick(u,p,L)):l.nextTick(u,p,L):f?(l.nextTick(g,p),f(L)):l.nextTick(g,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,f){var p=h._readableState,y=h._writableState;p&&p.autoDestroy||y&&y.autoDestroy?h.destroy(f):h.emit("error",f)}}}).call(this)}).call(this,o("_process"))},{_process:12}],24:[function(o,a){function l(f){var p=!1;return function(){if(!p){p=!0;for(var y=arguments.length,v=Array(y),L=0;L<y;L++)v[L]=arguments[L];f.apply(this,v)}}}function u(){}function g(f){return f.setHeader&&typeof f.abort=="function"}function b(f,p,y){if(typeof p=="function")return b(f,null,p);p||(p={}),y=l(y||u);var v=p.readable||p.readable!==!1&&f.readable,L=p.writable||p.writable!==!1&&f.writable,T=function(){f.writable||w()},I=f._writableState&&f._writableState.finished,w=function(){L=!1,I=!0,v||y.call(f)},_=f._readableState&&f._readableState.endEmitted,C=function(){v=!1,_=!0,L||y.call(f)},R=function(U){y.call(f,U)},S=function(){var U;return v&&!_?(f._readableState&&f._readableState.ended||(U=new h),y.call(f,U)):L&&!I?(f._writableState&&f._writableState.ended||(U=new h),y.call(f,U)):void 0},A=function(){f.req.on("finish",w)};return g(f)?(f.on("complete",w),f.on("abort",S),f.req?A():f.on("request",A)):L&&!f._writableState&&(f.on("end",T),f.on("close",T)),f.on("end",C),f.on("finish",w),p.error!==!1&&f.on("error",R),f.on("close",S),function(){f.removeListener("complete",w),f.removeListener("abort",S),f.removeListener("request",A),f.req&&f.req.removeListener("finish",w),f.removeListener("end",T),f.removeListener("close",T),f.removeListener("finish",w),f.removeListener("end",C),f.removeListener("error",R),f.removeListener("close",S)}}var h=o("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;a.exports=b},{"../../../errors":15}],25:[function(o,a){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(o,a){function l(I){var w=!1;return function(){w||(w=!0,I.apply(void 0,arguments))}}function u(I){if(I)throw I}function g(I){return I.setHeader&&typeof I.abort=="function"}function b(I,w,_,C){C=l(C);var R=!1;I.on("close",function(){R=!0}),y===void 0&&(y=o("./end-of-stream")),y(I,{readable:w,writable:_},function(A){return A?C(A):(R=!0,void C())});var S=!1;return function(A){if(!R)return S?void 0:(S=!0,g(I)?I.abort():typeof I.destroy=="function"?I.destroy():void C(A||new T("pipe")))}}function h(I){I()}function f(I,w){return I.pipe(w)}function p(I){return I.length&&typeof I[I.length-1]=="function"?I.pop():u}var y,v=o("../../../errors").codes,L=v.ERR_MISSING_ARGS,T=v.ERR_STREAM_DESTROYED;a.exports=function(){for(var I=arguments.length,w=Array(I),_=0;_<I;_++)w[_]=arguments[_];var C=p(w);if(Array.isArray(w[0])&&(w=w[0]),2>w.length)throw new L("streams");var R,S=w.map(function(A,U){var k=U<w.length-1;return b(A,k,0<U,function(D){R||(R=D),D&&S.forEach(h),k||(S.forEach(h),C(R))})});return w.reduce(f)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(o,a){function l(g,b,h){return g.highWaterMark==null?b?g[h]:null:g.highWaterMark}var u=o("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(g,b,h,f){var p=l(b,f,h);if(p!=null){if(!(isFinite(p)&&n(p)===p)||0>p){var y=f?h:"highWaterMark";throw new u(y,p)}return n(p)}return g.objectMode?16:16384}}},{"../../../errors":15}],28:[function(o,a){a.exports=o("events").EventEmitter},{events:7}],29:[function(o,a,l){l=a.exports=o("./lib/_stream_readable.js"),l.Stream=l,l.Readable=l,l.Writable=o("./lib/_stream_writable.js"),l.Duplex=o("./lib/_stream_duplex.js"),l.Transform=o("./lib/_stream_transform.js"),l.PassThrough=o("./lib/_stream_passthrough.js"),l.finished=o("./lib/internal/streams/end-of-stream.js"),l.pipeline=o("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(o,a,l){function u(f,p){for(var y in f)p[y]=f[y]}function g(f,p,y){return h(f,p,y)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var b=o("buffer"),h=b.Buffer;h.from&&h.alloc&&h.allocUnsafe&&h.allocUnsafeSlow?a.exports=b:(u(b,l),l.Buffer=g),g.prototype=Object.create(h.prototype),u(h,g),g.from=function(f,p,y){if(typeof f=="number")throw new TypeError("Argument must not be a number");return h(f,p,y)},g.alloc=function(f,p,y){if(typeof f!="number")throw new TypeError("Argument must be a number");var v=h(f);return p===void 0?v.fill(0):typeof y=="string"?v.fill(p,y):v.fill(p),v},g.allocUnsafe=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return h(f)},g.allocUnsafeSlow=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return b.SlowBuffer(f)}},{buffer:3}],31:[function(o,a,l){function u(S){if(!S)return"utf8";for(var A;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(A)return;S=(""+S).toLowerCase(),A=!0}}function g(S){var A=u(S);if(typeof A!="string"&&(C.isEncoding===R||!R(S)))throw new Error("Unknown encoding: "+S);return A||S}function b(S){this.encoding=g(S);var A;switch(this.encoding){case"utf16le":this.text=v,this.end=L,A=4;break;case"utf8":this.fillLast=y,A=4;break;case"base64":this.text=T,this.end=I,A=3;break;default:return this.write=w,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=C.allocUnsafe(A)}function h(S){return 127>=S?0:S>>5==6?2:S>>4==14?3:S>>3==30?4:S>>6==2?-1:-2}function f(S,A,U){var k=A.length-1;if(k<U)return 0;var D=h(A[k]);return 0<=D?(0<D&&(S.lastNeed=D-1),D):--k<U||D===-2?0:(D=h(A[k]),0<=D?(0<D&&(S.lastNeed=D-2),D):--k<U||D===-2?0:(D=h(A[k]),0<=D?(0<D&&(D===2?D=0:S.lastNeed=D-3),D):0))}function p(S,A){if((192&A[0])!=128)return S.lastNeed=0,"";if(1<S.lastNeed&&1<A.length){if((192&A[1])!=128)return S.lastNeed=1,"";if(2<S.lastNeed&&2<A.length&&(192&A[2])!=128)return S.lastNeed=2,""}}function y(S){var A=this.lastTotal-this.lastNeed,U=p(this,S);return U===void 0?this.lastNeed<=S.length?(S.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,A,0,S.length),void(this.lastNeed-=S.length)):U}function v(S,A){if((S.length-A)%2==0){var U=S.toString("utf16le",A);if(U){var k=U.charCodeAt(U.length-1);if(55296<=k&&56319>=k)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],U.slice(0,-1)}return U}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",A,S.length-1)}function L(S){var A=S&&S.length?this.write(S):"";if(this.lastNeed){var U=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,U)}return A}function T(S,A){var U=(S.length-A)%3;return U==0?S.toString("base64",A):(this.lastNeed=3-U,this.lastTotal=3,U==1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",A,S.length-U))}function I(S){var A=S&&S.length?this.write(S):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function w(S){return S.toString(this.encoding)}function _(S){return S&&S.length?this.write(S):""}var C=o("safe-buffer").Buffer,R=C.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};l.StringDecoder=b,b.prototype.write=function(S){if(S.length===0)return"";var A,U;if(this.lastNeed){if(A=this.fillLast(S),A===void 0)return"";U=this.lastNeed,this.lastNeed=0}else U=0;return U<S.length?A?A+this.text(S,U):this.text(S,U):A||""},b.prototype.end=function(S){var A=S&&S.length?this.write(S):"";return this.lastNeed?A+"":A},b.prototype.text=function(S,A){var U=f(this,S,A);if(!this.lastNeed)return S.toString("utf8",A);this.lastTotal=U;var k=S.length-(U-this.lastNeed);return S.copy(this.lastChar,0,k),S.toString("utf8",A,k)},b.prototype.fillLast=function(S){return this.lastNeed<=S.length?(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),void(this.lastNeed-=S.length))}},{"safe-buffer":30}],32:[function(o,a){(function(l){(function(){function u(g){try{if(!l.localStorage)return!1}catch{return!1}var b=l.localStorage[g];return b!=null&&(b+"").toLowerCase()==="true"}a.exports=function(g,b){function h(){if(!f){if(u("throwDeprecation"))throw new Error(b);u("traceDeprecation")?console.trace(b):console.warn(b),f=!0}return g.apply(this,arguments)}if(u("noDeprecation"))return g;var f=!1;return h}}).call(this)}).call(this,typeof Jt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Jt)},{}],"/":[function(o,a){function l(I){return I.replace(/a=ice-options:trickle\s\n/g,"")}function u(I){console.warn(I)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const g=o("debug")("simple-peer"),b=o("get-browser-rtc"),h=o("randombytes"),f=o("readable-stream"),p=o("queue-microtask"),y=o("err-code"),{Buffer:v}=o("buffer"),L=65536;class T extends f.Duplex{constructor(w){if(w=Object.assign({allowHalfOpen:!1},w),super(w),this._id=h(4).toString("hex").slice(0,7),this._debug("new peer %o",w),this.channelName=w.initiator?w.channelName||h(20).toString("hex"):null,this.initiator=w.initiator||!1,this.channelConfig=w.channelConfig||T.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},T.config,w.config),this.offerOptions=w.offerOptions||{},this.answerOptions=w.answerOptions||{},this.sdpTransform=w.sdpTransform||(_=>_),this.streams=w.streams||(w.stream?[w.stream]:[]),this.trickle=w.trickle===void 0||w.trickle,this.allowHalfTrickle=w.allowHalfTrickle!==void 0&&w.allowHalfTrickle,this.iceCompleteTimeout=w.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=w.wrtc&&typeof w.wrtc=="object"?w.wrtc:b(),!this._wrtc)throw y(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(y(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(y(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(w){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof w=="string")try{w=JSON.parse(w)}catch{w={}}this._debug("signal()"),w.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),w.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(w.transceiverRequest.kind,w.transceiverRequest.init)),w.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(w.candidate):this._pendingCandidates.push(w.candidate)),w.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(w)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(y(_,"ERR_SET_REMOTE_DESCRIPTION"))}),w.sdp||w.candidate||w.renegotiate||w.transceiverRequest||this.destroy(y(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(w){const _=new this._wrtc.RTCIceCandidate(w);this._pc.addIceCandidate(_).catch(C=>{!_.address||_.address.endsWith(".local")?u("Ignoring unsupported ICE candidate."):this.destroy(y(C,"ERR_ADD_ICE_CANDIDATE"))})}send(w){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(w)}}addTransceiver(w,_){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(w,_),this._needsNegotiation()}catch(C){this.destroy(y(C,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:w,init:_}})}}addStream(w){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),w.getTracks().forEach(_=>{this.addTrack(_,w)})}}addTrack(w,_){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const C=this._senderMap.get(w)||new Map;let R=C.get(_);if(!R)R=this._pc.addTrack(w,_),C.set(_,R),this._senderMap.set(w,C),this._needsNegotiation();else throw R.removed?y(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):y(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(w,_,C){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const R=this._senderMap.get(w),S=R?R.get(C):null;if(!S)throw y(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,R),S.replaceTrack==null?this.destroy(y(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):S.replaceTrack(_)}removeTrack(w,_){if(this.destroying)return;if(this.destroyed)throw y(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const C=this._senderMap.get(w),R=C?C.get(_):null;if(!R)throw y(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{R.removed=!0,this._pc.removeTrack(R)}catch(S){S.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(R):this.destroy(y(S,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(w){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),w.getTracks().forEach(_=>{this.removeTrack(_,w)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw y(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(w){this._destroy(w,()=>{})}_destroy(w,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",w&&(w.message||w)),p(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",w&&(w.message||w)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,w&&this.emit("error",w),this.emit("close"),_()}))}_setupData(w){if(!w.channel)return this.destroy(y(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=w.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=L),this.channelName=this._channel.label,this._channel.onmessage=C=>{this._onChannelMessage(C)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=C=>{const R=C.error instanceof Error?C.error:new Error(`Datachannel error: ${C.message} ${C.filename}:${C.lineno}:${C.colno}`);this.destroy(y(R,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(w,_,C){if(this.destroyed)return C(y(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(w)}catch(R){return this.destroy(y(R,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>L?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=C):C(null)}else this._debug("write before connect"),this._chunk=w,this._cb=C}_onFinish(){if(!this.destroyed){const w=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?w():this.once("connect",w)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(w=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(w.sdp=l(w.sdp)),w.sdp=this.sdpTransform(w.sdp);const _=()=>{if(!this.destroyed){const C=this._pc.localDescription||w;this._debug("signal"),this.emit("signal",{type:C.type,sdp:C.sdp})}};this._pc.setLocalDescription(w).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(C=>{this.destroy(y(C,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(w=>{this.destroy(y(w,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(w=>{w.mid||!w.sender.track||w.requested||(w.requested=!0,this.addTransceiver(w.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(w=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(w.sdp=l(w.sdp)),w.sdp=this.sdpTransform(w.sdp);const _=()=>{if(!this.destroyed){const C=this._pc.localDescription||w;this._debug("signal"),this.emit("signal",{type:C.type,sdp:C.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(w).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(C=>{this.destroy(y(C,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(w=>{this.destroy(y(w,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(y(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const w=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",w,_),this.emit("iceStateChange",w,_),(w==="connected"||w==="completed")&&(this._pcReady=!0,this._maybeReady()),w==="failed"&&this.destroy(y(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),w==="closed"&&this.destroy(y(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(w){const _=C=>(Object.prototype.toString.call(C.values)==="[object Array]"&&C.values.forEach(R=>{Object.assign(C,R)}),C);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(C=>{const R=[];C.forEach(S=>{R.push(_(S))}),w(null,R)},C=>w(C)):0<this._pc.getStats.length?this._pc.getStats(C=>{if(this.destroyed)return;const R=[];C.result().forEach(S=>{const A={};S.names().forEach(U=>{A[U]=S.stat(U)}),A.id=S.id,A.type=S.type,A.timestamp=S.timestamp,R.push(_(A))}),w(null,R)},C=>w(C)):w(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const w=()=>{this.destroyed||this.getStats((_,C)=>{if(this.destroyed)return;_&&(C=[]);const R={},S={},A={};let U=!1;C.forEach(D=>{(D.type==="remotecandidate"||D.type==="remote-candidate")&&(R[D.id]=D),(D.type==="localcandidate"||D.type==="local-candidate")&&(S[D.id]=D),(D.type==="candidatepair"||D.type==="candidate-pair")&&(A[D.id]=D)});const k=D=>{U=!0;let B=S[D.localCandidateId];B&&(B.ip||B.address)?(this.localAddress=B.ip||B.address,this.localPort=+B.port):B&&B.ipAddress?(this.localAddress=B.ipAddress,this.localPort=+B.portNumber):typeof D.googLocalAddress=="string"&&(B=D.googLocalAddress.split(":"),this.localAddress=B[0],this.localPort=+B[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let P=R[D.remoteCandidateId];P&&(P.ip||P.address)?(this.remoteAddress=P.ip||P.address,this.remotePort=+P.port):P&&P.ipAddress?(this.remoteAddress=P.ipAddress,this.remotePort=+P.portNumber):typeof D.googRemoteAddress=="string"&&(P=D.googRemoteAddress.split(":"),this.remoteAddress=P[0],this.remotePort=+P[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(C.forEach(D=>{D.type==="transport"&&D.selectedCandidatePairId&&k(A[D.selectedCandidatePairId]),(D.type==="googCandidatePair"&&D.googActiveConnection==="true"||(D.type==="candidatepair"||D.type==="candidate-pair")&&D.selected)&&k(D)}),!U&&(!Object.keys(A).length||Object.keys(S).length))return void setTimeout(w,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(B){return this.destroy(y(B,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const D=this._cb;this._cb=null,D(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};w()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>L)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(w=>{this._pc.removeTrack(w),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(w){this.destroyed||(w.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:w.candidate.candidate,sdpMLineIndex:w.candidate.sdpMLineIndex,sdpMid:w.candidate.sdpMid}}):!w.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),w.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(w){if(this.destroyed)return;let _=w.data;_ instanceof ArrayBuffer&&(_=v.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const w=this._cb;this._cb=null,w(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(w){this.destroyed||w.streams.forEach(_=>{this._debug("on track"),this.emit("track",w.track,_),this._remoteTracks.push({track:w.track,stream:_}),this._remoteStreams.some(C=>C.id===_.id)||(this._remoteStreams.push(_),p(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){const w=[].slice.call(arguments);w[0]="["+this._id+"] "+w[0],g.apply(null,w)}}T.WEBRTC_SUPPORT=!!b(),T.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},T.channelConfig={},a.exports=T},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(xo);var sh=xo.exports;const oh=Ho(sh),Ei=0,ki=1,Lo=2,Oo=(e,t)=>{q(e,Ei);const n=Kl(t);at(e,n)},Io=(e,t,n)=>{q(e,ki),at(e,$l(t,n))},ah=(e,t,n)=>Io(t,n,pt(e)),Mo=(e,t,n)=>{try{ql(t,pt(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},ch=(e,t)=>{q(e,Lo),at(e,t)},lh=Mo,uh=(e,t,n,r)=>{const s=Y(e);switch(s){case Ei:ah(e,t,n);break;case ki:Mo(e,n,r);break;case Lo:lh(e,n,r);break;default:throw new Error("Unknown message type")}return s},Lr=3e4;class hh extends or{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=de();this.getLocalState()!==null&&Lr/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((s,o)=>{o!==this.clientID&&Lr<=n-s.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&Gr(this,r,"timeout")},te(Lr/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,r=this.meta.get(n),s=r===void 0?0:r.clock+1,o=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:s,lastUpdated:de()});const a=[],l=[],u=[],g=[];t===null?g.push(n):o==null?t!=null&&a.push(n):(l.push(n),ln(o,t)||u.push(n)),(a.length>0||u.length>0||g.length>0)&&this.emit("change",[{added:a,updated:u,removed:g},"local"]),this.emit("update",[{added:a,updated:l,removed:g},"local"])}setLocalStateField(t,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}}const Gr=(e,t,n)=>{const r=[];for(let s=0;s<t.length;s++){const o=t[s];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){const a=e.meta.get(o);e.meta.set(o,{clock:a.clock+1,lastUpdated:de()})}r.push(o)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},tr=(e,t,n=e.states)=>{const r=t.length,s=bt();q(s,r);for(let o=0;o<r;o++){const a=t[o],l=n.get(a)||null,u=e.meta.get(a).clock;q(s,a),q(s,u),Zt(s,JSON.stringify(l))}return ot(s)},dh=(e,t,n)=>{const r=se(t),s=de(),o=[],a=[],l=[],u=[],g=Y(r);for(let b=0;b<g;b++){const h=Y(r);let f=Y(r);const p=JSON.parse(ue(r)),y=e.meta.get(h),v=e.states.get(h),L=y===void 0?0:y.clock;(L<f||L===f&&p===null&&e.states.has(h))&&(p===null?h===e.clientID&&e.getLocalState()!=null?f++:e.states.delete(h):e.states.set(h,p),e.meta.set(h,{clock:f,lastUpdated:s}),y===void 0&&p!==null?o.push(h):y!==void 0&&p===null?u.push(h):p!==null&&(ln(p,v)||l.push(h),a.push(h)))}(o.length>0||l.length>0||u.length>0)&&e.emit("change",[{added:o,updated:l,removed:u},n]),(o.length>0||a.length>0||u.length>0)&&e.emit("update",[{added:o,updated:a,removed:u},n])},fh=(e,t)=>{const n=Vr(e).buffer,r=Vr(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(s=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},No=(e,t)=>{if(!t)return ai(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{const s=bt();return Zt(s,"AES-GCM"),at(s,n),at(s,new Uint8Array(r)),ot(s)})},gh=(e,t)=>{const n=bt();return We(n,e),No(ot(n),t)},Uo=(e,t)=>{if(!t)return ai(e);const n=se(e);ue(n)!=="AES-GCM"&&Qc(ee("Unknown encryption algorithm"));const s=pt(n),o=pt(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:s},t,o).then(a=>new Uint8Array(a))},ph=(e,t)=>Uo(e,t).then(n=>qe(se(new Uint8Array(n)))),Wt=Ll("y-webrtc"),Ve=0,Fo=3,mn=1,Ri=4,er=new Map,De=new Map,Bo=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),Wt("synced ",Ft,e.name,xe," with all peers"))},jo=(e,t,n)=>{const r=se(t),s=bt(),o=Y(r);if(e===void 0)return null;const a=e.awareness,l=e.doc;let u=!1;switch(o){case Ve:{q(s,Ve);const g=uh(r,s,l,e);g===ki&&!e.synced&&n(),g===Ei&&(u=!0);break}case Fo:q(s,mn),at(s,tr(a,Array.from(a.getStates().keys()))),u=!0;break;case mn:dh(a,pt(r),e);break;case Ri:{const g=Te(r)===1,b=ue(r);if(b!==e.peerId&&(e.bcConns.has(b)&&!g||!e.bcConns.has(b)&&g)){const h=[],f=[];g?(e.bcConns.add(b),f.push(b)):(e.bcConns.delete(b),h.push(b)),e.provider.emit("peers",[{added:f,removed:h,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),Po(e)}break}default:return console.error("Unable to compute message"),s}return u?s:null},yh=(e,t)=>{const n=e.room;return Wt("received message from ",Ft,e.remotePeerId,ui," (",n.name,")",xe,ur),jo(n,t,()=>{e.synced=!0,Wt("synced ",Ft,n.name,xe," with ",Ft,e.remotePeerId),Bo(n)})},Or=(e,t)=>{Wt("send message to ",Ft,e.remotePeerId,xe,ui," (",e.room.name,")",ur);try{e.peer.send(ot(t))}catch{}},bh=(e,t)=>{Wt("broadcast message in ",Ft,e.name,xe),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class us{constructor(t,n,r,s){Wt("establishing connection to ",Ft,r),this.room=s,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new oh({initiator:n,...s.provider.peerOpts}),this.peer.on("signal",o=>{Di(t,s,{to:r,from:s.peerId,type:"signal",signal:o})}),this.peer.on("connect",()=>{Wt("connected to ",Ft,r),this.connected=!0;const a=s.provider.doc,l=s.awareness,u=bt();q(u,Ve),Oo(u,a),Or(this,u);const g=l.getStates();if(g.size>0){const b=bt();q(b,mn),at(b,tr(l,Array.from(g.keys()))),Or(this,b)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,s.webrtcConns.has(this.remotePeerId)&&(s.webrtcConns.delete(this.remotePeerId),s.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}])),Bo(s),this.peer.destroy(),Wt("closed connection to ",Ft,r),Jr(s)}),this.peer.on("error",o=>{Wt("Error in connection to ",Ft,r,": ",o),Jr(s)}),this.peer.on("data",o=>{const a=yh(this,o);a!==null&&Or(this,a)})}destroy(){this.peer.destroy()}}const ve=(e,t)=>No(t,e.key).then(n=>e.mux(()=>rh(e.name,n))),hs=(e,t)=>{e.bcconnected&&ve(e,t),bh(e,t)},Jr=e=>{er.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&Di(t,e,{type:"announce",from:e.peerId}))})},Po=e=>{if(e.provider.filterBcConns){const t=bt();q(t,Ri),gn(t,1),Zt(t,e.peerId),ve(e,ot(t))}};class wh{constructor(t,n,r,s){this.peerId=Is(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=s,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=ih(),this.bcconnected=!1,this._bcSubscriber=o=>Uo(new Uint8Array(o),s).then(a=>this.mux(()=>{const l=jo(this,a,()=>{});l&&ve(this,ot(l))})),this._docUpdateHandler=(o,a)=>{const l=bt();q(l,Ve),ch(l,o),hs(this,ot(l))},this._awarenessUpdateHandler=({added:o,updated:a,removed:l},u)=>{const g=o.concat(a).concat(l),b=bt();q(b,mn),at(b,tr(this.awareness,g)),hs(this,ot(b))},this._beforeUnloadHandler=()=>{Gr(this.awareness,[t.clientID],"window unload"),De.forEach(o=>{o.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Jr(this);const t=this.name;eh(t,this._bcSubscriber),this.bcconnected=!0,Po(this);const n=bt();q(n,Ve),Oo(n,this.doc),ve(this,ot(n));const r=bt();q(r,Ve),Io(r,this.doc),ve(this,ot(r));const s=bt();q(s,Fo),ve(this,ot(s));const o=bt();q(o,mn),at(o,tr(this.awareness,[this.doc.clientID])),ve(this,ot(o))}disconnect(){er.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Gr(this.awareness,[this.doc.clientID],"disconnect");const t=bt();q(t,Ri),gn(t,0),Zt(t,this.peerId),ve(this,ot(t)),nh(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const mh=(e,t,n,r)=>{if(De.has(n))throw ee(`A Yjs Doc connected to room "${n}" already exists!`);const s=new wh(e,t,n,r);return De.set(n,s),s},Di=(e,t,n)=>{t.key?gh(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:js(r)})}):e.send({type:"publish",topic:t.name,data:n})};class vh extends Zu{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{Wt(`connected (${t})`);const n=Array.from(De.keys());this.send({type:"subscribe",topics:n}),De.forEach(r=>Di(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const r=n.topic,s=De.get(r);if(s==null||typeof r!="string")return;const o=a=>{const l=s.webrtcConns,u=s.peerId;if(a==null||a.from===u||a.to!==void 0&&a.to!==u||s.bcConns.has(a.from))return;const g=l.has(a.from)?()=>{}:()=>s.provider.emit("peers",[{removed:[],added:[a.from],webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}]);switch(a.type){case"announce":l.size<s.provider.maxConns&&(Bt(l,a.from,()=>new us(this,!0,a.from,s)),g());break;case"signal":a.to===u&&(Bt(l,a.from,()=>new us(this,!1,a.from,s)).peer.signal(a.signal),g());break}};s.key?typeof n.data=="string"&&ph(Ps(n.data),s.key).then(o):o(n.data)}}}),this.on("disconnect",()=>Wt(`disconnect (${t})`))}}class _h extends or{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:s=null,awareness:o=new hh(n),maxConns:a=20+te(Xc()*15),filterBcConns:l=!0,peerOpts:u={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=l,this.awareness=o,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=a,this.peerOpts=u,this.key=s?fh(s,t):ai(null),this.room=null,this.key.then(g=>{this.room=mh(n,this,t,g),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=Bt(er,t,()=>new vh(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),er.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),De.delete(this.roomName)}),super.destroy()}}const Vo=F.createContext(void 0);function Ch(e){const{children:t}=e;function n(s){}function r(s){}return Et.jsx(Vo.Provider,{value:{registerPile:n,unregisterPile:r},children:t})}function Sh(e){const{children:t,style:n}=e,r=F.useRef(new Xe),s=F.useRef();F.useEffect(()=>{const b={name:"my room",password:"abc",playerName:"some guy"},h=r.current,f={signaling:[],password:b.password},p=new _h(b.name,h,f);p.awareness.on("update",o);const y={name:b.playerName};return p.awareness.setLocalState(y),s.current=p.awareness,()=>{p.destroy()}},[]);function o(){}function a(g){const b=g.active.id.toString(),h=g.active.data.current,{over:f}=g;return{card:{...h,id:b},sourcePile:h.parentPile,targetPile:f?f.id.toString():void 0}}function l(g){const b=a(g);console.log("drag start",b)}function u(g){const b=a(g);console.log("drag end",b)}return Et.jsx("div",{className:"table",style:n,children:Et.jsx(uc,{onDragStart:l,onDragEnd:u,children:Et.jsx(Ch,{children:t})})})}function Eh(e){let t=1779033703,n=3144134277,r=1013904242,s=2773480762;for(let o=0,a;o<e.length;o++)a=e.charCodeAt(o),t=n^Math.imul(t^a,597399067),n=r^Math.imul(n^a,2869860233),r=s^Math.imul(r^a,951274213),s=t^Math.imul(s^a,2716044179);return t=Math.imul(r^t>>>18,597399067),n=Math.imul(s^n>>>22,2869860233),r=Math.imul(t^r>>>17,951274213),s=Math.imul(n^s>>>19,2716044179),[(t^n^r^s)>>>0,(n^t)>>>0,(r^t)>>>0,(s^t)>>>0]}function kh(e,t,n,r){return function(){e>>>=0,t>>>=0,n>>>=0,r>>>=0;let s=e+t|0;return e=t^t>>>9,t=n+(n<<3)|0,n=n<<21|n>>>11,r=r+1|0,s=s+r|0,n=n+s|0,(s>>>0)/4294967296}}function Rh(e=3,t="seed"){const n=Eh(t),r=kh(...n);return Xt.map(Xt.range(0,e),()=>r())}function Dh(e){const{id:t,children:n,offset:r,rotation:s,style:o}=e,a=1.1,{isDragging:l,attributes:u,listeners:g,transform:b,setNodeRef:h}=fc({id:t,data:e}),[f,p]=F.useState(!1),[y]=$o(()=>{const[L,T]=r||[0,0],I=Xt.chain([b?`translate3d(${b.x+L}px, ${b.y+T}px, 0px)`:`translate3d(${L}px, ${T}px, 0px)`,l?`scaleX(${a}) scaleY(${a})`:"scaleX(1) scaleY(1)",Xt.isNumber(s)?`rotate(${s}deg)`:"rotate(0deg)"]).compact().join(" ").value();return{config:{mass:2,tension:600,friction:50},transform:I,onStart:()=>p(!0),onRest:()=>p(!1)}},[b,l,r,s]),v=Xt.chain(["card",l||f?"dragging":void 0]).compact().join(" ").value();return Et.jsxs(Yo.div,{ref:h,className:v,style:o?{...y,...o}:y,...g,...u,children:[Et.jsx("div",{className:"back"}),Et.jsx("div",{className:"front",children:n})]})}function Ir(e){const{id:t,cards:n,cardOffset:r,cardMess:s,style:o}=e,a=[0,20],l=10,{isOver:u,setNodeRef:g}=yc({id:t}),[b,h]=F.useState([]),[f,p]=F.useState([]),y=F.useContext(Vo),v={rotations:`${t}.rotations`};F.useEffect(()=>{if(y)return y.registerPile(e),()=>{y.unregisterPile(e)}},[]),F.useEffect(()=>{const T=Xt.map(Rh((n==null?void 0:n.length)||0,v.rotations),w=>(w*2-1)*(s||l));p(T);const I=Xt.chain(n).map((w,_)=>Xt.chain([w.offset,r!==void 0?[r[0]*_,r[1]*_]:void 0,[a[0]*_,a[1]*_]]).compact().first().value()).value();h(I)},[t,n,r,s]);const L=Xt.chain(["pile",u?"active":void 0]).compact().join(" ").value();return Et.jsx(Et.Fragment,{children:Et.jsx("div",{ref:g,className:L,style:o,children:n?n.map((T,I)=>{const w=b[I]||[0,0],_=T.rotation||Xt.get(f,I)||0;return Et.jsx(Dh,{...T,parentPile:t,offset:w,rotation:_,style:{position:"absolute",top:"1em",left:"1em"}},T.id)}):null})})}function xh(){return Et.jsx("div",{className:"route deck",children:Et.jsxs(Sh,{style:{display:"flex",gap:"0.5em",aspectRatio:"16/9",width:"auto",height:"100%",maxWidth:"100%",justifyContent:"space-evenly",alignItems:"center"},children:[Et.jsx(Ir,{id:"pile-1",cards:[{id:"card-3",children:"C"},{id:"card-4",children:"D"},{id:"card-5",children:"E"},{id:"card-6",children:"F"}]}),Et.jsx(Ir,{id:"pile-2",cards:[{id:"card-7",children:"G"}]}),Et.jsx(Ir,{id:"pile-3"})]})})}export{xh as RouteDeck,xh as default};
