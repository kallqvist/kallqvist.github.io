var N=Object.defineProperty;var _=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var I=(s,e,t)=>(_(s,typeof e!="symbol"?e+"":e,t),t),y=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var a=(s,e,t)=>(y(s,e,"read from private field"),t?t.call(s):e.get(s)),M=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},R=(s,e,t,r)=>(y(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var O=(s,e,t)=>(y(s,e,"access private method"),t);import{r as h,j as i,F as J,i as K,l as Q,m as Z}from"./index-O0Fl2C7K.js";import{G as $,a as tt,n as et,u as m,b as nt,V as A}from"./index-IS-IpSmw.js";class j extends ${constructor(t,r){super(t);I(this,"wall");this.wall=r||!1}getRGBA(){return this.wall?[255,0,100,255]:[0,0,0,0]}}var o,d,F,S;class st{constructor(e){M(this,F);M(this,o,void 0);M(this,d,!1);R(this,o,new tt({...e,createEmpty:t=>new j(t)})),this.restart()}start(){R(this,d,!0)}stop(){R(this,d,!1)}isRunning(){return a(this,d)}getGrid(){return a(this,o)}restart(){this.stop(),a(this,o).forEach(e=>{a(this,o).set(e.position,new j(a(this,o),Math.random()>.5))})}step(e){if(!a(this,d))return;const t=a(this,o).map(r=>r.wall);a(this,o).forEach(r=>{let c=O(this,F,S).call(this,t,r);r.wall!==c&&a(this,o).setAtIndex(r.index,new j(a(this,o),c))})}}o=new WeakMap,d=new WeakMap,F=new WeakSet,S=function(e,t){let r=0;return et.forEach(c=>{if(!t.position)return;const v=a(this,o).position2index(t.position.add(c));e[v]===!0&&r++}),t.wall&&(r<2||r>3)?!1:!t.wall&&r===3?!0:t.wall};function at(){const t=.08333333333333333,r=h.useRef(),[c,v]=m(void 0),p=h.useRef(),w=h.useRef(void 0),[E,b]=m(void 0),[C,W]=m(new A(0,0)),[x,q]=m(!1),[P,k]=m(-1);h.useEffect(()=>(r.current=new st({width:160,height:90}),v(r.current.getGrid()),D(),p.current=requestAnimationFrame(z),()=>{p.current!==void 0&&cancelAnimationFrame(p.current)}),[]),h.useEffect(()=>{const n=r.current;n&&(x.current?n.start():n.stop())},[x]);function B(n){n.preventDefault()}function L(n){var H;const l=n.target,{x:u,y:f,width:g,height:G}=l.getBoundingClientRect(),Y=new A(Math.floor((n.clientX-u)/g*160),Math.floor((n.clientY-f)/G*90)),T=(H=c.current)==null?void 0:H.get(Y);T&&b(T.wall?"erase":"add")}function U(){b(void 0),w.current=void 0}function V(n){const l=n.target,{x:u,y:f,width:g,height:G}=l.getBoundingClientRect();W(new A(Math.floor((n.clientX-u)/g*160),Math.floor((n.clientY-f)/G*90)))}function z(n){if(P.current===-1)k(n);else{const l=(n-P.current)/1e3;if(l>t){const u=r.current;if(!u)return;X(u.getGrid()),x.current&&u.step(l),k(n)}}p.current=requestAnimationFrame(z)}function X(n){if(E.current===void 0||!r.current)return;(w.current?n.getPositionsInLine(w.current,C.current):[C.current]).forEach(f=>{n.get(f)&&n.set(f,new j(n,E.current==="add"))}),w.current=C.current}function D(){const n=r.current;n&&n.restart()}return i.jsxs("div",{className:"route maze",children:[i.jsxs("div",{style:{position:"absolute",top:0,width:"100%",display:"flex",justifyContent:"center",background:"black",color:"white",zIndex:100},children:[i.jsx("button",{onClick:()=>q(n=>!n),children:x.current?i.jsxs(i.Fragment,{children:[i.jsx(J,{}),"stop"]}):i.jsxs(i.Fragment,{children:[i.jsx(K,{}),"start"]})}),i.jsxs("button",{onClick:()=>{var n;return(n=r.current)==null?void 0:n.step(1)},children:[i.jsx(Q,{}),"step"]}),i.jsxs("button",{onClick:()=>D(),children:[i.jsx(Z,{}),"reset"]})]}),i.jsx(nt,{grid:c.current,onMouseDown:L,onMouseUp:U,onMouseMove:V,onContextMenu:B})]})}export{at as default};
